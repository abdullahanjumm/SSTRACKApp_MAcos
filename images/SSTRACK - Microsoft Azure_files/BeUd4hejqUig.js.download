define("MsPortalImpl.Controls/Controls/Base/WidgetBinding",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTabIndexProperty=t.chainEnabledTabIndexProperties=t.chainDisabledProperties=t.contextFor=t.createChainedContext=t.createChildContext=t.createIsolatedContext=t.getContext=void 0;var s=MsPortalFx.isUndefined;function o(e,t){let o;return s(e)||(o=ko.unwrap(e)),s(o)?t:o}function i(e,t){const s=c([e.$disabled,t.$disabled]),o=d([e.$enabledTabIndex,t.$enabledTabIndex]);return{$disabled:s,$enabledTabIndex:o,$tabIndex:p(o,s)}}function n(e){return ko.contextFor($(e)[0])}function r(e){return new ko.bindingContext(e)}function a(e,t,s,o){let i=o||n(e);return i=i?i.createChildContext(t):r(t),s&&(i=i.extend(s)),i}function l(e,t){const s=i(e,t);return e.extend(s)}function c(e){return ko.pureComputed((()=>{let t=!1;for(let s=0;s<e.length;s++){const i=o(e[s],!1);t=t||i}return t}))}function d(e){return ko.pureComputed((()=>{let t=0;for(let s=0;s<e.length;s++){const i=o(e[s],0);null===t||null===i?t=null:t<0||(t=i)}return t}))}function p(e,t){return ko.pureComputed((()=>t()?-1:e()))}t.getContext=n,t.createIsolatedContext=function(e,t){return r(e).extend({$dicontainer:t.$dicontainer,$disabled:t.$disabled,$enabledTabIndex:t.$enabledTabIndex,$extensionName:t.$extensionName,$partName:t.$partName,$tabIndex:t.$tabIndex})},t.createChildContext=a,t.createChainedContext=l,t.contextFor=function(e){let t=n(e);return t||(t=r(null)),s(t.$disabled)&&(t=t.extend({$disabled:ko.pureComputed(MsPortalFx.wrap(!1))})),s(t.$tabIndex)&&(t=t.extend({$tabIndex:ko.pureComputed(MsPortalFx.wrap(0))})),s(t.$enabledTabIndex)&&(t=t.extend({$enabledTabIndex:ko.pureComputed(MsPortalFx.wrap(0))})),t},t.chainDisabledProperties=c,t.chainEnabledTabIndexProperties=d,t.makeTabIndexProperty=p,ko.bindingHandlers.context={init:function(e,t,s,o,n){const r=t(),l=i(n,{$disabled:r.$disabled,$enabledTabIndex:r.$tabIndex});r.$dicontainer&&(l.$dicontainer=r.$dicontainer);const c=a(e,o,l,n);return ko.applyBindingsToDescendants(c,e),{controlsDescendantBindings:!0}}},ko.virtualElements.allowedBindings.context=!0;const u=ko.bindingHandlers.template;ko.bindingHandlers.template={init:function(e,t,s,o,i){return u.init(e,t,s,o,i)},update:function(e,t,s,o,i){const n=t();let r=ko.unwrap(n);r="string"==typeof r?{name:n}:ko.utils.extend({},r);let a=r.context;a&&(i=ko.ignoreDependencies((()=>("function"==typeof a&&(a=a(r.data||o)),l(i,{$disabled:a.$disabled,$enabledTabIndex:a.$tabIndex})))),delete r.context);const c=i.$ctl,d=c&&c.templateEngine;return d&&r.name&&!r.templateEngine&&(r.templateEngine=d),t=()=>r,u.update(e,t,s,o,i)}}})),
define("MsPortalImpl/Base/Base.ElementWidgetMap",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAll=t.getAllMatch=t.remove=t.set=void 0;const s=new WeakMap;t.set=function(e,t){if(e&&t){const o=s.get(e);o?o.push(t):s.set(e,[t])}},t.remove=function(e,t){if(e&&t){let o=s.get(e);o&&(o=o.filter((e=>e!==t)),o.length>0?s.set(e,o):s.delete(e))}},t.getAllMatch=function(e,t){if(e){const o=s.get(e);return o&&o.filter((e=>e instanceof t))}},t.getAll=function(e){const t=e&&s.get(e);return t&&t.slice()}})),
define("MsPortalImpl/UI/Compositions/UI.Composition",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBladeType=t.bladeImplementedWithVirtualPart=t.isContextMenuContainer=t.tryGetAssetType=t.deepSubset=t.isPartComposition=t.findCommand=t.getIdMatchFunc=t.CompositionType=t.fxreplacedpartcomposing=t.CompositionInstanceDataName=t.PartContainerModelIdProperty=t.EditScopeIdPropertyName=t.referenceTypeMap=void 0;var s,o=MsPortalFx.Base.Constants.BladeParameterNames;t.referenceTypeMap={},t.referenceTypeMap[0]="Part",t.referenceTypeMap[1]="BladeInput",t.referenceTypeMap[2]="BladeActionBar",t.referenceTypeMap[3]="BladeProperty",t.referenceTypeMap[4]="Command",t.referenceTypeMap[5]="Constant",t.referenceTypeMap[6]="SelectedItem",t.referenceTypeMap[7]="Adapter",t.referenceTypeMap[8]="Dashboard",t.referenceTypeMap[9]="AdapterInput",t.EditScopeIdPropertyName=o.EditScopeId,t.PartContainerModelIdProperty="##SnapshotContainerId##",t.CompositionInstanceDataName="MsPortalImplCompositionInstance",t.fxreplacedpartcomposing="fxreplacedpartcomposing",function(e){e[e.Unknown=0]="Unknown",e[e.Part=1]="Part",e[e.StartboardPart=2]="StartboardPart",e[e.Lens=3]="Lens",e[e.BladeActionBar=4]="BladeActionBar",e[e.Blade=5]="Blade",e[e.Journey=6]="Journey",e[e.Startboard=7]="Startboard"}(s||(t.CompositionType=s={})),t.getIdMatchFunc=function(e){return t=>t.id===e},t.findCommand=function(e,t,s){if(!e)throw new Error("Commands list is required.");if(!t)throw new Error("Command name is required.");if(!s)throw new Error("Command container name is required.");return MsPortalFx.find(e,(e=>e.commandName===t))},t.isPartComposition=function(e){const t=e.locator&&e.locator.type;return 5===t||6===t||7===t},t.deepSubset=function(e,t){return Object.keys(t).every((s=>e.hasOwnProperty(s)&&MsPortalFx.deepEquals(t[s],e[s])))},t.tryGetAssetType=function(e){const t=e&&e.assetTypeId;if("string"==typeof t)return t},t.isContextMenuContainer=function(e){const t=e;return t&&t.beforeActivateCommandMenuItems&&"function"==typeof t.beforeActivateCommandMenuItems};const i={1:!0,3:!0,4:!0,2:!0,5:!0,6:!0};function n(e){let t;return t=12===e.style?4:e.templateBlade?1:e.frameBlade?2:e.menuBlade?3:16&e.attributes?5:e.tabMenuBlade?6:0,t}t.bladeImplementedWithVirtualPart=function(e){return!!i[n(e)]},t.getBladeType=n})),
define("MsPortalImpl/Services/Services.Tenants",["require","exports","FxHubs/ArmHelpers/ArmApisStartup","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","FxHubs/RpcEndPoints","Fx/Ajax","Fx","FxInternal/AsyncLoader"],(function(e,t,s,o,i,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.getHomeTenantsCountHandler=t.TenantsService=void 0;var c=MsPortalFx.Base,d=c.Diagnostics,p=d.Telemetry,u=c.Resources;const m="home",h=d.createLog(e),g="Services.Tenants",f={home:0,projectedby:0,managedby:0},x=(0,a.memoizePromise)((e=>{const t=p.startTrace({source:g,action:e});return(0,r.ajax)({uri:u.getAppRelativeUri("/api/directories/List"),type:"POST",dataType:"json",contentType:"application/json",performRetry:!0}).then((e=>(p.completeTrace(t,{tenantsCount:(e.tenants||[]).length,failure:e.failure}),e.tenants.forEach((e=>e.tenantCategory=e.tenantCategory||m)),e))).catch((e=>{throw p.cancelTrace(t),e}))})),b=(0,a.memoizePromise)((()=>{const e=p.start({source:g,action:"_getTenantsMemo"});return(0,r.batch)({uri:(0,s.listTenantsApi)(),setTelemetryHeader:g+".getTenants"}).then((t=>{const s=t.content.value||[];p.completeTrace(e,{tenantsCount:s.length});const o={failure:!1,tenants:[]},i={};return s.forEach((e=>{const t=e.displayName||"",s=e.domains||[],n=e.tenantId;let r=(e.tenantCategory||"").toLowerCase();r||(h.warning(`Tenant ${t}(${n}) received from ARM with missing tenantCategory. Treating it as 'Home' tenant.`),r=m);const a={displayName:t,domainName:e.defaultDomain||s[0]||"",id:n,tenantCategory:r};r.split(",").forEach((e=>{f[e]++})),(e.defaultDomain||1===s.length)&&t?o.tenants.push(a):i[n]=a})),p.trace({source:g,action:"tenantsInfo",data:{allTenantsCount:s.length,tenantsWithInfoCount:o.tenants.length,homeTenantsCount:f.home,projectedTenantsCount:f.projectedby,managedByTenantsCount:f.managedby}}),o.tenants.length!==s.length?x("GetTenantsFromArmFallback").then((e=>(e.tenants.forEach((e=>{const t=i[e.id];t&&(t.displayName=e.displayName||e.id,t.domainName=e.domainName||e.id)})),(0,a.forEachKey)(i,((e,t)=>{o.tenants.push(t)})),o))):o})).catch((t=>(p.cancelTrace(e,MsPortalFx.getLogFriendlyMessage(t)),MsPortalFx.Hubs.Notifications.ClientNotification.publish({title:i.tenantErrorTitle,description:i.tenantErrorDescription.format(location.hostname),status:MsPortalFx.Hubs.Notifications.NotificationStatus.Error}),{tenants:[],failure:!0})))})),y=(0,a.memoizePromise)((()=>b().then((e=>e.tenants.filter((e=>e.tenantCategory.toLowerCase().includes(m)))))));let v=class{getHomeTenantsCount(){return y().then((e=>e.length))}getTenants(){return b()}getHomeTenants(){return y()}};t.TenantsService=v,t.TenantsService=v=__decorate([__metadata("fx:diagnostics",[e,"TenantsService"]),o.Class()],v),t.getHomeTenantsCountHandler=(0,l.defineHandler)(n.Directories.getHomeTenantsCountEndPoint,(e=>e.diContainer.get(v).getHomeTenantsCount()))})),
define("MsPortalImpl/UI/UI.AuthStateManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Tenants","FxInternal/AsyncLoader","FxHubs/RpcEndPoints","Fx"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentUserEndPointHandler=t.getSubscriptions=t.AuthStateManager=t.getMsalJsLoginQueryParameters=t.hasFlag=void 0;var l=MsPortalFx.Base,c=l.Diagnostics,d=FxImpl.Rpc,p=HubsExtension.Internal.Azure,u=c.Telemetry,m=l.Resources,h=FxImpl.Security;const g=window,f=o.Services.PortalIdentity.tenantNameAndDomainFormat,x=MsPortalFx.ensureSuffix(m.getAppRelativeUri("/"),"/")+"SignOut";let b;function y(e,t){return(e&t)===t}t.hasFlag=y,t.getMsalJsLoginQueryParameters=function(e){return{"feature.msaljslogin":e,msaljsscript:e}};const v=(0,a.isFeatureEnabled)("persistcachedtokensonrefresh"),M={isAnonymous:!0};class C{constructor(e,t){if(this._diContainer=e,this.tokenCache={},this._persistAuthStateOnRefresh=!0,this.persist=()=>{"true"===MsPortalImpl.sessionStorage.getItem("MsalJsV3")&&!MsPortalImpl.localStorage.getItem("MsalJsV3")&&(this.disablePersistingAuthStateOnRefresh(),MsPortalImpl.sessionStorage.clear()),this._persistAuthStateOnRefresh&&(this.bootstrapState&&MsPortalImpl.sessionStorage.setItem("authState",JSON.stringify(this.bootstrapState)),v&&this.tokenCache&&Object.keys(this.tokenCache).length&&(u.trace({source:"UIAuthStateManager",action:"persistedTokenCache",data:{extensions:Object.keys(this.tokenCache)}}),MsPortalImpl.sessionStorage.setItem("extensionTokenCache",btoa(JSON.stringify(this.tokenCache)))))},this._loadCurrentDirectoryDetailsMemo=(0,a.memoizePromise)((()=>{const e=this.getCurrentUser();if((0,a.isFeatureEnabled)("tenants2020")&&!!e.tenantDisplayName){const{tenantDisplayName:t,tenantDomain:s}=e;return Promise.resolve({directoryName:t,domainName:s,uniqueDirectoryName:f.format(t,s)})}return this._diContainer.get(i.TenantsService).getHomeTenants().then((t=>{const s=(e.tenantId||"").toLowerCase(),o={};let i="",n="",r="";return t.forEach((t=>{if(s===(t.id||"").toLowerCase()){const s=e.tenantDomain||e.tenantId;t.displayName&&t.displayName!==t.id||(t.displayName=s),t.domainName&&t.domainName!==t.id||(t.domainName=s),i=r=t.displayName,n=t.domainName}else t.displayName?o[t.displayName.toLocaleLowerCase()]=!0:u.trace({source:"UIAuthStateManager",action:"getUserInfo",data:t})})),o[i.toLocaleLowerCase()]&&(r=f.format(i,n)),{directoryName:i,domainName:n,uniqueDirectoryName:r}}))})),this.bootstrapState={...t,loginReplyUrlPath:t?.loginReplyUrlPath||"/signin/index/"},(0,a.isFeatureEnabled)("singlesignout")&&g.addEventListener("storage",(e=>{"signOutAll"===e.key&&(this.clear(),g.location.href=x)})),MsPortalImpl.localStorage.getItem("authState")&&(u.trace({source:"UIAuthStateManager",action:"clearAuthState"}),this.clear(!0)),v){const e=MsPortalImpl.sessionStorage.getItem("extensionTokenCache");if(e){try{this.tokenCache=JSON.parse(atob(e)),u.trace({source:"UIAuthStateManager",action:"loadedTokenCache",data:{extensions:Object.keys(this.tokenCache)}})}catch(e){u.trace({source:"UIAuthStateManager",action:"errorLoadingTokenCache",data:{error:MsPortalFx.sanitizeMessage(JSON.stringify(e))}})}MsPortalImpl.localStorage.removeItem("extensionTokenCache")}}this.isInternal=fx.environment.internalTenants.includes((this.getCurrentUser().tenantId||"").toLowerCase());const s=[];this.onTokensUpdated=e=>{s.push(e)},this._notifyTokensUpdated=()=>{s.forEach((e=>e(this)))},document.addEventListener("visibilitychange",(function(){b="visible"===document.visibilityState}))}getPageVisibility(){return b}disablePersistingAuthStateOnRefresh(){this._persistAuthStateOnRefresh=!1}updateRefreshToken(e,t){u.trace({source:"UIAuthStateManager",action:"updateRefreshToken"});const s=this.bootstrapState||{},{refreshToken:o,...i}=s;this.updateBootstrapState({...i,refreshToken:e,altRefreshToken:t},"updateRefreshToken")}clear(e){e||(this.updateBootstrapState(null,"clear"),this.tokenCache&&delete this.tokenCache),MsPortalImpl.localStorage.removeItem("authState")}clearSpaAuthCode(){this.bootstrapState.spaAuthCode=""}getUserInfo(e){const t=MsPortalFx.isNullOrUndefined(e)?7:e;return(0,a.memoizePromise)((e=>Promise.all([this.getCurrentUser(),this._loadCurrentDirectoryDetailsMemo()]).then((([t,s])=>{let o={};return y(e,3)&&(o={...o,email:t.emailAddress,preferredUsername:t.preferredUsername,givenName:t.firstName,surname:t.lastName,isGitHubUser:!!t.gitHubUserId}),y(e,4)&&(o={...o,directoryId:t.tenantId,directoryName:s&&s.directoryName,domainName:s&&s.domainName,isOrgId:t.isOrgId,objectId:t.objectId,principalId:t.principalId,uniqueDirectoryName:s&&s.uniqueDirectoryName,isTenantAdmin:t.isTenantAdmin,countryCode:t.countryCode,isTenantParityDependent:t.isTenantParityDependent,dataBoundary:t.dataBoundary,armTenantDataBoundary:t.armTenantDataBoundary}),o}))))(t)}getSignedInUserTenant(){return this.getCurrentUser().tenantDomain||""}getCurrentUser(){return this.bootstrapState&&this.bootstrapState.user||M}updateBootstrapState(e,t){u.trace({source:"UIAuthStateManager",action:"updateBootstrapState",data:{caller:t,isBootstrapStateNull:!e}}),this.bootstrapState=e,this._notifyTokensUpdated()}async updateExtensionTokens(e,t,s,o){if(t.header&&!await h.validateTokenClaims({token:t.header,expectedClaims:{aud:o.audience,appId:o.appId},msalExpiresAtInMs:t.expiresAt,telemetrySource:"ShellTokenCache"})){u.trace({source:"UIAuthStateManager",action:"tokenCachingSkippedInvalidExpiration",data:{extensionName:e[0].name,msalTokenExpiresAt:t.expiresAt,resourceName:e[0].resource}});const o=await s;await o.localLogout()}else if(e?.length){const s=this.tokenCache;e.forEach((e=>{const o=e.resource??"",i=e.name;(s[i]||(s[i]={}))[o]=t})),this._notifyTokensUpdated()}}clearExtensionTokens(e){delete this.tokenCache[e],this._notifyTokensUpdated()}static create(e){return MsPortalEarly.authBootstrapStatePromise.then((t=>new C(e,t)))}}let P;t.AuthStateManager=C,__decorate([__metadata("fx:diagnostics",[e,"AuthStateManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",Promise)],C,"create",null),FxImpl.registerGlobalState({reset:()=>{P=null}}),t.getSubscriptions=function(){if(!P){const e=Promise.withResolvers();p.updateSubscriptionInfoEndPoint.register(d.client,"HubsExtension",(t=>{e.resolve(t)})),P=e.promise}return P},t.getCurrentUserEndPointHandler=n.defineHandler(r.Auth.getCurrentUserEndPoint,(e=>e.diContainer.get(C).getCurrentUser()))})),
define("MsPortalImpl/Base/JQueryHelper",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forceShow=t.filterVisible=t.getUnhideSelector=t.isVisible=t.isElementVisible=t.toggle=t.unhide=t.hide=t.findByClassName=t.jBody=void 0;const s="fxs-display-none",o=":not(.fxs-display-none)";function i(e){return e.addClass(s)}function n(e){return e.removeClass(s)}function r(e){return!!e.offsetParent}t.jBody=$(document.body),t.findByClassName=function(e,t){return e.find("."+t)},t.hide=i,t.unhide=n,t.toggle=function(e,t){return(t?n:i)(e)},t.isElementVisible=r,t.isVisible=function(e){return e.toArray().some(r)},t.getUnhideSelector=function(){return o},t.filterVisible=function(e,t){return $(e).find(t+o).filter(((t,o)=>!$(o).parentsUntil(e,"."+s).length))},t.forceShow=function(e,t){return n(e),e.show(t)}})),
define("MsPortalImpl/UI/UI.NavigationManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Base/JQueryHelper","FxInternal/AsyncLoader","FxInternal/Redirect","Fx/Ajax"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.forceSignInHandler=t.WindowManager=t.RootElements=t.Browser=void 0;var l=MsPortalFx.Base,c=l.UriBuilder,d=l.Diagnostics,p=l.Resources,u=d.Telemetry;const m=window,h=u.trace,g=MsPortalFx.pathJoin,f=MsPortalFx.ensureSuffix,x=f(p.getAppRelativeUri("/"),"/")+"signout/clearstate";function b(e){return t=>{t?i.unhide(e):i.hide(e)}}let y=class{confirm(e){return m.confirm(e)}};t.Browser=y,t.Browser=y=__decorate([__metadata("fx:diagnostics",[e,"Browser"]),s.Class()],y);class v{constructor(e,t){this.portal=e,this.splashScreen=t,[e,t].forEach((e=>{const t=e.length;if(1!==t)throw new Error("Unexpected length '"+e.selector+"': "+t)})),this.showPortal=b(e),this.showSplash=b(t)}static create(){return new v($(m.document.getElementById("web-container")),$(m.document.querySelectorAll("body>.fxs-splashscreen")))}dispose(){this.showPortal(!1)}}t.RootElements=v,__decorate([__metadata("fx:diagnostics",[e,"RootElements"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",v)],v,"create",null);let M=class{constructor(e,t){this.unloadCallbacks=[],this.unloadCallbacks.push(e.persist);const s=()=>{this.unloadCallbacks.forEach((e=>e()))};m.addEventListener("unload",s),this.location=m.location;const o=e.getCurrentUser(),i=e.bootstrapState;this.redirect=s=>{let n=s.uri||"";const r=Promise.withResolvers(),l=s.redirectAction||0;1&l&&e.clear(),2&l&&MsPortalImpl.localStorage.removeItem("LastValidSessionTs"),4&l&&MsPortalImpl.sessionStorage.clear(),8&l&&(0,a.postJSON)({uri:x},{portalAuthorization:i.refreshToken,altPortalAuthorization:i.altRefreshToken,tenant:i.user.tenantId}),t.showSplash(!0),MsPortalImpl.sessionStorage.setItem("portalInit_lastSessionId",MsPortalFx.sessionId),h({source:"Shell",action:"PortalRedirect",actionModifier:"Redirect",data:s});const d=()=>{r.resolve(void 0)};s.skipFlushBuffers?d():(Promise.all(this.unloadCallbacks.map((e=>e()))).finally(d),setTimeout(d,5e3)),Promise.allSettled([s.delayPromise,r.promise]).finally((()=>{if(!n){const e=new c(location.href);e.path=g("/",e.path,o.tenantId||"","/"),n=e.toString()}(e=>{window.location.href=e})(n)}))},this.openWindow=t=>{let s;const o=MsPortalFx.tryImmediateResolve(Q(t),(t=>{if(t){const s=new c(t),o=s.path,i=f(o,"/");if(!MsPortalFx.localeCompareIgnoreCase(i,f(location.protocol+"//"+location.host,"/"))){const o=s.fragment;o.startsWith("#@")||(s.fragment="#@"+e.getSignedInUserTenant()+("#"===o[0]?`/${o.slice(1)}`:""),t=s.toString())}}s?s.location.href=t:s=m.open(t)}));return s||(s=m.open()),o},this.dispose=()=>{m.removeEventListener("unload",s)}}};t.WindowManager=M,t.WindowManager=M=__decorate([__metadata("fx:diagnostics",[e,"WindowManager"]),s.Class(),__metadata("design:paramtypes",[o.AuthStateManager,v])],M),t.forceSignInHandler=(0,n.defineHandler)(r.forceSignInEndPoint,(t=>MsPortalFx.require(e.normalize("./UI.NavigationManager.ForceSignIn")).then((e=>e.forceSignIn(t.diContainer,t.messageArg,t.messageContext.srcWindowId)))))})),
define("MsPortalImpl/Base/Base.ImplUtils",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.AuthStateManager","FxInternal/Diagnostics"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.redirectWithCdn=t.getHashQueryStringSegment=t.getHashSegment=t.getQueryStringSegment=t.getPathSegment=t.getPort=t.getPathnameSegment=t.getHost=t.getProtocol=t.mapToQueryString=t.queryStringToMap=t.Uri=t.logIncludingProvenance=t.log=t.logToExtension=t.getLocationFromContext=t.validateAbsoluteHttpUri=t.CompositionProvenance=void 0;var l=MsPortalFx.Base,c=FxImpl.Rpc,d=l.Diagnostics;const p=d.createLog(e),u=/^https?:\/\/.+$/i,m=/^https:\/\/.+$/i,h=MsPortalFx.forEachKey,g=MsPortalFx.isEmpty;let f=class{constructor(e,t){this.locator=e,this.instanceId=t}};function x(e,t){let s,o;if(e&&!e.isDisposed()&&"composition"===e.scope){const t=e.get(f).locator;o=t.name,s=t.getExtensionName()}if(!s)if("string"==typeof t)s=t;else if(t){const e=function(e){const t=$(e),s=t.closest(".fxs-blade-content-container-details,.fxs-blade").data(i.CompositionInstanceDataName);if(s&&i.bladeImplementedWithVirtualPart(s.bladeDefinition))return s.locator;const o=t.closest(".fxs-tile").data(i.CompositionInstanceDataName);return o&&o.locator}(t);e?(o=e.name,s=e.getExtensionName()):s=function(e){const t="data-extensionname",s="["+t+"]["+t+"!='']";return $(e).closest(s).attr(t)||"fx"}(t)}return{bladeOrPartName:o,extension:s||"fx"}}function b(e,t,i,n,r={}){let{rpcClient:l}=r;const{contextData:d,diContainer:u}=r;d&&(n+=" "+JSON.stringify(d));try{l||(l=u?.get(c.Client)||c.client);const r=x(u,t),d=r.bladeOrPartName;if((d||"").toLowerCase().endsWith("_dx"))return void o.get("MsPortalImpl/Extension/DefinitionCache","DefinitionCache").then((e=>{s.container.get(e).getBladeDefinition(r.extension,r.bladeOrPartName).then((e=>{try{const t=MsPortalFx.first(MsPortalFx.find(e.effectiveInputs,(e=>"dxContext"===e.property)).valuesFrom).constantValue.viewKind;l.log(e.dxView?.runtimeExtension??"Microsoft_Azure_CreateUIDef",{level:i,code:0,area:t,message:(0,a.decycle)(n)})}catch(e){p.error(e)}}))}));const m=d||e.normalize();l.log(r.extension,{level:i,code:0,area:m,message:(0,a.decycle)(n)})}catch(e){p.error(e)}}t.CompositionProvenance=f,t.CompositionProvenance=f=__decorate([__metadata("fx:diagnostics",[e,"CompositionProvenance"]),s.Value("composition"),__metadata("design:paramtypes",[Object,String])],f),t.validateAbsoluteHttpUri=function(e,t){return((t=t||{}).requireHttps||!1?m:u).test(e)},t.getLocationFromContext=x,t.logToExtension=b,t.log=function(e,t,s,o){o=o?MsPortalFx.extend2(e.contextData,o):e.contextData,b(e.localRequire,e.windowContext,t,s,{contextData:o,diContainer:e.diContainer})},t.logIncludingProvenance=function(e,t,o){try{const i=(o=o||{windowContext:null,localRequire:null,diContainer:s.container}).windowContext,n=x(o.diContainer,i),r=o.localRequire&&o.localRequire.normalize(),l=MsPortalFx.extend2(o.contextData||{},{extensionName:n.extension,bladeOrPartName:n.bladeOrPartName,area:r}),c=MsPortalFx.getLogFriendlyMessage(t);new d.Log(r||n.bladeOrPartName||n.extension).writeEntry(e,c,null,[(0,a.decycle)(t),l])}catch(e){p.error(e)}};function y(e=""){const t={},s=e.indexOf("?");return(s>-1?e.slice(s+1):e).split("&").forEach((e=>{if(!e||/^=+$/.test(e))return;const s=e.split("="),o=s.shift(),i=s.length>0?s.join("="):"";t[o]=i})),t}function v(e){let t="",s="";return h(e,((e,o)=>{t+="{0}{1}={2}".format(s,e,o),s||(s="&")})),t}function M(e){const t=/^([^:/]+):\/\//.exec(e.toString());return t?t[1]+":":""}function C(e){const t=M(e=e.toString());if(!t)return"";const s=e.slice(t.length+2),o=s.indexOf("/"),i=o>0?s.slice(0,o):s;return!i||i.indexOf("@")>0?"":i.replace(/:.*/,"")}function P(e){const t=I(e),s=C(t),o=w(t),i=M(t),n=(i?i.length+2:0)+s.length+(o?o.length+1:0);return s&&i?t.slice(n):""}function w(e){const t=M(e),s=C(e);if(!t||!s)return"";const o=t.length+2+s.length,i=/^:(\d+)/.exec(e.toString().substring(o));return i?i[1]:""}function I(e){const t=e.toString().replace(/#.*/g,"").replace(/\?.*/,"");return C(t)&&M(t)?t:""}function S(e){return(e=e.toString().replace(/#.*/g,"")).includes("?")?e.replace(/.*\?/,"?"):""}function _(e){return(e=e.toString()).includes("#")?e.replace(/[^#]*#/,"#").replace(/\?.*/,""):""}function F(e){const t=e.indexOf("#"),s=-1===t?-1:e.slice(t).indexOf("?");return-1===t||-1===s?"":e.slice(t+s)}t.Uri=class{constructor(e){this._hashQs={},this._qs={},e=e&&e.toString()||"",this._protocol=M(e),this._host=C(e),this._port=w(e),this._pathname=P(e),this._hash=_(e),this._qsPart=S(e),this._qs=y(this._qsPart),this._hashQsPart=F(e),this._hashQs=y(this._hashQsPart)}getQueryStringValue(e){return this._qs[e]||""}setHashQueryStringValue(e,t){return this._hashQs[e]=t,this}setHashQueryString(e){return this._hashQs=y(e),this}deleteHashQueryStringValue(e){return delete this._hashQs[e],this}clearHashQueryStringIfEmpty(){return g(this._hashQs)&&(this._hashQsPart=""),this}getHashQueryStringValue(e){return this._hashQs[e]||""}setHash(e){return this._hash=e.toString().replace(/\?.*/,""),this}isHashEmpty(){return""===this.hash||"#"===this.hash}toString(){return this.href}get href(){return this.path+this.queryString+this.hash+this.hashQueryString}get host(){return this._host}get path(){return(this.protocol?this.protocol+"//":"")+this.host+(this.port?":"+this.port:"")+this.pathname}get pathname(){return this._pathname}get port(){return this._port}get protocol(){return this._protocol}get queryString(){const e=v(this._qs);return e||this._qsPart?"?"+e:""}get hash(){return this._hash||this.hashQueryString?"#"+(this._hash||"").replace(/^#/,""):""}get hashQueryString(){const e=v(this._hashQs);return this._hashQsPart||e?"?"+e:""}get hashWithHashQueryString(){return this.hash+this.hashQueryString}getHashParts(){return this._cachedHashParts&&this._partsBasedHash===this.hash||(this._partsBasedHash=this.hash,this._cachedHashParts=MsPortalEarly.getHashParts(this.hash)),this._cachedHashParts}},t.queryStringToMap=y,t.mapToQueryString=v,t.getProtocol=M,t.getHost=C,t.getPathnameSegment=P,t.getPort=w,t.getPathSegment=I,t.getQueryStringSegment=S,t.getHashSegment=_,t.getHashQueryStringSegment=F;const T=["cloudsimpleextbearer","tokencaching","internalgraphapiversion","cae"].reduce(((e,t)=>{const s=MsPortalFx.getFeatureValue(t);return s&&(e[`feature.${t}`]=s),e}),{});t.redirectWithCdn=function(e,t){const s=new l.UriBuilder(t.uri+location.search+MsPortalFx.ensurePrefix(t.hash,"#")),o=s.query;MsPortalFx.forEachKey(T,((e,t)=>o.setParameter(e,t))),MsPortalFx.forEachKey(t.parameters,((e,t)=>o.setParameter(e,t))),e.get(r.AuthStateManager).clear(!0),e.get(n.WindowManager).redirect({uri:s.toString(),redirectAction:t.redirectAction||0})}})),
define("MsPortalImpl/Base/Base.BrowserDetection",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOpera=t.isTouch=t.webKitVersion=t.isMac=t.isIPadOS=t.isIOS=t.isAndroidOrMobile=t.isChromeIos=t.isSafari=t.isIeOrEdgeNonChromium=t.isChromeOrEdgeChromium=t.isChromiumEdge=t.isEdge=t.isChrome=t.isFirefox=t.subscribeToInstalledPwa=t.isInstalledPwa=t.safari_11_webKitVersion=t.edgeFeature=t.msieFeature=t.chromeFeature=t.edgeChromiumFeature=t.operaFeature=t.ffFeature=void 0;const s=window.navigator.userAgent;t.ffFeature="undefined"!=typeof InstallTrigger,t.operaFeature=!!window.opr&&!!window.opr.addons||!!window.opera||navigator.userAgent.includes(" OPR/"),t.edgeChromiumFeature=function(){let e=!1,t=!1;if(navigator.userAgentData){const{brands:s}=navigator.userAgentData;return s.forEach((s=>{"Chromium"===s.brand&&(e=!0),"Microsoft Edge"===s.brand&&(t=!0)})),e&&t}return!1}(),t.chromeFeature=!(!window.chrome||!window.chrome.webstore&&!window.chrome.loadTimes||t.edgeChromiumFeature||t.operaFeature),t.msieFeature=!!document.documentMode,t.edgeFeature=!t.msieFeature&&!!window.StyleMedia;const o=/^(?!.*chrome).*safari/i.test(navigator.userAgent),i=/Trident\//i.test(s),n=/ip(?:hone|od|ad)/i.test(s),r=/ipad/i.test(s),a=/CriOS/i.test(s);function l(e){return window.matchMedia(e).matches}function c(e){const t=window.matchMedia("(display-mode: standalone)");return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}t.safari_11_webKitVersion=604,t.isInstalledPwa=l("(display-mode: standalone)"),c((e=>{t.isInstalledPwa=e.matches})),t.subscribeToInstalledPwa=c,t.isFirefox=t.ffFeature,t.isChrome=!(!t.chromeFeature&&!a),t.isEdge=t.edgeFeature,t.isChromiumEdge=t.edgeChromiumFeature,t.isChromeOrEdgeChromium=t.edgeChromiumFeature||t.isChrome||t.operaFeature,t.isIeOrEdgeNonChromium=t.msieFeature||i||t.edgeFeature,t.isSafari=o&&!a,t.isChromeIos=a,t.isAndroidOrMobile=/Mobile|Android/.test(s)||"true"===MsPortalFx.getFeatureValue("skipautofocus"),t.isIOS=n,t.isIPadOS=r,t.isMac=window.navigator.platform.includes("Mac"),t.webKitVersion=function(){const e=/AppleWebKit\/([\d.]+)/.exec(s);if(e)return parseFloat(e[1])}()||0,t.isTouch=function(){const e="-webkit- -moz- -o- -ms-".split(" ");return"ontouchstart"in window||l(`(${e.join("touch-enabled),(")}touch-enabled)`)}(),t.isOpera=t.operaFeature})),
define("MsPortalImpl/Base/Base.CssSelectorParser",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subselectorToString=t.parseCssSelector=void 0,t.parseCssSelector=function(e){return e=e.replace("::after",":after").replace("::before",":before"),n=(e,t)=>t,d(e||"",!1)},t.subselectorToString=function(e){return e.map((e=>e.value)).join("")};const s=jQuery.find,o=s.selectors,i=s.selectors.match;let n;
/*!
     * -----------------------------------------------------------------------------
     * The portion of this file from here until "End of jQuery code snippet" is code
     * derived from the jQuery JavaScript Library v2.0.3 - http://jquery.com/
     * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
     * Released under the MIT license - http://jquery.org/license
     * Date: 2013-07-03T13:30Z
     */const r="[\\x20\\t\\r\\n\\f]",a=new RegExp("^"+r+"+|((?:^|[^\\\\])(?:\\\\.)*)"+r+"+$","g"),l=new RegExp("^"+r+"*,"+r+"*"),c=new RegExp("^"+r+"*([>+~]|"+r+")"+r+"*"),d=function(e,t){let r,d,p,u;const m=n[e+" "];if(m)return t?0:m.slice(0);u=e;const h=[],g=o.preFilter;for(;u;){r&&!(d=l.exec(u))||(d&&(u=u.slice(d[0].length)||u),h.push(p=[])),r=!1,(d=c.exec(u))&&(r=d.shift(),p.push({value:r,type:d[0].replace(a," ")}),u=u.slice(r.length));for(const e in o.filter)!(d=i[e].exec(u))||g[e]&&!(d=g[e](d))||(r=d.shift(),p.push({value:r,type:e,matches:d}),u=u.slice(r.length));if(!r)break}return t?u.length:u?s.error(e):n(e,h).slice(0)};
/*!
     * End of jQuery code snippet
     * -----------------------------------------------------------------------------
     */let p;p=void 0})),
define("MsPortalImpl/Base/Base.CssSanitizer",["require","exports","MsPortalImpl/Base/Base.CssSelectorParser","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateErrorMessage=t.sanitizeStyleSheetText=t.mediaQueryToClass=t.sanitizeStyleDeclarationString=t.sanitizeDefinition=t.getScopeName=t.domStylePropertyToCssProperty=t.CssSanitizerErrorTypes=t.stylePolicy=t.cssTextModule4Directives=t.safariAnyValueAcceptedCssDirectives=t.chromeOrEdgeChromiumWithSafariDirectives=t.firefoxAnyValueAcceptedCssDirectives=void 0;let n=["align-content","align-items","align-self","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-shadow","box-sizing","break-after","break-before","break-inside","clear","clip-path","color","content","counter-increment","counter-reset","cursor","display","direction","enable-background","fill","fill-rule","fill-opacity","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","row-gap","column-gap","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-gap","grid-column-start","grid-column-end","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","height","justify-content","justify-items","left","letter-spacing","line-height","list-style-position","list-style-type","margin","margin-left","margin-top","margin-right","margin-bottom","max-height","max-width","min-height","min-width","opacity","order","orphans","outline","outline-color","outline-style","outline-width","overflow","overflow-wrap","overflow-x","overflow-y","padding","padding-top","padding-left","padding-right","padding-bottom","pointer-events","right","scroll-snap-align","scroll-snap-type","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","table-layout","text-align","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-decoration-thickness","text-indent","text-justify","text-orientation","text-transform","text-overflow","top","transform","transform-origin","transition","transition-delay","transition-duration","transition-property","transition-timing-function","user-select","vertical-align","visibility","white-space","widows","width","word-break","word-spacing","word-wrap","-webkit-line-clamp"];t.firefoxAnyValueAcceptedCssDirectives=["-moz-box-orient","-moz-border-top-colors","-moz-border-right-colors","-moz-border-bottom-colors","-moz-border-left-colors"],t.chromeOrEdgeChromiumWithSafariDirectives=["background-repeat-x","background-repeat-y","transition-behavior","-webkit-border-horizontal-spacing","-webkit-border-vertical-spacing","-webkit-box-orient","-webkit-text-stroke-width","-webkit-text-fill-color","-webkit-text-stroke-color","-webkit-font-smoothing","-webkit-user-drag"],t.safariAnyValueAcceptedCssDirectives=["transform-origin-x","transform-origin-y","transform-origin-z","-webkit-box-shadow","-webkit-tap-highlight"],t.cssTextModule4Directives=["text-wrap","text-wrap-mode","text-wrap-style","white-space-collapse","white-space-trim"],n=n.concat(t.firefoxAnyValueAcceptedCssDirectives),n=n.concat(t.chromeOrEdgeChromiumWithSafariDirectives),n=n.concat(t.safariAnyValueAcceptedCssDirectives),n=n.concat(t.cssTextModule4Directives),t.stylePolicy={},n.forEach((e=>{t.stylePolicy[e]=1})),t.stylePolicy["font-family"]=function(e){return/^ *["']?(?:Segoe UI|Consolas)["']? *(?:,|$)/.test(e)},t.stylePolicy.position=["relative","absolute","static","inherit","sticky"],t.stylePolicy["list-style-image"]=["none","inherit","initial"],t.stylePolicy["text-transform"]=function(e){return"none"===e||"uppercase"===e||"lowercase"===e||"capitalize"===e},t.stylePolicy["z-index"]=function(e){return parseInt(e,10)>=0};const r=/\(min-width: (\d+)px\)/,a=/\((min|max)-width: (\d+)px\)/,l=/\W/g,c=/[a-z|A-Z]+/g,d=Object.keys(t.stylePolicy).map((function(e){let t=e.toLowerCase().match(c).reduce(((e,t,s)=>s>0?e+(t=t.charAt(0).toUpperCase()+t.slice(1)):e+t));"float"===t&&(t="cssFloat");return t}));var p;function u(e){return"cssFloat"===e?"float":(e||"").replace(/([A-Z])/g,"-$1").toLowerCase()}function m(e){return"css-scope-"+e.replace(l,"")}function h(e){return`fxt-mq-${"MINWIDTH"===e.type?"min":"max"}w-${e.pixels}`}function g(e,t,i,n){const r=document.implementation.createHTMLDocument(""),l=r.createElement("style");r.body.appendChild(l);const c=function(e,t){const s=t.createElement("style");t.body.appendChild(s),s.textContent=e;const o=s.sheet,i=o&&o.cssRules;return i?Array.prototype.slice.call(i,0):[]}(e,r),d=c.filter((e=>e.type===CSSRule.MEDIA_RULE)).reduce(((e,t)=>{const s=(r=t.media,o.isIeOrEdgeNonChromium?r.mediaText.split(",").map((e=>e.trim())):Array.from(r)).map((e=>MsPortalFx.replaceAll(e,"all and ","").replace(/\((.*):\s*(.*)\)/,"($1: $2)").trim()));var r;s.filter((e=>!x(e))).forEach((e=>{!function(e,t,s){s.push(...e.map((e=>({type:p.MediaQuery,mediaQuery:t,errorMessage:e}))))}(["Media query is not allowed"],e,i)}));const l=s.filter((e=>x(e))).map((e=>{const t=function(e){const t=a.exec(e);return{type:"min"===t[1]?"MINWIDTH":"MAXWIDTH",pixels:Number(t[2])}}(e),s=h(t);return n&&n.push({mediaClass:s,mediaQuery:t}),"."+s}));if(0===l.length)return e;const c=function(e){const t=[];for(let s=0;s<e.length;s++)t[s]=e[s];return t}(t.cssRules).filter(w).map((e=>({selectorText:`${l.join()} ${e.selectorText}`,cssText:e.cssText,style:e.style,type:e.type})));return[...e,...c]}),[]),u=[...c,...d].filter(w).map((e=>{const o=function(e,t,o,i){const n=[],r=function(e,t,o){let i;const n=[];try{i=s.parseCssSelector(e)}catch(t){return o.push("Malformed selector: "+e+"\nException: "+t.toString()),null}return i.forEach((e=>{(function(e,t){return!e.some((e=>{if("CLASS"===e.type){if(e.value&&!MsPortalFx.startsWith(e.value,".ext-")&&!MsPortalFx.startsWith(e.value,".fxt-"))return t.push("Selectors can only refer to extension-specific class names (those starting with .ext- or .fxt-)"),!0}else if("ID"===e.type)return t.push("Selectors cannot refer to elements by ID"),!0}))})(e,o)&&n.push(t+" "+s.subselectorToString(e))})),n.join(", ")}(e.selectorText,o,n).replace(" .fxt-mq-",".fxt-mq-");if(b(n,e,i),r){t.insertRule(r+" {}",0);const s=t.cssRules[0],o=[];return y(e.style,s,o),b(o,e,i),s}return null}(e,l.sheet,t,i);return o?o.cssText:null}));let m=u.join("\n");return["ext-mode-light","ext-mode-dark","ext-mode-standardcontrast","ext-mode-highcontrast","ext-highcontrast-light","ext-highcontrast-dark"].forEach((e=>{const s=["{0} {1}","{1} {0}"].map((s=>s.format(t,"."+e)));m=MsPortalFx.replaceAll(m,s[0],s[1])})),m}function f(e){let t;if(e.type===p.StyleRule)t=`Invalid CSS property - ${e.errorMessage}\nCSS rule: ${e.rule.cssText}`;else t=`Invalid CSS Media Query - ${e.mediaQuery}\nMedia Query: ${e.errorMessage}`;return t}function x(e,t=[r]){return Boolean(t.some((t=>e.match(t))))}function b(e,t,s){s.push(...e.map((e=>({type:p.StyleRule,rule:t,errorMessage:e}))))}function y(e,s,o){const i=function(e){const s=[];for(let o=0,i=e.length;o<i;o++){const i=e[o];if(M[i]&&!(i in t.stylePolicy))return P(e);s.push(i)}return s}(e);for(let n=0,r=i.length;n<r;n++){const r=i[n],a=e.getPropertyValue(r),l=e.getPropertyPriority(r);if("initial"===a)continue;const c=v(l,o);let d=null,p=null;if(t.stylePolicy.hasOwnProperty(r)){d=r;const e=t.stylePolicy[r];if(1===e)p=a;else if(e instanceof Array){const t=e.indexOf(a);t>=0&&(p=e[t])}else"function"==typeof e&&e(a)&&(p=a);p?s.style.setProperty(r,a,c):o.push("Disallowed style value. Property name: {0}, value: {1}".format(d,a))}else r.startsWith("--ext")?(d=r,p=a,s.style.setProperty(r,a,c)):o.push("Disallowed style property. Property name: "+r)}}function v(e,t){return e?(t.push("Disallowed CSS priority value: "+e),""):e}!function(e){e[e.MediaQuery=0]="MediaQuery",e[e.StyleRule=1]="StyleRule"}(p||(t.CssSanitizerErrorTypes=p={})),t.domStylePropertyToCssProperty=u,t.getScopeName=m,t.sanitizeDefinition=function(t){const s="."+m(t.name),o=[];return t.styleSheets=(t.styleSheets||[]).map((e=>g(e,s,o))),o.forEach((s=>{const o=`Sanitization error found in style sheet in extension: ${t.name}\n${f(s)}`;i.logToExtension(e,t.name,2,o)})),!o.length},t.sanitizeStyleDeclarationString=function(e,t,s){t.insertRule(".ignored1 { {0} }".format(e),0),t.insertRule(".ignored2 {}",1);const o=t.cssRules[0],i=t.cssRules[1];return o.type===CSSRule.STYLE_RULE?(y(o.style,i,s),i.style.cssText):(s.push("Not a style rule: "+e),null)},t.mediaQueryToClass=h,t.sanitizeStyleSheetText=g,t.generateErrorMessage=f;const M={};var C;function P(e){const t=[];for(let s=d.length-1;s>=0;s--){const o=d[s];e[o]&&t.push(u(o))}return t}function w(e){return e.type===CSSRule.STYLE_RULE}(o.isChromeOrEdgeChromium||o.isSafari)&&(C=M,[].forEach((e=>{C[e]=1})))})),
define("MsPortalImpl/Base/Base.KnockoutBindingSanitizer",["require","exports","MsPortalImpl/Base/Base.CssSanitizer"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeBindingComment=t.sanitizeBindingAttribute=void 0;const o=y(m,g((()=>!0))),i={checked:m,click:m,clickBubble:m,commands:y(m,g((()=>!0))),disable:m,disableAutoDispose:m,enable:m,event:x(["click","keypress","afterkeypress"]),foreach:y(m,x(["data","as"])),formElement:o,fxclick:m,htmlTemplate:o,if:m,ifnot:m,image:m,options:m,optionsText:b,optionsValue:b,sanitizedAttr:o,sanitizedCss:o,sanitizedHtml:m,selectedOptions:m,stringOrHtmlContent:m,style:f(((e,t)=>t.style.hasOwnProperty(s.domStylePropertyToCssProperty(e))),(function(e,t,o){const i=s.domStylePropertyToCssProperty(e),n=o.style[i],r=c.exec(t),a=r?t.slice(1,-1):null;let l=!1;1===n?l=!!r||m(t)===t:n instanceof Array?l=!!r&&n.includes(a):"function"==typeof n&&(l=!!r&&n(a));return l})),submit:m,text:m,uniqueName:m,visible:m,value:m,valueUpdate:(n=["afterkeyup"],function(e,t){return n.some((t=>e==='"'+t+'"'||e==="'"+t+"'"))?e:null}),vtext:m,with:m};var n;const r={attr:"sanitizedAttr",css:"sanitizedCss",html:"sanitizedHtml"};const a="pc",l=["===","==","!==","!=","<=","<",">=",">","&&","||","-","+","*","/"],c=/^(?:"(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*')$/,d=/^[a-z_$][\w$]*$/i;function p(e,t,s,o,n){const l=[],c=ko.expressionRewriting.parseObjectLiteral(t);let d=!0;return c.forEach((function(t){const c=(t.key||t.unknown||"").trim(),p=function(e){return r[e]||e}(c);let h=i[p];if(h||p.substring(0,a.length)!==a||(h=m),h){const i=(t.value||"").trim(),r=h(i,o,e.windowContext);null!==r?l.push(u(p)+": "+r):(d=!1,n.push({provenanceContext:e,reason:6,tag:s,binding:c,val:i}))}else d=!1,n.push({provenanceContext:e,reason:5,tag:s,binding:c})})),d?l.join(", "):null}function u(e){return e&&!c.test(e)&&(d.test(e)||(e="'"+e.replace("'","\\'")+"'")),e}function m(e){const t=h(e);if(null!==t)return t;for(let t=0;t<l.length;t++){const s=e.split(l[t]);if(2===s.length&&h(s[0].trim())&&h(s[1].trim()))return e}return null}function h(e){return/^!?(?:[$\w.'\-"[\]]|\(\))+$/.test(e)||/^\{\s*\}$/.test(e)?e:null}function g(e){return f(e,((e,t,s)=>!!m(t)))}function f(e,t){return function(s,o){const i=ko.expressionRewriting.parseObjectLiteral(s),n=[];let r=!0;return i.forEach((function(s){const i=(s.key||"").trim(),a=(s.value||"").trim();e(i,o)&&t(i,a,o)?n.push(u(i)+": "+a):r=!1})),r?"{ "+n.join(", ")+" }":null}}function x(e){return g(((t,s)=>e.includes(t)))}function b(e){return/^"[^"]*"$/.test(e)||/^'[^']*'$/.test(e)?e:null}function y(...e){return function(t,s){let o,i;for(o=0;o<e.length;o++)if(i=e[o](t,s),null!==i)return i;return null}}t.sanitizeBindingAttribute=p,t.sanitizeBindingComment=function(e,t,s,o){const i=/^\s*ko\s([\s\S]*)/.exec(t);if(i){const t=p(e,i[1],"comment",s,o);return null===t?" ko ":" ko "+t+" "}return/^\s *\/ko/.test(t)?" /ko ":null}})),
define("MsPortalImpl/Base/Base.LruMap",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LruMap=void 0;t.LruMap=class{count(){return this._count}constructor(e){this._map=Object.create(null),this._count=0,this._lastAccessed=0,this._capacity=e}contains(e){return!!this._map[e]}trim(e){"number"!=typeof e&&(e=this._capacity);let t=this.count()-e;if("number"!=typeof e||t<1)return;const s=this._lastAccessed-e+1;MsPortalFx.forEachKey(this._map,((e,t,o)=>{t.lastAccessed<s&&o.push(t)}),[]).sort(((e,t)=>t.lastAccessed-e.lastAccessed)).some((e=>(delete this._map[e.key],t--,t<1))),this._count=e}getOrAdd(e,t){const s=this._map[e];let o;if(s)s.lastAccessed=++this._lastAccessed,o=s.data;else{if(!t)throw new Error(`Unable to find item with key: '${e}'.`);o=t(e),this.addOrUpdate(e,o)}return o}addOrUpdate(e,t,s){const o=this._map[e];return o?(o.data=t,o.lastAccessed=++this._lastAccessed):(this._map[e]={key:e,data:t,lastAccessed:++this._lastAccessed},this._count++,s||this.trim()),!o}remove(e){this._map[e]&&(this._count--,delete this._map[e])}}})),
define("MsPortalImpl/Base/Base.Sanitization",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","FxInternal/Utils/LinkSanitizer"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllowListedAttr=t.sanitizeLinkUri=t.sanitizeUri=t.validateDataImage=t.validateLocalUriOnly=t.validateLinkUri=t.validateUriOrBlank=void 0;MsPortalFx.Base.Diagnostics;const n=/^(?:vstfs:|ftp:|ftps:|sftp:|storageexplorer:|adlalink:|adl:|asalink:|vsweb:|azuredatastudio:|bfcomposer:|ms-quick-assist:|ms-remote-help:)?\/\/|^mailto:|^vscode:/,r=/^#(?:allservices|asset|blade|create|dashboard|home|menu|resource)\b/,a=/^#/,l=/^data:image\//;function c(e,t,s){return!!(""===e||(0,o.validateAbsoluteHttpUri)(e)||n.test(e)||"_self"===t&&r.test(e))&&(p(e,s),!0)}function d(e){return(e?.diContainer||s.container).get(i.LinkSanitizer)}function p(e,t){const s=(0,o.getLocationFromContext)(t?.diContainer,t?.windowContext).extension;if(FxImpl.features.isEnabled("logexternaldomainlinks")&&!d(t).isTrustedDomainLink(e,s)){const s=MsPortalFx.sanitizeMessage(e);(0,o.logIncludingProvenance)(1,"Link is external to the known valid domains: "+s,t)}}t.validateUriOrBlank=c,t.validateLinkUri=function(e,t){return!!(""===e||a.test(e)||(0,o.validateAbsoluteHttpUri)(e)||n.test(e))&&(p(e,t),!0)},t.validateLocalUriOnly=function(e){return""===e||a.test(e)},t.validateDataImage=function(e){return""===e||l.test(e)},t.sanitizeUri=function(t,s,i){const n=c(t,s,i);return n||(0,o.logToExtension)(i&&i.localRequire||e,i&&i.windowContext||null,2,"Disallowed URI: "+t),n},t.sanitizeLinkUri=function(e,t){if(""===e||a.test(e))return e;if((0,o.validateAbsoluteHttpUri)(e)||n.test(e)){const s=(0,o.getLocationFromContext)(t.diContainer,t.windowContext).extension;return d(t).getSafeLink(e,s)}return!1};const u=["alt","border","colspan","rowspan","span","disabled","height","width","lang","spellcheck","title","value","dx-content-path","dx-content-property","cx","cy","d","rx","ry","x","y","x1","x2","y1","y2","fill","fill-rule","opacity","points","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-width","transform","vector-effect","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-current","aria-disabled","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","role"];t.getAllowListedAttr=function(){return u}})),
define("MsPortalImpl/Base/Base.KnockoutTemplateSanitizer",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutBindingSanitizer","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.LruMap"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeHTML=t.KODeniedTemplateSanitizer=t.KOAllowedTemplateSanitizer=t.TemplateSanitizer=t.isAllowedCssClassName=t.sanitizeDefinition=t.sanitizeBladeDefinition=t.sanitizeInlineTemplate=void 0;MsPortalFx.Base.Diagnostics;const l=/^(?:az-|ms-|msportalfx|ext-|lang-|fxt-)[\w-]+$/,c=MsPortalFx.getUniqueId().toLowerCase(),d={sanitizeLinkUri:(e,t,s,o,i,n,a)=>r.sanitizeLinkUri(e,a),validateUriOrBlank:(e,t,s,o,i,n,a)=>r.validateUriOrBlank(e,null,a),validateLocalUriOnly:r.validateLocalUriOnly,validateClassNames:function(e,s,o,i,n,r,a){const l=/[\w-]+/g;let c;const d=[];for(;c=l.exec(e);){const e=c[0];(0,t.isAllowedCssClassName)(e)?d.push(e):r.push({provenanceContext:a,reason:2,tag:s,val:e})}return d.join(" ")||null},validateKOBindingString:function(e,t,s,o,n,r,a){return i.sanitizeBindingAttribute(a,e,t,n,r)},mapName:function(e,t,s,o){return o.setAttribute(s,"TemplateSanitizer"+c+"_"+e),!1}},p=["src"],u="data-sanitizer-"+c+"-";function m(e,t,s,o,i){const n=o&&o.htmlTemplateInline;n&&h(e,t,s,n,i,(()=>{n.content=null}))}function h(t,s,o,i,n,r){const a=t.get(y).sanitize({contextData:{File:i.file,TemplateKey:o},diContainer:t,localRequire:e,value:i.content,windowContext:s});!a.errors.length||0===n?i.content=a.sanitizedMarkup:r()}t.sanitizeInlineTemplate=m,t.sanitizeBladeDefinition=function(e,t,s,o){s.isWeave||(s.lenses||[]).forEach((i=>{(i.partInstances||[]).forEach((i=>{m(e,t,`${s.name}/${i.name}`,i.inline,o)}))}))},t.sanitizeDefinition=function(e,t,o=s.container){const i=e.name;MsPortalFx.forEachKey(e.htmlTemplates,((s,n)=>{h(o,i,s,n,t,(()=>{delete e.htmlTemplates[s]}))}))};t.isAllowedCssClassName=function(e){return"string"==typeof e&&l.test(e)};const g=(()=>{function e(e){return e.length?t(e):1}function t(t){const s={};return t.forEach((function(t){if("string"==typeof t)s[t]=1;else for(const o in t){const i=t[o];s[o]=i instanceof Function?i:e(i)}})),s}const s=["ABBR","ADDRESS","ARTICLE","B","BLOCKQUOTE","BR","CAPTION","CITE","CODE","COL","COLGROUP","DD","DEL","DFN","DIV","DL","DT","EM","FIELDSET","FIGURE","FIGCAPTION","FONT","FOOTER","HEADER","H1","H2","H3","H4","H5","H6","HR","I","INS","LABEL","LEGEND","MARK","OL","P","PRE","Q","S","SECTION","SMALL","SPAN","STRONG","SUB","SUP","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","U","UL",{A:[{href:d.sanitizeLinkUri},"target"]},{BUTTON:["value"]},{IMG:[C("src",d.validateUriOrBlank)]},{INPUT:[{type:["text","password","radio","checkbox","submit"]},"checked","maxlength","value"]},{LI:["value"]},{OPTION:["label","selected","value"]},{SELECT:["multiple","size"]},{TEXTAREA:["rows","cols"]},{TIME:["datetime"]},{SVG:["viewBox","focusable",{"xmlns:xlink":d.validateUriOrBlank},{"xmlns:svg":d.validateUriOrBlank},{xmlns:d.validateUriOrBlank}]},{CIRCLE:["r"]},"DEFS","DESC",{ELLIPSE:["id"]},{G:["id"]},{LINE:["id"]},"METADATA",{PATH:["id"]},{POLYGON:["id"]},{POLYLINE:["id"]},{RECT:["id"]},{STOP:["offset"]},{TEXT:["id","font-size"]},"TITLE",{USE:["id",{"xlink:href":d.validateLocalUriOnly}]},{AUDIO:[C("src",d.validateUriOrBlank),"controls","currentTime","duration","preload"]},{VIDEO:[C("src",d.validateUriOrBlank),"controls","poster","preload","autoplay"]},{SOURCE:[C("src",d.validateUriOrBlank),"type"]}],o=[{"data-bind":d.validateKOBindingString},{class:d.validateClassNames},{name:d.mapName},"dx-content-path","dx-content-property","data-click-telemetry",{"data-activatable":["true","false"]},"data-activate-info"].concat(...r.getAllowListedAttr());return{style:n.stylePolicy,elements:{tags:t(s),global:t(o)},comments:i.sanitizeBindingComment}})(),f=[];function x(e,t,s){const a=document.implementation.createHTMLDocument(""),l=document.createDocumentFragment(),c=FxImpl.createElement("div"),m=g.elements,h=m.tags,x=m.global,b=[];let y=!1,v=e.value||"";l.appendChild(c);try{p.forEach((e=>{v=M(v,e,u+e)}))}catch(t){o.log(e,s,`An error occured processing the untrustedHTMLString '${v}'.\nuntrustedHTMLString is now set to empty string to prevent further errors.\nError message was: '${t.message}'.\nReview binding and any other context provided.`,{untrustedHTMLString:v}),v=""}a.body.innerHTML=v;const C=a.createElement("style");C.setAttribute("type","text/css"),a.head.appendChild(C);const P=C.sheet;function w(s,o,i,n){if(i.hasAttribute(s)&&!n.hasAttribute(s)){const r=i.getAttribute(s),a=[],l=function(s,o,i,n,r,a){if(!t&&s===d.validateKOBindingString)return null;if(1===s)return o;if("object"==typeof s)return o in s?o:null;if(s instanceof Function){const t=s(o,i,n,r,g,a,e);return"boolean"==typeof t?!0===t?o:null:"string"==typeof t?t:null}return null}(o,r,i.nodeName.toUpperCase(),s,n,a);null!==l&&n.setAttribute(s,l),a.length>0?a.forEach((e=>{b.push(e)})):null===l&&b.push({provenanceContext:e,reason:1,tag:i.nodeName.toUpperCase(),attr:s,val:r})}}function I(e,t,s){if("object"==typeof s)for(let o=0,i=e.attributes,n=i.length;o<n;o++){const n=i[o].name;n in s&&w(n,s[n],e,t)}}!function s(o,l){const c=o.nodeName.toUpperCase();if(o.nodeType===Node.ELEMENT_NODE&&(y||(y=o!==a.body)))if(h[c]){const t=FxImpl.createElement(c);I(o,t,h[c]),I(o,t,x);const s=o.getAttribute("style");if(s){const o=[],i=n.sanitizeStyleDeclarationString(s,P,o);o.forEach((t=>{b.push({provenanceContext:e,reason:3,tag:c,attr:"style",val:t})})),t.setAttribute("style",i)}if("A"===c){const s=o.getAttribute("href"),i=o.getAttribute("target");!MsPortalFx.isNullOrWhiteSpace(s)&&r.validateUriOrBlank(s,null,e)&&((MsPortalFx.isNullOrWhiteSpace(i)||"_self"===i)&&t.setAttribute("target","_blank"),t.setAttribute("rel","noopener"))}l.appendChild(t),l=t}else if(b.push({provenanceContext:e,reason:4,tag:c}),!MsPortalFx.isFeatureEnabled("oldsanitizer"))return l;for(let n=0,r=o.childNodes,a=r.length;n<a;n++){const o=r[n];switch(o.nodeType){case Node.TEXT_NODE:l.appendChild(document.createTextNode(o.textContent));break;case Node.ELEMENT_NODE:s(o,l);break;case Node.COMMENT_NODE:{const s=g.comments;if(!(!t&&s===i.sanitizeBindingComment)&&s&&s instanceof Function){const t=[],i=s(e,o.textContent,g,t);null!==i&&l.appendChild(document.createComment(i)),t.length>0&&t.forEach((e=>{b.push(e)}))}break}}}return l}(a.body,c),b.forEach((e=>function(e,t){const s=f[e.reason]||"Unknown";o.log(e.provenanceContext,t,"Sanitization error found: "+s,{Tag:e.tag,Attribute:e.attr,Binding:e.binding,Value:e.val})}(e,s)));let S=c.innerHTML;return p.forEach((e=>{S=M(S,u+e,e)})),{sanitizedMarkup:S,errors:b}}f[1]="Invalid attribute",f[2]="Invalid CSS class name",f[3]="Invalid CSS property",f[4]="Invalid tag",f[5]="Unknown or prohibited binding",f[6]="Invalid binding value";class b{constructor(e){this._allowKnockoutBindings=e,this._templateCache=new a.LruMap(100),this.executionCount=0}sanitize(e,t=2){const s=e.value||"";return this._templateCache.getOrAdd(s,(()=>(this.executionCount++,x(e,this._allowKnockoutBindings,t))))}}t.TemplateSanitizer=b;let y=class extends b{constructor(){super(!0)}};t.KOAllowedTemplateSanitizer=y,t.KOAllowedTemplateSanitizer=y=__decorate([__metadata("fx:diagnostics",[e,"KOAllowedTemplateSanitizer"]),s.Class(),__metadata("design:paramtypes",[])],y);let v=class extends b{constructor(){super(!1)}};function M(e,t,s){if(!e)return e;const o=new RegExp("(\\s+)"+t+"(\\s*\\=)","g");return e.replace(o,"$1"+s+"$2")}function C(e,t){const s={};return s[u+e]=t,s}t.KODeniedTemplateSanitizer=v,t.KODeniedTemplateSanitizer=v=__decorate([__metadata("fx:diagnostics",[e,"KODeniedTemplateSanitizer"]),s.Class(),__metadata("design:paramtypes",[])],v),t.sanitizeHTML=function(e,t,o,i){return s.container.get(y).sanitize({value:e,localRequire:t,windowContext:o,diContainer:s.container},i)}})),
define("MsPortalImpl/Controls/ControlBindings",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.controlBindingMap=void 0;const s=ko.bindingHandlers;function o(e,s){t.controlBindingMap[e]=s}t.controlBindingMap={},o(127,"pcAccordion"),o(20,"pcArtifactLinks"),o(106,"pcAsyncFileUpload"),o(16,"pcAttachment"),o(63,"pcChart"),o(7,"pcCheckBoxField"),o(208,"pcClipboardButton"),o(75,"pcConsole"),o(40,"pcCopyableLabel"),o(85,"pcCreatorAndSelectorV2"),o(23,"pcCustomHtmlField"),o(91,"pcCustomValueSlider"),o(111,"pcCustomRangeSlider"),o(25,"pcDatePickerField"),o(26,"pcDateTimePickerField"),o(27,"pcDateTimeRangePickerField"),o(92,"pcDayPickerField"),o(76,"pcDeleteAssetConfirmation"),o(33,"pcDiffEditor"),o(32,"pcDockedBalloon"),o(65,"pcDonut"),o(3,"pcDropDownField"),o(99,"pcDurationPickerField"),o(15,"pcSection"),o(37,"pcEditor"),o(120,"pcEssentials"),o(82,"pcFileDownloadButton"),o(12,"pcFilterComboField"),o(67,"pcGraph"),o(125,"pcEditableGrid"),o(131,"pcDataGrid"),o(132,"pcPagedDataGrid"),o(133,"pcSequentialDataGrid"),o(98,"pcGroupDropDownField"),o(77,"pcHeroBanner"),o(19,"pcHistory"),o(84,"pcHotSpot"),o(108,"pcIFrame"),o(113,"pcIFrame2"),o(78,"pcInfoBox"),o(121,"pcIntuneAppFileUpload"),o(118,"pcLegend"),o(88,"pcHotSpot"),o(87,"pcInfoBox"),o(58,"pcLogStream"),o(68,"pcMap"),o(115,"pcMenu"),o(69,"pcMetrics"),o(126,"pcMonitorChart"),o(126,"pcMonitorChartV2"),o(204,"pcMetricGrid"),o(13,"pcMultiLineTextField"),o(79,"pcNotice"),o(10,"pcNumericTextBoxField"),o(29,"pcOAuthButtonField"),o(213,"pcOAuthButtonV2Field"),o(4,"pcOptionsGroupField"),o(209,"pcPager"),o(212,"pcPager2"),o(70,"pcPairedTimeline"),o(94,"pcPairedTimelineBadges"),o(5,"pcPasswordField"),o(39,"pcCheckBox"),o(42,"pcDropDown"),o(43,"pcFilterCombo"),o(54,"pcGrid"),o(56,"pcObsoleteListView1"),o(110,"pcMarkdown"),o(45,"pcMultiLineTextBox"),o(46,"pcMultiselectDropDown"),o(47,"pcNumericTextBox"),o(48,"pcOptionPicker"),o(49,"pcPassword"),o(50,"pcRangeSlider"),o(52,"pcSlider"),o(57,"pcTreeView"),o(112,"pcPartPinner"),o(128,"pcPill"),o(129,"pcPillCollection"),o(123,"pcPillList"),o(89,"pcPreviewTag"),o(71,"pcProgressBar"),o(72,"pcQuotaGauge"),o(9,"pcRangeSliderField"),o(93,"pcSearchBox"),o(86,"pcRangeSelection"),o(114,"pcResourceFilter"),o(11,"pcSelectorField"),o(100,"pcSimpleButton"),o(206,"pcRecommendations"),o(97,"pcChart"),o(73,"pcSingleValueGauge"),o(6,"pcSliderField"),o(21,"pcSplitter"),o(207,"pcSplitter2"),o(134,"pcSummary"),o(135,"pcPricingControl"),o(124,"pcResourceDropDown"),o(136,"pcTagsByResource"),o(101,"pcTextBlock"),o(2,"pcTextField"),o(24,"pcTimePickerField"),o(62,"pcToolbar"),o(22,"pcTriStateCheckBox"),o(116,"pcVideo"),o(119,"pcHeatMap"),o(137,"pcArmErrorList"),o(138,"pcDocsControl"),o(201,"pcFileShareDropDown"),o(202,"pcStorageAccountDropDown"),o(205,"pcToggle"),o(104,"pcList2"),o(203,"pcBlobContainerDropDown"),o(210,"pcManagementGroupDropDown"),o(211,"pcTabMenu"),o(214,"pcOpenCesCvaSurvey");const i={};function n(e,t,o){const i=ko.unwrap(e());if(i){const e=t[i.controlType];if(!e)throw new Error(`Unsupported ControlType in formControl binding handler: ${i.controlType}. Extension: ${o.$extensionName} ContentName: ${o.$partName}`);return s[e]}}function r(e,t,s,o,i,r){const a=n(t,r,i);if(a){const n=$(e);return n.attr("data-formelement",n.attr("data-bind")),a.init(e,t,s,o,i)}}function a(e,t,s,o,i,r){if(e){const a=n(t,r,i);if(a)return a.update(e,t,s,o,i)}}[127,20,16,7,208,85,23,91,111,25,26,27,92,138,3,99,15,120,201,12,98,124,19,108,113,110,13,8,10,29,4,112,5,128,129,123,135,89,9,11,6,21,207,202,134,136,2,24,22,210,214].forEach((e=>i[e]=t.controlBindingMap[e])),s.pcControl={init:function(e,s,o,i,n){return r(e,s,o,i,n,t.controlBindingMap)},update:function(e,s,o,i,n){return a(e,s,o,i,n,t.controlBindingMap)}},s.formElement={init:function(e,t,s,o,n){return r(e,t,s,o,n,i)},update:function(e,t,s,o,n){return a(e,t,s,o,n,i)}}})),
define("Viva.Controls/Controls/Base/Viva.KnockoutExtensions",["require","exports","MsPortalImpl.Controls/Controls/Base/WidgetBinding"],(function(e,t,s){"use strict";var o;return function(e){const t=ko.bindingHandlers;t.stopBindings={init:function(e,t,s,o){return{controlsDescendantBindings:ko.unwrap(t())}}};const o="__ko__disableAutoDispose",i=ko.utils.domNodeIsAttachedToDocument;function n(e){const t=s.createIsolatedContext(e.$data,e);return t.createChildContext=function(t,o){return s.createIsolatedContext(t,e)},t}ko.utils.domNodeIsAttachedToDocument=function(e){return!!$(e).data(o)||i.call(this,e)},t.disableAutoDispose={init:(e,t,s)=>{$(e).data(o,!0)}},t.privateTemplate={init:function(e,s,o,i,r){return t.template.init(e,s,o,i,n(r))},update:function(e,s,o,i,r){return t.template.update(e,s,o,i,n(r))}};const r={};t.vivaControl={registerCallback:function(e){const t=MsPortalFx.getUniqueId();return r[t]=e,t},unregisterGuid:function(e){delete r[e]},init:function(e,s,o,i,n){const a=ko.unwrap(s()),l=r[a];return ko.utils.domNodeDisposal.addDisposeCallback(e,(function(){const e=l().ltm;t.vivaControl.unregisterGuid(a),MsPortalFx.disposeDisposable(e)})),t.privateTemplate.init(e,l,o,i,n)},update:function(e,s,o,i,n){const a=ko.unwrap(s()),l=r[a];return t.privateTemplate.update(e,l,o,i,n)}}}(o||(o={})),o})),
define("Viva.Controls/Util/Viva.Util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setClassList=t.getClassList=t.DOMTokenListShim=t.existsOrRegisterId=t.fillObserableFields=t.cloneEvent=t.setFocusToFirstFocusableChild=t.shapeContains=t.getObjectBasicShape=t.executeSetFocusOn=t.findContainingControl=t.getScrollableParents=t.forceScreenRead=void 0;var s=MsPortalFx.isNullOrUndefined;function o(e){let t;return!(!$(e).attr("data-canfocus")||(t=e["data-canfocus"],!t))&&t()}function i(e,t,i){let n,r,a,l=0;do{if(n=null,a=e.find(t+":eq("+l+")"),a.length>0&&(n=a[0],r=i(n),r&&o(n)))return!0;l++}while(!s(n));return!1}t.forceScreenRead=function(e,t){let s,o;switch(e.tagName){case"TABLE":s="tr";break;case"TR":s="td";break;case"UL":s="li";break;default:s="span"}t&&(o=e.getAttribute("aria-live"),e.setAttribute("aria-live","assertive"));const i=FxImpl.createElement(s);e.appendChild(i),e.removeChild(i),t&&(o?e.setAttribute("aria-live",o):e.removeAttribute("aria-live"))},t.getScrollableParents=function(e,t){let s=e.parents().filter((function(e,t){const s=$(t),o=s.css("overflow-x"),i=s.css("overflow-y");return!("hidden"===o&&"hidden"===i||"visible"===o&&"visible"===i)}));return t&&(s=s.add(window)),s},t.findContainingControl=function(e){if(e){const t=$(e);let s;if(t.attr("data-control"))return e;if(s=t.closest("[data-control='true']"),s.length>0)return s[0]}return null},t.executeSetFocusOn=o,t.getObjectBasicShape=function(e,t=!0){const s=Object.keys(e);return t?s.sort(((e,t)=>e<t?1:-1)):s},t.shapeContains=function(e,t){if(t.length<=e.length){let s=-1;for(let o=0;o<t.length;o++){const i=t[o];if(s=MsPortalFx.findIndex(e,(e=>e===i),s+1),s<0)return!1}return!0}return!1},t.setFocusToFirstFocusableChild=function(e,t){const s="[data-focus-first='true']",o=":not("+s+")",n="[data-canfocus='true']",r=function(e){return e};let a=!1;return t&&(a=i(e,n+s,t),a||(a=i(e,n+o,t))),a||(a=i(e,n+s,r),a||(a=i(e,n+o,r))),a},t.cloneEvent=function(e,t){const s=t||e.type;return $.Event(e,{type:s,target:e.target,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,currentTarget:e.currentTarget,isImmediatePropagationStopped:e.isImmediatePropagationStopped,isPropagationStopped:e.isPropagationStopped,preventDefault:e.preventDefault,stopImmediatePropagation:e.stopImmediatePropagation,stopPropagation:e.stopPropagation})},t.fillObserableFields=function(e,t,s){const o=s?s.length:0;let i,n,r;for(let a=0;a<o;a++)i=s[a],n=t[i]||ko.observable(),r=e[i],n(ko.isObservable(r)?r.peek():r),t[i]||(t[i]=n)},t.existsOrRegisterId=function(e,t){const s=!e.includes(t);return s&&e.push(t),!s};class n{constructor(e=null){this._fields=e?e.split(" "):[]}add(e){this._fields.includes(e)||this._fields.push(e)}remove(e){for(;this._fields.includes(e);)this._fields.splice(this._fields.indexOf(e),1)}contains(e){return this._fields.includes(e)}get length(){return this._fields.length}toggle(e){return this._fields.includes(e)?(this.remove(e),!1):(this.add(e),!0)}item(e){return this._fields[e]}toString(){return this._fields.toString()}}t.DOMTokenListShim=n,t.getClassList=function(e){const t=e.getAttribute("class");return t?new n(t):new n},t.setClassList=function(e,t){e.setAttribute("class",t._fields.join(" "))}})),
define("_generated/Less/MsPortalImpl.Controls/Controls/Base.css",["module"],(function(e){"use strict";return{css:".fxc-base-fill-container-width{width:100%}.fxc-base-fill-container-height{height:100%}.fxc-base-loading{position:relative;height:100%}.fxc-base-loading .fxc-base-loadingImage{position:absolute;top:calc(50% - 30px/2);left:calc(50% - 30px/2)}",moduleId:e.id}})),
define("MsPortalImpl.Controls/Controls/Base/Base",["require","exports","Fx/DependencyInjection","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl.Controls/Controls/Base/WidgetBinding","FxInternal/ProxiedObservables","MsPortalImpl/Base/Base.ElementWidgetMap","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Controls/Base.css","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/UI/Compositions/UI.Composition","Viva.Controls/Controls/Base/Viva.KnockoutExtensions"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.WidgetUIState=t.isViewModelTrusted=t.setTrustedViewModel=t.getWidgets=t.getWidget=void 0;var m=MsPortalFx.Base.Diagnostics.Telemetry;(0,c.injectCss)(d);const h="remove.fxWidget",g="fxs-display-none";function f(e,t){return(t?l.getAllMatch(e[0],t):l.getAll(e[0]))||[]}function x(e){return!!e._isTrusted}t.getWidget=function(e,t){return MsPortalFx.first(f(e,t))||null},t.getWidgets=f,t.setTrustedViewModel=function(e){return e._isTrusted=!0,e},t.isViewModelTrusted=x;t.WidgetUIState=class{constructor(){this.tabIndex=ko.observable(0),this.disabled=ko.observable(!1),this._ltm=new FxImpl.TriggerableLifetimeManager}dispose(){this._ltm.dispose()}};t.Widget=class{constructor(t,o,c={},d){if(this._destroyIds=[],this._cssClassMap={},!t||!t.length)throw new Error("You must specify an element to associate a control to it. Your element is either null or an empty collection.");(0,a.setPoUndefined)(this),this.isTrusted=c.isTrusted||x(o),this.element=t,this.vm=o,this.state=d;const p=this.weaveContext=c.weaveContext,u=this.ltm=new FxImpl.TriggerableLifetimeManager;this.vmBasicOption={ltm:u},d&&u.registerForDispose(d),this._bindingContext=p?null:c.bindingContext;const m=p?null:this._bindingContext||r.contextFor(t);this._diContainer=c.diContainer||p&&p.diContainer||m&&m.$dicontainer||s.container,l.set(t[0],this);const h=o.controlType;if(0!==h&&94!==h){let e;const s=t.attr("data-bind")||"";if(s.length&&s.indexOf("visible")>=0){e=(ko.expressionRewriting.parseObjectLiteral(s)||[]).some((e=>"visible"===e.key))}if(!e){const e=o.visible;e&&e.subscribeAndRun(this.ltm,(e=>{MsPortalFx.isNullOrUndefined(e)||t.toggleClass(g,!e)}))}}const f=o&&o.cssClass;f&&f.subscribeAndRun(u,(s=>{s=s||"";const o=this._cssClassMap;this._cssClassMap={},s.split(/\s+/).forEach((s=>{s&&(this.isTrusted||n.isAllowedCssClassName(s)?(this._cssClassMap[s]=s,delete o[s]):(0,i.logToExtension)(e,t,2,`Invalid control css class name: ${s}`))}));const r=Object.keys(o);r.length&&this.element.removeClass(r.join(" "));const a=Object.keys(this._cssClassMap);a.length&&this.element.addClass(a.join(" "))})),this._registerDispose(),MsPortalFx.isFeatureEnabled("controlstelemetry")&&0!==h&&(this._initializeTelemetry(),this._attachTelemetryEvents(),this._trace({action:"ControlInitialized"}))}isDisposed(){return this._destroyIds.length>0}dispose(){if(this._checkExistsOrRegisterDestroyId(null))return;this.ltm&&this.ltm.dispose();const e=this.element;e.removeClass(`${g} ${Object.keys(this._cssClassMap).join(" ")}`),l.remove(e[0],this),this._disposeCallback&&(this._unregisterDispose(),this._disposeCallback=null)}_checkExistsOrRegisterDestroyId(e){return o.existsOrRegisterId(this._destroyIds,e)}_cleanDescendants(){ko.utils.cleanDescendantNodes(this.element)}_cleanElement(...e){const t=this.element;this.weaveContext||this._cleanDescendants(),e.length&&t.removeClass(e.join(" ")),this.weaveContext||t.empty()}_registerDispose(){const e=this.element;this._bindingContext?ko.utils.domNodeDisposal.addDisposeCallback(e[0],this._disposeCallback=e=>{this.dispose()}):e.on(h,this._disposeCallback=t=>{t.target!==e[0]||this._destroyTriggered||(this._destroyTriggered=!0,this.dispose())})}_unregisterDispose(){const e=this.element,t=this._disposeCallback;this._bindingContext?ko.utils.domNodeDisposal.removeDisposeCallback(e[0],t):e.off(h,t)}_trace(e){this._telemetryInfo||this._initializeTelemetry();const t=ko.unwrap(this.vm.telemetryName);m.trace({source:this._telemetryInfo.telemetrySource,extension:this._telemetryInfo.extensionName,name:t||FxImpl.Po.getMetadataId(this.vm),action:e.action,actionModifier:e.actionModifier,data:{controlType:this._telemetryInfo.controlType,vmKind:this._telemetryInfo.vmKind,...e.data},lowPriority:!0})}_startTrace(e){this._telemetryInfo||this._initializeTelemetry();const t=ko.unwrap(this.vm.telemetryName);return m.startTrace({source:this._telemetryInfo.telemetrySource,extension:this._telemetryInfo.extensionName,name:t||FxImpl.Po.getMetadataId(this.vm),action:e.action,actionModifier:e.actionModifier,data:{controlType:this._telemetryInfo.controlType,vmKind:this._telemetryInfo.vmKind,...e.data},lowPriority:!0})}_initializeTelemetry(e){const t=this.vm.controlType,s=this.element.closest(".fxs-blade")[0],o=s&&$.data(s,u.CompositionInstanceDataName),i=o&&o.locator,n=i&&i.toFriendlyString(),r=i&&i.getExtensionName(),a=p.controlBindingMap[t]||t||"UNKNOWN",l=this.vm.vmKind||"INVALID";this._telemetryInfo={telemetrySource:n,extensionName:r,controlType:a,vmKind:l}}_attachTelemetryEvents(){const e=this.element,t=()=>{this._trace({action:"ControlClicked",actionModifier:"click"})},s=()=>{this._focusTrace&&(m.cancelTrace(this._focusTrace),this._focusTrace=null),this._focusTrace=this._startTrace({action:"ControlFocused",actionModifier:"focusout"}),this._trace({action:"ControlFocused",actionModifier:"focusin"})},o=()=>{this._focusTrace?(m.endTrace(this._focusTrace,"focusout"),this._focusTrace=null):this._trace({action:"ControlFocused",actionModifier:"focusout"})};e.on("focusin",s),e.on("focusout",o),e.get(0).addEventListener("click",t,!0),this.ltm.registerForDispose((()=>{e.off("focusin",s),e.off("focusout",o),e.get(0).removeEventListener("click",t,!0),this._focusTrace&&m.cancelTrace(this._focusTrace)}))}}})),
define("MsPortalImpl.Controls/Controls/Base/OptionsBase",["require","exports","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","FxInternal/Weave","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Controls/Base.css"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.isHtmlContent=void 0,(0,r.injectCss)(a);var l=MsPortalFx.Base,c=l.Promises.CancelationToken,d=l.Promises.makeCancelable,p=MsPortalFx.Errors;const u="fxc-base",m="fxc-base-fill-container-width",h="fxc-base-fill-container-height",g=[];t.isHtmlContent=function(e){return e&&!!e.htmlTemplate};class f extends s.Widget{constructor(e,t,s,i){super(e,t,s,i),this._addDisposablesToCleanUp=e=>this.ltm.registerForDispose(e),s=s||{},this._options=t,this._widgets=[],this._waitToken=new c,e.addClass(u);switch(s.fillBehavior||0){case 1:e.addClass(m);break;case 2:e.addClass(h);break;case 3:e.addClass(`${m} ${h}`)}const r=g.length;if(r){g[r-1].push(this)}const a=this.tabindex=this.state?this.state.tabIndex:ko.observable(0),l=this.disabled=this.state?this.state.disabled:ko.observable(!1),d=this.weaveContext,p=d?null:this._bindingContext||o.getContext(e)||{},f=d?(0,n.toObservable)(this.ltm,d.disabled):p.$disabled,x=d?(0,n.toObservable)(this.ltm,d.enabledTabIndex):p.$enabledTabIndex;this.$disabled=o.chainDisabledProperties([f,l,t.disabled]),this.$enabledTabIndex=o.chainEnabledTabIndexProperties([x,a]),this.$tabIndex=o.makeTabIndexProperty(this.$enabledTabIndex,this.$disabled)}dispose(){if(this._checkExistsOrRegisterDestroyId(super.dispose))return;this._waitToken.cancel(new p.DisposedCanceledError),this._widgets&&(this._widgets.forEach((e=>{e&&e.dispose()})),this._widgets=null),this.element.removeClass(`${u} ${m} ${h}`).removeAttr("role");const e=g.length;if(e){const t=g[e-1];MsPortalFx.remove(t,this)}super.dispose()}get options(){return this._options}widget(){return this.element}get widgets(){return this._widgets}awaitContentRevealed(){return Promise.resolve(!1)}static beginTracking(e=[]){g.push(e)}static endTracking(){return g.pop()}trigger(e,t,s,o){const i=this.options[e],n=this.element;return s=s||{},(t=t||$.Event(e)).type=e,t.target=o||n[0],n.trigger(t,s),!($.isFunction(i)&&!1===i.apply(n[0],[t].concat(s))||t.isDefaultPrevented())}waitFor(e){return d(e,this._waitToken)}sanitizeTemplate(t){return t&&!this.isTrusted?i.sanitizeHTML(t,e,this.element).sanitizedMarkup:t}_bindDescendants(e={},t){const s=this.options,o=$(t||this.element)[0];ko.utils.extend(e,{data:s});const i=this._createBindingContext(e,s,o);ko.applyBindingsToDescendants(i,o)}_bindElement(e,t){const s=$(t)[0],o=this._createBindingContext(e,e,s);ko.applyBindings(o,s)}_createBindingContext(e,t,s){return o.createChildContext(s,e,{$ctl:this,$vm:t,$disabled:this.$disabled,$enabledTabIndex:this.$enabledTabIndex,$tabIndex:this.$tabIndex,$dicontainer:this._diContainer},this._bindingContext)}_isRtl(){return"rtl"===$.querySelectorAll("html").attr("dir")}}t.Widget=f})),
define("MsPortalImpl.Controls/Controls/SimpleButton",["require","exports","Weave/DirectMode","MsPortalImpl.Controls/Controls/Base/OptionsBase","FxInternal/WeaveControls/Button.Component.Internal","FxInternal/Weave"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.InnerTsxComponent=void 0;const r="fxc-simplebutton";t.InnerTsxComponent=function(e){const t=e.vm;return s(i.ButtonInner,{onClick:t.onClick,text:(0,n.toComputation)(t.text),style:(0,n.toComputation)(t.style),disabled:(0,n.toComputation)(t.disabled),ariaLabel:(0,n.toComputation)(t.ariaLabel),loading:(0,n.toComputation)(t.loading),loadingText:(0,n.toComputation)(t.loadingText),icon:(0,n.toComputation)(t.icon)})};class a extends o.Widget{constructor(e,t,s){super(e,t,s),this.element.addClass(r)}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._cleanElement(r),super.dispose())}}t.Widget=a})),
define("MsPortalImpl.Controls/Fields/Base/FormValidation",["require","exports","MsPortalImpl/Base/JQueryHelper"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.focusOnFirstInvalidField=t.performFieldValidation=t.gatherFormFields=t.gatherFormFieldsFromElements=t.markFormFieldElement=t.gridEnableValidation=t.ensureFormFieldValidation=void 0;const o=MsPortalFx.identity;MsPortalFx.Base.Diagnostics.createLog(e);function i(e){e.forEach((e=>{const t=e&&e.rowMetadata;t&&t.editState&&t.editState()&&e.performValidation&&!e.performValidation()&&e.performValidation(!0)}))}t.ensureFormFieldValidation=function(e,t=!0,s=!1){const o=d(e,s),n=o.map((e=>e.field)),r=o.map((e=>e.viewmodel)).filter(MsPortalFx.identity);return t&&i(r),0===n.length?Promise.resolve(!0):p(n)},t.gridEnableValidation=i;const n="data-validatable",r="field",a="viewmodel",l="widgetviewmodel";function c(e,t,o){return e.filter((e=>{const i=$(e);return e&&e.hasAttribute(n)&&i.closest(".fxs-suppresschildvalidation").length<1&&i.data(r)&&(!t||t(e))&&(o||s.isElementVisible(e))})).map((e=>{const t=$(e);return{viewmodel:t.data(a),widgetviewmodel:t.data(l),field:t.data(r)}}))}function d(e,t=!1,s){return e.length?c(e.find(`[${n}]`).toArray(),(e=>$(e).data(r)&&(!s||s(e))),t):[]}function p(e){const t=[];return e.filter((e=>e.triggerValidation)).map((e=>{t.push(e.triggerValidation())})),Promise.all(t).then((e=>e.every(o)))}t.markFormFieldElement=function(e,t,s,o){const i=$(e);i.attr(n,"true"),i.data(r,o),i.data(a,t),i.data(l,s);const c=(!!o.fieldsData?i.parent():i).closest(".fxs-validationContainer");let p;if(c.length&&c.hasClass("fxs-part-content")){const t=c.parent(),s=ko.dataFor(t[0]),o=s&&s.context;p=o&&o.validateElements,p&&p.push(e)}else if(c.length){const e=c.data(r);e&&e.fieldsData&&e.fieldsData(d(c,!0))}o.ltm.registerForDispose((()=>{p&&p.remove(e),i.data(r,null),i.data(a,null),i.data(l,null)}))},t.gatherFormFieldsFromElements=c,t.gatherFormFields=d,t.performFieldValidation=p,t.focusOnFirstInvalidField=function(e){e.find(".fxs-bg-error").eq(0).closest("[data-validatable='true']").find(".azc-input").eq(0).focus()}})),
define("MsPortalImpl/AzFramework/AzBladeViewModel",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileViewModel=t.BladeViewModel=void 0;class s{constructor(){this._initializedPromiseDeferred=Promise.withResolvers(),this._onInputsSetCalledDeferred=Promise.withResolvers()}hookOnInputsSet(e){return this._initializedPromiseDeferred.resolve(e),this._onInputsSetCalledDeferred.promise}onInputsSet(e){return this._onInputsSetCalledDeferred.resolve({parameters:e.parameters}),this._initializedPromiseDeferred.promise.then((e=>e))}}t.BladeViewModel=class extends s{constructor(e){super(),this.title=ko.observable(),this.subtitle=ko.observable(),this.icon=ko.observable(),this.statusBar=ko.observable(),this.menuContent={title:ko.observable(),subtitle:ko.observable()},this._onPinHandler=ko.observable(),this.menuBladeViewModel=ko.observable(),this._msPortalFxV2ShellApi=ko.computed(e,(()=>({onPin:this._onPinHandler()})))}setOnPinHandler(e){this._onPinHandler(e)}};t.TileViewModel=class extends s{constructor(e){super(),this._container=e,this.onClick=ko.observable()}setOnClickHandler(e){this.onClick(e)}setUpdatableHeaderHandler(e,t){this._container.updatableHeader.enableForExtensionRenderedHeader((t=>{e(t)}),t)}}})),
define("MsPortalImpl/ViewModels/ViewModels.BladeCaller",["require","exports"],(function(e,t){"use strict";var s;return function(e){const t="internal_";e.bindingName_bladeCallId=t+"bladeCallId",e.bindingName_bladeCallerParams=t+"bladeCallerParams",e.bindingName_bladeCallerResult=t+"bladeCallerResult",e.addCallerBindings=function(t,s,o){const i=s.additionalInputArguments=s.additionalInputArguments||[];s.outputArguments=s.outputArguments||[];const n=t+".";i.push({property:e.bindingName_bladeCallId,valuesFrom:[{referenceType:o,property:n+e.bindingName_bladeCallId}]}),i.push({property:e.bindingName_bladeCallerParams,valuesFrom:[{referenceType:o,property:n+e.bindingName_bladeCallerParams}]}),s.outputArguments.push({property:e.bindingName_bladeCallerResult,valuesFrom:[{referenceType:1,property:e.bindingName_bladeCallerResult}]})},e.addCallablePartInputs=function(t){t.inputs=t.inputs||[],t.inputs.push(e.bindingName_bladeCallId,e.bindingName_bladeCallerParams)},e.addCallableBindings=function(t,s,o,i){const n=s.inputs=s.inputs||[];let r;if(s.outputs=s.outputs||[],s.bindings=s.bindings||[],i.inline)r=i.inline.bindings=i.inline.bindings||[];else{if(!i.reference)throw new Error("Part is neither inline nor a reference, so cannot add blade callable bindings");r=i.reference.bindings=i.reference.bindings||[]}n.push(e.bindingName_bladeCallId),r.push({property:e.bindingName_bladeCallId,valuesFrom:[{referenceType:1,property:e.bindingName_bladeCallId}]}),n.push(e.bindingName_bladeCallerParams),r.push({property:e.bindingName_bladeCallerParams,valuesFrom:[{referenceType:1,property:e.bindingName_bladeCallerParams}]}),s.outputs.push(e.bindingName_bladeCallerResult),s.bindings.push({property:e.bindingName_bladeCallerResult,valuesFrom:[{referenceType:0,property:t+"."+e.bindingName_bladeCallerResult,part:o}]})}}(s||(s={})),s})),
define("MsPortalImpl/Extension/DefinitionPreprocessor",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/ViewModels/ViewModels.BladeCaller","FxInternal/Utils/LinkSanitizer"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processCommands=t.processBlade=t.processPart=t.preprocessDefinition=t.collisionPrefix=t.PinPrefix=void 0;var r=MsPortalFx.Base.Constants.BladeParameterNames,a=MsPortalFx.Parts,l=a.PartKind,c=a.PartSize,d=MsPortalFx.Composition.Configuration;const p="internal_parameterProviderActionBarOutput",u="content.parameterProvider",m=MsPortalFx.isDevelopmentMode?1:0;t.PinPrefix="InferredBladePinPart",t.collisionPrefix="inferredBladePinPartInputs.";const h="Microsoft_Azure_Insights",g="MetricsSummaryPart",f="timeRange",x="_msPortalFxTimeRange";function b(e,t){e&&e.extension&&(e.extension=t[e.extension]||e.extension)}function y(e,t){e&&e.length&&e.forEach((e=>{e.bladeExtension&&(e.bladeExtension=t[e.bladeExtension]||e.bladeExtension)}))}function v(e,t,i,r){if(i.processed)return i;r=r||{},b(i.reference,r),y(i.details,r),e.partTypeMap[i.name.toLowerCase()]=i,i.assetTypeDefinition=MsPortalFx.find(t.assetTypes,(e=>e.partName===i.name&&!e.partExtensionName)),I(i.details,0),i.parameterProvider&&S(i),function(e,t){const s=t.reference;if(s){if(s.partTypeName===g&&(s.extension===h||!s.extension&&e.name===h)){const e=s.bindings;MsPortalFx.find(e,(e=>e.property===f))||(e.push({property:f,valuesFrom:[{referenceType:9,property:x}],optional:!0}),t.inputDefinitions.push({name:x,type:d.TimeRangeValueType,optional:!0}))}}}(e,i);const a=s.container;return i.trustedLinkedDomains&&a.get(n.LinkSanitizer).processTrustedLinkedDomains(e.name,i.trustedLinkedDomains),o.sanitizeInlineTemplate(a,e.name,i.name,i,m),i.processed=!0,i}function M(e,a,d,h){if(h=h||{},d.processed)return d;MsPortalFx.isNullOrUndefined(d.pinnable)&&(d.pinnable=!!d.pinnedPart),2&d.attributes&&(d.optionalInputs=d.optionalInputs||[],d.optionalInputs.push("_provisioningContext")),d.templateBlade&&function(e){const t=e.templateBlade,s=t.isV2,o=t.isV2?c.FitToContainer:t.partSize||c.FullWidthFitHeight,i=P(e.name,e,t.htmlTemplate,t.htmlTemplateInline,o,t.partState,t.parameterProvider,t.styleSheets,e.permissions,12===e.style?l._Internal_App:null,s);e.lenses=e.lenses||[],e.lenses.push({name:"TemplateBladeVirtualLens",partInstances:[i]}),e.locked=!0,s&&(e.style=8);const n=i.inline;C(n,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),C(n,e.optionalInputs,[],!0,e.effectiveInputs);const r=e.effectiveInputs=n.bindings;e.outputs&&e.outputs.forEach((t=>{e.bindings=e.bindings||[],e.bindings.push({property:t,valuesFrom:[{referenceType:0,property:"content."+t,part:i.name}]})})),e.editScopeType&&r.push({property:"editScopeId",valuesFrom:[{referenceType:1,property:"editScopeId"}]});e.actionBar&&(e.actionBar.source={valuesFrom:[{referenceType:0,part:i.name,property:"content.actionBar"}]});e.toolbar&&(e.toolbar.source={valuesFrom:[{referenceType:0,part:i.name,property:"content.commandBar"}]});n.details=t.details}(d),d.menuBlade&&function(e){const t=e.name,s=e.menuBlade.isV2,o=P(t,e,void 0,{content:`<div data-bind='pcControl: ${s?"viewModel && viewModel._msPortalFxMenu":"menu"}' class='ext-menublade-part'></div>`,file:t+MsPortalFx.getUniqueId()},c.FitToContainer,void 0,!1,[],void 0);C(o.inline,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),C(o.inline,e.optionalInputs,[],!0,e.effectiveInputs);const i={name:t,partInstances:[o]};e.lenses.splice(0,0,i),e.effectiveInputs=o.inline.bindings,MsPortalFx.isNullOrUndefined(e.pinnable)&&(e.pinnable=!0)}(d),d.tabMenuBlade&&function(e){const t=e.name,s=e.tabMenuBlade.isV2,o=P(t,e,void 0,{content:`<div data-bind='pcControl: ${s?"viewModel && viewModel._msPortalFxTabMenu":"tabMenu"}' class='ext-tabmenublade-part'></div>`,file:t+MsPortalFx.getUniqueId()},c.FitToContainer,void 0,!1,[],void 0);C(o.inline,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),C(o.inline,e.optionalInputs,[],!0,e.effectiveInputs);const i={name:t,partInstances:[o]};e.lenses.splice(0,0,i),e.effectiveInputs=o.inline.bindings,e.style=10,MsPortalFx.isNullOrUndefined(e.pinnable)&&(e.pinnable=!0)}(d),d.frameBlade&&function(e){const t=e.name,s=P(t,e,void 0,void 0,c.FitToContainer,e.frameBlade.partState,!1,[],e.permissions,l.Frame);C(s.inline,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),C(s.inline,e.optionalInputs,[],!0,e.effectiveInputs),e.toolbar={source:{valuesFrom:[{referenceType:0,part:t,property:"content.commandBar"}]}};const o={name:t,partInstances:[s]};e.lenses.splice(0,0,o),e.effectiveInputs=s.inline.bindings}(d),(d.lenses||[]).forEach((e=>{(e.partInstances||[]).forEach((e=>{b(e.reference,h),y(e.inline&&e.inline.details,h)}))})),e.bladeMap[d.name.toLowerCase()]=d,d.assetTypeDefinition=MsPortalFx.find(a.assetTypes,(e=>e.bladeName===d.name)),function(e){e.lenses&&e.lenses.forEach((t=>{t.partInstances&&t.partInstances.forEach((t=>{t.inline&&(t.parameterProvider&&S(t.inline),I(t.inline.details,0)),function(e,t,s){if(s.parameterProvider&&(e.attributes|=1,i.addCallableBindings(u+".bladeCallable",e,t,s),e.actionBar)){e.actionBar.bindings=e.actionBar.bindings||[];e.actionBar.bindings.some((e=>"input"===e.property))||e.actionBar.bindings.push({property:"input",valuesFrom:[{referenceType:0,part:t,property:u+".defaultActionBarInput"}]}),e.templateBlade||(s.inline||s.reference).bindings.push({property:p,valuesFrom:[{referenceType:2,property:"content.output"}]})}}(e,t.name,t)}))}))}(d),d.effectiveInputs||(d.effectiveInputs=d.viewModelInputs||[]);const g=function(e){const s=t.PinPrefix+e.name;e.pinnedPart||(e.pinnedPart=s);const o={name:s,viewModel:"Shell.InferredBladePinPart"+e.name,partKind:l.Button,inputs:e.inputs,initialSize:c.Normal,details:[{blade:e.name,invocationInputArguments:[{valuesFrom:[{property:"container.selectable.value",referenceType:0}]}],additionalInputArguments:[]}],bindings:[],viewStateProperties:["container.selectable.isSelected"],commandGroup:e.commandGroup,commandGroupReference:e.commandGroupReference,assetIdInputProperty:e.assetIdInputProperty,assetType:e.assetType};(e.inputs||[]).forEach((e=>{o.bindings.push({property:t.collisionPrefix+e,valuesFrom:[{property:e,referenceType:1}]})})),(e.optionalInputs||[]).forEach((e=>{e!==r.ReferrerInfo&&o.bindings.push({property:t.collisionPrefix+e,optional:!0,valuesFrom:[{property:e,referenceType:1}]})})),e.viewModelInputs&&e.viewModelInputs.forEach((t=>{t.property===e.assetIdInputProperty&&o.bindings.push(t)}));return o}(d);e.partTypeMap[g.name.toLowerCase()]=g;const f=s.container;return d.trustedLinkedDomains&&f.get(n.LinkSanitizer).processTrustedLinkedDomains(e.name,d.trustedLinkedDomains),o.sanitizeBladeDefinition(f,e.name,d,m),d.processed=!0,d}function C(e,t,s,o,i){t&&t.forEach((t=>{const n=!o&&s&&s.includes(t);e.inputs.push(t),e.bindings.push(i&&MsPortalFx.find(i,(e=>e.property===t))||{property:t,optional:o,isIdentityInput:n,valuesFrom:[{referenceType:1,property:t}]})}))}function P(e,t,s,o,i,n,r,a,c,d,p){return{name:e,inline:{bindings:[],details:[],inputs:[],partKind:d||l.Custom,viewModelLocator:t.viewModelLocator,viewModel:t.viewModelName,htmlTemplate:s,htmlTemplateInline:o,assetType:t.assetType,assetIdInputProperty:t.assetIdInputProperty,initialSize:i,viewStateProperties:[],shareVmWithParentBlade:!0,partState:n,styleSheets:a,permissions:c,noFxContentPadding:p},parameterProvider:r}}function w(e){e.commandsCatalog&&e.commandsCatalog.forEach((e=>{I([e.details],4)})),e.commandGroups&&e.commandGroups.forEach((e=>{e.commands&&e.commands.forEach((e=>{I([e.details],4)}))}))}function I(e,t){e&&e.filter((e=>e&&!!e.parameterCollector)).forEach((e=>{i.addCallerBindings(e.parameterCollector+".bladeCaller",e,t)}))}function S(e){e.editScopeType=e.editScopeType||"PDLEditScope",e.inputs=e.inputs||[],e.inputs.push(p),i.addCallablePartInputs(e)}t.preprocessDefinition=function(e,t){const s=e;return s.partTypeMap=s.partTypeMap||{},s.bladeMap=s.bladeMap||{},(s.partsCatalog||[]).forEach((e=>v(s,t,e,{}))),(s.blades||[]).forEach((e=>M(s,t,e,{}))),function(e){e.startBoardParts&&e.startBoardParts.forEach((e=>{e.inline&&I(e.inline.details,0)})),w(e)}(e),s},t.processPart=v,t.processBlade=M,t.processCommands=w})),
define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validatePartType=t.validateBlade=t.validateIsArray=t.validateIsBoolean=t.validateIsString=t.validateDefinition=t.ValidationResult=void 0;var s=MsPortalFx.Extension.SetRequirement;function o(e,t){MsPortalFx.forEachKey(e,((e,s)=>{void 0!==s&&t(e,s)}))}function i(e,t,s){"string"!=typeof t&&s.push("{0} is not a valid string.".format(e))}function n(e,t,s){"boolean"!=typeof t&&s.push("{0} is not a valid boolean.".format(e))}function r(e,t,s){const o=Array.isArray(t);return o||s.push("The '{0}' property is not a valid array.".format(e)),o}function a(e,t,s,o){const i=t.name;t.inputs&&r("Blade: {0}. Property: blades[{1}].inputs".format(i,s),t.inputs,o),t.optionalInputs&&r("Blade: {0}. Property: blades[{1}].optionalInputs".format(i,s),t.optionalInputs,o),r("Blade: {0}. Property: blades[{1}].lenses".format(i,s),t.lenses,o)&&t.lenses.forEach(((e,t)=>{const n="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(i,e.name,s,t);e.partInstances&&r(n,e.partInstances,o)&&e.partInstances.forEach(((n,r)=>{d("Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(i,e.name,n.name,s,t,r),n,o)}))})),t.permissions&&r("Blade: {0}. Property: blades[{1}].permissions".format(i,s),t.permissions,o)&&t.permissions.forEach(((e,t)=>{c("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(i,s,t),e,o)})),function(e,t,s){if(!e)return;e.source?l(e.source,t+".source",s):s.push("Source not specified for toolbar. "+t)}(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(i,s),o),function(e,t,s){e&&e.source&&l(e.source,t+".source",s)}(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(i,s),o)}function l(e,t,s){e.property&&i(t+".property",e.property,s),e.optional&&"boolean"!=typeof e.optional&&s.push("The attribute 'optional' should be of type boolean. "+t),e.isIdentityInput&&"boolean"!=typeof e.isIdentityInput&&s.push("The attribute 'isIdentityInput' should be of type boolean. "+t),r(t+".valuesFrom",e.valuesFrom,s)&&e.valuesFrom.forEach(((e,o)=>{!function(e,t,s){switch(t.referenceType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;default:s.push("Unknown reference type '{0}' found for {1}.referenceType.".format(t.referenceType,e))}i(e+".property",t.property,s),t.part&&i(e+".part",t.part,s)}(t+".valuesFrom[{0}]".format(o),e,s)}))}function c(e,t,o){switch(t.permissionType){case 0:{const s=t;s.extensionName&&i(e+".extensionName",s.extensionName,o),i(e+".assetType",s.assetType,o),s.assetId?function(e,t,s){switch(t.sourceType){case 0:t.providerKey&&s.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(e));break;case 1:t.providerKey||s.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(e)),i(e+".providerKey",t.providerKey,s);break;case 2:t.providerKey||s.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(e)),i(e+".providerKey",t.providerKey,s);break;default:s.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".format(t.sourceType,e))}i(e+".property",t.property,s)}(e+".assetId",s.assetId,o):o.push("Permission missing assetId found for {0}.assetId.".format(e)),i(e+".action",s.action,o);break}case 1:{const i=t;switch(i.requirement){case s.All:case s.Any:break;default:o.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(i.requirement,e))}r(e+".permissions",i.permissions,o)&&i.permissions.forEach(((t,s)=>{c("{0}.permissions[{1}]".format(e,s),t,o)}));break}default:o.push("Unknown permission type '{0}' found for {1}.permissionType.".format(t.permissionType,e))}}function d(e,t,s){t.reference||t.inline?t.reference&&t.inline?s.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".format(e)):t.reference&&!t.reference.partTypeName?s.push("'partTypeName' property is required on part reference. Property: {0}".format(e)):t.inline&&p(e,t.inline,s):s.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(e))}function p(e,t,s){t&&(!function(e,t,s){if(!t)return;const o=t.inputIdentityProperties||[],i=t.sharedProperties||[],n=o.concat(i.map((e=>e.property))),r=i.map((e=>e.key)),a=u(n),l=u(r);a&&a.length>0&&s.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(a),e));l&&l.length>0&&s.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(l),e))}(e,t.partState,s),t.permissions&&r("{0}.permissions".format(e),t.permissions,s)&&t.permissions.forEach(((t,o)=>{c("{0}.permissions[{1}]".format(e,o),t,s)})))}function u(e){const t={},s=[];return(e||[]).forEach((e=>{t[e]&&s.push(e),t[e]=!0})),s}function m(e,t){e.inputDefinitions&&r("PartType: {0}. Property: inputDefinitions".format(e.name),e.inputDefinitions,t),e.reference&&function(e,t){(e.reference.bindings||[]).forEach((s=>{(s.valuesFrom||[]).forEach((s=>{7!==s.referenceType&&9!==s.referenceType&&5!==s.referenceType&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".format(e.name))}))}))}(e,t),p("PartType: {0}".format(e.name),e,t)}t.ValidationResult=class{constructor(){this.errors=[]}valid(){return!this.errors.length}},t.validateDefinition=function(e,t){return t=t||[],e?o(e,((s,l)=>{switch(s){case"name":i("Extension name",l,t);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":i(s,l,t);break;case"isPreview":n(s,l,t);break;case"assetTypes":r(s,l,t);break;case"blades":!function(e,t,s){t&&r("blades",t,s)&&t.forEach(((t,o)=>{a(e,t,o,s)}))}(e,l,t);break;case"startBoardParts":!function(e,t){r("startBoardParts",e,t)&&e.forEach(((e,s)=>{d("startBoardParts[{0}]".format(s),e,t)}))}(l,t);break;case"partsCatalog":!function(e,t){if(!e)return;r("partsCatalog",e,t)&&e.forEach((e=>{m(e,t)}))}(l,t);break;case"commandsCatalog":!function(e,t){if(!e)return;r("commandsCatalog",e,t)&&e.forEach((e=>{const s="Commands in 'commandsCatalog' ";e.name||t.push(`${s}must have names.`),e.reference&&t.push(`${s}cannot specify a 'reference' property.`)}))}(l,t);break;case"commandGroups":!function(e,t){if(!e)return;r("commandGroups",e,t)&&MsPortalFx.mapMany(e,(e=>e.commands)).forEach((e=>{e.reference&&function(e,t){if(!e||!e.reference)return;let s=!1;o(e,(e=>{"name"!==e&&"bindings"!==e&&"reference"!==e&&(s=!0)})),s?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".format(ko.toJSON(e))):e.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(ko.toJSON(e)))}(e,t)}))}(l,t);break;case"htmlTemplates":!function(e,t){o(e,((e,s)=>{"string"!=typeof s&&(i("htmlTemplates['{0}'].file".format(e),s.file,t),i("htmlTemplates['{0}'].content".format(e),s.content,t))}))}(l,t);break;case"styleSheets":!function(e,t){Array.isArray(e)?e.forEach(((e,s)=>{i("StyleSheet at position {0}".format(s),e,t)})):t.push("Invalid type for 'styleSheets' property on definition.")}(l,t);break;case"galleryService":case"bladeMap":case"partTypeMap":case"requireConfig":case"dashboardProvider":break;default:t.push("Unexpected attribute '{0}' on definition.".format(s))}})):t.push("Definition is null or undefined."),!t.length},t.validateIsString=i,t.validateIsBoolean=n,t.validateIsArray=r,t.validateBlade=a,t.validatePartType=m})),
define("MsPortalImpl/Extension/CachedManifestClient",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CachedManifestClient=void 0;var o=MsPortalFx.Base;const i=o.Diagnostics.createLog(e);class n{constructor(e,t){this.getManifests=t=>{const s="assetTypes"===t?Promise.resolve(e):function(e){return Promise.resolve(MsPortalEarly.getCachedManifestUri(e)).then((e=>e?o.Net2.ajax({uri:e,performRetry:!0,type:"GET",dataType:"json",contentType:"application/json",useRawAjax:!0}).catch((e=>(i.error(e),null))):{manifestResponse:{}}))}(t);return s.then((e=>e.manifest||{}))},this.getMetadata=()=>t}static create(){return MsPortalEarly.manifestCachePromise.then((e=>{const t={},s=fx.bootParameters.environment.extensionsPageVersion;return Object.keys(s).forEach((o=>{const i=e.manifest[o]||{},n=MsPortalEarly.pickExtensionStamp(s[o]).split("/");i.pageVersion=n[0],i.prewarmerScript=n[1]&&[n[1],null],t[o]=i})),new n({manifest:t},e.metadata)})).catch((e=>{throw MsPortalEarly.navigateError("NoExtensions",[["stack",encodeURIComponent(e&&e.stack).slice(0,1e3)]]),e}))}}t.CachedManifestClient=n,__decorate([__metadata("fx:diagnostics",[e,"CachedManifestClient"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],n,"create",null)})),
define("MsPortalImpl/Extension/ExtensionManagerOptions",["require","exports","FxInternal/AsyncLoader","Fx/DependencyInjection","MsPortalImpl/Extension/CachedManifestClient"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.postBoot=t.getCatalogApiCacheContent=t.listTestExtensions=t.unregisterTestExtensions=t.registerTestExtensions=t.getExtensionRegistration=t.PostBootCache=t.ExtensionManagerOptions=t.TestExtensionsSource=void 0;const n=fx.environment,r=/\{0\}/g,a="feature.canmodifyextensions=true";function l(e,t,s){const o=!e.isEnabled("disableextensions"),i=[],a={};return t.forEach((t=>{if(a[t.name])return;a[t.name]=!0;const l=t.name.toLowerCase(),c=(/^[\w\-]+$/.exec(e.getValue(l)||"")||[""])[0];let d=c||o&&!(1&t.flags)&&!s.includes(t.name);if("false"===c&&(d=!1),d){const s="true"!==c&&"false"!==c?c:"",o=e.getValue(l+"_urlredirect"),a="string"==typeof o&&/^[a-z0-9]+$/i.test(o)?o:null,d=function(e){return void 0!==e.hostingServiceName}(t)?function(e,t,s){const o=s||e.hostingServiceName,i=16&e.flags?n.hostingServiceConfiguration.thirdParty:n.hostingServiceConfiguration.default,r=MsPortalEarly.formatHostingServiceEndpoints(i.uriFormat,{extName:o,stamp:t}),a=i.prewarmUriFormats.map((e=>MsPortalEarly.formatHostingServiceEndpoints(e,{extName:o}))),l=a.filter((e=>!MsPortalEarly.blockedHosts.includes(e.hostname))),c=l.length>0?l[0]:a[0],d=MsPortalEarly.formatHostingServiceEndpoints(i.uriFormat,{useEnvPrefix:!1,useEnvSuffix:!1,extName:o}).toString(),p=(i.baseDomains||[]).map((e=>MsPortalEarly.formatHostingServiceEndpoints(e,{extName:o,stamp:t}).toString())),u=!s&&!t;return{name:e.name,flags:e.flags,redirectTo:e.redirectTo,uri:r.toString(),prewarmUri:c.toString(),homePageUri:d,baseDomains:p,isTestExtension:!1,stamp:t,useBootProvidedVersion:u,isSideloaded:e.missingCachedManifest||!u,azBaseUri:e.azBaseUri,serviceTreeId:e.serviceTreeId}}(t,s,a):function(e,t){const s=t&&e.uriFormat?e.uriFormat.replace(r,t):e.uri,o=!e.isTestExtension&&!t;return{name:e.name,flags:0|e.flags,redirectTo:e.redirectTo,uri:s,prewarmUri:s,homePageUri:s,baseDomains:[],isTestExtension:e.isTestExtension,stamp:t,useBootProvidedVersion:o,isSideloaded:e.missingCachedManifest||!o,azBaseUri:e.azBaseUri,serviceTreeId:e.serviceTreeId,armResourceId:e.armResourceId}}(t,s);i.push(d)}})),i}class c{constructor(e){this.value=e}static create(e,t){const o=e.isEnabled("canmodifyextensions"),i=()=>t.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource")),n=o&&t.getAsync(s.get("MsPortalImpl/Extension/ExtensionPatch","PatchMetadataSource")),r=o&&i().then((e=>e.getCodeComponentsMetadata()));return MsPortalImpl.Extension={registerTestExtension:(e,t)=>i().then((s=>s.registerTestExtension(e,t))),unregisterAll:()=>i().then((e=>e.unregisterAll())),listTestExtensions:()=>i().then((e=>e.listTestExtensions()))},Promise.all([r,n]).then((([e])=>new c(e||[])))}}t.TestExtensionsSource=c,__decorate([__metadata("fx:diagnostics",[e,"TestExtensionsSource"]),o.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[FxImpl.Features,o.Container]),__metadata("design:returntype",Promise)],c,"create",null);class d{constructor(e,t,s){this._normalizedNameMap={};const o=(e.getValue("disabledextensionredirects")||"").toLowerCase().split(","),i=l(e,t,s||[]),n=FxImpl.partition(i,(e=>e.redirectTo&&!o.includes(e.name.toLowerCase())));this.extensionRedirectMap=MsPortalFx.convertArrayToMap(n[0],(e=>e.name),(e=>e.redirectTo)),this.extensionsAsArray=n[1],this.extensionsAsMap=MsPortalFx.convertArrayToMap(this.extensionsAsArray,(e=>e.name)),this._normalizedNameMap=MsPortalFx.convertArrayToMap(i,(e=>e.name.toLowerCase()),(e=>e.name))}static create(e,t,s){return new d(t,e.value.concat(s.getMetadata()),fx.environment.disabledExtensions)}getNormalizedMetadata(e,t){const s=e?this._normalizedNameMap[e.toLowerCase()]:e;if(t&&!s)throw new Error(`The extension name '${e}' is not valid`);return s&&this.extensionsAsMap[this.resolveExtensionName(s)]}resolveExtensionName(e){return this.extensionRedirectMap[e]||e}}t.ExtensionManagerOptions=d,__decorate([__metadata("fx:diagnostics",[e,"ExtensionManagerOptions"]),o.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[c,FxImpl.Features,i.CachedManifestClient]),__metadata("design:returntype",d)],d,"create",null);let p=class{constructor(){this._value={}}get(e){return this._getEntry(e).promise}set(e,t){const s=t.extensionEnvironment;this._getEntry(e).resolve({...t,extensionEnvironment:"string"==typeof s?JSON.parse(s):s||{}})}_getEntry(e){return this._value[e]||(this._value[e]=Promise.withResolvers())}};t.PostBootCache=p,t.PostBootCache=p=__decorate([__metadata("fx:diagnostics",[e,"PostBootCache"]),o.Class()],p),t.getExtensionRegistration=s.defineHandler(FxImpl.Extension.getExtensionRegistrationEndPoint,(e=>{const t=e.diContainer.get(d).extensionsAsMap[e.messageArg];return{baseUri:MsPortalEarly.ExtensionLoader.getUri(t),resourceId:t.armResourceId}})),t.registerTestExtensions=s.defineHandler(FxImpl.Extension.CreateUiDef.registerTestExtensionsEndPoint,(async e=>{const t=await e.diContainer.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource")),o=e.messageArg.map((e=>t.registerTestExtension(e)));await Promise.all(o);const i=globalThis.location;i.search?i.search=i.search.concat("&"+a):i.search="?"+a})),t.unregisterTestExtensions=s.defineHandler(FxImpl.Extension.CreateUiDef.unregisterTestExtensionsEndPoint,(async e=>{const t=await e.diContainer.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource")),o=e.messageArg.map((e=>t.unregisterTestExtension(e)));await Promise.all(o),globalThis.location.reload()})),t.listTestExtensions=s.defineHandler(FxImpl.Extension.CreateUiDef.listTestExtensionsEndPoint,(async e=>(await e.diContainer.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource"))).listTestExtensions())),t.getCatalogApiCacheContent=s.defineHandler(FxImpl.Extension.getCatalogApiCacheContentEndPoint,(()=>MsPortalEarly.manifestCachePromise.then((e=>e.catalogApi)).then((e=>({...e}))))),t.postBoot=s.defineHandler(FxImpl.Extension.postBootEndPoint,(e=>{e.diContainer.get(p).set(e.messageContext.srcWindowId,e.messageArg)}))})),
define("MsPortalImpl/Extension/Extension.Manifest",["require","exports","Fx/DependencyInjection","Fx","FxHubs/ResourceManagement","FxInternal/AsyncLoader","MsPortalImpl/Extension/CachedManifestClient","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/ExtensionManagerOptions","Fx/Experimentation"],(function(e,t,s,o,i,n,r,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManifestCache=t.RedirectMap=t.assetRedirectKey=t.bladeRedirectKey=t.partRedirectKey=void 0;var d=MsPortalFx.Extension,p=MsPortalFx.Base.Diagnostics,u=MsPortalFx.isNullOrWhiteSpace,m=(MsPortalFx.Extension.BrowseType,MsPortalFx.Base.Diagnostics.Telemetry);const h=window;function g(e,t,s,o,i){return`[${e}]${t}-${s}-${o}-${i}`.toLowerCase()}function f(e,t){return`${e}-${t}`.toLowerCase()}function x(e,t,s){return`${e}_${t}${s?"."+s:""}`.toLowerCase()}t.partRedirectKey=g,t.bladeRedirectKey=f,t.assetRedirectKey=x;const b=p.createLog(e);function y(e){if(!e)return;const t={hideassettype:1,hideinstances:2,showassettype:4,showinstances:8,disabled:16},s=(e,s,o)=>{if("number"==typeof o)e[s]={options:o};else if("string"==typeof o){let i=0;(o||"").toLowerCase().split(",").forEach((e=>{e=(e||"").trim(),t[e]&&(i|=t[e])})),e[s]={options:i}}},o=(e,t,s)=>{"boolean"==typeof s&&(e[t]?e[t].hideBrowseInfoBox=s:e[t]={hideBrowseInfoBox:s})},i=Object.create(null);return MsPortalFx.forEachKey(e,((e,t)=>{t&&(s(i,e,t.options),o(i,e,t.hidebrowseinfobox),t.kinds&&(i[e]=i[e]||Object.create(null),i[e].kinds=Object.create(null),MsPortalFx.forEachKey(t.kinds,((t,n)=>{n&&(s(i[e].kinds,t,n.options),o(i[e].kinds,t,n.hidebrowseinfobox))}))),t.featureCardOptions&&(i[e]=i[e]||Object.create(null),i[e].featureCardOptions=t.featureCardOptions),t.variant&&(i[e].variant=t.variant))})),i}let v=class{constructor(e){this._partRedirectsMap={},this._bladeRedirectsMap={},this._assetRedirectsMap={},this._experimentAssignments=e.shellAssignments}addPartRedirect(e){this._partRedirectsMap[g(e.type,e.fromExtension,e.fromPart,e.fromBlade,e.fromLens)]=e}addBladeRedirect(e){this._bladeRedirectsMap[f(e.fromExtension,e.fromBlade)]=e}addAssetRedirect(e){this._assetRedirectsMap[x(e.fromExtension,e.fromAsset,e.fromKind)]=e}getPartRedirect(e,t,s,o,i){const n=g(e,t,s,o,i);return{key:n,definition:this._partRedirectsMap[n]}}getBladeRedirect(e,t){const s=f(e,t),o=this._bladeRedirectsMap[s];let i=!!o;return o&&o.useFlighting&&(i=!!this._experimentAssignments.isAvailable&&this._experimentAssignments.getBooleanValue(`RedirectBlade-${o.fromExtension}-${o.fromBlade}`)),o&&m.trace({source:"ExtensionManifest.RedirectMap",action:"getBladeRedirect.redirection",data:{redirect:o,redirectApplied:i,nullExperimentAssignments:!this._experimentAssignments.isAvailable}}),{key:s,definition:i?o:null}}getAssetRedirect(e){return this._assetRedirectsMap[e.toLowerCase()]}};function M(e,t,s,o){e.push(t.format(s,o))}t.RedirectMap=v,t.RedirectMap=v=__decorate([__metadata("fx:diagnostics",[e,"RedirectMap"]),s.Class(),__metadata("design:paramtypes",[c.Experimentation])],v);const C={},P={};let w=class{constructor(e,t,s,o,i,r){this._redirectMap=t,this._cachedManifestClient=o,this._features=i,this._experimentation=r,this._cachedManifestsLoaded={},this._cache={},this._asyncCache={},this._extensionBlockBladeRedirect=(i.getValue("blockbladeredirect")||"").toLowerCase(),function(e){const t=(e,t)=>{e&&e.split(",").forEach(t)};t(e.getValue("assettypeapiversion"),(e=>{const t=e.split(":");2===t.length&&t[0]&&(C[t[0].toLowerCase()]=t[1])}));const s=e=>t=>{t&&(P[t.toLowerCase()]=e)};t(e.getValue("showassettypes"),s(!0)),t(e.getValue("hideassettypes"),s(!1))}(this._features),i.isEnabled("prefetchbrowsequerymanifest")&&this._cachedManifestClient.getManifests("assetTypesBrowse"),i.isEnabled("prefetchfeaturecardsmanifest")&&this._cachedManifestClient.getManifests("featureCards"),r.shellAssignments.getBooleanValue("disablecopilotmanifest")&&(this._cachedManifestsLoaded.copilot=Q.resolve(null));const a=FxImpl.partition(s.extensionsAsArray,(e=>e.isSideloaded)),l=[];a[0].length&&l.push(e.getAsync(n.get("MsPortalImpl/Extension/SideloadManifestClient","SideloadManifestClient")).then((e=>e.getManifests(a[0]))).then((e=>{MsPortalFx.forEachKey(e,((e,t)=>{this.trySetAllManifest(e,t)}))}))),this._sideloadManifestsLoaded=Promise.all(l).then((()=>a[1]))}getManifests(e,t){const s=Object.create(null);t&&Object.keys(this._cache).forEach((o=>{const i=this.getManifest(o,e);i&&(s[o]=!0,t(o,i))}));let o=this._cachedManifestsLoaded[e]||(this._cachedManifestsLoaded[e]=Q(Promise.all([this._sideloadManifestsLoaded,this._cachedManifestClient.getManifests(e)]).then((([t,s])=>{t.forEach((t=>{this.trySetManifest(t.name,e,s[t.name]||{})}))}))));return t&&(o=Q(MsPortalFx.tryImmediateResolve(o,(()=>{Object.keys(this._cache).forEach((o=>{s[o]||t(o,this.getManifest(o,e))}))})))),o}getManifest(e,t){return this._getCache(e)[t]}getManifestAsync(e,t){return MsPortalFx.tryImmediateResolve(MsPortalFx.tryImmediateResolve(this.getManifests(t),(()=>this._getAsyncCache(e)[t].promise)),(()=>this._getCache(e)[t]))}trySetManifest(e,t,s,o){if(this._validateAndProcessManifest(e,s,o))return this._setManifest(e,t,s),!0}trySetAllManifest(e,t,s){if(this._validateAndProcessManifest(e,t,s))return MsPortalEarly.cachedManifestTypes.forEach((s=>{this._setManifest(e,s,t)})),!0}getVersion(e){const t=this.getManifest(e,"assetTypes");return t&&t.pageVersion}getHostOverride(){return this._features.getValue("manifesthost")}_setManifest(e,t,s){this._getCache(e)[t]||(this._getCache(e)[t]=s,this._getAsyncCache(e)[t].resolve())}_getCache(e){return this._cache[e]||(this._cache[e]={})}_getAsyncCache(e){return this._asyncCache[e]||(this._asyncCache[e]={assetTypes:Promise.withResolvers(),assetTypesBrowse:Promise.withResolvers(),assetTypesMenu:Promise.withResolvers(),featureCards:Promise.withResolvers(),galleryParts:Promise.withResolvers(),surveys:Promise.withResolvers(),uiDefinition:Promise.withResolvers(),extensionConfiguration:Promise.withResolvers(),sourceMappings:Promise.withResolvers(),copilot:Promise.withResolvers(),tourGuide:Promise.withResolvers()})}_validateAndProcessManifest(e,t,s){const n=s||[],r=[];if(!t){const e="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the MsPortalFx.Extension.register/FxExtension.registerAmd call that is used to register your extension with the portal.";n.push(e)}const l=this._features.getValue("manifesthost"),c=/([^:]*)/.exec(h.location.host)[1],p=t.assetTypes;if(p){(0,a.validateIsArray)("manifest.assetTypes",p,n)&&p.forEach((t=>{!function(e,t,s,o){const i=e.name;if(u(i)&&M(s,"The name for the asset type in manifest '{0}' was not specified.",t),void 0!==e.options&&"number"!=typeof e.options&&M(s,"The asset type options property present for the asset type '{0}' in manifest '{1}' was not a number.",i,t),void 0!==e.browseType&&"number"!=typeof e.browseType&&M(s,"The browse type for the asset type '{0}' in manifest '{1}' was not a number.",i,t),e.browseLinkUri&&"string"!=typeof e.browseLinkUri&&M(s,"The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.",i,t),void 0!==e.privateBrowse&&"boolean"!=typeof e.privateBrowse&&M(s,"The private browse flag present for the asset type '{0}' in manifest '{1}' was not a boolean.",i,t),void 0!==e.browseRequiresRdfe&&"boolean"!=typeof e.browseRequiresRdfe&&M(s,"The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",i,t),void 0!==e.browseRequirements&&"number"!=typeof e.browseRequirements&&M(s,"The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.",i,t),void 0!==e.browseType){switch(e.browseType){case 1:case 2:case 3:break;default:M(o,"The browse for the asset type '{0}' in manifest '{1}' is deprecated: '"+e.browseType+"'.",i,t)}u(e.pluralDisplayName)&&u(e.text)&&M(s,"The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",i,t),MsPortalFx.isNullOrUndefined(e.icon)&&M(s,"The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",i,t)}else void 0!==e.privateBrowse&&M(s,"The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.",i,t);e.propertyProviderServiceViewModel&&"string"!=typeof e.propertyProviderServiceViewModel&&M(s,"The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.",i,t)}(t,e,n,r)}));const s=this._features.getValue(`${e}_hideassettypes`),m=this._features.getValue(`${e}_showassettypes`),h=this._features.getValue(`${e}_assettypeoptions`),g=this._features.getValue(`${e}_resourcetypeapiversions`),f=this._features.getValue(`${e}_argbrowseoptions`),x=this._features.getValue(`${e}_showargcolumns`),v=this._features.getValue(`${e}_hideassettypecommands`);let w;const I=s&&s.toLowerCase().split(","),S=m&&m.toLowerCase().split(",");let _;const F=h&&y(JSON.parse(h.toLowerCase()));let T;const k=g&&JSON.parse(g.toLowerCase());let D;const E=f&&JSON.parse(f.toLowerCase());let B;const A=x&&JSON.parse(x.toLowerCase());let N;const R=v&&JSON.parse(v.toLowerCase());let L,O;const z=t.environmentConfiguration;if(z){const e=z[z[l]&&l||z[c]&&c||MsPortalFx.find(Object.keys(z),(e=>c.endsWith(e)))||"*"];e&&(w=e.hideAssetTypes,_=y(e.assetTypeOptions),T=e.resourceTypeApiVersions,D=e.argBrowseOptions,B=e.showArgColumns,N=e.hideAssetTypeCommands,L=e.assetTypeBrowseCommandsExperiments,O=e.assetTypeExtensibleCommandsApiVersions)}if(p.forEach((t=>{if(t?.name){const s=t.name.toLowerCase(),n=e.toLowerCase(),r=t.variants&&this._experimentation.shellAssignments.getStringValue("assettypevariant-"+n+"-"+s);if(S||I||w||F||_||k||T||E||D||A||B||R||N||L||O||r){r&&(t.variant=r);const n=(e,o)=>{const n=e[s];n&&(void 0!==n.options&&(t.options=n.options),o||r||!n.variant||(t.variant=n.variant),t.hideBrowseInfoBox=n.hideBrowseInfoBox,t.privateBrowse=(0,i.supportsOption)(t.options,1),t.resourceType&&t.resourceType.kinds&&t.resourceType.kinds.forEach((e=>{const t=e.name.toLowerCase();if(n.kinds){const s=n.kinds[t];s&&(void 0!==s.options&&(e.options=s.options),e.hideBrowseInfoBox=s.hideBrowseInfoBox)}})),n.featureCardOptions&&(t.featureCardOptions=n.featureCardOptions))},a=e=>{const o=e[s];o&&(t.hiddenCommands=o)},l=e=>{e.includes(s)&&(t.privateBrowse=!1,t.options=-2&t.options)},c=e=>{e.includes(s)&&(t.privateBrowse=!0,t.options=1|t.options)};_?n(_,!0):w&&c(w),F?n(F):S?l(S):I&&c(I);const p=t.resourceType;if(p){const e=T&&T[p.resourceTypeName.toLowerCase()];e&&(p.apiVersion=e);const t=k&&k[p.resourceTypeName.toLowerCase()];t&&(p.apiVersion=t)}if(D&&D[s]){const o=D[s].toLowerCase();d.ArgBrowseFeatureValueToEnumMap[o]?(t.armBrowseOption=d.ArgBrowseFeatureValueToFallbackEnumMap[o],t.argBrowseOption=d.ArgBrowseFeatureValueToEnumMap[o]):d.RemappedArgBrowseFeatureValueToEnumMap[o]?(b.verbose(`Remapped arg browse option in config for asset type ${t.name} in extension ${e}: ${D[s]} to '${d.RemappedArgBrowseFeatureValueToEnumMap[o].mappedOptionString}'`),t.armBrowseOption=d.ArgBrowseFeatureValueToFallbackEnumMap[o],t.argBrowseOption=d.RemappedArgBrowseFeatureValueToEnumMap[o].mappedOption):(b.error(`Unknown arg browse option in config for asset type ${t.name} in extension ${e}: ${D[s]}, defaulting to 'Disable'`),t.armBrowseOption=0,t.argBrowseOption=4)}if(E&&E[s]){const o=E[s].toLowerCase();d.ArgBrowseFeatureValueToEnumMap[o]?(t.armBrowseOption=d.ArgBrowseFeatureValueToFallbackEnumMap[o],t.argBrowseOption=d.ArgBrowseFeatureValueToEnumMap[o]):d.RemappedArgBrowseFeatureValueToEnumMap[o]?(b.verbose(`Remapped arg browse option in config for asset type ${t.name} in extension ${e}: ${D[s]} to '${d.RemappedArgBrowseFeatureValueToEnumMap[o].mappedOptionString}'`),t.armBrowseOption=d.ArgBrowseFeatureValueToFallbackEnumMap[o],t.argBrowseOption=d.RemappedArgBrowseFeatureValueToEnumMap[o].mappedOption):(b.error(`Unknown arg browse option in URL for asset type ${t.name} in extension ${e}: ${D[s]}, defaulting to 'Disable'`),t.armBrowseOption=0,t.argBrowseOption=4)}if(B&&(t.showArgColumns=B[s]),A&&(t.showArgColumns=A[s]),N&&a(N),R&&a(R),t.browseCommandExperiments=L?.[s],t.extensibleCommandsApiVersions=O?.[s],t.variant){const e=t.variants?.find((e=>e.name.toLowerCase()===t.variant.toLowerCase()));e&&(0,o.forEachKey)(e,((e,s)=>{"name"!==e&&(t[e]=s)}))}}}})),C||P){const t=(e||"").toLowerCase()+"_";p.forEach((e=>{const s=t+(e.name||"").toLowerCase(),o=e.resourceType;void 0!==C[s]&&o&&(o.apiVersion=C[s]),void 0!==P[s]&&(e.privateBrowse=!P[s],e.options=e.privateBrowse?1|e.options:-2&e.options)}))}}const m=t.featureCards;if(m){const s=this._features.getValue(`${e}_featurecardoptions`);let o;const i=s&&JSON.parse(s.toLowerCase()),n=t.featureCardEnvironmentConfiguration;if(n){const e=n[n[l]&&l||n[c]&&c||MsPortalFx.find(Object.keys(n),(e=>c.endsWith(e)))||"*"];e&&(o=e.featureCardOptions)}(i||o)&&m.forEach((e=>{const t=e.id.toLowerCase(),s=t=>{const s=Object.create(null);t.forEach((e=>{const t=e.resourceType||e.resourcetype;"string"==typeof e.enabled&&t?s[t.toLowerCase()]=e.enabled:s[t.toLowerCase()]=!!e.enabled}));e.resourceTypes=s};if(o){const e=o[t];e&&s(e)}if(i){const e=i[t];e&&s(e)}}))}if(!n.length){return(t.redirects||[]).forEach((t=>{if(t.toExtension=t.toExtension||(3!==t.type?e:""),t.fromExtension=t.fromExtension||e,t.useFlighting=!!t.useFlighting,t.toExtension===e||t.fromExtension===e||"HubsExtension"===t.toExtension)switch(t.type){case 2:case 3:{const e=t;e.fromBlade&&(this._extensionBlockBladeRedirect&&e.toExtension.toLowerCase()===this._extensionBlockBladeRedirect||this._redirectMap.addBladeRedirect(e));break}case 4:case 5:this._redirectMap.addPartRedirect(t);break;case 6:this._redirectMap.addAssetRedirect(t)}})),!0}s||b.error(`The manifest for '${e}' has validation errors. Errors: ${JSON.stringify(n)}`),r.length&&b.error(`The manifest for '${e}' has non-fatal validation errors. Errors: ${JSON.stringify(r)}`)}};t.ManifestCache=w,t.ManifestCache=w=__decorate([__metadata("fx:diagnostics",[e,"ManifestCache"]),s.Class(),__metadata("design:paramtypes",[s.Container,v,l.ExtensionManagerOptions,r.CachedManifestClient,FxImpl.Features,c.Experimentation])],w)})),
define("MsPortalImpl/Extension/ShellPart",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isShellPart=t.shellParts=void 0,t.shellParts={ResourcePart:{viewModelName:"ResourcePartViewModel",shellModule:"MsPortalImpl/UI/UI.ResourcePart"}},t.isShellPart=function(e){const s=e.name;return"HubsExtension"===e.getExtensionName()&&!!t.shellParts[s]}})),
define("MsPortalImpl/Extension/Extension",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension.Manifest"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShellWorkerExtension=t.ExtensionFactory=t.InitializedManifestCache=void 0;var i=FxImpl.Extension,n=FxImpl.Rpc;class r{static create(e){return e.getManifests("assetTypes").then((()=>null))}}t.InitializedManifestCache=r,__decorate([__metadata("fx:diagnostics",[e,"InitializedManifestCache"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.ManifestCache]),__metadata("design:returntype",Promise)],r,"create",null);let a=class{constructor(e,t){this.createExtension=s=>{const o=t.getManifest(s.name,"assetTypes")||{};return new l(s,32&o.flags?null:e)}}};t.ExtensionFactory=a,t.ExtensionFactory=a=__decorate([__metadata("fx:diagnostics",[e,"ExtensionFactory"]),s.Class(),__metadata("design:paramtypes",[n.Client,o.ManifestCache])],a);class l{constructor(e,t){this.isLoaded=ko.observable(),this.lastError=ko.observable(),this.refCount=ko.observable(0);const{name:s,serviceTreeId:o}=e;this.name=s,this.serviceTreeId=o,this.processMessages=t?()=>i.pingEndPoint.invoke(t,s,void 0):()=>Promise.resolve(),this.waitForIdle=t?(e,o)=>FxImpl.Extension.waitForExtensionIdleEndPoint.invoke(t,s,{bladeName:e,bladeInstanceId:o}):()=>Promise.resolve(void 0),this.onStateChange=e=>{const{loadTime:t,error:s,refCount:o}=e;void 0!==t&&(this.isLoaded(!!t),t&&(this.loadTime=t)),s&&this.lastError(s),MsPortalFx.isNullOrUndefined(o)||this.refCount(o)}}}t.ShellWorkerExtension=l})),
define("MsPortalImpl/Extension/ExtensionManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/ExtensionManagerOptions","ShellWorker/ExtensionManager"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionManager=t.ExtensionManagerImpl=t.ExtensionLoader=t.ExtensionManagerOptions=void 0,Object.defineProperty(t,"ExtensionManagerOptions",{enumerable:!0,get:function(){return i.ExtensionManagerOptions}});var r=MsPortalFx.Base.Diagnostics,a=FxImpl.Rpc;const l=r.createLog(e);let c=class{constructor(e,t){this._options=e,this._rpcClient=t}startRpc(e){this._rpcClient.start({instanceIndex:0,loadChannelFunction:void 0,originId:"fx",shellChannel:new FxImpl.Rpc.RpcChannel(FxImpl.localRpcPort),windowRedirectMap:this._options.extensionRedirectMap}),n.onExtensionStateChangeEndPoint.register(this._rpcClient,"fxw",(t=>{e[t.name].onStateChange(t)}))}setRequestedBlade(e,t){n.setRequestedBladeEndPoint.invoke(this._rpcClient,"fxw",{extensionName:e,bladeName:t})}};c=__decorate([__metadata("fx:diagnostics",[e,"ExtensionLoaderImpl"]),s.Class(),__metadata("design:paramtypes",[i.ExtensionManagerOptions,a.Client])],c);class d{static create(e,t){return t}}t.ExtensionLoader=d,__decorate([__metadata("fx:diagnostics",[e,"ExtensionLoader"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.InitializedManifestCache,c]),__metadata("design:returntype",d)],d,"create",null);let p=class{constructor(e,t,s){this._options=s,this.lastExtensionError=ko.observable(),this.initializedExtensions=[],this._callbacks=$.Callbacks(),this._unloadCallbacks=$.Callbacks(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._extensionsMap=FxImpl.mapValues(s.extensionsAsMap,(t=>{const s=e.createExtension(t);return s.lastError.subscribeAndRun(this._ltm,(e=>{e&&this.lastExtensionError(s)})),s.isLoaded.subscribeAndRun(this._ltm,(e=>{e?(this.initializedExtensions.push(s),this._callbacks.fire(s.name)):(MsPortalFx.remove(this.initializedExtensions,s),this._unloadCallbacks.fire(s.name))})),s})),t.startRpc(this._extensionsMap)}getExtension(e){const t=this._options.getNormalizedMetadata(e);return t&&this._extensionsMap[t.name]}onLoad(e){const t=this.initializedExtensions.slice(0),s=t=>{try{e(t)||this._callbacks.remove(s)}catch(e){l.error("onLoad event callback has thrown an exception.",2,e)}};this._callbacks.add(s),t.forEach((t=>{e(t.name)}))}onUnload(e){const t=s=>{try{e(s)||this._unloadCallbacks.remove(t)}catch(e){l.error("onUnload event callback has thrown an exception.",3,e)}};this._unloadCallbacks.add(t)}dispose(){this._ltm.dispose()}getExtensions(){return Object.keys(this._extensionsMap).map((e=>this._extensionsMap[e]))}};t.ExtensionManagerImpl=p,t.ExtensionManagerImpl=p=__decorate([__metadata("fx:diagnostics",[e,"ExtensionManagerImpl"]),s.Class(),__metadata("design:paramtypes",[o.ExtensionFactory,d,i.ExtensionManagerOptions])],p);class u{static create(e){return e}}t.ExtensionManager=u,__decorate([__metadata("fx:diagnostics",[e,"ExtensionManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[p]),__metadata("design:returntype",u)],u,"create",null)})),
define("MsPortalImpl/Services/Services.ExtensionStorageManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionStorageManager=void 0;const i=MsPortalFx.Base.Diagnostics.createLog(e),n="LocalStorage",r=e=>{i.error(`error performing IndexedDB operation: ${e?.target?.error?.toString()}`,void 0,e?.target?.error)},a=(e,t,s)=>{const o=s?.name;"NotFoundError"!==o&&"UnknownError"!==o||(i.warning(`IDBDatabase produced ${o}, deleting unusable database`),t.close(),indexedDB.deleteDatabase(e).onerror=r)},l=(e,t)=>{const s=`ExtensionStorage${e}`,o=new Set;let l=Object.create(null);const c="localStorage"===t&&indexedDB?"localStorage":"sessionStorage";let d=!1;const p=new Promise((e=>{"sessionStorage"===c?e():((e,t)=>{const s=indexedDB.open(e,1);let o=s=>{let l;try{l=s.transaction(n,"readonly")}catch(o){i.warning(`call to IDBDatabase.transaction threw: ${o?.toString()}`,void 0,o),a(e,s,o),t(Object.create(null),!0)}if(l){l.onerror=o=>{i.debug(`call to IDBDatabase.transaction errored: ${o?.target?.error?.toString()}`,o?.target?.error),a(e,s,o?.target?.error),t(Object.create(null),!0)};const o=l.objectStore(n).getAll();o.onsuccess=()=>{const e={};for(const t of o.result){const{key:s,value:o}=t;e[s]=o}t(e)},o.onerror=r}o=MsPortalFx.noop};s.onsuccess=()=>{o(s.result)},s.onerror=e=>{i.debug(`call to indexedDB.open failed (expected for Private mode): ${e?.target?.error?.toString()}`,e?.target?.error),t(Object.create(null),!0)},s.onupgradeneeded=e=>{const t=e.target.result;t.createObjectStore(n,{keyPath:"key"}).transaction.oncomplete=()=>{o(t)}}})(s,((t,s)=>{l=t,d=s,u("init",l),e()}))})),u=(e,s,i)=>{o.forEach((o=>o({storage:t,serializedStorage:s,action:e,key:i})))},m=e=>{"localStorage"===c&&p.then((()=>{d||((e,t)=>{const s=indexedDB.open(e,1);s.onsuccess=()=>{const e=s.result.transaction(n,"readwrite");e.onerror=r;const o=e.objectStore(n);t(o).onerror=r},s.onerror=r})(s,e)}))};return{internalStorage:{setItem:(e,t)=>{l[e]=t,m((s=>s.put({key:e,value:t}))),u("set",{[e]:t},e)},removeItem:e=>{delete l[e],m((t=>t.delete(e))),u("remove",{},e)},clear:()=>{l=Object.create(null),m((e=>e.clear())),u("clear",{})},serialize:()=>l,registerChangeListener:e=>{o.add(e);return()=>{o.delete(e)}}},ready:p}};let c=class{constructor(e){this._storageByExtension=new Map,this._registeredExtensionNames=new Set(e.extensionsAsArray.map((e=>e.name)))}getStorageForExtension(e){let t=this._storageByExtension.get(e);return!t&&this._registeredExtensionNames.has(e)&&(t=function(e){const t=l(e,"sessionStorage"),s=l(e,"localStorage"),o={sessionStorage:t.internalStorage,localStorage:s.internalStorage},i={setItem:e=>{o[e.storage].setItem(e.keyName,e.keyValue)},removeItem:e=>{o[e.storage].removeItem(e.keyName)},clear:e=>{o[e.storage].clear()},registerChangeListener:e=>{const t=Object.keys(o).map((t=>o[t].registerChangeListener(e)));return()=>t.forEach((e=>{e()}))},serialize:()=>({sessionStorage:o.sessionStorage.serialize(),localStorage:o.localStorage.serialize()})};return Promise.all([t.ready,s.ready]).then((()=>i))}(e),this._storageByExtension.set(e,t)),t}};t.ExtensionStorageManager=c,t.ExtensionStorageManager=c=__decorate([__metadata("fx:diagnostics",[e,"ExtensionStorageManager"]),s.Class(),__metadata("design:paramtypes",[o.ExtensionManagerOptions])],c)})),
define("MsPortalImpl/Extension/DefinitionCache",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/ShellPart","FxHubs/RpcEndPoints","MsPortalImpl/Services/Services.ExtensionStorageManager"],(function(e,t,s,o,i,n,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.doesBladeDefinitionExist=t.DefinitionCache=t.DefinitionSource=void 0;var p=FxImpl.Extension;const u=new RegExp(`^[\\w$]*(\\${".ReactView".toLowerCase()}|\\${".MenuView".toLowerCase()})?$`);function m(e){return{commandsCatalog:MsPortalFx.convertArrayToMap(e.commandsCatalog,(e=>e.name)),commandGroups:MsPortalFx.convertArrayToMap(e.commandGroups,(e=>e.name))}}let h=class{getDefinition(e){return null}};t.DefinitionSource=h,t.DefinitionSource=h=__decorate([__metadata("fx:diagnostics",[e,"DefinitionSource"]),s.Class()],h);let g=class{constructor(e,t,s,o,i){this._diContainer=e,this._definitionSource=t,this._extensionManagerOptions=s,this._manifestCache=o,this._rpcClient=i,this._cache={},this._azCache={}}getDefinition(e){return this._getEntry(e).definition}getCommandGroup(e,t){return this._getCommandDefinitions(e,t,(e=>e.commandGroups))}getCommand(e,t){return this._getCommandDefinitions(e,t,(e=>e.commandsCatalog))}getBladeDefinition(e,t,s){const o=this._getEntry(e),i=o.definition,n=t.toLowerCase(),r=i.bladeMap[n];if(r)return Q(r);const a=o.bladeDefMap;return u.test(t?.toLowerCase())?(this._diContainer.get(d.ExtensionStorageManager).getStorageForExtension(e),t.toLowerCase().endsWith(".ReactView".toLowerCase())||t.toLowerCase().endsWith(".MenuView".toLowerCase())?Q(this._getAzBladeDefinition(t,e)):n.endsWith("_dx")?Q(a[n]||this.setDxBladeDefinition(e,t)):Q(a[n]||!s&&this.setBladeDefinition(e,t,p.getBladeDefinitionEndPoint.invoke(this._rpcClient,e,t)))):Q.reject(FxImpl.createError("Blade name is invalid identifier"))}doesBladeDefinitionExist(e,t){if(t.toLowerCase().endsWith("_dx")){let s;try{s=this._extensionManagerOptions.getNormalizedMetadata(e,!0)}catch{return Q(!1)}return o.get("MsPortalImpl/Extension/DxDefinitionCache","getDxBladeDefinition").then((o=>o(this._diContainer,this,e,t,s,!0))).then((e=>!!e))}throw new Error("Not implemented")}async setDxBladeDefinition(e,t){const s=this._extensionManagerOptions.getNormalizedMetadata(e,!0),i=o.get("MsPortalImpl/Extension/DxDefinitionCache","getDxBladeDefinition").then((o=>o(this._diContainer,this,e,t,s)));return this.setBladeDefinition(e,t,i)}setBladeDefinition(e,t,s){const o=this._getEntry(e),i=o.definition,n=t.toLowerCase(),l=o.bladeDefMap;return l[n]=s.then((t=>r.processBlade(i,this._manifestCache.getManifest(e,"assetTypes"),t,this._extensionManagerOptions.extensionRedirectMap))).then((e=>{const t=[];if(a.validateBlade(i,e,null,t),t.length)throw new Error("Invalid blade definition. Errors: "+t.join("\n"));return e})).finally((()=>{delete l[n]}))}loadPartDefinition(e,t){if("HubsExtension"===e){const e=l.shellParts[t];if(e)return Q(MsPortalFx.tryImmediateResolve(MsPortalFx.require(e.shellModule),(e=>("resourcepart"===t.toLowerCase()&&(e.partDefinition.resizeMode=2,e.partDefinition.initialSize=MsPortalFx.Parts.PartSize.Large),e.partDefinition))))}return Q(p.getPartDefinitionEndPoint.invoke(this._rpcClient,e,t))}getPartDefinition(e,t){const s=this._getEntry(e),i=s.definition,n=t.toLowerCase(),l=i.partTypeMap[n];if(l)return Q(l);if(t.toLowerCase().endsWith(".ReactTile".toLowerCase())){if(!["hubsextension","samplesextension","internalsamplesextension","microsoft_azure_playground"].includes(e.toLowerCase()))throw new Error("ReactTiles are not publicly available yet.");return Q(this._diContainer.getAsync(o.get("MsPortalImpl/AzFramework/AzExtensionCore","AzDefinitionCache"))).then((s=>s.getPartDefinition(this._getAzDefinition(e),t,e)))}const c=s.partDefMap;return c[n]||(c[n]=this.loadPartDefinition(e,t).then((t=>{t=r.processPart(i,this._manifestCache.getManifest(e,"assetTypes"),t,this._extensionManagerOptions.extensionRedirectMap);const s=[];if(a.validatePartType(t,s),s.length)throw new Error("Invalid part type definition. Errors: "+s.join("\n"));return t})).finally((()=>{delete c[n]})))}_getAzBladeDefinition(e,t){return this._diContainer.getAsync(o.get("MsPortalImpl/AzFramework/AzExtensionCore","AzDefinitionCache")).then((s=>s.getBladeDefinition(this._getAzDefinition(t),e,t)))}_getCommandDefinitions(e,t,s){if(!t)return Q();const o=this._getEntry(e);if(!o.commandDefMap){const t=o.definition;o.commandDefMap=t.commandGroups||t.commandsCatalog?Q(m(t)):Q(FxImpl.Extension.getCommandsDefinitionEndPoint.invoke(this._rpcClient,e,void 0)).then((e=>(r.processCommands(e),m(e))))}return Q(MsPortalFx.tryImmediateResolve(o.commandDefMap,(e=>s(e)[t])))}_getAzDefinition(e){return this._azCache[e]||(this._azCache[e]={name:e,bladeMap:{},partTypeMap:{}})}_getEntry(e){return this._cache[e]||(this._cache[e]={definition:this._definitionSource.getDefinition(e)||{name:e,bladeMap:{},partTypeMap:{}},bladeDefMap:{},partDefMap:{},commandDefMap:null})}};t.DefinitionCache=g,t.DefinitionCache=g=__decorate([__metadata("fx:diagnostics",[e,"DefinitionCache"]),s.Class(),__metadata("design:paramtypes",[s.Container,h,n.ExtensionManagerOptions,i.ManifestCache,FxImpl.Rpc.Client])],g),t.doesBladeDefinitionExist=o.defineHandler(c.Provisioning.doesBladeDefinitionExistEndPoint,(e=>{const t=e.messageArg;return Q(e.diContainer.get(g).doesBladeDefinitionExist(t.extensionName,t.bladeName))}))})),
define("MsPortalImpl/Extension/Extension.Definition.Locator",["require","exports","Fx/DependencyInjection","Fx/ResourceManagement","FxInternal/AsyncLoader","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/DefinitionCache","FxHubs/RpcEndPoints"],(function(e,t,s,o,i,n,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBladeDefinitionLocator=t.resourceMenu=t.hubsLocator=t.DefinitionFinder=t.DefinitionFinderImpl=t.Locator=t.LocatorContext=t.LocatorError=t.LocatorTypeMap=void 0;var p=MsPortalFx.Base.Constants,u=MsPortalFx.Base.Diagnostics;MsPortalFx.Extension.BrowseType;const m=u.createLog(e),h="Unable to locate {0} '{1}'. Search path:'{2}'.";function g(e,t){const s=[];let o=e;for(;o;)s.unshift(o.getCacheKeyPart()),o=o.parent;const i=s.join("-");return t?i:i.toLowerCase()}function f(e,t,s){return e.definitionCache.getDefinition(t.name).partTypeMap[s.toLowerCase()]}function x(e,t){let s="<InvalidJsonString>";try{s=JSON.stringify(t)}catch(e){}return m.error("{0} JSON: {1}".format(e,s)),M.forExtension("##ErrorDeserializingLocator##-{0}".format(s))}var b;!function(e){e[e.Extension=0]="Extension",e[e.Blade=1]="Blade",e[e.Lens=2]="Lens",e[e.AssetType=3]="AssetType",e[e.CommandGroup=4]="CommandGroup",e[e.PartInstance=5]="PartInstance",e[e.PartType=6]="PartType",e[e.StartboardPartInstance=7]="StartboardPartInstance",e[e.BladeActionBar=8]="BladeActionBar",e[e.Command=9]="Command",e[e.Hub=11]="Hub",e[e.CustomLen_Unused=12]="CustomLen_Unused",e[e.CommandType=13]="CommandType",e[e.BladeRedirect=14]="BladeRedirect",e[e.PartInstanceRedirect=15]="PartInstanceRedirect",e[e.PartTypeRedirect=16]="PartTypeRedirect",e[e.AssetTypeForBrowse=17]="AssetTypeForBrowse",e[e.HtmlTemplate=18]="HtmlTemplate"}(b||(t.LocatorTypeMap=b={}));class y extends MsPortalFx.Errors.Error{constructor(e,t,s,o){super({message:s,innerErrors:o}),this.source=t,this.data=e}}t.LocatorError=y;let v=class{constructor(e,t,s,o){this.extensionManager=e,this.manifestCache=t,this.definitionCache=s,this.redirectMap=o}tryLocateAssetDefinitionFromResourceId(e,t){const s=o.ArmId.parse(e,!0).resourceType,i=o.ArmId.parse(e).resourceType;return!!this.tryLocateAssetDefinitionFromResourceType(s,t)||this.tryLocateAssetDefinitionFromResourceType(i,t)}tryLocateAssetDefinitionFromResourceType(e,t){const s=e.toLowerCase(),o=this.extensionManager.getExtensions().some((e=>{const o=this.manifestCache.getManifest(e.name,"assetTypes"),i=o&&MsPortalFx.find(o.assetTypes,(e=>e.resourceType&&e.resourceType.resourceTypeName&&e.resourceType.resourceTypeName.toLowerCase()===s&&3!==e.browseType));return i&&(t.extensionName=e.name,t.value=i),!!i}));return o||(t.error="Unable to locate extension for resource type '{0}'.".format(e),t.value=null),o}};t.LocatorContext=v,t.LocatorContext=v=__decorate([__metadata("fx:diagnostics",[e,"LocatorContext"]),s.Class(),__metadata("design:paramtypes",[l.ExtensionManager,a.ManifestCache,c.DefinitionCache,a.RedirectMap])],v);class M{constructor(e,t,s,o,i,n,r){this.type=e,this.name=t,this.parent=i,this.enumerate=s,this.getValue=n,this.getValueAsync=r,this.typeDisplayName=o}static forExtension(e){return new M(0,e,void 0,"extension",void 0,(t=>t.extensionManager.getExtension(e)),null)}static fromJSON(e,t){if(!t||"object"!=typeof t)return x("Locator object is invalid.",t);const s=t.parent?M.fromJSON(e,t.parent):null,o=b[t.type],i="with{0}".format(o);if(!s&&0!==t.type)return x("Locator with name '{0}' has no parent.".format(t.name),t);let n;return 0===t.type?(n=e.resolveExtensionName(t.name),M.forExtension(n)):i in s?s[i](t.name):x("Unknown locator type: {0}.".format(o),t)}getCacheKeyPart(){return`[${this.type}]${this.name}`}getCacheFriendlyKeyPart(e="/"){return`${b[this.type]}${e}${this.name}`}withBlade(e){return new M(1,e,void 0,"blade",this,((e,t,s)=>e.definitionCache.getDefinition(t.name).bladeMap[s.toLowerCase()]),((t,s)=>t.definitionCache.getBladeDefinition(s.name,e)))}withPartInstance(e){return new M(5,e,((e,t)=>t.partInstances),"part instance",this)}tryLocate(e,t,s){const o=g(this),i={};let n=!1;if(!t.hasOwnProperty(o)&&(this.parent&&this.parent.tryLocate(e,t,i),!this.parent||i.value))if(this.getValue){const s=this.getValue(e,i.value,this.name);void 0!==s&&(t[o]=s)}else{const s=this.enumerate(e,i.value);this._fillCacheFromArray(t,s)}const r=t[o];return r?(s.value=r,n=!0):(s.error=h.format(this.typeDisplayName,this.name,this.toString()),i.error&&(s.error=i.error+"\n"+s.error)),n}locateAsync(e,t){const s={};if(this.tryLocate(e,t,s))return Promise.resolve(s.value);{let o;const i=this.parent;return o=i?i.locateAsync(e,t):Promise.resolve(),o.then((o=>{if(this.tryLocate(e,t,s))return s.value;if(this.getValueAsync)return this.getValueAsync(e,o);throw new y(this.type,this.toFriendlyString(),s.error)}),(e=>{const t=h.format(this.typeDisplayName,this.name,this.toString());throw new y(this.type,this.toFriendlyString(),t,e)})).then((e=>t[g(this)]=e))}}_fillCacheFromArray(e,t){t&&t.forEach((t=>{const s=g(new M(this.type,t.name,this.enumerate,this.typeDisplayName,this.parent,this.getValue,this.getValueAsync));e[s]=t}))}static forPartInstanceRedirect(e,t,s,o){return new M(15,(0,a.partRedirectKey)(5,e,t,s,o),void 0,"part instance redirect",void 0,(i=>{const n=i.redirectMap.getPartRedirect(5,e,t,s,o);return n.definition&&MsPortalFx.extend({name:n.key},n.definition)}))}static forPartTypeRedirect(e,t){return new M(16,(0,a.partRedirectKey)(4,e,t),void 0,"part type redirect",void 0,(s=>{const o=s.redirectMap.getPartRedirect(4,e,t);return o.definition&&MsPortalFx.extend({name:o.key},o.definition)}))}static forBladeRedirect(e,t){return new M(14,(0,a.bladeRedirectKey)(e,t),void 0,"blade redirect",void 0,(s=>{const o=s.redirectMap.getBladeRedirect(e,t);return o.definition&&MsPortalFx.extend({name:o.key},o.definition)}))}withBladeActionBar(e){return new M(8,e,((e,t)=>t.actionBar?[t.actionBar]:[]),"blade actionbar",this)}withStartboardPartInstance(e){return new M(7,e,((e,t)=>e.definitionCache.getDefinition(t.name).startBoardParts),"startboard part instance",this)}withPartType(e){return new M(6,e,void 0,"part type",this,f,((t,s)=>{if(MsPortalFx.startsWith(e,r.PinPrefix)){const o=e.slice(r.PinPrefix.length);return t.definitionCache.getBladeDefinition(s.name,o).then((()=>f(t,s,e)))}return t.definitionCache.getPartDefinition(s.name,e)}))}withLens(e){return new M(2,e,((e,t)=>t.lenses),"lens",this)}withAssetType(e){return new M(3,e,((e,t)=>e.manifestCache.getManifest(t.name,"assetTypes").assetTypes),"asset type",this)}withAssetBrowseType(e){return new M(17,e,((e,t)=>{const s=e.manifestCache.getManifest(t.name,"assetTypesBrowse");return s&&s.assetTypesBrowse}),"asset browse type",this,void 0,((t,s)=>t.manifestCache.getManifestAsync(s.name,"assetTypesBrowse").then((t=>MsPortalFx.find(t.assetTypesBrowse,(t=>e===t.name))||Promise.reject(new MsPortalFx.Errors.NotFoundDataError({dataSetName:"assetTypesBrowse"}))))))}withCommand(e){return new M(9,e,null,"command",this)}withHtmlTemplate(e){return new M(18,e,null,"html template",this,((e,t,s)=>e.definitionCache.getDefinition(t.name).htmlTemplates[s]))}getExtensionLocator(){let e=this;for(;e.parent;)e=e.parent;return e}getExtensionName(){return this.getExtensionLocator().name}toString(){return g(this,!0)}toFriendlyString(e="/"){return function(e,t){const s=[];let o=e;for(;o;)s.unshift(o.getCacheFriendlyKeyPart(t)),o=o.parent;return s.join(t)}(this,e)}equals(e){if(this.name&&e&&e.name&&this.name===e.name&&this.type===e.type){if(this.parent)return this.parent.equals(e.parent);if(!e.parent)return!0}return!1}toJSON(){return{name:this.name,type:this.type,parent:this.parent&&this.parent.toJSON()}}}t.Locator=M;class C{static populateCache(e,t,s){return e[g(t)]=s,e}constructor(e,t){this._locatorContext=e,this._cache=t||{}}locateAsync(e){return e.locateAsync(this._locatorContext,this._cache)}locate(t,s){const o={};let i=null;if(this.tryLocate(t,o))i=o.value;else{const i=s||t.getExtensionName();(0,n.logToExtension)(e,i,2,o.error)}return i}tryLocate(e,t){return e.tryLocate(this._locatorContext,this._cache,t)}}t.DefinitionFinderImpl=C;class P{static create(e){return new C(e)}}t.DefinitionFinder=P,__decorate([__metadata("fx:diagnostics",[e,"DefinitionFinder"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[v]),__metadata("design:returntype",P)],P,"create",null);const w=p.BladeNames.Hubs.ResourceMenuBlade;t.hubsLocator=M.forExtension("HubsExtension"),t.resourceMenu=t.hubsLocator.withBlade(w),t.getBladeDefinitionLocator=i.defineHandler(d.Provisioning.getBladeDefinitionLocatorEndPoint,(e=>{const t=e.messageArg;return e.diContainer.get(P).locateAsync(M.forExtension(t.extensionName).withBlade(t.bladeName)).then((e=>({...e})))}))})),
define("MsPortalImpl/ReactViews/ReactFrame.Constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reactFrameSignature=t.SESSION_STORAGE_THROTTLE=t.SESSION_STORAGE_DEVTOOLS_RECORD_CHANGE_DESCRIPTIONS_KEY=t.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE=void 0,t.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE="React::DevTools::reloadAndProfile",t.SESSION_STORAGE_DEVTOOLS_RECORD_CHANGE_DESCRIPTIONS_KEY="React::DevTools::recordChangeDescriptions",t.SESSION_STORAGE_THROTTLE="React::PerfTools::throttle",t.reactFrameSignature="Az"})),
define("MsPortalImpl/ReactViews/ReactFrame.FrameCreator",["require","exports","Fx","MsPortalImpl/ReactViews/ReactFrame.Constants"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.releaseOriginIndexForFrame=t.createReactViewFrame=void 0;var i=MsPortalFx.Base.Diagnostics,n=i.Telemetry;const r=i.createLog(e);let a=fx.environment.reactViewSameOriginEndpoints.length>0,l=!1;const c=MsPortalFx.isFeatureEnabled("skipreactorigincheck"),d=MsPortalFx.getFeatureValue("reactviewendpointindex")||"0",p="ReactViewPrewarmer",u=MsPortalFx.Errors.Error,m=new Map,h={true:fx.environment.reactFrameContentHashes[0],false:fx.environment.reactFrameContentHashes[1],bundle:fx.environment.reactFrameContentHashes[2]},g=MsPortalFx.sessionId,f=/_clientoptimizations=(true|false|bundle)/.exec(window.location.search.toLowerCase())?.[1]??fx.environment.clientOptimizations,x={l:FxImpl.Intl.effectiveLocale,preorderperf:MsPortalFx.getFeatureValue("preorderPerf"),trustedAuthority:FxImpl.trustedParentOrigin,contentHash:(b=f,h[b]),reactIndex:d,sessionId:g};var b;const y=Object.keys(x).reduce(((e,t)=>{const s=x[t];return s?e+`&${t}=${s}`:e}),"");let v=0,M=Promise.resolve();if(a&&!c){let e=0;M=fetch(P(!0)).then((t=>{e=t.status,e>=200&&e<400?l=!0:a=!1})).catch((()=>{a=!1})).finally((()=>{n.trace({source:`${p}`,action:"PrewarmOriginCheck",data:e,actionModifier:l?"complete":"failed"})}))}const C=function(e){const t=window.location.hostname,s=new URL(e).hostname;return t.toLowerCase()!==s.toLowerCase()||"localhost"===t.toLowerCase()}(P(!1));function P(e,t=0,s=0){const o=e?fx.environment.reactViewSameOriginEndpoints:fx.environment.reactViewEndpoints,i=`sandbox-${1+t}`;return`${(o.length&&o[Number(d)]||FxImpl.trustedParentOrigin).replace("{subdomain}",i)}${fx.environment.applicationPath}/React/Index?reactView=true&retryCount=${s}${y}#postParams/`}let w=2e4;t.createReactViewFrame=async function(e){const{frameContainer:t,isOnDemand:i,lifetime:c}=e;let d=a;const h=document.createElement("iframe"),g=`_react_frame_${v++}`,x=(e=>{let t=0;for(;m.has(t);)t++;return m.set(t,e),t})(g);h.setAttribute("id",g),h.classList.add("fxs-part-frame"),h.classList.add("fxs-portal-bg-txt-br"),h.setAttribute("allow","microphone *; encrypted-media *;clipboard-read;clipboard-write;"),h.setAttribute("role","presentation"),h.setAttribute("allowfullscreen","true"),h.classList.add("fxs-extension-frame");const b=e=>e.source===h.contentWindow&&e.data?.signature===o.reactFrameSignature;let y=0,I=!0;const S=[],_=(e,t)=>{S.push({event:e,value:t,timestamp:Date.now(),retryCount:y})};_("Frame Location",i?"On Demand":"Frame Pool"),_("Frame ID",g);const F=()=>{const e=d,t=P(e,x,y),s=e||C;return h.setAttribute("sandbox",s?"allow-scripts allow-popups allow-modals allow-forms allow-popups-to-escape-sandbox allow-downloads allow-presentation allow-same-origin":"allow-scripts allow-popups allow-modals allow-forms allow-popups-to-escape-sandbox allow-downloads allow-presentation"),h.src=t,t};return new Promise(((e,o)=>{let i,n;const m=()=>{"visible"===document.visibilityState&&(_("Document Visible","Delaying failure handling by 3 seconds"),window.removeEventListener("visibilitychange",m),setTimeout(C,3e3))},x=()=>{_("Network Online","Delaying failure handling by 3 seconds"),window.removeEventListener("online",x),setTimeout(C,3e3)},v=(e,t)=>{const s=setTimeout(e,t);return c.createChildLifetime().registerForDispose((()=>clearTimeout(s)))},C=()=>{const e=i();if(_("Attempt to Load ReactFrame Failed",{frameTimeout:w,elapsedTime:e,frameSrc:h.src}),"hidden"===document.visibilityState)return _("Document Hidden"),void window.addEventListener("visibilitychange",m);if(!window.navigator.onLine)return _("Network Offline"),void window.addEventListener("online",x);if(r.warning(new u({message:`Timeout occurred. FrameReady message not received within ${w} ms. Time elapsed: ${e} seconds`,source:p,data:{frameId:g,url:h.src}})),i=(0,s.startTimer)(),y++,y<4){d&&(3===y||e>=25e3||!a)&&(d=!1);const t=F();r.warning(`${g} load failed. Retry attempt ${y} with ${t}`),w=Math.min(3e4,4*w),_("Retrying",{newUri:t,newFrameTimeout:w}),n=v(C,w)}else I=!1,_("Failed to load ReactFrame"),o(new u({message:"Failed to load ReactFrame in Prewarmer after 4 attempts.",source:p,data:{frameId:g,url:h.src}})),window.removeEventListener("message",P),window.removeEventListener("visibilitychange",m),window.removeEventListener("online",x)},P=t=>{const s=t.data;if(b(t)&&0===s.kind){n.dispose();const t=i();_("Successfully loaded ReactFrame",{elapsedTime:t}),w=Math.max(Math.min(w,2*t),2e3),e({frameId:g,iframeElement:h,isFrameReactViewMessage:b,frameClientOptimizations:f}),d?l=!0:a&&!l&&(a=!1),setTimeout((()=>window.removeEventListener("message",P)),1e3),window.removeEventListener("visibilitychange",m),window.removeEventListener("online",x)}else(e=>e.source===h.contentWindow&&"ReactFrameRenderer"===e.data?.signature)(t)&&_("Iframe Script Load",{message:s.message,isSuccess:s.isSuccess})};window.addEventListener("message",P),M.then((()=>{d=a,F(),n=v(C,w),i=(0,s.startTimer)(),_("Start Time"),_("IFrame Source",h.src),h.onload=()=>{_("Frame on load")},h.onerror=e=>{_("Frame on error",{error:MsPortalFx.getLogFriendlyMessage(e)})}})),t.appendChild(h)})).finally((()=>{n.trace({source:`${p}-${g}`,action:"PrewarmEventHistory",data:S,actionModifier:I?"complete":"cancel"})}))},t.releaseOriginIndexForFrame=function(e){for(const[t,s]of Array.from(m.entries()))s===e&&m.delete(t)}})),
define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Resources/ImplScriptResources","Fx/Cryptography","Fx/UriBuilder","Fx/Experimentation","FxInternal/Authentication/TokensCommon"],(function(e,t,s,o,i,n,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.SecurityTokensManager=t.persistOrClearFeatureValueInLocalStorage=void 0;var p=MsPortalFx.Base,u=p.Net2,m=p.Constants,h=p.Diagnostics,g=h.Telemetry,f=p.Resources,x=p.Security,b=FxImpl.Security;h.LogEntryLevel;const y=window,v=h.createLog(e),M=m.Shell,C=["cloudsimpleextbearer","cacheextensionapp","internalgraphapiversion","prefetchtokensinparallel"].reduce(((e,t)=>{const s=MsPortalFx.getFeatureValue(t);return s&&(e[`feature.${t}`]=`${s}`),e}),{}),P=f.getAppRelativeUri("/api/DelegationToken"),w=f.getAppRelativeUri("/api/PortalAuthorization/GetPopToken"),I=f.getAppRelativeUri("/api/PortalAuthorization/GetThirdPartyToken"),S=b.tokenErrors,_=fx.environment.auth.portalClientId,F=fx.environment.auth.armAadResource,T={},k=S.unknown,D=S.sessionEnded,E=S.credentialsExpired,B=S.networkError,A=S.badRequest,N={[S.requiresMFA.toLowerCase()]:!0,[S.tooManyRequests.toLowerCase()]:!0,[S.missingBrokerReplyUrl.toLowerCase()]:!0,[S.deviceUncompliant.toLowerCase()]:!0,[S.passthroughUserError.toLowerCase()]:!0},R=Object.create(null);let L;try{L=JSON.parse(MsPortalImpl.sessionStorage.getItem("FallbackHardFailMap")||null)||Object.create(null)}catch{L=Object.create(null)}function O(e,t,s){g.trace({source:"Services.SecurityTokens",name:t,action:e,data:s})}let z=null;function H(e,t){e?MsPortalImpl.localStorage.setItem(t,"true"):MsPortalImpl.localStorage.removeItem(t)}t.persistOrClearFeatureValueInLocalStorage=H;let U=e=>MsPortalFx.isFeatureEnabled("msaljs")&&e.getBooleanValue("msaljsexp");function W(e){const t=e.toLowerCase();return(MsPortalFx.getFeatureValue("xmscc")+"").toLowerCase().split(",").includes(t)}function V(e){return MsPortalFx.isFeatureEnabled("cae")||e.getBooleanValue("caeexp")}function j(e,t,s){if(!U(e))return!1;z||function(e){z={};let t={};try{t=JSON.parse(e||"{}")}catch{O("MsaljsOptedOutExtensionsParseError",null,{inputString:e})}MsPortalFx.forEachKey(t,((e,t)=>{const s=e.toLowerCase();s in z||(z[s]=new Set),(t||[]).forEach((e=>{e&&z[s].add(e.toLowerCase())}))}))}(e.getStringValue("msaljsoptedoutextensions"));const o=z[t];return O("checkMsalJsEnabledForExtensionResource",null,{normalizedExtensionNameLowerCase:t,resourceNameLowerCase:s,extensionLevelOptOut:o?.has("*"),resourceLevelOptOut:o?.has(s)}),!o||!o.has("*")&&!o.has(s)}function q(e){return Promise.resolve({result:{value:{authHeader:null,expiresAt:0,expiresInMs:0,status:A,errorMessage:e},portalAuthorization:"",altPortalAuthorization:""},requestDetails:{audience:null,extensionClientId:null}})}let $=class{constructor(e,t,s,o){this._authStateManager=e,this._experimentation=t,this.saveMruTokenFunc=MsPortalFx.noop,this.sessionEndedHandler=MsPortalFx.noop,this.tokenFailedHandler=MsPortalFx.noop,this.unauthorizedTokenHandler=MsPortalFx.noop,this.tokenMfaErrorHandler=MsPortalFx.noop,this.tokenClaimsErrorHandler=MsPortalFx.noop,this.prefetchTokenThrottlingHandler=MsPortalFx.noop,this.portalAuthHandlerPromise=Promise.resolve(null),this._sessionEnded=!1,this._extensionsAuthMetadataLoadPromise=null,this._tokenHistory={},this.portalAuthHandlerPromise=this._experimentation.shellAssignments.whenAvailable().then((t=>{if(U(t)||MsPortalFx.isFeatureEnabled("msaljswithfallback")){this._extensionsAuthMetadataLoadPromise=MsPortalEarly.extensionAuthMetadataInPortalConfig;const i=t.getBooleanValue("msaljsv3");H(i,"MsalJsV3");const n="true"===MsPortalImpl.sessionStorage.getItem("MsalJsV3"),r=g.start({source:"Services.SecurityTokens",action:"msalModuleLoad",actionModifier:n?"v3":"v2"});return(n?MsPortalFx.require("MsPortalImpl/Services/PortalAuthHandlerV3"):MsPortalFx.require("MsPortalImpl/Services/PortalAuthHandlerV2")).then((t=>(g.completeTrace(r,{msalJsV3ExperimentationFlightEnabled:i}),t.MsalClientAuth.getInstance(e,s,o))))}return Promise.resolve(null)}));const i=e.bootstrapState??{},n=i.createdOn??Date.now();this._userUsedMfa=e.getCurrentUser().isMfa;const r=this._user=i.user??{};this._tenantId=r.tenantId,this._ongoingTokenRequest=Promise.resolve(void 0),this.shellTokenCache=this._createShellTokenCache(i.oAuthToken,i.selfOAuthToken,n),setInterval((()=>function(e,t){const s=Date.now(),o=[];Object.keys(e).forEach((t=>{const s=e[t];s.expiresAt<Date.now()&&(o.push(`${s.extensionName}_${s.resourceName}`),delete e[t])})),O("CleanTokenHistoryScheduledJobCompleted",M,{pageVisible:t,timeTaken:Date.now()-s,extensionTokensDeleted:o})}(this._tokenHistory,this._authStateManager.getPageVisibility())),36e5),this.getTokenFunc=async e=>{const{sshTokenData:t,resourceName:s,audience:o,tenantId:i}=e,n=window.fx.environment.consoleClientId;if(MsPortalFx.isFeatureEnabled("enableauthtelemetrycli")&&!T[s]&&(O("GetTokenFuncForAzConsoleRequestSummary",null,{resourceName:s,audience:o,azConsoleClientId:n,tenantId:i,includesSshTokenData:!!t}),T[s]=!0),t){let s=o;const i=await this._extensionsAuthMetadataLoadPromise;if(!s){s=(((i["HubsExtension".toLowerCase()]||{}).resourceAccessMap||{})[e.resourceName]||{}).resource}const{token:r,errorMessage:a}=await this.getSshCertToken({extensionClientId:n,audience:s,jwk:t.jwk,kid:t.kid});return{header:r?.header,expiresAt:r?.expiresAt,tokenType:r?.header?.split(" ")[0],errorMessage:a}}try{const t=await this.getToken({extensionName:"HubsExtension",resourceName:e.resourceName,audience:e.audience,extensionClientId:n,isBackground:!1,skipCache:!1}),s=t.token;return s?.header?{header:s.header,expiresAt:s.expiresAt,tokenType:""}:{header:"",expiresAt:null,tokenType:"",errorMessage:t.errorMessage}}catch(e){const t=e.innerErrors;return{header:"",expiresAt:null,tokenType:"",errorMessage:t.length?t[0]?.errorMessage:e.message}}},u.initialize((async e=>(await this.shellTokenCache.getToken(e)).header),(async()=>(await p.Security.getUserInfo()).armTenantDataBoundary))}isSessionEnded(){return this._sessionEnded}getDiagnosticsData(){return{user:this._user}}async getAuthorizationTokenForChallenge({currentAuthorizationHeader:e,wwwAuthHeader:t}){const s=this._tokenHistory;if(!e)return O("ClaimsChallengeAuthHeaderInvalid",null,"Received a null/empty authorization header for the initial request that resulted in a claims challenge. This is an invalid request."),Promise.resolve(null);if(!t)return O("ClaimsChallengeStringInvalid",null,"Received a null/empty claims challenge string. This is an invalid request."),Promise.resolve(null);const o=s[await(0,a.getHmacSha256UsingCryptoApi)("key1",e)],i=o?.extensionName;return o?(O("ClaimsChallengeCacheHit",i,{cachedTokenDetails:o}),this.getToken({audience:o.audience,extensionClientId:o.extensionClientId,extensionName:i,resourceName:o.resourceName,wwwAuthHeader:t,isBackground:!1,skipCache:!0})):(O("ClaimsChallengeCacheMiss",null,"Did not find a match for the current authorization header presented on the request."),Promise.resolve(null))}async getToken(e){e=e||{};const{extensionName:t,isBackground:s,isThirdPartyExtension:o,audience:i,authConfigStamp:n,extensionIsSideloaded:l,extensionClientId:c,popTokenData:d,wwwAuthHeader:p,tenantId:m,addXmsCcForExtension:h}=e,f=e.skipCache||!!p||!!m,x=!m;let{resourceName:b}=e;b=b||"";let C=t===M?"HubsExtension":t,P=b;"telemetrytoken"===b.toLowerCase()&&(C="HubsExtension",P=MsPortalFx.isFeatureEnabled("selftoken")?"self":"");const w=this.shellTokenCache;let _=1;const F=j(await this._experimentation.shellAssignments.whenAvailable(),C.toLowerCase(),P.toLowerCase()),T=this._authStateManager.tokenCache;O("IncomingTokenRequestSummary",t,{addXmsCcForExtensionValue:h,audience:i,authConfigStamp:n,extensionClientId:c,extensionIsSideloaded:l,extensionName:t,includesPopTokenData:!!d,includesWwwAuthHeader:!!p,isBackground:s,isThirdPartyExtension:o,normalizedExtensionName:C,normalizedResourceName:P,resourceName:b,skipCache:f,tenantIdOnRequest:m,isNullTokenCache:!T});const B=async()=>{if(!f){const e=T&&T[C];if(e){const s=e[P];if(s){const e=s.header,o=s.expiresAt;if(o>Date.now())return O(e?"GetCachedToken":"GetCachedErrorResponse",t,{normalizedExtensionName:C,normalizedResourceName:P,resourceName:b,cacheEntryExpirationTicks:o}),Promise.resolve({...s,token:e?{header:e,expiresAt:o}:null});this._authStateManager.clearExtensionTokens(C)}}}const o=Date.now(),n={...e,extensionName:C,resourceName:P,skipCache:f,audience:i,addXmsCcForExtension:W(t)},l=g.start({source:"Services.SecurityTokens",action:"GetTokenResult"});let d;return d=MsPortalFx.isFeatureEnabled("msaljswithfallback")?this._getTokenFromMsalJsWithFallback(n):F?this._getTokenFromMsalJs(n):this._getTokenFromServer(n),d.then((async({result:n,requestDetails:d})=>{const p=(n=n||{}).value||{};let u=p.status,h=p.errorMessage;const I=p.missingClaims,T=p.authHeader,A=n.relatedExtensionMetadata?.length?n.relatedExtensionMetadata:[{name:C,resource:P}];if(g.endTrace(l,!!T,{enableMsalJs:F,extensionName:t,normalizedExtensionName:C,resourceName:b,normalizedResourceName:P,audience:i,status:u,errorMessage:h,missingClaimsReceived:!!I,isBackground:s,pageVisible:this._authStateManager.getPageVisibility()}),u===S.tooManyRequests&&this.prefetchTokenThrottlingHandler(),T){const e=p.expiresAt,o=await(0,a.getHmacSha256UsingCryptoApi)("key1",T);if(this._tokenHistory[o]={extensionName:t,resourceName:b,expiresAt:e,extensionClientId:c,audience:i,tenantId:m},s||!MsPortalFx.isFeatureEnabled("prefetchtokens")&&!MsPortalFx.isFeatureEnabled("msaljsprefetch")||this.saveMruTokenFunc({extension:C,resource:P,audience:i}),u)v.warning(`Received malformed token with non-null 'authHeader' and 'status' values. If the token has a valid authHeader, the status must be null and vice-versa. Extension: ${t}, resource: ${b}, status: ${u}`);else{const o=Date.now();if(!(e<=o)){const t={header:p.authHeader,expiresAt:e};return x&&await this._authStateManager.updateExtensionTokens(A,t,this.portalAuthHandlerPromise,{audience:d.audience,appId:d.extensionClientId}),{token:t}}if(!(_>3))return v.warning(`Token fetch took longer than token lifetime, retrying operation. Retry attempt: ${_++}, Token expiration: ${e}, Current time: ${o}`,null,{extensionName:t,resourceName:b,normalizedExtensionName:C,normalizedResourceName:P,isBackground:s,skipCache:f}),B();v.error("Unable to get token after {0} retry attempts.".format(_)),u=k}}if(u||(u="NullTokenNullError",v.warning(`Token missing both authHeader and status. The token must contain a valid status if the authHeader could not be obtained. Setting status to "${u}". Extension: ${t}, resource: ${b}`)),!s){if(I)return this.tokenClaimsErrorHandler(t,b,I,h),{token:null,error:"MissingClaims",errorMessage:"Token request failed due to missing claims"};if(u===S.passthroughUserError&&(h=r.passthroughUserError.format(t,this._tenantId,h)),x&&N[u.toLowerCase()]){const e={header:null,expiresAt:o+6e4,error:u,errorMessage:h};this._authStateManager.updateExtensionTokens(A,e,this.portalAuthHandlerPromise,{audience:d.audience,appId:d.extensionClientId})}const s=u===E;if(u===D&&["UnauthorizedRefreshToken","AccountIdentifierMismatch"].includes(h))this.unauthorizedTokenHandler(t,b,h);else if(u===D||s){let e;if(this._sessionEnded=!0,s||!w)e=o;else{const s=t===M?b:"";e=w.getTokenExpiresAt(s)}this.sessionEndedHandler(t,e||o)}else if(u===S.requiresMFA){const e=this._userUsedMfa?r.mfaFailureUserHasMfa:r.mfaFailureUserHasNoMfa.format(y.fx.environment.links.mfa);this.tokenMfaErrorHandler(t,b,e)}else if(e.extensionIsSideloaded&&(h+=" Testing extension authorization configuration changes by sideloading is not supported. Please deploy your changes to test."),u!==S.brokerTimeout&&this.tokenFailedHandler(t,b,h),t!==M){const e="Failed to get token for {0} & {1}. Error:{2}. Message:{3}".format(t,b,u,h);u===k?v.error(e):v.verbose(e)}}return{token:null,error:u,errorMessage:h}}))};return B().then((e=>{const s=e?.token;return F&&o&&s.header?async function(e,t){const s=e.header,o=g.start({source:"Services.SecurityTokens",action:"GetThirdPartyEncryptedToken",name:t}),{encryptedToken:i}=await u.postJSON({uri:I,dataType:"json",setAuthorizationHeader:!1,headers:{authorization:s},performRetry:!1},{extensionName:t});let n;return n=i?{token:{header:i,expiresAt:e.expiresAt}}:{error:k,errorMessage:"Failed to encrypt the authorization header."},g.endTrace(o,!!n.token?.header,{isNonEmptyTokenHeader:!!s}),n}(s,t):e}))}async getPopToken(e){const{extensionName:t,scopes:s,resourceRequestMethod:o,resourceRequestUri:i,shrClaims:n,shrNonce:r}=e,a=await this.portalAuthHandlerPromise,c=g.start({source:"Services.SecurityTokens",action:"GetPopToken",name:e.extensionName});let d;if(a){const e=await MsPortalEarly.extensionAuthMetadataInPortalConfig||{};let l=e[t.toLowerCase()]?.oAuthClientId;l||(v.warning(`The extension '${t}' does not have an oAuthClientId specified when requesting a PoP token. The portal's client ID will be used to make this request.`),l=_),d=await a.acquireTokenForExtension({extensionClientId:l,scopes:s,isBackground:!1,popTokenData:{scopes:s,resourceRequestMethod:o,resourceRequestUri:i,shrClaims:n,shrNonce:r}})}else{const t=new l(w);d=(await u.postJSON({uri:t.toString(),dataType:"json",setAuthorizationHeader:!1,performRetry:!1},{extensionName:e.extensionName,portalAuthorization:this._authStateManager.bootstrapState.refreshToken,altPortalAuthorization:this._authStateManager.bootstrapState.altRefreshToken,tenant:this._tenantId,httpMethod:e.resourceRequestMethod,scopes:e.scopes,requestUri:e.resourceRequestUri,shrClaims:e.shrClaims})).value}return g.endTrace(c,!!d?.authHeader,{isMsalJsEnabled:!!a}),d}async getSshCertToken(e){const t=this._experimentation.shellAssignments;if(!U(t))return Promise.reject("The 'getSshCertToken' API was called in a portal session where msaljs was not enabled. This API is not supported here and should not be called.");const{audience:s,extensionClientId:o,jwk:i,kid:n}=e;if(!s)return Promise.reject("The audience value is null or empty.");if(!o)return Promise.reject("The extensionClientId value is null or empty.");const r=await this.portalAuthHandlerPromise,a=await r.acquireTokenForExtension({extensionClientId:o,isBackground:!1,scopes:[s+"/.default"],sshTokenData:{jwk:i,kid:n},tenantId:this._tenantId});return a.authHeader?{token:{header:a.authHeader,expiresAt:a.expiresAt}}:{token:null,error:a.status,errorMessage:a.errorMessage}}async _getTokenFromMsalJsWithFallback(e){const{extensionName:t,resourceName:s}=e,o=t.toLowerCase(),i=s.toLowerCase();if(L[o]=L[o]||Object.create(null),L[o][i])return await this._getTokenFromServer(e);const n=await this._getTokenFromMsalJs(e);return n?.result?.value?.status?(L[o][i]=!0,function(){try{const e=JSON.stringify(L);MsPortalImpl.sessionStorage.setItem("FallbackHardFailMap",e)}catch(e){g.trace({source:"Services.SecurityTokens",action:"StoreFallbackHardFailMap",actionModifier:"Failed",data:{error:MsPortalFx.getLogFriendlyMessage(e)}})}}(),await this._getTokenFromServer(e)):n}isPortalToken(e){const t=e?.toLowerCase();return!t||t===FxImpl.nonCaeArmAliasLowerCase}async _getTokenFromMsalJs(t){const{extensionName:s,resourceName:i,tenantId:n,popTokenData:a,wwwAuthHeader:c,addXmsCcForExtension:u,isThirdPartyExtension:m,isBackground:h}=t;let{audience:g,extensionClientId:f}=t;const x=(await this._extensionsAuthMetadataLoadPromise)[s.toLowerCase()];if(!f&&!x){if(!this.isPortalToken(i)){const e=`The extension '${s}' was not found in the list of extensions registered with the portal. Please follow the instructions at https://aka.ms/portalfx/extensionauth register your extension with the portal.`;return v.error(e),q(e)}{v.warning(`The extension '${s}' was not found in the list of extensions registered with the portal. The portal's ARM token will be returned by default.`);const e=this._authStateManager.tokenCache.HubsExtension,t=e&&e[""],o=t?.expiresAt>Date.now()-6e5;if(t&&o)return Promise.resolve({result:{value:{authHeader:t.header,expiresAt:t.expiresAt,expiresInMs:t.expiresAt-Date.now()},portalAuthorization:"",altPortalAuthorization:""},requestDetails:{audience:g,extensionClientId:f}});g=F,f=_}}if(f=f||x.oAuthClientId,f||(v.warning(`The extension '${s}' does not have an oAuthClientId specified. The portal's client ID will be used to make this request.`),f=_),i&&i.toLowerCase()!==FxImpl.nonCaeArmAliasLowerCase||(g=F,f=_),!g){const e=x.resourceAccessMap;if(!e)return O("EmptyAudienceInPortalConfig",s,{normalizedResourceName:i}),q(`The extension '${s}' has not defined any resource access in the portal's configuration. Please follow the instructions at https://aka.ms/portalfx/resourceaccess to fix this.`);const t=e[i.toLowerCase()];if(!t)return O("MissingResourceInPortalConfig",s,{normalizedResourceName:i}),q(`The extension '${s}' has not defined the resource access for resource '${i}' in the extension's configuration, or in the portal's configuration. Please follow the instructions at https://aka.ms/portalfx/resourceaccess to add your new resource.`);if(g=t.resource,f=t.overrideClientId||f,!g)return O("MissingAudienceInPortalConfig",s,{normalizedResourceName:i}),q(`The extension '${s}' has an invalid audience for the resource '${i}' in the extension's configuration or portal's configuration.`)}const b=(0,d.isCommonEndPointMatch)(g);if(b&&b.length){const e=g;if(g=(0,d.translateCommonEndpoint)(b[0]),!g)return q(`The extension '${s}' has an unsupported placeholder '${e}' as the audience for the resource '${i}' in the extension's configuration or portal's configuration.`)}const y=g===f;y&&(f=_),MsPortalFx.isFeatureEnabled("replaceaadgraphendpoint")&&new l(g).getAuthority()===new l(fx.internalEnv.fxGraphEndpoint).getAuthority()&&(g="https://graph.microsoftazure.us/");const M=[p.Constants.Shell.toLowerCase(),"HubsExtension".toLowerCase()].includes(s.toLowerCase());if(f===_&&!M&&!y&&!this.isPortalToken(i)){const t=await async function(e,t,s){const o=await(e?.whenAvailable()),i=o?.getStringValue("portalappidallowlist");if(!i)return!0;let n;try{n=JSON.parse(i)}catch(e){return O("ErrorParsingPortalAppIdAllowList",t,{extensionName:t,audience:s}),!0}return(n[t.toLowerCase()]||[]).some((e=>e.toLowerCase()===s.toLowerCase()))}(this._experimentation.shellAssignments,s,g),i=`The extension '${s}' does not have an oAuthClientId specified when requesting a token for audience '${g}'. To resolve this error, the extension needs to create a first-party application and enlist it with the portal.`;if(this._experimentation.shellAssignments.getBooleanValue("logmissingextensionappid")&&(0,o.logToExtension)(e,s,2,i),!t){return q(`The extension '${s}' does not have an oAuthClientId specified when requesting a token for audience '${g}'. To resolve this error, the extension needs to create a first-party application and enlist it with the portal.`)}}O("ExtensionTokenRequestSummary",s,{normalizedExtensionName:s,normalizedResourceName:i,audience:g,extensionClientId:f,isThirdPartyExtension:m});const C=[g+"/.default"];let P;if(f.toLowerCase()===_){const e=V(this._experimentation.shellAssignments)&&t.resourceName.toLowerCase()!==FxImpl.nonCaeArmAliasLowerCase||u;P=this.portalAuthHandlerPromise.then((t=>t.acquireTokenForPortal({scopes:C,isBackground:h,wwwAuthHeader:c,addXmsCcClaim:e})))}else P=this.portalAuthHandlerPromise.then((e=>e.acquireTokenForExtension({scopes:C,isBackground:h,extensionClientId:f,tenantId:n,popTokenData:a,wwwAuthHeader:c,addXmsCcClaim:u})));return P.then((e=>{if(e.status===S.missingBrokerReplyUrl){const t=r.missingBrokerReplyUrlError.format(s,f,"https://aka.ms/portalfx/msaljsreplyurl");e={...e,errorMessage:t}}return{result:{value:e,portalAuthorization:"",altPortalAuthorization:""},requestDetails:{audience:g,extensionClientId:f}}}))}_getTokenFromServer(e){if(MsPortalFx.isFeatureEnabled("paralleltokens")){const{extensionName:t,resourceName:s}=e,o=(t+"_"+s).toLowerCase();let i=R[o];return i&&!e.skipCache||(R[o]=i=this._getTokenFromController(e)),i.finally((()=>{R[o]=null}))}return this._ongoingTokenRequest=this._ongoingTokenRequest.then((()=>this._getTokenFromController(e))),this._ongoingTokenRequest}_getTokenFromController(e){const{extensionName:t,resourceName:s}=e,o=this._authStateManager.bootstrapState.refreshToken,i=this._authStateManager.bootstrapState.altRefreshToken,n=function(e,t){const s={extensionName:e.extensionName,resourceName:e.resourceName,tenant:e.tenant,portalAuthorization:e.portalAuthorization,wwwAuthHeader:e.wwwAuthHeader,authConfigStamp:e.authConfigStamp,altPortalAuthorization:e.altPortalAuthorization,sshTokenData:e.sshTokenData},o=g.start({source:"Services.SecurityTokens",action:"Get",name:e.extensionName});let i="",n="";const r=new l(P),a={...C};return(V(t)||W(e.extensionName))&&(a["feature.cae"]="true"),e.skipCache?a["feature.tokencaching"]="false":a["feature.tokencaching"]=`${MsPortalFx.isFeatureEnabled("tokencaching")}`,a["feature.replaceaadgraphendpoint"]=`${MsPortalFx.isFeatureEnabled("replaceaadgraphendpoint")}`,u.postJSON({uri:r.toString(),dataType:"json",setAuthorizationHeader:!1,performRetry:!1,headers:{"x-ms-feature-flags":JSON.stringify(a)}},s).catchError(MsPortalFx.Errors.AjaxError,(t=>{i="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(e.extensionName,e.resourceName,t?.jqXHR?.status??"",t?.textStatus??"",t?.errorThrown??"");let s="";return t?t.jqXHR?t.jqXHR.responseText||(s="response.jqXHR.responseText"):s="response.jqXHR":s="response",n=s?`${s} was undefined.`:t.jqXHR.responseText.slice(0,20),Promise.reject(t)})).finally((()=>{g.endTrace(o,!i,{error:i,resourceName:e.resourceName,skipCache:e.skipCache,errorResponseText:n})}))}({extensionName:t,tenant:this._tenantId,resourceName:s??"",portalAuthorization:o,skipCache:e.skipCache,wwwAuthHeader:e.wwwAuthHeader,authConfigStamp:e.authConfigStamp,altPortalAuthorization:i},this._experimentation.shellAssignments).catch((e=>{const t=e.data??{},s=t.status;let n;n=401===s?E:400===s?A:s?k:B;const r=e?.jqXHR?.responseJSON?.message??e.message,a=e?.stack??"";return{portalAuthorization:o,value:{authHeader:null,expiresAt:0,expiresInMs:0,refreshToken:null,status:n,errorMessage:`code: ${s}, statusText: ${t.statusText}, message: ${r}, stack: ${a}`},altPortalAuthorization:i}}));return n.then((e=>(this._authStateManager.updateRefreshToken(e.portalAuthorization||o,e.altPortalAuthorization||i),{result:e,requestDetails:{audience:null,extensionClientId:null}})))}_createShellTokenCache(e,t,s){const o=Object.create(null);if(e){const t=e.expiresInMs??1;o[""]={header:e.authHeader,expiresAt:t>0?s+t:-1}}if(t){const e=t.expiresInMs??1;o.self={header:t.authHeader,expiresAt:e>0?s+e:-1}}return x.createAuthTokenCache((e=>{let t=e?.resourceName||"";return"telemetrytoken"===t.toLowerCase()&&(t=MsPortalFx.isFeatureEnabled("selftoken")?"self":""),this._sessionEnded?Promise.resolve({error:D}):this.getToken({...e,extensionName:M,resourceName:e.resourceName,skipCache:e.skipCache}).then((e=>{const s=(e??{}).token;if(s&&["","self"].includes(t.toLowerCase())){const e=Date.now(),o=this._authStateManager.bootstrapState??{};let i,n;""===t?(i={authHeader:s.header,expiresAt:s.expiresAt,expiresInMs:s.expiresAt-e},n=o.selfOAuthToken):(i=o.oAuthToken,n={authHeader:s.header,expiresAt:s.expiresAt,expiresInMs:s.expiresAt-e});const r={...o,createdOn:e,oAuthToken:i,selfOAuthToken:n};this._authStateManager.updateBootstrapState(r,"getTokenFunc")}return e}))}),o)}};t.SecurityTokensManager=$,t.SecurityTokensManager=$=__decorate([__metadata("fx:diagnostics",[e,"SecurityTokensManager"]),s.Class(),__metadata("design:paramtypes",[i.AuthStateManager,c.Experimentation,n.WindowManager,s.Container])],$)})),
define("MsPortalImpl/Services/Services.Settings",["require","exports","Fx/DependencyInjection","FxHubs/HubsSettingsSchema","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/UI/UI.NavigationManager","FxHubs/RpcEndPoints","FxInternal/AsyncLoader","Fx"],(function(e,t,s,o,i,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readExtUserSettingsHandler=t.readBrowserStorageSettingsHandler=t.writeBrowserStorageSettingsHandler=t.writeUserSettingsHandler=t.readUserSettingsHandler=t.deleteUserSettingsHandler=t.deleteUserSettings=t.writeUserSettings=t.readUserSettings=t.flush=t.SettingsManager=t.Internal=t.queryStores=t.getDashboardStoreId=t.getDashboardStoreName=t.getAllStoreIds=t.PortalStartupMarkers=void 0;var c=MsPortalFx.Base,d=c.Net2,p=MsPortalFx.Base.Diagnostics,u=FxImpl.Base.Diagnostics;const m=fx.environment,h=fx.environment.applicationPath+"/api/Settings{0}",g=h.format("/Update"),f=h.format("/Select"),x=h.format("/Clear"),b=h.format("/ClearAll"),y=c.Diagnostics.createLog(e);c.getVersionFromString(m.version).revision=0;const v={General:0,Blade:1,Part:2,LensState:3,Startboard:4,SharedPart:5,HubsExtension:6,CrossTenant:7,Favorites:8,DashboardInventory:9,FileUpload:10,FirstVisited:12,StartupNotifications:13,ArgQueryInventory:14,Browse:15,Recents:16,Hats:18,ResourceFilters:19,TrialLanding:20,Contactability:21,TourGuide:23,Session:22,MenuFavorites:24},M=(0,l.forEachKey)(v,((e,t,s)=>{s[t]=e}),[]);(()=>{for(let e=0;e<100;e++){const t="Dashboard"+e,s=e+1e3;v[t]=s,M[s]=t}})();let C=class{};var P;t.PortalStartupMarkers=C,t.PortalStartupMarkers=C=__decorate([__metadata("fx:diagnostics",[e,"PortalStartupMarkers"]),s.Class()],C),t.getAllStoreIds=function(){return MsPortalFx.map(v,MsPortalFx.identity)},t.getDashboardStoreName=function(e){return M[e+1e3]},t.getDashboardStoreId=function(e){return v[e]},t.queryStores=function(e,t){if(!t||!t.length)return Promise.resolve(new Map);const s=t.map((t=>e.queryStore(t)),e);return Promise.all(s).then((e=>{const s=new Map;return e.forEach(((e,o)=>{s.set(t[o],e)})),s}))},function(e){const t=FxImpl.features.isEnabled("selftoken");function s(e){const t=M[e];if(!t)throw new Error(`Invalid store: ${e}`);return t}function o(e,t){const o={};return t&&t.forEach(((t,i)=>{const n="string"==typeof i?i:s(i);o[n]=t,e&&delete e[n]})),o}function i(e){const t={};var s;e.keys.forEach((s=null,function(e){this[e]=s}),t);const o=new Map;return o.set(e.store,t),o}function n(e,t){const s=MsPortalFx.merge(e,t);let o={settingsToSet:new Map,settingsToDelete:new Map};return o=s.reduce(((e,t)=>(r(e.settingsToSet,e.settingsToDelete,t.settingsToSet),r(e.settingsToDelete,e.settingsToSet,t.settingsToDelete),e)),o),[o]}function r(e,t,s){s&&s.forEach(((o,i)=>{const n="string"==typeof i?i:parseInt(i),r=s.get(n);if(e&&(e.get(n)||e.set(n,{}),a(r,e.get(n))),t){const e=t.get(n);e&&(p(r,e),MsPortalFx.isEmpty(e)&&t.delete(n))}}))}function a(e,t){(0,l.forEachKey)(e,((e,s)=>{t[e]=s}))}function p(e,t){(0,l.forEachKey)(e,(e=>{delete t[e]}))}e.createUserSettingsManager=function(e,t,s,o){return new w(new h(e,new u(m.createWithWriteDeleteBufferTimeout(t,o),s)))},e.getSettingStoreName=s,e.convertSettingQueryToDictionary=i,e.updateDictionary=r,e.updateSettingsDictionary=a,e.sanitizeSettingsDictionary=p;e.InMemorySettingsManagerImpl=class{constructor(){this._maps={}}setSettings(e){return(0,l.forEachKey)(e.settings,((e,t,s)=>{s.set(e,JSON.stringify(t))}),this._getMap(e.store)),Promise.resolve()}queryStore(e){const t=this._getMap(e),s={};return t.forEach(((e,t)=>{s[t]=JSON.parse(e)})),Promise.resolve(s)}deleteSettings(e){if(e.keys){const t=this._getMap(e.store);e.keys.forEach((e=>{t.delete(e)}))}return Promise.resolve()}clearSettings(){return Promise.resolve(this._maps={})}flushSettings(){return Promise.resolve()}dispose(){}_getMap(e){return this._maps[e]=this._maps[e]||new Map}};class u{constructor(e,t){this._baseManager=e,this._managersDictionary=new Map,this._managers=[this._baseManager],t&&t.forEach((e=>{this._managers.push(e.manager),e.stores.forEach((t=>{this._managersDictionary.set(t,e.manager)}))}))}queryStore(e,t){return this._getManager(e).queryStore(e,t)}deleteSettings(e,t){return this._getManager(e.store).deleteSettings(e,t)}setSettings(e,t){return this._getManager(e.store).setSettings(e,t)}clearSettings(){return Promise.all(this._managers.map((e=>e.clearSettings())))}flushSettings(){return this._baseManager.flushSettings()}dispose(){this._baseManager.dispose()}_getManager(e){return this._managersDictionary.get(e)||this._baseManager}}e.RoutingSettingsManager=u;e.UserSettingsManagerImpl=class{constructor(e,t){this._ajaxState=0,this._memoizedQueryStore=(0,l.memoizePromise)((e=>{const t=(0,l.startTimer)();return this._ajax(f,[e]).then((s=>{this._setAjaxState(1);const o=s?.content&&s.content[e]||{},i=t();return i>5e3&&y.warning(`\n                        Request to store '${e}' took more than 5s to complete.\n                        Request time: ${i}ms.\n                        Response size: ${s&&s.jqXHR&&s.jqXHR.responseText.length}\n                    `),o})).catch((e=>(this._setAjaxState(2,e,`queryStore(duration:${t()})`),{})))})),this._clearAllUserSettings=e.isEnabled("clearallusersettings"),this._useInMemorySettings=e.isEnabled("inmemorysettings"),t=Promise.resolve(t),this._preloadingStores=t.then((e=>(this._setAjaxState(1),e&&e.settings||{})),(e=>(MsPortalFx.Helpers.isXMLHttpRequestLike(e)&&d.isRetryable(e)||y.error(new MsPortalFx.Errors.Error({message:"Early Failed to preload stores.",innerErrors:e}),1),{}))),this._preloadingStores.then((e=>{this._preloadStores=(0,l.forEachKey)(e,((e,t,s)=>{t&&(s[e]=Promise.resolve(t))}),{}),this._preloadingStores=null}))}_ajax(e,s){return s||e!==g&&e!==f?d.ajaxExtended({uri:e,type:"POST",dataType:"json",data:s&&JSON.stringify(s),contentType:"application/json;charset=utf-8",timeout:3e4,performRetry:!0,maxRetryDuration:3e4,setAuthorizationHeader:!t||{resourceName:"self"},headers:{"x-ms-feature-flags":JSON.stringify(MsPortalEarly.earlyBaseFeatureFlags)}}).catchError(MsPortalFx.Errors.AjaxError,(t=>(400===t.jqXHR?.status?y.error(`Setting _ajax 400 occurred. uri: ${e}, data: ${MsPortalFx.getObjectDescriptor(s,!0)}.`):t.jqXHR?.status>=500&&y.error(`Setting _ajax 5xx occurred. uri: ${e}, response: ${t.jqXHR.responseText}.`),Promise.reject(t)))):Promise.reject(FxImpl.createError(`Invalid setting ajax call uri: ${e}, data: ${MsPortalFx.getObjectDescriptor(s)}`))}_setAjaxState(e,t,s){if(e>this._ajaxState&&(this._ajaxState=e,2===e)){(t&&t.data&&0===t.data.status?y.warning:y.error).bind(y)(new MsPortalFx.Errors.Error({message:`${s} Setting is transitioned into HasFailRequests state. All further querystore/updatesetting will be in-memory mode.`,innerErrors:t}))}}queryStore(e,t){const o="string"==typeof e?e:s(e);return this._ajaxState>=2?Promise.resolve({}):(t&&this._memoizedQueryStore.delete(o),this._preloadingStores?this._preloadingStores.then((e=>e[o]||this._memoizedQueryStore(o))):this._preloadStores[o]||this._memoizedQueryStore(o))}clearSettings(){(0,l.forEachKey)(this._preloadStores,(e=>{delete this._preloadStores[e]})),this._memoizedQueryStore.clear();const e=(0,l.startTimer)();return this._ajax(this._clearAllUserSettings?b:x).catch((t=>{this._setAjaxState(2,t,`clearSetting(duration:${e()}):`)}))}updateSettings(e){if(!this._useInMemorySettings&&1===this._ajaxState){const t={save:o(this._preloadStores,e.settingsToSet),remove:o(this._preloadStores,e.settingsToDelete)};if(t.save||t.remove){const e=(0,l.startTimer)();return this._ajax(g,t).catch((t=>(this._setAjaxState(2,t,`updateSettings(duration:${e()}):`),Promise.reject(t))))}}return Promise.resolve()}};class m{constructor(e,t,s,o){this._primitiveSettingsManager=e,this._sequencer=t(n,(e=>this._executeMethod(e[0])),s,!0,{optionalDataInterval:o})}static createWithWriteDeleteBufferTimeout(e,t,s){return new m(e,((e,t,s,o,i)=>new c.Debouncer(e,t,s,o,i)),t||5e3,s||3e5)}queryStore(e,t){return this._primitiveSettingsManager.queryStore(e,t)}setSettings(e,t){return MsPortalFx.isEmpty(e.settings)?Promise.resolve():new Promise(((s,o)=>{const i=new Map;i.set(e.store,e.settings),this._sequencer.execute([{settingsToSet:i,settingsToDelete:null}],1===t,s,o)}))}deleteSettings(e,t){return e.keys&&e.keys.length?new Promise(((s,o)=>{this._sequencer.execute([{settingsToSet:null,settingsToDelete:i(e)}],1===t,s,o)})):Promise.resolve()}flushSettings(){return this._sequencer.flush()}clearSettings(){const e=Promise.withResolvers();return this.flushSettings().finally((()=>{this._primitiveSettingsManager.clearSettings().finally((()=>{e.resolve()}))})),e.promise}dispose(){this.flushSettings()}_executeMethod(e){return this._primitiveSettingsManager.updateSettings(e)}}e.SequencingSettingsManager=m;class h{constructor(e,t){this._cache=new Map,this._activeUpdatePromises=new Map,this._uniqueId=1,this._memoizedQueryPromises=(0,l.memoizePromise)((e=>{const t=this._verifySettings()?this._baseManager.queryStore(e):Promise.resolve({});return MsPortalFx.tryImmediateResolve(t,(t=>this._updateCaches(e,t)))})),this._useInMemorySettings=e.isEnabled("inmemorysettings"),this._baseManager=t}queryStore(e,t){return t?(this._memoizedQueryPromises.delete(e),this._baseManager.queryStore(e,t).then((t=>this._updateCaches(e,t)))):this._memoizedQueryPromises(e)}setSettings(e,t,s){return new Promise(((o,i)=>{this._execute(this._setSettingsInternal,e,t,o,i,s)}))}dispose(){this._baseManager.dispose()}_setSettingsInternal(e,t,s,o,i,n){const r=this._writeSettingsToCache(e,!0),a=()=>this._baseManager.setSettings(r,t).then(o).catch(i);n?(a(),this._resolveSetPromise(s)):this._executeIfBaseManagerCallIsAllowed(a,s)}_resolveSetPromise(e){const t=this._activeUpdatePromises.get(e);t&&(t.resolve(),this._activeUpdatePromises.delete(e))}_execute(e,t,s,o,i,n){const r=this._uniqueId++;if(this._activeUpdatePromises.set(r,Promise.withResolvers()),t){const a=t.store,l=()=>{e.call(this,t,s,r,o,i,n)};this._cache.get(a)?l():this.queryStore(a).then(l)}}deleteSettings(e,t){return new Promise(((s,o)=>{this._execute(this._deleteSettingsInternal,e,t,s,o)}))}_deleteSettingsInternal(e,t,s,o,i){this._deleteSettingsFromCache(e),this._executeIfBaseManagerCallIsAllowed((()=>{this._baseManager.deleteSettings(e,t).then(o).catch(i)}),s)}clearSettings(){const e=Promise.withResolvers();return this.flushSettings().finally((()=>this._baseManager.clearSettings().finally((()=>{this._cache=new Map,this._memoizedQueryPromises.clear(),e.resolve()})))),e.promise}flushSettings(){const e=[];return this._activeUpdatePromises.forEach((t=>e.push(t.promise))),Promise.all(e).then((()=>this._baseManager.flushSettings()))}_updateCaches(e,t){return this._writeSettingsToCache({store:e,settings:t}),this._cache.get(e)}_verifySettings(){return!this._useInMemorySettings}_executeIfBaseManagerCallIsAllowed(e,t){e(),this._resolveSetPromise(t)}_deleteSettingsFromCache(e){const t=this._cache.get(e.store);e.keys&&t&&e.keys.forEach((e=>{delete t[e]}))}_writeSettingsToCache(e,t){const s=e.store;if(e){this._cache.has(s)||this._cache.set(s,{});const o=this._cache.get(s),i={};return(0,l.forEachKey)(e.settings,((e,s)=>{(!t||o[e]!==s&&JSON.stringify(o[e])!==JSON.stringify(s))&&(o[e]=i[e]=s)})),{store:s,settings:i}}return null}}e.CachingSettingsManagerImpl=h}(P||(t.Internal=P={}));class w{constructor(e){this._baseManager=e}deleteSettings(e,t){return this._baseManager.deleteSettings(e,t)}clearSettings(){return this._baseManager.clearSettings()}flushSettings(){return this._baseManager.flushSettings()}dispose(){this._baseManager.dispose()}async queryStore(e,t,s){const o=await this._baseManager.queryStore(e,t);return s?o:I(o)}querySettings(e,t){return e.keys&&e.keys.length>0?this.queryStore(e.store,t,!0).then((t=>{const s={};if(t){e.keys.filter((e=>e in t)).forEach((e=>{s[e]=t[e]}))}return I(s)})):this.queryStore(e.store,t)}querySetting(e,t,s){return this.querySettings({store:e,keys:[t]},s).then((e=>{if(e){const s=e[t];return void 0===s?null:s}return null}))}setSettings(e,t){return this._baseManager.setSettings(I(e),t)}setSetting(e,t,s,o){return this.setSettings(function(e,t,s){const o={};return o[t]=s,{store:e,settings:o}}(e,t,s),o)}readSettingsRpc(e,t){const s=e,i=MsPortalFx.find(e,(e=>!o.allowedUserSettingsKeys.includes(e)));if(i)throw p.createIgnoreUnhandledRejectionError(`${t.srcWindowId} is not allowed to read the user setting ${i}.`);return _(this,s).then((e=>{const t={};return Object.getOwnPropertyNames(e).forEach((s=>{t[s]=e[s]})),t}))}static create(e,t,s){const o={manager:new P.InMemorySettingsManagerImpl,stores:[11]},i=e.isEnabled("day0settings"),n=P.createUserSettingsManager(e,new P.UserSettingsManagerImpl(e,!i&&MsPortalEarly.preload),[o]);return t.unloadCallbacks.push((()=>S(n))),i?n.clearSettings().then((()=>{const e=new c.UriBuilder(t.location.href);return e.query.removeParameters(["day0settings","feature.day0settings"]),t.redirect({uri:e.toString(),skipFlushBuffers:!0,reason:"useDayZeroSettings"}),Promise.withResolvers().promise})):n}}function I(e){return JSON.parse(JSON.stringify(e))}function S(e){const t=[e?e.flushSettings():Promise.resolve(),p.Telemetry.flush(),p.Upload.flush(),u.Metric.flush()];return Promise.all(t)}function _(e,t,s){const o={store:MsPortalFx.isNullOrUndefined(s)?6:s,keys:t};return e.querySettings(o).then((e=>t.length?MsPortalFx.convertArrayToMap(t,MsPortalFx.identity,(t=>e[t])):e))}function F(e,t,s,o){const i={store:o||6,settings:t};e.setSettings(i,s)}function T(e,t,s){const o={store:s||6,keys:t};e.deleteSettings(o)}t.SettingsManager=w,__decorate([__metadata("fx:diagnostics",[e,"SettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[FxImpl.Features,n.WindowManager,i.SecurityTokensManager]),__metadata("design:returntype",Object)],w,"create",null),t.flush=S,t.readUserSettings=_,t.writeUserSettings=F,t.deleteUserSettings=T,t.deleteUserSettingsHandler=(0,a.defineHandler)(o.deleteHubsUserSettings,(e=>T(e.diContainer.get(w),e.messageArg.settingsKeys,e.messageArg.settingStore))),t.readUserSettingsHandler=(0,a.defineHandler)(o.readHubsUserSettings,(e=>_(e.diContainer.get(w),e.messageArg.settingsKeys,e.messageArg.settingStore))),t.writeUserSettingsHandler=(0,a.defineHandler)(o.writeHubsUserSettings,(e=>F(e.diContainer.get(w),e.messageArg.settings,e.messageArg.priority,e.messageArg.settingStore)));const k=[];k[1]="hideBrowseInfo",t.writeBrowserStorageSettingsHandler=(0,a.defineHandler)(r.BrowserStorageSettings.writeBrowserStorageSettingsEndpoint,(e=>{const t=e.messageArg;if(0!==t.storageType)return Promise.reject("Access outside of local storage is denied.");let s=!1;return(0,l.forEachKey)(t.storageSettings,((e,t)=>{k[e]||(s=!0)})),s?Promise.reject("Certain keys in the list are not allowed to be accessed."):((0,l.forEachKey)(t.storageSettings,((e,t)=>{"string"===MsPortalFx.getTypeOf(t)&&MsPortalImpl.localStorage.setItem(k[e],t)})),Promise.resolve(null))})),t.readBrowserStorageSettingsHandler=(0,a.defineHandler)(r.BrowserStorageSettings.readBrowserStorageSettingsEndpoint,(e=>{const t=e.messageArg;if(0!==t.storageType)return Promise.reject("Access outside of local storage is denied.");const s={};let o=!1;return t.storageKeys.forEach((e=>{k[e]||(o=!0),s[e]=MsPortalImpl.localStorage.getItem(k[e])})),o?Promise.reject("Certain keys in the list are not allowed to be accessed."):Promise.resolve(s)})),t.readExtUserSettingsHandler=(0,a.defineHandler)(FxImpl.Azure.ResourceManager.readUserSettingsEndPoint,(e=>e.diContainer.get(w).readSettingsRpc(e.messageArg,e.messageContext)))})),
define("MsPortalImpl/Services/Services.SettingsProcessor",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=t.SettingsProcessor=void 0;t.SettingsProcessor=class{constructor(e,t,s){this.value=e,this.flush=t||(()=>Promise.resolve()),this.dispose=s||(()=>{})}},t.create=async function(e,t,s,o,i){const n=new FxImpl.TriggerableLifetimeManager,r={},a=Object.keys(s);a.forEach((e=>{r[e]=0,s[e].subscribe(n,(s=>{1!==r[e]&&(r[e]=3,void 0===s?t.deleteSettings({store:o,keys:[e]}):t.setSetting(o,e,s),i&&t.flushSettings())}))}));const l=await t.queryStore(o)||{};return a.forEach((e=>{const t=l[e];void 0!==t&&0===r[e]&&(r[e]=1,s[e](t),r[e]=2)})),new e(s,(()=>t.flushSettings()),(()=>n.dispose()))}})),
define("MsPortalImpl/Services/Services.GeneralSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor","FxHubs/HubsSettingsSchema","FxInternal/AsyncLoader"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringifyDefaultMenuCollapseState=t.setCurrentDeepLink=t.getCurrentDeepLink=t.writeBrowsePreviewOptInFlagHandler=t.GeneralSettings=t.GeneralSettingsManager=t.effectiveMenuBehaviorSetting=t.getMenuBehaviorSettingFromSettings=t.isSideBarDocked=t.isLandingPageDashboard=void 0;function a(e){switch(e){case 3:case 1:default:return 3;case 2:case 0:return 2}}t.isLandingPageDashboard=function(e){const t=e.get(FxImpl.Features),s=e.get(c).landingPage();return!t.isEnabled("azurehome")||2===s||4===s},t.isSideBarDocked=function(e){const t=e.get(FxImpl.Features),s=e.get(c).sideBarLayout();return!t.isEnabled("sidebarhamburgermode")||2===s||4===s},t.getMenuBehaviorSettingFromSettings=function(e){let t;return t=e instanceof c?e:e.get(c),a(t.defaultMenuCollapseState())},t.effectiveMenuBehaviorSetting=a;class l extends i.SettingsProcessor{constructor(e,t,s){super(e,t,s)}static create(e,t){const s=new c;return t.registerObjectFactory(FxImpl.Constants.RpcMethods.getSettings,{allowedOrigin:null,allowRemoteChanges:!1,handler:()=>MsPortalFx.clone(s,!1)}),i.create(l,e,s,0)}}t.GeneralSettingsManager=l,__decorate([__metadata("fx:diagnostics",[e,"GeneralSettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.SettingsManager,FxImpl.Rpc.Client]),__metadata("design:returntype",Promise)],l,"create",null);class c{constructor(){this.rawLocale=ko.observable(""),this["fxs-theme"]=ko.observable(),this.npsTimeMs=ko.observable(0),this.sideBarCollapsedKey=ko.observable(!1),this.notificationToastEnabledKey=ko.observable(!0),this.notificationTeachingBubbleEnabledKey=ko.observable(!0),this.whatsNewEnabledKey=ko.observable(!0),this.sideBarBrowseDisplayModeKey=ko.observable(0),this.whatsNewVersion=ko.observable(0),this.userConsentForNpsContact=ko.observable(!1),this.mfaNotificationLastSeen=ko.observable(0),this.highContrastKey=ko.observable(0),this.idleTimeoutMins=ko.observable(0),this.dblClickThemeEnabledKey=ko.observable(!0),this.searchHistory=ko.observable(""),this.landingPage=ko.observable(MsPortalFx.isFeatureEnabled("landalltohome")?3:4),this.devSatTimeMs=ko.observable(0),this.TestExtensions=ko.observable(),this.TestPatches=ko.observable(),this.sideBarLayout=ko.observable(MsPortalFx.isFeatureEnabled("sidebarhamburgermode")?3:4),this.defaultMenuCollapseState=ko.observable(!0===window?.fx?.environment?.chrome?.defaultSettingForMenuGroupsAsExpanded?0:1),this.showAzHome=ko.observable(!1)}static create(e){return e.value}}t.GeneralSettings=c,__decorate([__metadata("fx:diagnostics",[e,"GeneralSettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[l]),__metadata("design:returntype",c)],c,"create",null),t.writeBrowsePreviewOptInFlagHandler=(0,r.defineHandler)(n.writeBrowsePreviewOptInFlagEndpoint,(e=>{const s=e.messageArg;if((s.assetIds||[]).length){const i=e.diContainer.get(o.SettingsManager);i.querySetting(15,"argBrowsePreference").then((e=>{e=e||{},s.assetIds.forEach((t=>{e[t.toLowerCase()]=s.value})),i.setSetting(15,"argBrowsePreference",e);const o=(0,t.getCurrentDeepLink)().toLowerCase();if(!s.preventAutoBladeLaunch&&(o.startsWith("#blade/HubsExtension/BrowseResource/resourceType/".toLowerCase())||o.startsWith("#blade/HubsExtension/BrowseResourceBlade/resourceType/".toLowerCase())||o.startsWith("#view/HubsExtension/BrowseResource/resourceType/".toLowerCase())||o.startsWith("#view/HubsExtension/BrowseResourceBlade/resourceType/".toLowerCase()))){const e=encodeURIComponent(s.resourceType);let o=s.value?"#view/HubsExtension/BrowseResource/resourceType/"+e:"#view/HubsExtension/BrowseResourceBlade/resourceType/"+e;s.kind&&(o=o+"/kind/"+encodeURIComponent(s.kind)),(0,t.setCurrentDeepLink)(o)}}))}}));t.getCurrentDeepLink=()=>window.location.hash||"";t.setCurrentDeepLink=e=>{window.location.hash=e},t.stringifyDefaultMenuCollapseState=function(e){switch(e){case 1:return"InitAsCollapsed";case 3:return"Collapsed";case 0:return"InitAsExpanded";case 2:return"Expanded";default:return""}}})),
define("_generated/Less/MsPortalImpl/Themes/Themes.Reset.css",["module"],(function(e){"use strict";return{css:'.fxs-display-none{display:none!important}.fxs-hide-accessible-label{overflow:hidden;position:absolute;top:-1000px;left:-1000px;width:0;height:0}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{font-size:100%;font-weight:inherit}html{-webkit-text-size-adjust:100%;text-size-adjust:100%}html,body{height:100%}body{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;margin:0;padding:0;overflow:hidden}button,input,select,textarea{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;border-radius:0}input::-ms-clear{display:none}button,[type="button"],[type="reset"],[type="submit"]{font-size:13px;line-height:1.385;background:none;color:inherit}img{overflow:hidden;max-height:100%;max-width:100%}textarea{overflow:auto}img,a img,:link img,:visited img{border:0}a[href]{-webkit-touch-callout:default}a[href]:not([tabindex="-1"]):focus,area[href]:not([tabindex="-1"]):focus,input:not([disabled]):not([tabindex="-1"]):focus,select:not([disabled]):not([tabindex="-1"]):focus,textarea:not([disabled]):not([tabindex="-1"]):focus,button:not([disabled]):not([tabindex="-1"]):focus,iframe:not([tabindex="-1"]):focus,[contentEditable="true"]:not([tabindex="-1"]):focus{outline-offset:-1px}[tabindex="0"]:focus{outline-offset:-1px}tbody tr[tabindex]:not([tabindex="-1"]):focus{box-shadow:none}a{text-decoration:none}b,strong{font-weight:700}pre,code{font-family:Consolas,"Courier New",monospace;font-size:13px}legend,fieldset{border:0;margin:0;padding:0}hr{border-width:0;border-top-width:1px;border-top-style:solid}[role="button"],[role="link"],.fxs-fxclick{cursor:pointer}a[href]:hover,[role="link"].fxs-fxclick:hover{text-decoration:underline}::placeholder{opacity:1}@supports(outline-offset:-1px){:focus{outline-width:1px;outline-style:solid}}@supports(-webkit-touch-callout:none){*{-webkit-touch-callout:none}}svg{overflow:hidden}',moduleId:e.id}})),
define("MsPortalImpl/Base/Themes",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.GeneralSettings","FxInternal/Css","_generated/Less/MsPortalImpl/Themes/Themes.Reset.css","Fx/Experimentation"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeManager=t.noHCThemesFlag=void 0,(0,n.injectCss)(r);var l=MsPortalFx.Base,c=l.Resources,d=l.Diagnostics.Telemetry.trace;const p=window,u="fxs-theme",m=`${u}-`,h="fxs-mode-standardcontrast ext-mode-standardcontrast",g="fxs-mode-highcontrast ext-mode-highcontrast",f="fxs-highcontrast-dark ext-highcontrast-dark",x="fxs-highcontrast-light ext-highcontrast-light",b=o.Themes.Names,y="_generated/Less/MsPortalImpl/Themes/Theme2.Colors.{0}.css",v=window.fx.environment;t.noHCThemesFlag="nohc";const M="dark",C="azure",P={name:"HighContrastMode",mode:1},w={name:"HighContrastMode",mode:0},I="#f1f1f8",S="#333",_="Theme_Light.png",F="Theme_Dark.png",T=l.Images.Themes.System(),k=l.Images.Themes.Azure();function D(e,t,s,o,i,n){return{colorCode:e,imageUri:c.getContentUri("Content/Images/MsPortalImpl/Themes/"+t),svg:s,name:o,title:i,mode:n}}const E=D(I,_,T,C,b.system,0),B=D(S,F,T,M,b.system,1),A=e=>e?B:E;function N(e,t,s){d({source:e,action:t,data:s})}class R{constructor(e,t){this._lifetime=new FxImpl.TriggerableLifetimeManager,this._brandingDefaultTheme=v.chrome.defaultTheme;const s=t[u]||ko.observable(null),o=t.highContrastKey,i=L.getThemesFlag(),n=()=>D("#0078d4","Theme_Azure.png",k,C,b.azure,0),r=n(),a=D("#215b7d","Theme_Blue.png",l.Images.Themes.Blue(),"blue",b.blue,0),c=D(S,F,l.Images.Themes.Dark(),M,b.dark,1),d=D(I,_,l.Images.Themes.Light(),"light",b.light,0),y=n();if(this._legacyThemes=[r,a,d,c],i){const e=(e,t,s)=>{t=t||{},(e=e||n()).colorCode=t.colorCode,e.imageUri=t.imageUri,e.name=t.name,s&&(e.svg=t.svg)};switch(this._brandingDefaultTheme){case"blue":e(y,a,!0);break;case"light":e(y,d,!0)}y.title=b.light,e(E,y);const t=window.matchMedia("(prefers-color-scheme: dark)"),i=t.matches;this._themes=[A(i),y,c];const r=e=>{const t=e.matches,o=A(t);this._themes[0]=o,b.system===s()?.title&&s(o),this.updateThemesCallback?.()};t.addEventListener("change",r),this._lifetime.registerForDispose((()=>{t.removeEventListener("change",r)}));const l=o();if(o(0),0!==l){let e=y;2===l&&(e=c),s(e)}}else this._themes=this._legacyThemes;let T,B;i&&(T=b.system===s()?.title?this._themes[0]:MsPortalFx.find(this._themes.slice(1),(e=>e.name===s()?.name))),MsPortalFx.isNullOrUndefined(T)&&(T=MsPortalFx.find(this._legacyThemes,(e=>e.name===(s()||this.getDefaultTheme()).name))),MsPortalFx.isNullOrUndefined(T)&&(T=a),this.currentTheme=s,s(T),this.highContrastMode=o,ko.reactor(this._lifetime,[s,o],((t,s)=>{t=t||this._themes[0];const o=0!==s,n=2===s,r=1===s;o&&(t=n?c:i?y:d);const a=this._injectStyles(t),l=n?this._injectStyles(P):r?this._injectStyles(w):Promise.resolve({});Promise.all([l,a]).then((()=>{const s=t.mode?"fxs-mode-dark ext-mode-dark":"fxs-mode-light ext-mode-light";e.removeClass(B).addClass(B=m+t.name+" "+s).toggleClass(h,!o).toggleClass(g,o).toggleClass(f,n).toggleClass(x,r)}))})),s.subscribe(this._lifetime,(()=>{N("Shell","SelectedTheme",s().name)})),o.subscribe(this._lifetime,(e=>{N("Shell","SelectedHighContrastMode",o())}));const R=p.matchMedia("(forced-colors: active) and (prefers-color-scheme: light)"),O=p.matchMedia("(forced-colors: active) and (prefers-color-scheme: dark)"),z=[R,O],H=()=>{R.matches?o(1):O.matches?o(2):o(0)};z.forEach((e=>e.addEventListener("change",H))),p.matchMedia("(forced-colors: active)").matches&&H(),this._lifetime.registerForDispose((()=>{e.removeClass(`${B} ${h} ${g} ${f} ${x}`),z.forEach((e=>e.removeEventListener("change",H)))}))}getThemes(){return this._themes}getDefaultTheme(){if(this._brandingDefaultTheme){const e=this._legacyThemes.filter((e=>e.name===this._brandingDefaultTheme));if(e&&e.length>0)return e[0]}return this._legacyThemes[1]}getCurrentThemeColorCssModuleId(){if(1===this.highContrastMode())return y.format("HighContrastMode.LightMode");if(2===this.highContrastMode())return y.format("HighContrastMode.DarkMode");switch(this.currentTheme().name){case C:return y.format("Azure");case"blue":return y.format("Blue");case"light":return y.format("Light");case M:return y.format("Dark")}}_injectStyles(t){const s=t.name,o=t.mode,i=s.charAt(0).toUpperCase()+s.slice(1),r=o?"DarkMode":"LightMode";let a;return a="HighContrastMode"===i?["_generated/Less/MsPortalImpl/Themes/Theme2.{0}.css".format(i),y.format(i+"."+r)]:["_generated/Less/MsPortalImpl/Themes/Theme2.css",y.format(i)],Promise.all(a.map((t=>MsPortalFx.require(t,e)))).then((e=>(0,n.injectCss)(...e)))}dispose(){this._lifetime.dispose()}}class L{static createManager(e){return new R($([window.document.body,window.document.head]),e)}}t.ThemeManager=L,L.getThemesFlag=()=>s.container.get(a.Experimentation).shellAssignments.getBooleanValue(t.noHCThemesFlag),__decorate([__metadata("fx:diagnostics",[e,"ThemeManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.GeneralSettings]),__metadata("design:returntype",L)],L,"createManager",null)})),
define("MsPortalImpl/Base/Base.Events",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";function o(e){return e._handle}Object.defineProperty(t,"__esModule",{value:!0}),t.PortalCustomEvents=t.CustomEvents=t.getOrCreateFxElement=t.unwrapFxElement=t.requestFullscreen=t.exitFullscreen=t.isFullscreen=t.fullscreen=t.fxpinmultipleparts=void 0,t.fxpinmultipleparts="fxpinmultipleparts",t.fullscreen="fullscreenchange MSFullscreenChange mozfullscreenchange webkitfullscreenchange",t.isFullscreen=function(){const e=document;return!!(e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement)},t.exitFullscreen=function(){const e=document,t=e.exitFullscreen||e.webkitExitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen;t&&t.call(e)},t.requestFullscreen=function(){const e=document.documentElement,t=e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen;t&&t.call(e)},t.unwrapFxElement=o,t.getOrCreateFxElement=function(e,t){let s=MsPortalFx.find(t(),(t=>o(t)===e));return s||(s={_handle:e},t.push(s)),s};class i{constructor(){this._events=new Map}setElement(e){this._element=e,this._events.forEach(((e,t)=>{e.forEach((e=>{this._setEvent(t,e)}))}))}_setEvent(e,t){if(t.ltm){if(t.ltm.isDisposed&&t.ltm.isDisposed())return;t.ltm.registerForDispose([this._element.setEvents([e,t.callback])])}else this._element.setEvents([e,t.callback])}trigger(e,t){if(!this._element)return;const s=$.Event(e);return s.type=e,s.target=this._element[0],this._element.trigger(s,t),s.isDefaultPrevented()}addHandler(e,t,s){this._events.has(t)||this._events.set(t,[]);const o={ltm:e,callback:s};this._events.get(t).push(o),this._element&&this._setEvent(t,o)}removeHandler(e,t){if(!this._events.has(e))return;const s=this._events.get(e);s.filter((e=>e.callback===t)).forEach((e=>{MsPortalFx.remove(s,e)}))}}t.CustomEvents=i;let n=class extends i{};t.PortalCustomEvents=n,t.PortalCustomEvents=n=__decorate([__metadata("fx:diagnostics",[e,"PortalCustomEvents"]),s.Class()],n)})),
define("MsPortalImpl/Services/Clarity",["require","exports","MsPortalImpl/Base/Base.Events","Fx/DependencyInjection","Fx/Telemetry"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClarityManager=t.isClarityEnabled=void 0;const n=window,r=n.fx.environment;async function a(){const e=MsPortalEarly.query.clientoptimizations||MsPortalEarly.query.trace||MsPortalEarly.query.healthCheck||MsPortalFx.isFeatureEnabled("canmodifyextensions")||MsPortalFx.isFeatureEnabled("canaddgallerypackages")||MsPortalFx.isFeatureEnabled("canmodifystamps")||MsPortalFx.isFeatureEnabled("disableextensions")||MsPortalFx.isFeatureEnabled("prefetch")||MsPortalFx.isFeatureEnabled("ci");try{if(MsPortalFx.isFeatureEnabled("clarity")&&!e){const e=await MsPortalFx.Base.Security.getUserInfo();return"EU"!==e.dataBoundary}}catch(e){i.trace({source:"Shell",action:"ClarityEnablementCheck",data:{error:e}})}return Promise.resolve(!1)}t.isClarityEnabled=a;let l=class{constructor(e){this._lifetime=new FxImpl.TriggerableLifetimeManager,e.addHandler(this._lifetime,"fxdeeplinkchanged",(async()=>{await a()&&n.clarity&&c()}))}async initialize(){if(await a()&&r?.clarity?.projectId){const e=document.createElement("script"),t=`(function(c,l,a,r,i,t,y){\n                                    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};\n                                    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;\n                                    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);\n                                   })(window, document, "clarity", "script", "${r.clarity.projectId}");`;e.append(t),document.head.appendChild(e),c()}}};function c(){n.clarity("identify","azureportal",MsPortalFx.sessionId,encodeURIComponent(location.hash))}t.ClarityManager=l,t.ClarityManager=l=__decorate([__metadata("fx:diagnostics",[e,"ClarityManager"]),o.Class(),__metadata("design:paramtypes",[s.PortalCustomEvents])],l)})),
define("MsPortalImpl/ReactViews/ReactFrame.FramePrewarmer",["require","exports","MsPortalImpl/Base/Themes","MsPortalImpl/Services/Clarity","FxInternal/Errors","MsPortalImpl/ReactViews/ReactFrame.Constants"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prewarmReactFrame=void 0,t.prewarmReactFrame=async function(e){const{diContainer:t,flights:r,frameClientOptimizations:a,frameCreationStart:l,frameId:c,iframeElement:d,isFrameReactViewMessage:p,boundToView:u,lifetime:m,provisioningContextPromise:h}=e,[g,f,x,b]=await Promise.all([MsPortalFx.require("_generated/Less/MsPortalImpl/Base/Base.Images.css"),MsPortalFx.require("_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css"),MsPortalFx.require(t.get(s.ThemeManager).getCurrentThemeColorCssModuleId()),(0,o.isClarityEnabled)()]);if(m.isDisposed())throw new i.FxDisposedCanceledError;const y=new MessageChannel;d.contentWindow.postMessage({signature:n.reactFrameSignature,kind:3,data:{requireConfig:FxImpl.internalEnv.fxRequireConfig,initModules:[],css:[g,f].map((e=>e.css)).join("\n"),isMenuBladeContent:!0,boundToView:u,preload:MsPortalFx.isFeatureEnabled("preorderpreload"),profile:MsPortalFx.isFeatureEnabled("reactprofile"),portalUri:FxImpl.internalEnv.portalApplicationUri,type:"prewarm",clarityProjectId:b&&fx.environment?.clarity?.projectId,shellClientOptimizations:fx.environment.clientOptimizations,internalEnv:{blockUntrustedDomains:FxImpl.internalEnv.blockUntrustedDomains,azsEndpoints:FxImpl.internalEnv.azsEndpoints,fxTrustedDomains:FxImpl.authTokenDomainValidator?.fxTrustedDomains},perfLogEntries:[{groupName:"ReactView boot",name:"prewarm",timeStamp:l}],themeColorCssModule:x,prewarmFluentUI9:r.prewarmFluentUI9}},"*",[y.port1]);const v=[];let M=(e,t,s)=>{v.push({kind:e,data:t,azHostId:s})};const C={},P=e=>{if(p(e)){const t=e.data;M(t.kind,t.data,t.azHostId)}};window.addEventListener("message",P);const w={id:c,element:d,port:y.port2,setMessageListener:(e,t)=>{C[t]=e,M=(e,t,s)=>{if(C[s])return C[s](e,t);v.push({kind:e,data:t,azHostId:s})},v.splice(0).forEach((({kind:e,data:t,azHostId:s})=>{M(e,t,s)}))},clearMessageListener:()=>{w.supportsFrameReuse||window.removeEventListener("message",P)},inUse:!1,frameClientOptimizations:a,provisioningContextPromise:h};return w}})),
define("MsPortalImpl/ReactViews/ReactFrame.FramePool",["require","exports","Fx/DependencyInjection","Fx/Experimentation","FxInternal/Lifetime","MsPortalImpl/ReactViews/ReactFrame.FrameCreator","MsPortalImpl/ReactViews/ReactFrame.FramePrewarmer"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReactFramePool=void 0;var a=MsPortalFx.Base.Diagnostics.Telemetry;let l=class{constructor(e){this._diContainer=e,this._framesByExtension=new Map,this._flights={},this._framesInUse=[],this._getExtensionFrameCache=new Map,this._lifetime=new i.TriggerableLifetimeManager,this._previousCompleted=MsPortalFx.noop,this._provisioningContextDeferred=Promise.withResolvers(),this._viewLoadsByFrame=new Map,this._spareFrameTimeout=0,this._diContainer.get(o.Experimentation).shellAssignments.whenAvailable().then((e=>{Object.assign(this._flights,{earlyExtensionAssignments:e.getBooleanValue("EarlyExtensionAssignments"),prewarmContextPanes:e.getBooleanValue("PrewarmContextPanes"),prewarmFluentUI9:e.getBooleanValue("PrewarmFluentUI9")})})),this._spareFrameCreationDelay=1e3*(+MsPortalFx.getFeatureValue("reactspareframedelay")||0)}getFrame(e,t,s,o,i){if(3===e&&this._sidebarFrame)return this._sidebarFrame;const r=(i&&(1!==e||this._flights.prewarmContextPanes)?this.getExtensionFrame({extensionName:s,bladeSequenceNumber:o}):this.createFrame(t,!0)).promise.then((s=>{this._framesInUse[this._framesInUse.length-1]?.classList.remove("fxs-reactview-frame-active");const o=s.element;return o.classList.add("fxs-reactview-frame-active"),o.classList.remove("fxs-display-none"),this._framesInUse.push(o),s.container=t,this._flights.prewarmContextPanes&&o.classList.toggle("fxs-contextpane-floated-frame",1===e),s})),a=()=>{this._previousCompleted===a&&(this._previousCompleted=MsPortalFx.noop,r.then((e=>{this.makeSpareFrame()})))};this._previousCompleted=a;const l={frame:r,completed:a,dispose:()=>{r.then((e=>{const t=e.element;t.classList.remove("fxs-reactview-frame-active");const o=this._framesInUse.findIndex((e=>e===t));if(-1!==o&&this._framesInUse.splice(o,1),!e.supportsFrameReuse){t.remove();const o=this._framesByExtension.get(s);o&&this._framesByExtension.set(s,o.filter((t=>t.frame!==e)))}this._framesInUse[this._framesInUse.length-1]?.classList.add("fxs-reactview-frame-active"),(0,n.releaseOriginIndexForFrame)(e.id),e.onDisposed?.()}))}};return 3===e&&(this._sidebarFrame=l),l}getSidebarFrame(){return this.getFrame(3,document.querySelector(".fxs-sidebar-content"),"",0,!1)}setFrameRoot(e){this._rootElement=e,this.makeSpareFrame()}loadReactView(e){const{bladeSequenceNumber:t,diContainer:s,extensionName:o,frame:i,inContextPane:n,inSideBar:r,inDockedContextPane:l,viewName:c}=e,d=Date.now(),p=s.get(FxImpl.Rpc.Client);p.acquireWindow(o,90);const u=o+t;if(this._viewLoadsByFrame.has(u))return this._viewLoadsByFrame.get(u);if((l||n&&!this._flights.prewarmContextPanes)&&!i)return{viewLoadingCompleted:Promise.resolve({}),viewLoadingStarted:Promise.resolve()};i||this._spareFrame||this._previousCompleted();const m=i?{promise:Promise.resolve(i),frame:i,boundToView:!0}:r?{promise:this.getSidebarFrame().frame,boundToView:!0}:this.getExtensionFrame({extensionName:o,bladeSequenceNumber:t});m.promise.then((e=>e.inUse=!0));const h=Promise.withResolvers(),g={viewLoadingCompleted:MsPortalFx.require("MsPortalImpl/ReactViews/ReactFrame.ViewLoader").then((({loadReactViewIntoFrame:t})=>{const s=i?.id??"No frame",n=a.startTrace({action:"ReactViewLoad",source:"Prewarmer",actionModifier:"mark",data:{extensionName:o,viewName:c,frameId:s}});return t({...e,loadReactViewStart:d,flights:this._flights,frameLifetime:this._lifetime.createChildLifetime(),provisioningContextDeferred:this._provisioningContextDeferred,reactFramePromise:m.promise,rpcClient:p,viewLoadingStartedDeferred:h}).then((()=>({traceKey:n}))).catch((e=>(a.trace({source:"ReactViewPrewarmer",action:"SetLatestError",actionModifier:"cancel",data:{error:MsPortalFx.getLogFriendlyMessage(e),extensionName:o,viewName:c,frameId:s}}),{traceKey:n})))})),viewLoadingStarted:h.promise};return this._viewLoadsByFrame.set(u,g),g}dispose(){this._lifetime.dispose()}getExtensionFrame({extensionName:e,bladeSequenceNumber:t}){const s=e+t;if(this._getExtensionFrameCache.has(s))return this._getExtensionFrameCache.get(s);this._framesByExtension.has(e)||this._framesByExtension.set(e,[]);let o=MsPortalFx.find(this._framesByExtension.get(e),(e=>e.frame&&e.frame.supportsFrameReuse&&!e.frame.inUse));return o?o.frame.reused=!0:(o=this.takeSpareFrame(),this._framesByExtension.get(e).push(o)),this._getExtensionFrameCache.set(s,o),o}createFrame(e,t){if(!e)throw new Error("No root element has been defined yet, cannot create any frames");const s={boundToView:t,promise:void 0};return s.promise=this.initializeNewFrame(s,e).then((e=>(s.frame=e,e))),s}async initializeNewFrame(e,t){const s=Date.now();MsPortalFx.require("MsPortalImpl/ReactViews/ReactFrame.ViewLoader");const o=await(0,n.createReactViewFrame)({frameContainer:t,lifetime:this._lifetime,isOnDemand:e.boundToView});return(0,r.prewarmReactFrame)({...o,diContainer:this._diContainer,flights:this._flights,frameCreationStart:s,boundToView:e.boundToView,lifetime:this._lifetime,provisioningContextPromise:this._provisioningContextDeferred.promise})}makeSpareFrame(){this._spareFrame||(window.clearTimeout(this._spareFrameTimeout),this._spareFrameTimeout=window.setTimeout((()=>{this._spareFrame=this.createFrame(this._rootElement,!1)}),this._spareFrameCreationDelay))}takeSpareFrame(){if(this._spareFrame){const e=this._spareFrame;return this._spareFrame=void 0,e.boundToView=!0,e.promise=e.promise.catch((()=>this.initializeNewFrame(e,this._rootElement))),e}return this.createFrame(this._rootElement,!0)}};t.ReactFramePool=l,t.ReactFramePool=l=__decorate([__metadata("fx:diagnostics",[e,"ReactFramePool"]),s.Class(),__metadata("design:paramtypes",[s.Container])],l)})),
define("MsPortalImpl/Extension/ViewModelManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/ReactViews/ReactFrame.FramePool","MsPortalImpl/Extension/ShellPart","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Definition.Locator"],(function(e,t,s,o,i,n,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolve=t.registerWithDi=t.registerWithState=t.ViewModelManager=t.getViewModelOptions=t.getNextSequenceNumber=void 0;var p=FxImpl.TelemetryContext;const u=MsPortalFx.Base.Diagnostics.createLog(e);let m=1;function h(){return m++}function g(e,t,s){return{type:e,locator:"object"==typeof t?t:{name:t},createSelectable:s.createSelectable,telemetryContext:p.getState(),partSize:s.partSize,contentSize:s.contentSize,partLocation:s.partLocation,onInputsSetParameters:s.onInputsSetParameters,collapsed:s.collapsed,flags:s.flags,menuId:s.menuId}}t.getNextSequenceNumber=h,t.getViewModelOptions=g;let f=class{constructor(e,t,s,o,i){this._diContainer=e,this._rpcClient=t,this._extensionManagerOptions=s,this._definitionCache=o,this._extensionLoader=i,this._proxiedObjects=new Map,this._prefetchedResults=[],this._bladeSequenceNumbers=[]}getViewModel(e,t,s,o){return this._getViewModel(e,s,t,o,i.getViewModelEndPoint,!1)}getPartViewModel(e,t,s,n){if(this._useAzViewModelManager(e,t,!!(64&s)))return this._diContainer.getAsync(o.get("MsPortalImpl/AzFramework/AzExtensionCore","AzViewModelManager")).then((o=>o.getPartViewModel(e,t,s,n)));{const o=this._getViewModel(e,s,t,n,i.getPartViewModelEndPoint,!0),r=n?.bladeName&&64&s,a=r&&this._getBladeRedirector();return o.then((o=>{o||u.error("ViewModelComposer returned null/undefined for the view model",0,[{extensionName:e,type:s,name:t,options:n}]);const i=r&&n?.onInputsSetParameters&&{extensionName:e,bladeName:n.bladeName,parameters:n.onInputsSetParameters.inputs||{}};this._onPartViewModelAcquired(o,a,i)})),o}}getWeaveShellPort(e){const t=this._proxiedObjects.get(e);return t&&t.isPartViewModel&&t.managedValue}_useAzViewModelManager(e,t,s){return"string"==typeof t&&(s?t.toLowerCase().endsWith(".ReactView".toLowerCase())||t.toLowerCase().endsWith(".MenuView".toLowerCase())||t.toLowerCase().endsWith("_dx"):t.toLowerCase().endsWith(".ReactTile".toLowerCase()))}_getViewModel(e,t,s,o,i,n){const r=g(t,s,o=o||{}),a=C(this._diContainer,e,r,o.onViewModelAcquired);return a||i.acquireChannel(this._rpcClient,e,r).then((e=>{const t=e.value;return this._proxiedObjects.set(t,{isPartViewModel:n,managedValue:e}),o.onViewModelAcquired&&o.onViewModelAcquired(t),t}))}releaseViewModel(e,t){const s=this._proxiedObjects.get(e);if(s){const{managedValue:o}=s;t||MsPortalFx.disposeViewModelProperties(e),MsPortalFx.disposeDisposable(e),o.dispose(),this._proxiedObjects.delete(e)}}getBladeSequenceNumber(e,t,s){const o=w(e,t,s);return MsPortalFx.find(this._bladeSequenceNumbers,(e=>o===e.key))?.sequenceNumber}tryEarlyGetViewModel(e,t,s,n){let a;try{a=this._extensionManagerOptions.getNormalizedMetadata(e,!0),e=a.name}catch(e){return Promise.reject(e)}const c=(e,t)=>{for(;t.length>2;)t.pop();t.push(e)},d=w(e,t,s),{isPrefetch:p}=n,u=this.getBladeSequenceNumber(e,t,s),m=n.sequenceNumber||u||h();p&&!u&&c({key:d,sequenceNumber:m},this._bladeSequenceNumbers);const g=this._useAzViewModelManager(e,t,!0);let f=null;if(g){const i=this._diContainer.get(r.ReactFramePool),l={isMenuBladeContent:n.isMenuBladeContent,inContextPane:n.inContextPane,inDockedContextPane:n.inDockedContextPane,inSideBar:n.inSideBar,diContainer:this._diContainer,bladeSequenceNumber:m};t.toLowerCase().endsWith(".ReactView".toLowerCase())||t.toLowerCase().endsWith(".MenuView".toLowerCase())?i.loadReactView({extensionName:e,viewName:t,parameters:s,...l}):t.toLowerCase().endsWith("_dx")&&(f=o.get("MsPortalImpl/Extension/DxDefinitionCache","getRuntimeBlade").then((e=>e(this._diContainer,a,t).then((e=>{e?.bladeName?.toLowerCase().endsWith(".ReactView".toLowerCase())&&i.loadReactView({extensionName:e.extensionName,viewName:e.bladeName,parameters:null,...l})})))))}let x=!(g||(v=t,v in y||v in b||v.startsWith("Shell.InferredBladePinPart")));var v;if(x){const o=this._getCachedBladeDefinition(e,t);(o&&!(0,i.canGetViewModelEarly)(o,s)||P(s=ko.toJS(s||{})))&&(x=!1)}const M=MsPortalFx.find(this._prefetchedResults,(e=>d===e.key));if(!p){M&&MsPortalFx.remove(this._prefetchedResults,M);const e=MsPortalFx.find(this._bladeSequenceNumbers,(e=>d===e.key));e&&MsPortalFx.remove(this._bladeSequenceNumbers,e)}let C;x?M?C=M.result:(this._extensionLoader.setRequestedBlade(e,t),C=i.tryEarlyGetViewModelEndPoint.acquireChannel(this._rpcClient,e,{timestamp:Date.now(),bladeName:t,parameters:s,options:{menuId:n.menuId,partialFlags:(n.inContextPane?1:0)|(n.isMenuBladeContent?4:0)|(n.menuContentOverride?8:0),sequenceNumber:m}}).then((o=>{const i=o.value;return i.viewModel?(this._proxiedObjects.set(i.viewModel,{isPartViewModel:!0,managedValue:o}),this._onPartViewModelAcquired(i.viewModel,I,{extensionName:e,bladeName:t,parameters:s})):o.dispose(),this._diContainer.get(l.DefinitionCache).setBladeDefinition(e,t,Promise.resolve(i.definition)).then((e=>({definition:e,rpcDurationMs:i.rpcDurationMs,viewModel:i.viewModel,viewModelLoadIndex:i.viewModelLoadIndex})))})),p&&c({key:d,result:C},this._prefetchedResults)):C=M?.result||this._definitionCache.getBladeDefinition(e,t).then((e=>({definition:e,rpcDurationMs:-1,viewModel:null,viewModelLoadIndex:-1})));const I=this._getBladeRedirector();return p&&this._prefetchMenuBladeContent(n.menuContentOverride,I,{extensionName:e,bladeName:t,parameters:s}),f?Promise.all([C,f]).then((([e])=>e)):C}_onPartViewModelAcquired(e,t,s){this._tryPrefetchMenuBladeContent(e?.internal.initialMenuHeaderBlade,t,s),this._tryPrefetchMenuBladeContent(e?.internal.initialMenuContentBlade,t,s)}_tryPrefetchMenuBladeContent(e,t,s){e&&MsPortalFx.tryImmediateResolve(Q(e),(e=>{this._prefetchMenuBladeContent(e,t,s)}))}_prefetchMenuBladeContent(e,t,s){if(e){const{extensionName:o,bladeName:i,parameters:n}=e;if(o&&i){const e=s&&this._getCachedBladeDefinition(s.extensionName,s.bladeName),r=Q(t).valueOf();if(e&&r){const t=r.applyRedirects(d.Locator.forExtension(o).withBlade(i),n||{},{bladeDefinition:e,locator:d.Locator.forExtension(s.extensionName).withBlade(s.bladeName),model:s.parameters});t&&this.tryEarlyGetViewModel(t.getExtensionName(),t.name,n||{},{isPrefetch:!0,isMenuBladeContent:!0})}}}}_getCachedBladeDefinition(e,t){const s=Q(this._definitionCache.getBladeDefinition(e,t,!0));return s&&s.valueOf()}_getBladeRedirector(){return this._diContainer.getAsync(o.get("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Helpers","BladeRedirector"))}};f=__decorate([__metadata("fx:diagnostics",[e,"ViewModelManagerImpl"]),s.Class(),__metadata("design:paramtypes",[s.Container,FxImpl.Rpc.Client,n.ExtensionManagerOptions,l.DefinitionCache,c.ExtensionLoader])],f);class x{static create(e){return e}}t.ViewModelManager=x,__decorate([__metadata("fx:diagnostics",[e,"ViewModelManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[f]),__metadata("design:returntype",x)],x,"create",null);const b={},y={};let v=class extends i.ViewModelProvider{constructor(e){super(null,null,e.get(FxImpl.Rpc.Client))}};function M(e,t,s){y[e]={name:t,modulePath:s}}function C(e,t,s,o){let i=null,n=null;const r=s.locator.name;if(r in y){const t=e.get(v);return s.locator={name:r,module:y[r].modulePath,export:y[r].name},t.getObservable(e.createChildContainer("viewModel"),null,s,o)}if(r in b?(i=b[r].modulePath,n=e=>b[r].factoryWithState(e)):r.startsWith("Shell.InferredBladePinPart")&&(i="MsPortalImpl/Extension/PinBladeInferred",n=s=>s.createViewModel(r,e.get(x),e.get(l.DefinitionCache),t)),i)return MsPortalFx.require(i).then((e=>n(e))).then((e=>(o&&o(e),"number"==typeof s.partSize&&e&&e.content&&ko.isObservable(e.content.size)&&e.content.size(s.partSize),s.onInputsSetParameters&&e&&e.updatePartInputValues&&(e.onInputsSetPromise=e.updatePartInputValues(s.onInputsSetParameters.inputs,s.onInputsSetParameters.settings,s.onInputsSetParameters.traceOptions)),e)))}function P(e){const t=MsPortalFx.isPlainObject(e)&&Object.keys(e).map((t=>e[t]))||Array.isArray(e)&&e;return t&&t.some((e=>"function"==typeof e||P(e)))}function w(e,t,s){return`${e},${t}${"string"==typeof s?.id?","+s.id:""}`}v=__decorate([__metadata("fx:diagnostics",[e,"ShellViewModelProvider"]),s.Class(),__metadata("design:paramtypes",[s.Container])],v),t.registerWithState=function(e,t,s){b[e]={name:e,modulePath:t,factoryWithState:s}},t.registerWithDi=M,t.resolve=C,MsPortalFx.forEachKey(a.shellParts,((e,t)=>M(t.viewModelName,e,t.shellModule)))})),
define("MsPortalImpl/AzFramework/AzExtensionCore",["require","exports","Fx/DependencyInjection","MsPortalImpl/AzFramework/AzBladeViewModel","MsPortalImpl/Base/Base.ImplUtils","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Extension/ViewModelManager","FxInternal/Composition/Part"],(function(e,t,s,o,i,n,r,a){"use strict";function l(e,t){const s=p(e,t,!0),o={name:e,initialDisplayState:2,locked:!0,pinnable:!0,reactView:{},style:8,lenses:[{name:"AzBladeVirtualLens",partInstances:[{name:e,inline:s}]}],effectiveInputs:s.bindings,hasOnPinMethod:!0,attributes:17,contextPaneWidth:1,reflowReady:!0,menuBlade:e.toLowerCase().endsWith(".MenuView".toLowerCase())?{isMenuView:!0}:null};return["Browse.ReactView","BrowseAll.ReactView","BrowseFavoriteResources.ReactView","BrowseRecentResources.ReactView","BrowseResourceGroups.ReactView","BrowseResource.ReactView","ArmBrowse.ReactView"].includes(o.name)&&(o.activationStyle={width:0}),o}Object.defineProperty(t,"__esModule",{value:!0}),t.AzViewModelManager=t.AzDefinitionCache=t.createAzBladeDefinition=t.isValidUri=void 0,t.isValidUri=function(e){return(0,i.validateAbsoluteHttpUri)(e)||MsPortalFx.startsWith(e,"//")&&(0,i.validateAbsoluteHttpUri)(`http:${e}`)},t.createAzBladeDefinition=l;let c=class{constructor(){}getBladeDefinition(e,t,s){const o=t.toLowerCase(),i=e.bladeMap[o];return Promise.resolve(i||(e.bladeMap[o]=l(t,s)))}getPartDefinition(e,t,s){const o=t.toLowerCase(),i=e.partTypeMap[o];return Promise.resolve(i||(e.partTypeMap[o]=p(t,s)))}};t.AzDefinitionCache=c,t.AzDefinitionCache=c=__decorate([__metadata("fx:diagnostics",[e,"AzDefinitionCache"]),s.Class(),__metadata("design:paramtypes",[])],c);let d=class{getPartViewModel(e,t,s,i){"object"==typeof t&&(t=t.name);const l=(0,a.composePartViewModel)((e=>64&s?new o.BladeViewModel(e):new o.TileViewModel(e)),{createSelectable:i&&i.createSelectable,location:i&&i.partLocation,logArea:`Extension/${e}/PartType/${t}`,flags:i&&i.flags,type:s});return l.internal.reactViewInitializeEnd=ko.observable(),i&&((0,n.tryApplyEarlyOnInputsSet)(l,(0,r.getViewModelOptions)(s,t,i)),i.onViewModelAcquired&&i.onViewModelAcquired(l)),Promise.resolve(l)}};function p(e,t,s=!1){const o="parameters";return{isBlade:s,bladeOrPartName:e,isMenuBlade:e.toLowerCase().endsWith(".MenuView".toLowerCase()),extensionName:t,partKind:MsPortalFx.Parts.PartKind._Internal_React,viewModel:e,inputs:[o],...s?{bindings:[{property:o,optional:!1,isIdentityInput:!1,valuesFrom:[{referenceType:999,property:o}]}],initialSize:MsPortalFx.Parts.PartSize.FitToContainer,shareVmWithParentBlade:!0}:{inputDefinitions:[{name:o}]}}}t.AzViewModelManager=d,t.AzViewModelManager=d=__decorate([__metadata("fx:diagnostics",[e,"AzViewModelManager"]),s.Class()],d)})),
define("MsPortalImpl/ReactViews/ReactQueryStore",["require","exports","Fx/DependencyInjection","FxInternal/Diagnostics"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerQuery=t.ReactQueryStoreManager=void 0;var i=MsPortalFx.Base.Diagnostics,n=MsPortalFx.Base.Diagnostics.Telemetry;const r=i.createLog(e);let a=0;class l{constructor(e,t,s){this.extensionName=e,this.baseStore=t,this.getSharedExtensionStore=s,this.entryState={},this.listeners=[],this.entries=t?.getEntries()??{},this.baseUnsubscribe=t?.subscribe((e=>this.setEntry({...e,scope:"view"})))}clearEntry(e,t){this.setValue(e,{state:"unset"},t)}getEntries(){return this.entries}getEntry(e){return this.entries[e]}setValue(e,t,s={},i){const n=Date.now(),l=i||n;if("rejected"===t.state&&t.error){let e=t.error?.message||"Unknown error";try{e=JSON.parse(JSON.stringify((0,o.decycle)(t.error)))}catch{}t={state:"rejected",error:e}}const c={...t,completed:n,expires:s.expires?n+1e3*s.expires:Number.MAX_SAFE_INTEGER,staleAfter:n+1e3*(s.staleAfter||5),started:l,sequenceId:a++,skipStructuralSharing:s.skipStructuralSharing},d=this.getEntryState(e);d.pendingRequests=d.pendingRequests.filter((e=>e.requestStarted>l)),this.setEntry({id:e,entry:c,scope:s.scope}),r.debug(`Updated query entry: ${e}`,c)}setValueAsync(e,t,s={},o={}){const{forceNewRequest:i}=o,n=this.getEntryState(e);if(i||0===n.pendingRequests.length){const o={requestStarted:Date.now(),promise:void 0};n.pendingRequests.push(o),o.promise=t().then((e=>({state:"resolved",data:e})),(e=>({state:"rejected",error:e}))).then((t=>{if(n.pendingRequests.some((e=>e===o))&&(n.pendingRequests=n.pendingRequests.filter((e=>e!==o)),this.setValue(e,t,s,o.requestStarted)),"rejected"===t.state)throw t.error;return t.data}))}return n.pendingRequests[n.pendingRequests.length-1].promise}setEntry(e){const{entry:t,id:s,scope:o}=e,i=this.getEntry(s);if((!i||i.started<t.started||i.started===t.started&&i.sequenceId<t.sequenceId)&&(this.entries[s]=t,this.baseStore&&"session"===o&&this.baseStore.setEntry(e),this.notifyListeners(e),"session"===o&&e.sharedWith&&this.getSharedExtensionStore))for(const s of e.sharedWith){this.getSharedExtensionStore(s).setEntry({...e,entry:{...t,sharedBy:this.extensionName},sharedWith:void 0})}}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter((t=>t!==e))}}dispose(){this.listeners=[],this.baseUnsubscribe?.()}getEntryState(e){let t=this.entryState[e];return t||(t=this.entryState[e]={pendingRequests:[]}),t}notifyListeners(e){for(const t of this.listeners)t(e)}}let c=class{constructor(){this.extensionStores=new Map,this.viewStores=new Map}getViewStore(e,t,s){let o=this.viewStores.get(t);if(!o){const i=this.getExtensionStore(e);o=new l(e,i,this.getExtensionStore.bind(this)),this.viewStores.set(t,o),s.registerForDispose((()=>{this.viewStores.delete(t),o.dispose()}))}return o}getExtensionStore(e){let t=this.extensionStores.get(e);return t||(t=new l(e),this.extensionStores.set(e,t)),t}};t.ReactQueryStoreManager=c,t.ReactQueryStoreManager=c=__decorate([__metadata("fx:diagnostics",[e,"ReactQueryStoreManager"]),s.Class()],c),t.registerQuery=function(e){const{cacheOptions:t,getArgsKey:s,name:i,onError:a,query:l}=e;return{name:i,bind:(e,...c)=>{const d={},p=(e=>{const t=s?s(...e):e.length?JSON.stringify(e):"";return t?`${i}:${t}`:i})(c),u=()=>{const e=Date.now();let t=!1;return l(...c).then((e=>e),(e=>{if(t=!0,a)a(e);else{let t=e?.message||"Unknown error";try{t=JSON.parse(JSON.stringify((0,o.decycle)(e)))}catch{}r.writeEntry(2,`Query failed: ${i}`,t.code,[t])}throw e})).finally((()=>{const s=Date.now();n.trace({source:"ShellReactQuery",action:"get",timestamp:s,name:i,duration:s-e,actionModifier:t?"failed":"completed"})}))};return d.query={store:e,arguments:c,clear:()=>{e.clearEntry(p,t)},get:async(s={})=>{const{ignoreCachedValue:o="if-stale",force:i}=s,n=Date.now();if(!i&&"always"!==o){const t=e.getEntry(p);if(t){const e=t.expires<n,s=e||t.staleAfter<n;if(!(e||"unset"===t.state||s&&"never"!==o))return"resolved"===t.state?Promise.resolve(t.data):Promise.reject(t.error)}}return e.setValueAsync(p,u,t,{forceNewRequest:i})},getCacheEntry:()=>e.getEntry(p),set:s=>{e.setValue(p,{state:"resolved",data:s},t)}},d.query}}}})),
define("MsPortalImpl/Services/Services.BrowserSettings",["require","exports","Fx/DependencyInjection","Weave"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceDependencyState=t.PrivateLinkState=t.temporaryExtensionCount=t.isZoomedInTooDeep=t.hideSmallModals=void 0;const i=window,n=i.screen||{},r=MsPortalFx.isFeatureEnabled("hidemodalsonsmallscreens");t.hideSmallModals=function(){return r&&n.width<480},t.isZoomedInTooDeep=function(){return r&&(i.innerHeight<400&&i.innerWidth<800||100*i.devicePixelRatio>300)};t.temporaryExtensionCount=new class{constructor(){this._extensionCountTable=new Object(null),this._intervalIds=[]}_getCurrentCount(e){return this._extensionCountTable[e]??0}addIntervalId(e){this._intervalIds.push(e)}flush(){this._extensionCountTable=new Object(null)}flushIntervalIds(){this._intervalIds.filter((e=>clearInterval(e))),this._intervalIds.length=0}incrementCount(e){this._extensionCountTable[e]=this._getCurrentCount(e)+1}getExtensionCountsAsList(){const e=[];return Object.keys(this._extensionCountTable).forEach((t=>{e.push({extension:t,count:this._extensionCountTable[t]})})),e}};let a=class{constructor(){this.isPrivateLinked=(0,o.makeWritableComputation)(!1)}};t.PrivateLinkState=a,t.PrivateLinkState=a=__decorate([__metadata("fx:diagnostics",[e,"PrivateLinkState"]),s.Class()],a);let l=class{constructor(){this.azureResourceGraphUnavailable=(0,o.makeWritableComputation)(!1)}};t.ServiceDependencyState=l,t.ServiceDependencyState=l=__decorate([__metadata("fx:diagnostics",[e,"ServiceDependencyState"]),s.Class()],l)})),
define("MsPortalImpl/Services/SubscriptionAndLocationHelpers",["require","exports","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compareSubscriptions=t.mergeSelectedSubscriptionsWithFirstPage=t.getSubscriptionsWithUniqueDisplayNames=void 0;var o=MsPortalFx.Base.Diagnostics.Telemetry;t.getSubscriptionsWithUniqueDisplayNames=function(e){const t=e.subsMap||{},i={},n=[];let r=0;const a=new Set;if(MsPortalFx.forEachKey(t,((e,{subscription:o,notInFirstPage:l})=>{const c=o.displayName,d=o.state,p=(o.subscriptionPolicies||{}).quotaId,{uniqueDisplayName:u,...m}=o;p&&a.size<10&&a.add(p);let h=d&&"disabled"===d.toLowerCase()?s.disabledSubscriptionLabelFormat.format(c):c;const g=i[c];if(g){if(h=s.subscriptionNameAndIdLabelFormat.format(h,e),!g.updated){const e=n[g.index];e.uniqueDisplayName=s.subscriptionNameAndIdLabelFormat.format(e.uniqueDisplayName,e.subscriptionId),g.updated=!0}}else i[c]={index:r,updated:!1};o={...m,uniqueDisplayName:h},t[e]={subscription:o,notInFirstPage:l},n.push(o),r++})),a.size){const t=[];a.forEach((e=>t.push(e))),o.trace({source:`${e.telemetrySource}.getSubscriptionsWithUniqueDisplayNames`,action:e.isPortalStartup?"quotaIdsOnPortalLoad":"additionalQuotaIdsOnAllSubscriptionsLoad",data:{quotaIds:t.join(",")}})}return n},t.mergeSelectedSubscriptionsWithFirstPage=function(e,t){const s=e.length+t.length,o=new Map,i=new Array(s);let n=Math.min(e.length,s);for(let t=0;t<n;t++){const s=e[t];o.set(s.subscriptionId,s),i[t]=s}const r=Math.min(t.length,s);let a=0;for(;a<r&&n<i.length;){const e=t[a++];o.has(e.subscriptionId)||(o.set(e.subscriptionId,e),i[n++]=e)}return i.length=n,i},t.compareSubscriptions=function(e,t){const s="disabled",o=(e.state||"").toLowerCase(),i=(t.state||"").toLowerCase();if(o!==i){if(o===s)return 1;if(i===s)return-1}const n=(e.displayName||"").toLowerCase(),r=(t.displayName||"").toLowerCase(),a=(e.subscriptionId||"").toLowerCase(),l=(t.subscriptionId||"").toLowerCase();return MsPortalFx.compare(n,r)||MsPortalFx.compare(a,l)}})),
define("MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers",["require","exports","MsPortalImpl/Notifications/NotificationsClientStrings","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/SubscriptionAndLocationHelpers","MsPortalImpl/UI/UI.AuthStateManager","FxInternal/AsyncLoader","FxInternal/Diagnostics","FxHubs/RpcEndPoints","Fx/Ajax"],(function(e,t,s,o,i,n,r,a,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.useAdvancedSubFilters=t.lazyUserDataMemo=t.countTypeMap=void 0;d.Subscriptions.CountTypeEnum;var u=MsPortalFx.Base,m=u.Constants,h=u.Diagnostics,g=h.Telemetry,f=MsPortalFx.Hubs.Notifications.NotificationStatus;const x=s.PrivateLinkNotification;let b=window;const y=h.createLog(e);let v,M=!1;async function C(e){const t=await MsPortalFx.require("MsPortalImpl/Services/LazyUserData/LazyUserData.Deferred");return await t.getLazyUserData({diContainer:e,useAdvancedFiltersPromise:_(e),fetchFirstPageAndSelectedSubscriptions:!0})}async function P(e){M&&y.error("getLazyUserData should only be called once per session");const[s,n]=await Promise.all([e.get(a.AuthStateManager),e.get(i.SecurityTokensManager)]),d=await n.getToken({extensionName:"fx",resourceName:"",isBackground:!1,skipCache:!1})||{};M=!0;let h=b.fx.environment.applicationPath;"/"!==h[h.length-1]&&(h+="/");const v=e.get(FxImpl.Features),P=v.isEnabled("selftoken"),w=new u.UriBuilder(h+"api/Portal/GetLazyUserData"),I=g.startTrace({source:"LazyUserDataHelpers",action:"loadLazyUserData"}),S=d.token||{};let _,F="2019-10-01";v.isEnabled("policyforrestypes")&&v.isEnabled("fetchpolicyforrestypes")&&(F="2022-04-01");try{_=(await(0,p.ajaxExtended)({contentType:"application/json",headers:{accept:"application/json","x-ms-feature-flags":JSON.stringify({"feature.inmemorysettings":v.getValue("inmemorysettings"),"feature.globalresourcefilter":v.getValue("globalresourcefilter"),"feature.settingsportalinstance":v.getValue("settingsportalinstance")})},setAuthorizationHeader:!P||{resourceName:"self"},type:"POST",uri:w.toString(),data:JSON.stringify({version:F,armAuthorizationHeader:S.header})})).content}catch(t){if(403===t.jqXHR.status){const e=b.location,t=s.bootstrapState||{},o=t.loginReplyUrlPath||"/signin/index/",i=t?.user?.tenantId||"";return e.href=`${e.origin}${o}${i}?mfalogin=true&reason=AuthenticationCriteraNotSatisfiedInLazy`,null}y.warning(`Call to GetLazyUserData failed and will be retried on the client. Error details: ${MsPortalFx.getLogFriendlyMessage(t)}`);try{_=await C(e)}catch(e){y.warning(new MsPortalFx.Errors.Error({message:`Failed to load client-side lazyUserData. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`,innerErrors:e}))}}_=_||{};let T=_.firstPageSubscriptions||{},k=_.serviceHealthAlerts;const D=["Failure_PrivateLink","Failure_CaePolicyValidation"].includes(T.resultCode),E=_.argServiceIsUnavailable||"Failure_ArgServiceUnavailable"===T.resultCode;if(E&&(e.get(o.ServiceDependencyState).azureResourceGraphUnavailable(!0),y.error("ServiceErrorFromArg received from LazyUserDataHelpers")),D&&e.get(o.PrivateLinkState).isPrivateLinked(!0),D||E){g.trace({source:"LazyUserDataHelpers",action:D?"ReceivedPrivateLinkCode":"ARGUnavailableFallback",data:{resultCode:T.resultCode}});try{const t=await C(e);T=t.firstPageSubscriptions||{};const s=T.exception;if(D&&s){let t=s.content?.message||s.message;try{if(t?.includes("DebugOnlyDetails:")){const e=JSON.parse(t.substring(t.indexOf("DebugOnlyDetails:")+17));e?.error?.message&&(t=(0,c.sanitizeMessage)(e.error.message))}else t=(0,c.sanitizeMessage)(t||MsPortalFx.getLogFriendlyMessage(s))}catch{}t=t||MsPortalFx.getLogFriendlyMessage(s),e.getAsync(l.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationHandler")).then((o=>o.showModalNotification({diContainer:e,messageContext:{srcWindowId:m.Shell,destWindowId:m.Shell,callStack:s.stack},messageArg:{primaryButtonText:x.primaryButtonText,secondaryButtonClickAction:2,secondaryButtonText:x.secondaryButtonText,notification:{title:x.title,description:x.description+"<br /><br />"+x.details.format(t),descriptionAsHtml:!0,status:f.Warning,timestamp:new Date}}})))}k=t.serviceHealthAlerts}catch(e){y.warning(new MsPortalFx.Errors.Error({message:`Failed to load client-side lazyUserData. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`,innerErrors:e}))}}const B=T.valueMapById||{},A=T.count||{},N=(A.type||"").toLowerCase(),R=_.locations||{},L=_.recentResources||Object.create(null),O=L.recentResources||Object.create(null),z=_.policyForResourceTypes||{isIncomplete:!0};k=k||[];const H=(0,r.getSubscriptionsWithUniqueDisplayNames)({subsMap:B,isPortalStartup:!0,telemetrySource:"LazyUserDataHelpers"}),U=H.length;g.completeTrace(I,{firstPageSubscriptions:{armCount:T.count||{},hasErrors:T.hasErrors,nextLink:T.nextLink,resultCode:T.resultCode,subscriptionsReturned:U},locations:{armCount:R.count||{},hasErrors:R.hasErrors,locationsReturned:(R.value||[]).length,nextLink:R.nextLink},recentResources:{recentResourcesCount:Object.keys(L).length,status:L.status||"unknown",verifiedRecentResourcesCount:Object.keys(O).reduce(((e,t)=>("exists"===O[t].existenceState.toLowerCase()&&e++,e)),0)},serviceHealthAlerts:{returnedCount:k.length}}),T.hasErrors&&y.warning("Subscriptions in GetLazyUserData contained errors.");let W=A.value;return"total"!==N&&(W=U),{firstPageSubscriptions:{subscriptions:H,subscriptionsMap:B,countData:{value:W,type:t.countTypeMap[N]},nextLink:T.nextLink},locations:R,recentResources:"completedsuccess"===(L.status||"").toLowerCase()?O:void 0,serviceHealthAlerts:k,policyForResourceTypes:z}}t.countTypeMap={total:1,partial:2,notabletocalculate:4};let w,I=0;async function S(e){try{return P(e)}catch(t){if(y.warning(new MsPortalFx.Errors.Error({message:`Failed to load lazyUserData. Error details: ${MsPortalFx.getLogFriendlyMessage(t)}`,innerErrors:t})),I<1)return I++,S(e);throw t}}async function _(e){if(v)return v;if(!e.get(FxImpl.Features).isEnabled("globalresourcefilter"))return v=Promise.resolve(!1);const t=await e.getAsync(n.SettingsManager);return v=t.querySetting(19,"optedIn").then((e=>!!e))}t.lazyUserDataMemo=function(e){return w||(w=S(e),w)},t.useAdvancedSubFilters=_})),
define("MsPortalImpl/Services/Services.Subscriptions",["require","exports","Fx/Ajax","Fx/DependencyInjection","FxHubs/ArmHelpers/ArmApisStartup","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/SubscriptionAndLocationHelpers","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Tenants","FxInternal/ResourceManagement/Subscriptions","FxInternal/AsyncLoader","Weave","Fx"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.getInSessionDisplayedSubscriptionsHandler=t.getSubscriptionInfoHandler=t.getInSessionSelectedSubscriptionsObservableHandler=t.searchForSubscriptionsHandler=t.setInSessionSelectedSubscriptionsHandler=t.SubscriptionsUserContext=t.StartupSubscriptionsInfoProvider=t.ServicesSubscriptions=t.getSubscriptionArgQueryFormat=t.searchSubscriptionArgQueryFormat=void 0;r.Subscriptions.CountTypeEnum;var x=MsPortalFx.Base.Diagnostics,b=x.Telemetry,y=MsPortalFx.Hubs.Notifications;const v=MsPortalFx.require,M=x.createLog(e),C=(0,f.isFeatureEnabled)("getselectedsubstelemetry");let P=(0,f.isFeatureEnabled)("argsubscriptions")?parseInt((0,f.getFeatureValue)("maxselectedsubs")||"1000"):100;const w=(0,f.memoizePromise)((()=>v("MsPortalImpl/Services/Services.SubscriptionsDeferred")));t.searchSubscriptionArgQueryFormat='resourcecontainers| where type =~ "microsoft.resources/subscriptions"| project subscriptionId, displayName=name| where displayName contains "{0}" or subscriptionId contains "{0}"',t.getSubscriptionArgQueryFormat='resourcecontainers| where type =~ "microsoft.resources/subscriptions" and subscriptionId == "{0}"| project subscriptionId, displayName=name';let I=class{constructor(e,t,s,o){this._diContainer=e,this._authStateManager=s,this.globalSelectedSubscriptionsObservable=ko.observable([]),this.loadedSubscriptionsPromise=ko.observable(),this.startupSubscriptionsInfoMemo=(0,f.memoizePromise)((async()=>{const e=b.start({source:"Services.Subscriptions",action:"startupSubscriptionsInfoMemo"}),t=this._loadSubscriptions().then((t=>(b.completeTrace(e,{subscriptionsCount:t.subscriptions.length,countData:t.countData,hasNextLink:!!t.nextLink}),t)));return this.loadedSubscriptionsPromise(t),this.handleZeroSubsNotification=(async()=>{const e=await t;this.subscriptionsMap=e.subscriptionsMap;const s=4===e.countData.type,o=e.subscriptions.length;if(o&&e.countData.value)s&&T(o);else{const[e,t]=await Promise.all([this._authStateManager.getUserInfo(),this._diContainer.get(u.TenantsService).getHomeTenantsCount()]),i=await v("MsPortalImpl/Services/NoSubsChecks");if(!await i.handleNoSubsInDirectory(this._diContainer,e,t,(0,l.useAdvancedSubFilters)(this._diContainer))&&s)return T(o)}})(),t})),this.allSubscriptionsInfoMemo=(0,f.memoizePromise)((async()=>{const[e,t]=await Promise.all([this.startupSubscriptionsInfoMemo(),(0,l.useAdvancedSubFilters)(this._diContainer)]);let s;if(b.trace({source:"Services.Subscriptions",action:"allSubscriptionsInfoMemo",data:{nextLink:e.nextLink,startupSubsInfoCountData:e.countData,startupSubscriptionsInfoSubsCount:e.subscriptions.length}}),e.nextLink&&!t){s=this._loadSubscriptions(e);const t=await s;this.subscriptionsMap=t.subscriptionsMap}else s=Promise.resolve({...e,countData:{type:1,value:e.subscriptions.length}});return this.loadedSubscriptionsPromise(s),s}));const i="ServicesSubscriptionsConstructor",r=async()=>{if(o.isEnabled("mspfilter")){const e=await v("MsPortalImpl/Services/Services.ProjectedDirectories");return await this._diContainer.getAsync(e.ServicesProjectedDirectories)}return null},d=(0,l.useAdvancedSubFilters)(e),p=async()=>{if(!await d)return await async function(e){const t=await e.querySetting(6,n.Keys.subscriptionsSelected);return t?.split(";")||[]}(t)},m=async e=>{let s;if(e){const e=(await w()).fetchSubscriptions(this._diContainer);this.loadedSubscriptionsPromise(e),this.startupSubscriptionsInfoMemo=(0,f.memoizePromise)((()=>e)),s=e}else s=this.startupSubscriptionsInfoMemo();try{const[n,l,u,m]=await Promise.all([s,p(),r(),d]);let h=l;if(m){if(0===n.countData.value)return[];h=n.subscriptions.map((e=>e.subscriptionId))}else b.trace({source:"Services.Subscriptions",action:i,data:{selectedSubscriptionsInSettingsCount:h.length}});const g=n.subscriptions,f=n.countData.value,x=n.countData.type,M=m?g:g.filter((e=>h.includes(e.subscriptionId)));let C=!1,w=Promise.resolve(M);if(!m&&u){const e=await u.getSubscriptionsForSelectedDirectories(M);w=e.length?Promise.resolve(e):u.getSubscriptionsForSelectedDirectories(g)}else 0===M.length&&(b.trace({source:"Services.Subscriptions",action:"zeroValidSelectedSubscriptions"}),w=Promise.resolve(g.slice(0,P)),C=f>0&&2===x);const I=await w;if(!m&&I.length>=P&&(b.trace({source:"Services.Subscriptions",action:"cappedSelectedSubscriptions",data:{selectedSubscriptionsCount:I.length}}),I.length=P,C=f>P),C){const e=(e,t)=>{y.ClientNotification.publish({status:y.NotificationStatus.Information,title:e,description:t,uri:"#menu/directory"})},t=a.SubscriptionsNotification;1===x?e(t.totalCappedTitle.format(P,f),t.totalSubscriptionsCapped.format(P,f)):2===x&&e(t.partialCappedTitle.format(f),t.partialSubscriptionsCapped.format(P,f))}const S=(0,c.mergeSelectedSubscriptionsWithFirstPage)(I,g);if(!m&&I&&F(t,(I.length===f?[]:I).map((e=>e.subscriptionId)),e?"forceReload":"startup"),o.isEnabled("subscreditcheck")){(await v("MsPortalImpl/Services/SubsCreditCheck")).checkRemainingCredit(I)}if(!o.isEnabled("ci")){const e=I.filter((e=>"pastdue"===e.state.toLowerCase()));if(b.trace({source:"Services.Subscriptions",action:"pastDueSubsCheck",data:{pastDueSubsCount:e.length}}),e.length){(await v("MsPortalImpl/Services/PastDueSubsCheck")).raiseWarningForPastDueSubs(this._diContainer,e)}}return this.globalSelectedSubscriptionsObservable(I),S}catch(e){b.trace({source:"Services.Subscriptions",action:i,data:{err:e}}),M.warning(e)}};this.forceReloadDisplayedSubscriptions=()=>m(!0);let h=!1;this.displayedSubscriptionsPromise=ko.observable((async()=>{const e=await m(!1);return h=!0,e})()),d.then((async e=>{if(!e)return;const t=await v("MsPortalImpl/Services/Services.GlobalResourceFilters"),s=await this._diContainer.getAsync(t.ResourceFilterManager),o=new FxImpl.TriggerableLifetimeManager;(0,g.subscribe)(o,[s.currentFilter],(async()=>{if(!h)return;const e=m(!0);if(this.displayedSubscriptionsPromise(e),!(await e)?.length){const[e,t]=await Promise.all([this._authStateManager.getUserInfo(),this._diContainer.get(u.TenantsService).getHomeTenantsCount()]);(await v("MsPortalImpl/Services/NoSubsChecks")).handleNoSubsInDirectory(this._diContainer,e,t,Promise.resolve(!0))}}))}))}async _loadSubscriptions(e){let t;if((e=e||{}).nextLink){const s=await w();t=await s.loadAllSubscriptionsFromArm(e)}else try{const e=(await this._diContainer.get(S).getSubscriptionsInfo()).firstPageSubscriptions||{},{subscriptions:s,...o}=e;t={...o,subscriptions:MsPortalFx.stableSort(s,c.compareSubscriptions)}}catch(e){return M.warning(new MsPortalFx.Errors.Error({message:`Error retrieving first page of subscriptions: \n${MsPortalFx.getLogFriendlyMessage(e)}`,innerErrors:e})),{subscriptions:[],subscriptionsMap:{},countData:{type:0,value:0},nextLink:""}}return b.trace({source:"Services.Subscriptions",action:"_loadSubscriptions",data:{startupStubsNextLink:e.nextLink,subscriptionsCount:t.subscriptions.length,countData:t.countData,nextLink:t.nextLink}}),t}};t.ServicesSubscriptions=I,t.ServicesSubscriptions=I=__decorate([__metadata("fx:diagnostics",[e,"ServicesSubscriptions"]),(0,o.Class)(),__metadata("design:paramtypes",[o.Container,p.SettingsManager,d.AuthStateManager,FxImpl.Features])],I);let S=class{constructor(e){this.getSubscriptionsInfo=()=>(0,l.lazyUserDataMemo)(e)}};t.StartupSubscriptionsInfoProvider=S,t.StartupSubscriptionsInfoProvider=S=__decorate([__metadata("fx:diagnostics",[e,"StartupSubscriptionsInfoProvider"]),(0,o.Class)(),__metadata("design:paramtypes",[o.Container])],S);let _=class{constructor(e,t,s){this._diContainer=e,this._servicesSubscriptions=t,this._settingsManager=s;const o=new FxImpl.TriggerableLifetimeManager;t.displayedSubscriptionsPromise.subscribeAndRun(o,(e=>{this._inSessionDisplayedSubscriptionsPromise=this._globalDisplayedSubscriptionsPromise=e}));const i=this._globalSelectedSubscriptions=t.globalSelectedSubscriptionsObservable;this.inSessionSelectedSubscriptions=ko.observable(i()),t.loadedSubscriptionsPromise.subscribeAndRun(o,(e=>{this._loadedSubscriptionsPromise=e})),this.useAdvancedFiltersPromise=(0,l.useAdvancedSubFilters)(e),this._globalSelectedSubscriptions.subscribe(o,(e=>{this.inSessionSelectedSubscriptions(e)}))}async getAllSubscriptionsCount(){const{countData:e}=await this._loadedSubscriptionsPromise;return e}getGlobalDisplayedSubscriptions(){return this._globalDisplayedSubscriptionsPromise}async getInSessionDisplayedSubscriptions(){const[e,t,s]=await Promise.all([this.getGlobalSelectedSubscriptions(),this._inSessionDisplayedSubscriptionsPromise,this.getAllSubscriptionsCount()]);return{subscriptions:[...t],isPartialSet:1!==s.type||t.length<e().length}}async getGlobalSelectedSubscriptions(){const e=C?b.start({source:"Services.Subscriptions",action:"GetSelectedSubscriptions"}):"";return await this._globalDisplayedSubscriptionsPromise,C&&b.completeTrace(e,{selectedSubscriptionsCount:this._globalSelectedSubscriptions().length}),this._globalSelectedSubscriptions}async getInSessionSelectedSubscriptions(){return await this._globalDisplayedSubscriptionsPromise,this.inSessionSelectedSubscriptions}async setGlobalSelectedSubscriptions(e){if(await this.useAdvancedFiltersPromise)return Promise.reject("Unable to set global selected subscriptions with feature.globalresourcefilter enabled");const t=await this.processNewSelectedSubscriptions(MsPortalFx.convertArrayToMap(e,MsPortalFx.identity,(()=>!0)));b.trace({source:"Services.Subscriptions",action:"setGlobalSelectedSubscriptions",data:{areAllSubsSelected:t.areAllSubsSelected,displayedSubscriptionsCount:t.displayedSubscriptions.length,selectedSubscriptionsCount:t.selectedSubscriptions.length,first100SubscriptionIds:t.selectedSubscriptions.slice(0,100).map((e=>e.subscriptionId))}}),this._globalDisplayedSubscriptionsPromise=Promise.resolve(t.displayedSubscriptions),this._inSessionDisplayedSubscriptionsPromise=Promise.resolve(t.displayedSubscriptions);const s=t.selectedSubscriptions;this._globalSelectedSubscriptions([...s]);const o=s.length===t.countData.value?[]:s.slice(0,P);F(this._settingsManager,o.map((e=>e.subscriptionId)),"updated")}async setInSessionSelectedSubscriptions(e){const t=await this.processNewSelectedSubscriptions(MsPortalFx.convertArrayToMap(e,MsPortalFx.identity,(()=>!0)));b.trace({source:"Services.Subscriptions",action:"setInSessionSelectedSubscriptions",data:{areAllSubsSelected:t.areAllSubsSelected,displayedSubscriptionsCount:t.displayedSubscriptions.length,selectedSubscriptionsCount:t.selectedSubscriptions.length,first100SubscriptionIds:t.selectedSubscriptions.slice(0,100).map((e=>e.subscriptionId))}}),this._inSessionDisplayedSubscriptionsPromise=Promise.resolve(t.displayedSubscriptions),this.inSessionSelectedSubscriptions(t.selectedSubscriptions)}async getSubscriptionSearchResults(e){return(await w()).getSubscriptionSearchResults(e,this._servicesSubscriptions.allSubscriptionsInfoMemo())}async searchSubscriptionFromArg(e,s){const{getDataFromArt:o}=await MsPortalFx.require("FxHubs/ArtHelpers/ArtApis"),i=s+".searchSubscriptions";return{subscriptions:(await o({query:t.searchSubscriptionArgQueryFormat.format(e),options:{resultFormat:"objectArray"}},i)).data||[]}}async getSubscriptionFromArg(e,s){const{getDataFromArt:o}=await MsPortalFx.require("FxHubs/ArtHelpers/ArtApis"),i=s+".getSubscription",n=(await o({query:t.getSubscriptionArgQueryFormat.format(e),options:{resultFormat:"objectArray"}},i)).data||[];if(1===n.length)return n[0];throw 0===n.length?new Error("Subscription not found"):new Error("Multiple subscriptions found")}async getAllSubscriptionIds(){const e=await this.useAdvancedFiltersPromise?this._loadedSubscriptionsPromise:this._servicesSubscriptions.allSubscriptionsInfoMemo(),t=await e;return{subscriptionIds:t.subscriptions.map((e=>e.subscriptionId)),allSubscriptionsCountData:t.countData}}async getSubscriptionTenant(e){if(!e)return{};const t=b.startTrace({source:"Services.Subscriptions",action:"GetSubscriptionTenant",data:{subscriptionId:e}}),o=(await MsPortalFx.Base.Security.getUserInfo()).directoryId,n=await this._diContainer.get(u.TenantsService).getHomeTenants();try{const r=(0,i.getSubscriptionApi)(e),a=(await(0,s.batch)({uri:r,type:"GET",setTelemetryHeader:"GetSubscriptionTenant"})).content.tenantId,l=n.find((e=>e.id===a))||{};return b.completeTrace(t,{source:"Services.Subscriptions",action:"GetSubscriptionTenant",data:{subscriptionId:e,signedInTenantId:o,subscriptionTenantId:l.id}}),l}catch(s){const i=s||{},r=i.content?.error||{};if("InvalidAuthenticationTokenTenant"===r.code){const s=r.message,i=[...s.matchAll(/https:\/\/([a-zA-Z0-9.-]+)\/([a-zA-Z0-9-]+)\//g)];if(i.length>0){const r=(i.map((e=>e[2]))||[]).slice(1),a=n.find((e=>r.includes(e.id)))||{};return b.completeTrace(t,{source:"Services.Subscriptions",action:"GetSubscriptionTenant",data:{subscriptionId:e,signedInTenantId:o,subscriptionTenantId:a?.id,armErrorMessage:s}}),a}}return b.cancelTrace(t,{source:"Services.Subscriptions",action:"GetSubscriptionTenant",data:{subscriptionId:e,error:s}}),{}}}async getSubscription(e){if(!e)return Promise.reject("Invalid subscription ID.");const t=await this._loadedSubscriptionsPromise;return this._subscriptionsNameMap||(this._subscriptionsNameMap=MsPortalFx.convertArrayToMap(t.subscriptions,(e=>e.uniqueDisplayName),(()=>!0))),await(0,f.memoizePromise)((async e=>{try{await this._globalDisplayedSubscriptionsPromise;const t=this._servicesSubscriptions.subscriptionsMap;let o;if(t&&(o=(t[e]||{}).subscription),!o){const o=(0,i.getSubscriptionApi)(e),n=(await(0,s.batch)({uri:o,type:"GET",setTelemetryHeader:"GetSubscription"})).content,r=n.displayName;let l=n.state&&"disabled"===n.state.toLowerCase()?a.disabledSubscriptionLabelFormat.format(r):r;return this._subscriptionsNameMap[r]&&(l=a.subscriptionNameAndIdLabelFormat.format(l,n.subscriptionId)),n.uniqueDisplayName=l,t[n.subscriptionId]={subscription:n,notInFirstPage:!1},this._subscriptionsNameMap[l]=!0,n}return o}catch(e){const t=e||{},s=t.content,o=t.httpStatusCode,i=MsPortalFx.Base.Diagnostics.createIgnoreUnhandledRejectionError(JSON.stringify({httpStatusCode:o,message:s||t}),s?.stackTrace);throw i.httpStatusCode=o,[401,404,403].includes(o)&&(i.errorLevel=0),i}}))(e)}processNewSelectedSubscriptions(e){return(async()=>{const t=await w(),s=this._servicesSubscriptions.allSubscriptionsInfoMemo();return t.processSelectedSubscriptionChanges(this._diContainer,e,this._loadedSubscriptionsPromise,s,this.useAdvancedFiltersPromise)})()}};function F(e,t,s){b.trace({source:"Services.Subscriptions",action:"saveSelectedSubscriptions",data:{selectedSubscriptionsCount:t.length,first100SelectedSubscriptionIds:t.slice(0,100),reason:s}}),e.setSetting(6,n.Keys.subscriptionsSelected,t.join(";"))}function T(e){const t=1===e?a.subscriptionErrorSingleSubscription:a.subscriptionErrorPluralSubscription,s=a.subscriptionErrorDescription.format(e,t);y.ClientNotification.publish({title:a.subscriptionErrorTitle,description:s,status:y.NotificationStatus.Warning})}t.SubscriptionsUserContext=_,t.SubscriptionsUserContext=_=__decorate([__metadata("fx:diagnostics",[e,"SubscriptionsUserContext"]),(0,o.Class)(),__metadata("design:paramtypes",[o.Container,I,p.SettingsManager])],_),t.setInSessionSelectedSubscriptionsHandler=(0,h.defineHandler)(FxImpl.Azure.setInSessionSelectedSubscriptionsEndPoint,(e=>e.diContainer.get(_).setInSessionSelectedSubscriptions(e.messageArg))),t.searchForSubscriptionsHandler=(0,h.defineHandler)(FxImpl.Azure.searchForSubscriptionsEndPoint,(e=>e.diContainer.get(_).getSubscriptionSearchResults(e.messageArg))),t.getInSessionSelectedSubscriptionsObservableHandler=(0,h.defineHandler)(m.getInSessionSelectedSubscriptionsObservableEndPoint,(e=>e.diContainer.get(_).getInSessionSelectedSubscriptions())),t.getSubscriptionInfoHandler=(0,h.defineHandler)(FxImpl.Azure.getSubscriptionInfoEndPoint,(async e=>({...await e.diContainer.get(_).getSubscription(e.messageArg)}))),t.getInSessionDisplayedSubscriptionsHandler=(0,h.defineHandler)(r.Subscriptions.getInSessionDisplayedSubscriptionsEndPoint,(e=>e.diContainer.get(_).getInSessionDisplayedSubscriptions()))})),
define("MsPortalImpl/ReactViews/Browse.Prewarmer",["require","exports","FxHubs/ArtHelpers/ArtApis","Fx","FxHubs/ArtHelpers/ArgBrowseHelpers","Fx/ResourceManagement","FxHubs/ResourceManagement","FxHubs/ArtHelpers/KustoQueryGenerator","FxHubs/ArtHelpers/KustoQueryHelpers","FxHubs/Common/ResourcesOperationsCache","Fx/DependencyInjection","Fx/Errors","FxHubs/Common/AssetViewModelCommon","FxHubs/Common/AssetTypeCache","MsPortalImpl/ReactViews/ReactQueryStore","MsPortalImpl/Services/Services.Subscriptions"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useEdgeZones=t.respectOperationsCacheBeforeArgRequest=t.prewarmBrowseFrame=t.getSubscriptionsFromArg=t.getResourceTypeBrowseData=t.getColumnType=t.getColumnProjectionForFacet=t.getBrowsePreReqs=t.createKustoQueryGenerator=t.resourcesQuery=t.columnsDataQuery=t.browseDataQuery=t.defaultProjectedColumns=void 0;var f=MsPortalFx.Extension.ResourceRoutingType,x=MsPortalFx.Base.Diagnostics.Telemetry;const b=MsPortalFx.Resources.Strings.Browse,y=ko.utils.peekObservable;let v,M,C={};function P(e){const{browsePrereqs:s,columns:c,visibleColumns:d,resourceType:p,currentResourceTypes:u,kind:m,showHiddenTypes:h,searchTerm:g,filters:f,telemetrySource:b,sortColumns:y,groupByColumn:v,subscriptions:M,columnDataMap:C,scope:P,scopeParameters:w,useNamePrioritization:_}=e,F=s.browseQueryManifest,T=!!w;let D="";if(P){const e=n.ArmId.parse(P,!0);4===e.kind?D=`where ${(0,a.getPredicate)(7,["resourceGroup"],[e.resourceGroup])}`:[6,3,8].includes(e.kind)&&(D=`where ${(0,a.getPredicate)(9,["id"],[P+"/"])}`)}const B=(T?e=>{for(const t in w||[]){const s=w[t];e=e.replaceAll("{{parameters."+t+"}}","string"==typeof s?(0,a.encodeKustoValue)(s).slice(1,-1):s.map((e=>(0,a.encodeKustoValue)(e))).join(","))}return e}:e=>e)([F.browseQuery,D].filter((e=>!!e)).join("|")),A=(p||"").toLowerCase(),N=m?.toLowerCase(),R=k(A,F),L=[...(0,t.defaultProjectedColumns)(R),...c],O=[];v&&O.push({sortBy:v,order:1,sortFormat:null}),g&&_&&O.push({sortBy:"__hubs_search_priority_ranking",order:2,sortFormat:null}),y&&O.push(...y);const z={},H=MsPortalFx.unique(O,((e,t)=>e.sortBy===t.sortBy)),W=H?.length?H.map((e=>({sortColumn:e,mappingProvider:E(s,u,e,C[e.sortBy.toLowerCase()],M||[])}))):null;W&&L.push(...W.filter((e=>e.mappingProvider)).map((e=>e.mappingProvider.projectedColumn)));for(const e of F?.excludeColumns||[])MsPortalFx.remove(L,i.columnIdToArgColumnForReact[e]||i.columnIdToStringMapForReact[e]);const V=W?.length?W.map((e=>function(e,t,s){const o=t[e.sortBy.toLowerCase()],i=s||o?.sortColumn||e.sortBy,n=1===e.order?1:2;let r={sortBy:i,order:n};if(i.startsWith("tags.")){const e=i.slice(5).toLowerCase();r={sortBy:`tagsLowerCase[${(0,a.encodeKustoValue)(e,!0)}]`,order:n}}else if("__hubs_search_priority_ranking"===i)r={...r,castFunction:1};else switch(o?.format){case 4:r={...r,castFunction:5};break;case 3:r={...r,castFunction:4}}return r}(e.sortColumn,C,e.mappingProvider?.projectedColumn))):[];y?.length||V.push({sortBy:"name",order:1});const j=new a.KustoQueryGenerator(V,L,null,B);let q=!1;if(B){const e=(0,l.smartQuerySplit)(B);if(e.length&&e[0]){const t=e[0].trim().split(" ");q=!i.knownArgTopLevelOperatorsLowerCased.includes(t[0].toLowerCase())}}const $=!q&&("microsoft.resources/resourceswithtag"===A?7:"microsoft.resources/subscriptions/resourcegroups"===A?2:1);j.setSources($),j.setIncludeSubscriptionNameJoin(U(A,P));const G=[];if(W)for(const e of W)e.mappingProvider&&!z[e.mappingProvider.projectedColumn]&&(G.push(e.mappingProvider.provider),z[e.mappingProvider.projectedColumn]=!0);const K=[],J=[];h||o.forEachKey(s.assetTypes,((e,t)=>{K.push(e);const s=(0,r.supportsOption)(t.options,2);if(!("microsoft.resources/resources"===A||"microsoft.resources/subscriptions/resourcegroups"===A||"microsoft.resources/resourceswithtag"===A)&&u[e]){const i=t.kindMap&&o.forEachKey(t.kindMap,((e,t,s)=>(0,r.supportsOption)(t.options,2)&&e!==N&&s.push(e)),[])||[];t.defaultKind&&(0,r.supportsOption)(t.defaultKind.options,2)&&i.unshift(""),i.length&&J.push((0,l.buildTypeKindsExclusionQueryProvider)(e,i)),N&&s&&J.push((0,l.buildTypeExclusionWithKindInclusionQueryProvider)(e,[N]))}else if(s){const s=t.kindMap&&o.forEachKey(t.kindMap,((e,t,s)=>(0,r.supportsOption)(t.options,8)&&s.push(e)),[])||[];t.defaultKind&&(0,r.supportsOption)(t.defaultKind.options,8)&&s.unshift(""),s.length?J.push((0,l.buildTypeExclusionWithKindInclusionQueryProvider)(e,s)):J.push((0,l.buildTypeExclusionQueryProvider)(e))}else{const s=t.kindMap&&o.forEachKey(t.kindMap,((e,t,s)=>(0,r.supportsOption)(t.options,2)&&s.push(e)),[])||[];t.defaultKind&&(0,r.supportsOption)(t.defaultKind.options,2)&&s.unshift(""),s.length&&J.push((0,l.buildTypeKindsExclusionQueryProvider)(e,s))}}));const Q=h?[]:[...J];if("microsoft.resources/resourceswithtag"!==A&&"microsoft.resources/resources"!==A||h||Q.unshift({columnName:"type",comparisonType:7,value:K}),N){const e=[],t=s.assetTypes?.[A];if(t&&t.kindMap){const s=(t.kindMap[N]||{kinds:[N]}).kinds;e.push({columnName:"kind",comparisonType:7,value:s,nestedQueryProvider:{columnName:"type",comparisonType:7,value:A}})}e.length&&Q.unshift({queryProviders:e,operator:1})}const X={"==":2,"!=":12,"<":26,"<=":28,">=":29,">":27},Z={between:30,"!between":31},Y={"==":2,"!=":12,before:26,after:27},ee={between:30,"!between":31},te={"==":7,"!=":17},se={contains:6,"!contains":16,startswith:9,"!startswith":19,endswith:10,"!endswith":20},oe={"==":2,"!=":12},ie={contains:1,"!contains":11,startswith:4,"!startswith":14,endswith:5,"!endswith":15};let ne,re=0;f?.forEach((e=>{if(e.isAllValues)return;if(e.filter.key.startsWith("tags.")){ne||(ne=!0,G.push(...a.tagKeyClauses)),G.push("extend tagIndex=array_index_of(lowerTagKeys,tolower("+(0,a.encodeKustoValue)(e.filter.value,!0)+"))");const t="tagValue"+ ++re;if(G.push("extend "+t+"=iff(tagIndex==-1,'',tags[tostring(tagKeys[tagIndex])])"),oe[e.operator])Q.push({columnName:t,comparisonType:oe[e.operator],value:e.values.map((e=>e.value))});else{if(!ie[e.operator])throw new Error("Unhandled tag string operator: "+e.operator);Q.push({columnName:t,comparisonType:ie[e.operator],value:null===e.values[0].key?e.values[0].value:e.values[0].text})}return}const t=I(e.filter.value),o=S(t)&&E(s,u,{sortBy:e.filter.value,order:1,sortFormat:null},C[e.filter.value.toLowerCase()],M||[]);switch(o&&!z[o.projectedColumn]&&(G.push(o.provider),z[o.projectedColumn]=!0),e.filter.format){case 4:if(X[e.operator]){const s=e=>{const t=Number.parseFloat(e);return Number.isNaN(t)?0:t};Q.push({columnName:t,comparisonType:X[e.operator],value:s(e.values[0]?.text||"")})}else{if(!Z[e.operator])throw new Error("Unhandled number operator: "+e.operator);Q.push({columnName:t,comparisonType:Z[e.operator],value:e.values.map((e=>parseFloat(e?.text||"")))})}break;case 3:if(Y[e.operator])Q.push({columnName:t,comparisonType:Y[e.operator],value:e.values[0]?.text||""});else{if(!ee[e.operator])throw new Error("Unhandled date operator: "+e.operator);Q.push({columnName:t,comparisonType:ee[e.operator],value:e.values.map((e=>e?.text||""))})}break;default:if(te[e.operator])if("type"===e.filter.key&&e.values.some((e=>"string"!=typeof e.value))){const t=[];e.values.forEach((s=>{if("string"==typeof s.value)t.push({columnName:"type",comparisonType:7,value:s.value});else{if(!s.value.resourceTypeName)throw new Error("Unhandled type filter: "+JSON.stringify(e));{const e=s.value;if(e.resourceKindName){const s=[e.resourceKindName];e.additionalKinds&&s.push(...e.additionalKinds),t.push({columnName:"type",comparisonType:7,value:e.resourceTypeName,nestedQueryProvider:{columnName:"kind",comparisonType:7,value:s}})}else t.push({columnName:"type",comparisonType:7,value:e.resourceTypeName})}}})),Q.push({queryProviders:t,operator:1})}else Q.push({columnName:t,comparisonType:te[e.operator],value:e.values.map((e=>e.value))});else{if(!se[e.operator])throw new Error("Unhandled string operator: "+e.operator);Q.push({columnName:t,comparisonType:se[e.operator],value:e.values[0].text})}}}));const ae=[],le=[];let ce=!1;if(g){_&&(ae.push(a.tagsLowerCasePredicate),ae.push((0,a.buildNamePrioritizationPredicate)("__hubs_search_priority_ranking",g)),le.push((0,a.buildNamePrioritizationCleanupPredicate)("__hubs_search_priority_ranking"))),ce=!0;const e=function(e,t){const s=e.length,o=(e=e.slice(0,1e3)).split(" ");(s>1e3||o.length>10)&&x.trace({source:t,action:"TextFilterTruncated",data:{filterLength:s,tokenCount:o.length}});return o.splice(0,10)}(g,b),t=["name"];for(const e of d||L){const o=I(e);if(!z[e]){const t=S(o)&&E(s,u,{sortBy:e,order:1,sortFormat:null},C[e.toLowerCase()],M||[]);t&&!z[t.projectedColumn]&&(G.push(t.provider),z[t.projectedColumn]=!0)}t.push(o)}t.push("tagsLowerCase['hidden-title']");for(const s of e)Q.push({columnName:t.map((e=>`tostring(${e})`)),comparisonType:6,value:s})}return ce&&G.push(a.tagsLowerCasePredicate),j.setMappingProviders(G),j.setQueryProviders(Q),y?.some((e=>e?.sortBy?.startsWith("tags.")))&&ae.push(a.tagsLowerCasePredicate),j.setPreSortPredicates(ae),j.setPostSortPredicates(le),j.updateQuery(),j.addedTagKeyClauses=ne,j}function w(e){const t=(e.resourceType+(e.scope?":"+n.ArmId.parse(e.scope,!0).resourceType:"")).toLowerCase(),s=z(e.resourceType.toLowerCase()),o=!(0,i.areColumnsInitialized)(s),r={resourceType:e.resourceType,resourceTypeKey:t,includeColumnsVersion:o&&s,includeFavoriteViewId:!1};return(0,i.getBrowsePreRequisitesMemoized)(r)}function I(e){return"location"===e?"locationDisplayName":"type"===e?"typeDisplayName":"subscription"===e?"subscriptionDisplayName":e}function S(e){let t;switch(e){case"typeDisplayName":t="resourceType";break;case"locationDisplayName":t="location";break;case"subscriptionDisplayName":t="subscription";break;case"edgeZone":t="edgeZone"}return t}async function _(e,s,o){return t.browseDataQuery.bind(e,s,o).get()}async function F(e){const{searchTerm:t}=e;return await o.memoizePromise((async e=>{const t=new a.KustoQueryGenerator;t.setSources(4),t.setDefaultQueryPredicate(null),t.setIncludeSubscriptionNameJoin(!1),t.setQueryProviders(e?[{columnName:"name",comparisonType:6,value:e}]:null),t.setExpansionProviders(null),t.setPostExpandQueryProviders(null),t.setSuffixPredicates(["project name, subscriptionId, tenantId"]),t.setPrefixPredicates(null),t.updateQuery();const o={query:t.query(),options:{$top:1e3,$skipToken:""}},i=await s.getDataFromArt(o,"getSubscriptionsForReactBrowse"),n={subscriptions:[],totalRecords:i.totalRecords,sourceQuery:t.query()},r=i?.data;if(r){const e=r.columns.findIndex((e=>"name"===e.name)),t=r.columns.findIndex((e=>"subscriptionId"===e.name)),s=r.columns.findIndex((e=>"tenantId"===e.name));r.rows.forEach((o=>{n.subscriptions.push({displayName:o[e],subscriptionId:o[t],tenantId:o[s],uniqueDisplayName:null,authorizationSource:null,state:null,subscriptionPolicies:null})}))}return n}))(t)}function T(e,t,s,i,r){const a=d.container.get(c.ResourcesOperationsCache).getDeletedResourceIds(),l=d.container.get(c.ResourcesOperationsCache).getCreatedResourceGroups(),p=o.isFeatureEnabled("cachecreatedresources")?d.container.get(c.ResourcesOperationsCache).getCreatedResources():ko.observableArray([]);if(a?.().length||l?.().length||p?.().length){if(a?.().length){const t=e.getQueryProviders();t.push({columnName:"id",comparisonType:13,value:a()}),e.setQueryProviders(t)}const c=(t||"").toLowerCase(),d="microsoft.resources/resourceswithtag"!==c&&(!s?.browseQueryManifest.browseQuery||s?.browseQueryManifest.edgeZonesSupported)&&o.isFeatureEnabled("argbrowseedgezones");if("microsoft.resources/subscriptions/resourcegroups"===c&&l?.().length){const t=[["id","string"],["name","string"],["type","string"],["location","string"],["subscriptionId","string"],["resourceGroup","string"],["kind","string"],["tags","dynamic"],["status","string"]];d&&t.push(["extendedLocation","dynamic"]);const s=e=>{const t=[e.armResourceGroup.id,e.armResourceGroup.name,"microsoft.resources/subscriptions/resourcegroups",e.armResourceGroup.location,e.subscriptionId,e.armResourceGroup.name,"",e.armResourceGroup.tags??{},e.armResourceGroup.properties?.provisioningState];return d&&t.push(null),t},o={dataTableHeader:t,dataTableRows:l().filter((e=>!U(c,r)&&(!r||e.armResourceGroup.id.includes(r)))).map((e=>s(e))),upstreamDataFilterColumn:"id"};e.setInlineDataSource(o)}if(p?.().length){const t=[["id","string"],["name","string"],["type","string"],["location","string"],["subscriptionId","string"],["resourceGroup","string"],["kind","string"],["tags","dynamic"]];d&&t.push(["extendedLocation","dynamic"]);const s=e=>{const t=n.ArmId.parse(e.id),s=[e.id,e.name,e.type,e.location,t.subscription,t.resourceGroup,e.kind??"",e.tags??{}];return d&&s.push(null),s},o={dataTableHeader:t,dataTableRows:p().filter((e=>!U(c,r)&&(!r||e.id.includes(r))&&"microsoft.resources/resources"===c||i[e.type?.toLowerCase()])).map((e=>s(e))),upstreamDataFilterColumn:"id"};e.setInlineDataSource(o)}e.updateQuery()}}function k(e,t){return"microsoft.resources/resourceswithtag"!==e&&(!t.browseQuery||t.edgeZonesSupported)&&o.isFeatureEnabled("argbrowseedgezones")}async function D(e,t,s,r,a){a&&(C={name:1,kind:2,resourceGroup:3,location:4,locationId:5,resourceId:6,resourceGroupId:7,resourceType:8,subscription:9,subscriptionId:10,assetType:11,tagsArray:12});const l={},c=e.browsePrereqs?.browseQueryManifest,d=n.ArmId.parse(r,!0),p=!c?.browseQuery||c?.edgeZonesSupported;let u=[6,3,8].includes(d.kind)?function(e,t){const s=[B(11,e,b.Columns.AssetType,0),B(4,e,b.Columns.Location,1),B(3,e,b.Columns.ResourceGroup,-1,!0),B(9,e,b.Columns.Subscription,-1,!0),B(2,e,b.Columns.Kind,-1,!0),B(7,e,b.Columns.ResourceGroupId,-1,!0),B(5,e,b.Columns.LocationId,-1,!0),B(6,e,b.Columns.ResourceId,-1,!0),B(8,e,b.Columns.ResourceType,-1,!0),B(10,e,b.Columns.SubscriptionId,-1,!0),B(12,e,b.Columns.Tags,-1,!0)];t&&o.isFeatureEnabled("argbrowseedgezones")&&s.push(B(13,e,b.Columns.EdgeZone,-1,!0));return s}(e.columnIdToStringMap,p):4===d.kind?function(e,t){const s=[B(11,e,b.Columns.AssetType,0),B(4,e,b.Columns.Location,1),B(3,e,b.Columns.ResourceGroup,-1,!0),B(9,e,b.Columns.Subscription,-1,!0),B(2,e,b.Columns.Kind,-1,!0),B(7,e,b.Columns.ResourceGroupId,-1,!0),B(5,e,b.Columns.LocationId,-1,!0),B(6,e,b.Columns.ResourceId,-1,!0),B(8,e,b.Columns.ResourceType,-1,!0),B(10,e,b.Columns.SubscriptionId,-1,!0),B(12,e,b.Columns.Tags,-1,!0)];t&&o.isFeatureEnabled("argbrowseedgezones")&&s.push(B(13,e,b.Columns.EdgeZone,-1,!0));return s}(e.columnIdToStringMap,p):function(e,t,s){const i=[B(11,e,b.Columns.AssetType,0)];t.includes(3)||i.push(B(3,e,b.Columns.ResourceGroup,1));t.includes(4)||i.push(B(4,e,b.Columns.Location,2));t.includes(10)||i.push(B(9,e,b.Columns.Subscription,3));i.push(B(2,e,b.Columns.Kind,-1,!0)),t.includes(3)||i.push(B(7,e,b.Columns.ResourceGroupId,-1,!0));t.includes(4)||i.push(B(5,e,b.Columns.LocationId,-1,!0));i.push(B(6,e,b.Columns.ResourceId,-1,!0),B(8,e,b.Columns.ResourceType,-1,!0)),t.includes(10)||i.push(B(10,e,b.Columns.SubscriptionId,-1,!0));t.includes(12)||i.push(B(12,e,b.Columns.Tags,-1,!0));s&&o.isFeatureEnabled("argbrowseedgezones")&&i.push(B(13,e,b.Columns.EdgeZone,-1,!0));return i}(e.columnIdToStringMap,e.browsePrereqs?.browseQueryManifest?.excludeColumns||[],p);const h={},g={};c?.defaultColumns&&(c.defaultColumns.forEach(((e,t)=>{"string"==typeof e?g[e]={visible:!0,index:t}:h[e]={visible:!0,index:t}})),u.forEach((e=>{e.visible=(h[C[e.id]]||{visible:!1}).visible,e.index=(h[C[e.id]]||{index:-1}).index})));for(const e of c?.columns||[])l[e.name]=e,u.push({id:e.name,name:e.displayName,visible:(g[e.name]||{visible:!1}).visible,description:e.description,index:(g[e.name]||{index:-1}).index});u=u.sort(((e,t)=>e.index-t.index));const x="microsoft.resources/resourceswithtag"===t,v=a?1:z(t.toLowerCase());let M;a?await async function(e){const t=await(0,m.getMergedResourceTypeSingleAssetTypeInformation)(e,!0),s=t?.base?.routingType===f.Tenant?function(){const e=[A(11,b.Columns.AssetType),A(4,b.Columns.Location),A(2,b.Columns.Kind,!0),A(5,b.Columns.LocationId,!0),A(6,b.Columns.ResourceId,!0),A(8,b.Columns.ResourceType,!0),A(12,b.Columns.Tags,!0)];return e}():function(){const e=[A(11,b.Columns.AssetType),A(3,b.Columns.ResourceGroup),A(4,b.Columns.Location),A(9,b.Columns.Subscription),A(2,b.Columns.Kind,!0),A(7,b.Columns.ResourceGroupId,!0),A(5,b.Columns.LocationId,!0),A(6,b.Columns.ResourceId,!0),A(8,b.Columns.ResourceType,!0),A(10,b.Columns.SubscriptionId,!0),A(12,b.Columns.Tags,!0)];return e}(),o=t?.associated?.length>0,n=new Map;let r=[],a=[];const l=t?.base;if(V(l,2)){const e=await N(l),s=e.columns||[];s.forEach((e=>{n.set(e.id,[l.compositeDisplayName.lowerPlural])})),r=s,a=e.defaultColumns,o&&(MsPortalFx.remove(a,11),a.unshift(11));const i=[];t.associated.forEach((e=>{if(V(e,2)){const t=N(e).then((e=>{const t=e.columns||[];t.forEach((e=>{const t=e.id,s=l.compositeDisplayName.lowerPlural;n.get(t)?n.get(t).push(s):n.set(t,[s])})),r=MsPortalFx.pushUnique(r,t,((e,t)=>{return s=e.name(),o=t.name(),s===o||(s||"").toLowerCase()===(o||"").toLowerCase();var s,o}))}));i.push(t)}})),await Promise.all(i)}if(r.forEach((e=>{s.push({id:e.id,itemKey:e.itemKey,name:e.name(),visible:!1,format:e.format,formatOptions:e.formatOptions,description:y(e.description)})})),a){const e=a.map((e=>W(e))),t=W(9);e.includes(t)||l?.routingType===f.Tenant||e.push(t);for(let t=e.length-1;t>=0;t--){const o=MsPortalFx.findIndex(s,(s=>s.id===W(e[t])));o>=0&&s.splice(0,0,s.splice(o,1)[0])}for(let t=0;t<s.length;t++)s[t].visible=t<e.length}const c=l?.resourceType||e;(0,i.setDefaultBrowseColumns)(c,"",1,s)}(t):(0,i.setDefaultBrowseColumns)(x?"microsoft.resources/resources":t,x?"tags":r,v,u.map((e=>"type"===e.id?{...e,id:"assetType"}:e))),M=(0,i.getVisibleBrowseColumns)(x?"microsoft.resources/resources":t,x?"tags":r,v)().map((e=>"assetType"===e.id?{...e,id:"type"}:e));const P=u.filter((e=>e.visible)).sort(((e,t)=>e.index-t.index));if(s&&"_default_"!==s.id)if(s?.gridColumns?.length){const e=e=>{switch(e.toLowerCase()){case"typedisplayname":case"assettype":return"type";case"locationdisplayname":return"location";case"subscriptiondisplayname":return"subscription"}return e},t={};s.gridColumns.forEach(((s,o)=>t[e(s.id.toLowerCase())]={index:o,...s})),M=u.map((e=>t[e.id.toLowerCase()]?{...e,visible:!1!==t[e.id.toLowerCase()].visible,index:t[e.id.toLowerCase()].index}:null)).filter((e=>e?.visible)).sort(((e,t)=>e.index-t.index))}else M=P;const w={name:{name:"name",displayName:b.name,format:1},type:{name:"type",displayName:b.type,format:1,sortType:"resourceType"},location:{name:"location",displayName:b.location,format:5,sortType:"location"},resourcegroup:{name:"resourceGroup",displayName:b.resourceGroup,format:2},subscription:{name:"subscription",displayName:b.subscription,format:2,sortColumn:"subscriptionId",sortType:"subscription"},locationid:{name:"locationId",displayName:b.Columns.LocationId.title,format:1,sortColumn:"location"},edgezone:{name:"edgeZone",displayName:b.Columns.EdgeZone.title,format:1,sortType:"edgeZone"},kind:{name:"kind",displayName:b.Columns.Kind.title,format:1},resourcegroupid:{name:"resourceGroupId",displayName:b.Columns.ResourceGroupId.title,format:1,sortColumn:"resourceGroup"},resourceid:{name:"resourceId",displayName:b.Columns.ResourceId.title,format:1,sortColumn:"id"},resourcetype:{name:"resourceType",displayName:b.Columns.ResourceType.title,format:1,sortColumn:"type"},subscriptionid:{name:"subscriptionId",displayName:b.Columns.SubscriptionId.title,format:1},tagsarray:{name:"tagsArray",displayName:b.Columns.Tags.title,format:1}};return Object.values(l).forEach((e=>{let t,s;switch(e.format){case 5:t="location";break;case 7:t="tenant"}e.sortColumn&&(s="string"==typeof e.sortColumn?e.sortColumn:Object.keys(C).find((t=>C[t]===e.sortColumn))),w[e.name.toLowerCase()]={name:e.name,displayName:e.displayName,format:e.format,sortColumn:s,sortType:t}})),{columnIdToResourceColumnMap:C,manifestColumnsMap:l,visibleColumns:M,defaultVisibleColumns:P,columnDataMap:w}}function E(e,t,s,i,n){if(s.sortBy.startsWith("tags.")||"__hubs_search_priority_ranking"===s.sortBy)return null;if(!i)throw new p.FxError("columnData was null for column '"+s.sortBy+"'");const r=i.sortColumn||i.name;if("resourceType"===i.sortType){const s=o.forEachKey(e.assetTypes,((e,s,i)=>{if(e&&s&&(!Object.keys(t).length||t[e.toLowerCase()])){const t=s.displayName?.singular||e;let n,r;s.defaultKind?.displayName?.singular&&(n=s.defaultKind.displayName?.singular),s.kindMap&&(r=o.forEachKey(s.kindMap,((e,s,o)=>{o[e]=s.displayName?.singular||t}),{})),i[e]={displayName:n||t,subValueDisplayNames:r}}}),{}),i=`${r}DisplayName`;return{projectedColumn:i,provider:(0,a.buildDisplayNameMapProvider)({columnName:r,mappedColumnName:i,subValueColumnName:"kind",displayNameMapFunc:()=>s})}}if("location"===i.sortType){const t=MsPortalFx.extendStringMapIntoMap(Object.create(null),e.locations,(e=>({displayName:e.displayName}))),s=`${r}DisplayName`;return{projectedColumn:s,provider:(0,a.buildDisplayNameMapProvider)({columnName:r,mappedColumnName:s,displayNameMapFunc:()=>t})}}if("subscription"===i.sortType){const e=`${i.name}DisplayName`;return{projectedColumn:e,provider:(0,a.buildDisplayNameMapProvider)({columnName:r,mappedColumnName:e,displayNameMapFunc:()=>MsPortalFx.convertArrayToMap(n,(e=>e.subscriptionId),(e=>({displayName:e.displayName})))})}}if("edgeZone"===i.sortType){const e="edgeZone";return{projectedColumn:e,provider:(0,a.buildIifMapProvider)({predicate:'isnotnull(extendedLocation) and extendedLocation.type =~ "edgezone"',trueValue:"extendedLocation.name",falseValue:'""',mappedColumnName:e})}}if("tenant"===i.sortType){const t=MsPortalFx.extendStringMapIntoMap(Object.create(null),e.directoriesMap,(e=>({displayName:e.displayName}))),s=`${i.name}DisplayName`;return{projectedColumn:s,provider:(0,a.buildDisplayNameMapProvider)({columnName:r,mappedColumnName:s,displayNameMapFunc:()=>t})}}}function B(e,t,s,o,i){const n={id:t?.[e]||e.toString(),name:s.title,description:s.description,visible:!i,index:o};return C[n.id]=e,n}function A(e,t,s){return{id:i.columnIdToStringMapForReact[e],name:t.title,description:t.description,visible:!s}}async function N(e){const t=(await("HubsExtension"===e.extensionName?(0,u.getAssetTypeViewModel)(e):(0,u.getAssetTypeViewModel)(e,{keepReturnsIn:"getBrowseConfig",method:"getBrowseConfig",args:[{}]}))).getAssetTypeContract(2);return MsPortalFx.first(t._msPortalFx_earlyExecgetBrowseConfig)||t.getBrowseConfig()}function R(e){return"microsoft.resources/resources"===e.resourceType?.toLowerCase()||"microsoft.resources/resourceswithtag"===e.resourceType?.toLowerCase()?Promise.resolve({compositeDisplayName:b.AssetTypeNames.AllResource,extensionName:"HubsExtension"}):(0,m.getResourceTypeSingleAssetTypeInformation)(e.resourceType).then((e=>e))}function L(e,t,s){return"string"==typeof e?e:t[e]||s[e]}function O(e,t){const{name:s,iconColumn:o,bladeParameterColumn:i,sortColumn:n}=e,{columnIdToArgColumn:r,columnIdToStringMap:a}=t,l=[s],c=[o,i,n];for(const e of c)e&&l.push(L(e,r,a));return l}function z(e){return"microsoft.resources/resources"===e||"microsoft.resources/subscriptions/resourcegroups"===e||"microsoft.resources/resourceswithtag"===e?1:2}async function H(e){const t=n.ArmId.parse(e,!0);return 1===t.kind?await d.container.get(g.SubscriptionsUserContext).getSubscription(t.subscription):await d.container.get(g.SubscriptionsUserContext).getSubscription(e)}function U(e,t){const s=n.ArmId.parse(t,!0);return("microsoft.resources/resources"===e||"microsoft.resources/subscriptions/resourcegroups"===e)&&o.isFeatureEnabled("argbrowsemgscope")&&8===s.kind&&"microsoft.management/managementgroups"===s.resourceType.toLowerCase()}function W(e){return"number"==typeof e&&i.columnIdToStringMapForReact[e]||("number"==typeof e||e)&&e.toString()}function V(e,t){return e?.viewModel&&(0,r.supportsContract)(e.contracts,t)}t.defaultProjectedColumns=e=>MsPortalFx.isFeatureEnabled("argbrowseedgezones")&&e?["id","name","type","kind","location","subscriptionId","resourceGroup","tags","extendedLocation"]:["id","name","type","kind","location","subscriptionId","resourceGroup","tags"],t.browseDataQuery=(0,h.registerQuery)({name:"Browse::BrowseData",cacheOptions:{staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:(e,t)=>`${e}-${t}`,query:(e,t)=>Promise.all([R({resourceType:e}),w({resourceType:e,scope:t})]).then((t=>{const[s,o]=t;return(0,i.initializeColumnsWithSettings)(z(e.toLowerCase()),o.columnSettings),{resourceTypeDetails:s,browsePrereqs:o,columnIdToArgColumn:i.columnIdToArgColumnForReact,columnIdToStringMap:i.columnIdToStringMapForReact,emptyBrowseLink:"https://go.microsoft.com/fwLink/?LinkID=845598"}}))}),t.columnsDataQuery=(0,h.registerQuery)({name:"Browse::ColumnsData",cacheOptions:{scope:"view",staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:(e,t,s,o)=>`${t}-${s}-${o?.id}`,query:(e,s,o,i)=>v||t.browseDataQuery.bind(e,s,o).get().then((e=>D(e,s,i,o)))}),t.resourcesQuery=(0,h.registerQuery)({name:"Browse::PrefetchedResources",cacheOptions:{scope:"view",staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:()=>"",query:()=>M,onError:()=>{}}),t.createKustoQueryGenerator=P,t.getBrowsePreReqs=w,t.getColumnProjectionForFacet=I,t.getColumnType=S,t.getResourceTypeBrowseData=_,t.getSubscriptionsFromArg=F,t.prewarmBrowseFrame=function(e,i,r,a){let l=!1,c=!1,p=!1;if(["browse.reactview","browseall.reactview","browseresource.reactview","browseresourcegroups.reactview","resourcegroupoverview.reactview"].includes(e.toLowerCase())?(l=!0,c=!0):["armbrowse.reactview"].includes(e.toLowerCase())&&(l=!0,p=!0),l){const{kind:l,view:u}=i.parameters,m={"browseall.reactview":"microsoft.resources/resources","browseresourcegroups.reactview":"microsoft.resources/subscriptions/resourcegroups","resourcegroupoverview.reactview":"microsoft.resources/resources"}[e.toLowerCase()]||i.parameters.resourceType,h="resourcegroupoverview.reactview"===e.toLowerCase()?i.parameters.id:i.parameters.scope,f=i.parameters.scopeParameters,x=u||{id:"_default_",version:"1.0"},y=_(r,m,h);t.browseDataQuery.bind(r,m,h).get(),v=y.then((e=>D(e,m,x,h,p))),t.columnsDataQuery.bind(r,r,m,h,u).get({force:!0}),c&&(M=Promise.all([y,v]).then((([e,t])=>async function(e,t,i,r,a,l,c,p,u,m){let h={};const f=a.toLowerCase(),x=r?.browsePrereqs,y=x?.browseQueryManifest||{};if(y.mergedResourceTypes){"microsoft.resources/resourceswithtag"!==f&&(h={[f]:{resourceTypeName:a,selected:!0}});for(const e of y.mergedResourceTypes)h[e.resourceTypeName.toLowerCase()]=e}const v=await async function(e,t,s){if(s){if(s.subscriptionId){const e=s.subscriptionId;return"string"==typeof e?[await H(e)]:await Promise.all(e.map((e=>H(e))))}return[...await MsPortalFx.Azure.getSelectedSubscriptions()]}const o=n.ArmId.parse(t,!0);return U(e,t)?(await F({})).subscriptions:o?.subscription?[await d.container.get(g.SubscriptionsUserContext).getSubscription(o.subscription)]:[...await MsPortalFx.Azure.getSelectedSubscriptions()]}(a,p,u),M=function(e){const t={"microsoft.resources/resources":"All","microsoft.resources/subscriptions":"Subscriptions","microsoft.resources/subscriptions/resourcegroups":"ResourceGroups","microsoft.resources/resourceswithtag":"TagResources","microsoft.management/managementgroups":"ManagementGroups"},s=(e||"").toLowerCase();return t[s]||"Resources:"+s}(f),I=[],S=!!r?.resourceTypeDetails?.resourceType,_=S&&"microsoft.resources/subscriptions/resourcegroups"===r.resourceTypeDetails?.resourceType.toLowerCase(),k=S&&"microsoft.resources/resourceswithtag"===r?.resourceTypeDetails?.resourceType.toLowerCase(),D=S&&1===r.resourceTypeDetails?.routingType,E=y.excludeColumns?.includes(4),B=y.excludeColumns?.includes(10),A=[{name:11,displayName:b.Columns.AssetType.title,format:1},!_&&!D&&{name:3,displayName:b.Columns.ResourceGroup.title,format:2},!E&&{name:4,displayName:b.Columns.Location.title,format:5},!D&&!B&&{name:9,displayName:b.Columns.Subscription.title,format:2},{name:2,displayName:b.Columns.Kind.title,format:1},!_&&!D&&{name:7,displayName:b.Columns.ResourceGroupId.title,format:1},!E&&{name:5,displayName:b.Columns.LocationId.title,format:1},{name:6,displayName:b.Columns.ResourceId.title,format:1},{name:8,displayName:b.Columns.ResourceType.title,format:1},!D&&!B&&{name:10,displayName:b.Columns.SubscriptionId.title,format:1},!y.excludeColumns?.includes(12)&&{name:12,displayName:b.Columns.Tags.title,format:1},!k&&(!y.browseQuery||y.edgeZonesSupported)&&o.isFeatureEnabled("argbrowseedgezones")&&{name:13,displayName:b.Columns.EdgeZone.title,format:1}].filter((e=>!!e)),N={};for(const e of t)N[C[e.id]||e.id]=e,i[e.id]&&(I.push(i[e.id]),A.push(i[e.id]));let R;if(m?.gridColumns){R=m.gridColumns.filter((e=>e.visible)).map((e=>i[e.id])).filter((e=>!!e)).map((e=>O(e,r))).reduce(((e,t)=>[...e,...t]),[])}else R=I.map((e=>O(e,r))).reduce(((e,t)=>[...e,...t]),[]);const z=[];if(m?.filterFacets&&r){const{columnIdToArgColumn:e,columnIdToStringMap:t}=r;m.filterFacets.forEach((s=>{const o=s.key||s.filter?.key;A.find((s=>L(s.name,e,t).toLowerCase()===o.toLowerCase()))}))}const W=e=>{switch(e.toLowerCase()){case"typedisplayname":case"assettype":return"type";case"locationdisplayname":return"location";case"subscriptiondisplayname":return"subscription"}return e};let V;if(m?.groupByValue&&r){const{columnIdToArgColumn:e,columnIdToStringMap:t}=r,s=W(m.groupByValue),o=A.find((o=>L(o.name,e,t).toLowerCase()===s.toLowerCase()));o&&(V=L(o.name,e,t))}const j=[];if(m?.sortedColumns&&r){const{columnIdToArgColumn:e,columnIdToStringMap:t}=r;m.sortedColumns.forEach((s=>{const o=W(s.sortBy),i=A.find((s=>L(s.name,e,t).toLowerCase()===o.toLowerCase()));if(i){const o=L(i.name,e,t);o!==V&&j.push({sortBy:o,order:s.order,sortFormat:null})}}))}else j.push({sortBy:"name",order:1,sortFormat:"string"});const q=n.ArmId.parse(p,!0);if(y.mergedResourceTypes){const e=r.browsePrereqs.browseQueryManifest.mergedResourceTypes.filter((e=>e.selected)),t=0===e.length||e.length===r.browsePrereqs.browseQueryManifest.mergedResourceTypes.length;z.push({filter:{key:"type",text:b.mergedType,value:"type",format:1},operator:"==",values:!t&&e.map((e=>{const t=function(e,t,s){const o=e?.browsePrereqs?.assetTypes[t.toLowerCase()],i={plural:t,lowerPlural:t,singular:t,lowerSingular:t};if(!o)return i;if(o.kindMap&&s){const e=o.kindMap[s.toLowerCase()]||o.defaultKind;if(e)return e.displayName||o.displayName||i}return o.displayName||i}(r,e.resourceTypeName,e.resourceKindName);return{key:e.resourceTypeName.toLowerCase(),value:e,text:t.plural}}))||[],isAllValues:t})}const $={startIndex:0,currentResourceTypes:h,managementGroups:U(a,p)?[n.ArmId.getResourceNames(q)[0]]:void 0,pageSize:100,reason:"initial load",browseData:r,columns:R,visibleColumns:t.map((e=>e.id)),resourceType:a,subscriptions:v,telemetrySource:M,showHiddenTypes:m?.showAll,kind:l,searchTerm:m?.filter||"",filters:z,sortColumns:j,groupByColumn:V,columnDataMap:c,scope:p,scopeParameters:u};return async function(e,t){const{columns:o,visibleColumns:i,startIndex:r,currentResourceTypes:a,kind:l,managementGroups:c,pageSize:d,subscriptions:p,reason:u,resourceType:m,showHiddenTypes:h,telemetrySource:g,searchTerm:f,filters:x,browseData:b,sortColumns:y,groupByColumn:v,columnDataMap:M,scope:C,scopeParameters:I}=e,S=b?.browsePrereqs||await w({resourceType:m}),_=t.getBooleanValue("NameSearchPrioritization"),F=P({browsePrereqs:S,columns:o,visibleColumns:i,resourceType:m,currentResourceTypes:a,kind:l,showHiddenTypes:h,searchTerm:f,filters:x,telemetrySource:g,sortColumns:y,groupByColumn:v,columnDataMap:M,scope:C,scopeParameters:I,subscriptions:p,useNamePrioritization:_}),k={$top:d,$skip:r,$skipToken:""},D=F.query();T(F,m,S,a,C);const E={query:F.query(),options:k};1!==b?.resourceTypeDetails?.routingType&&(p?.length?E.subscriptions=p.map((e=>e.subscriptionId)):c&&(E.managementGroups=c));const B=await s.getDataFromArt(E,`${g}.${u}`,256),A=B.data||{},N=MsPortalFx.convertArrayToMap(A.columns,(e=>e.name),((e,t)=>t));return{resources:A.rows.map((e=>{const t={};(A.columns||[]).forEach(((s,o)=>{const i=MsPortalFx.replaceAll(s.name,"_",".");t[i]=e[o]}));const s=e[N.id];return t.resourceId=s,t.name=n.ResourceName.getDisplayName({id:s,name:e[N.name],armId:n.ArmId.parse(s,!0),tags:e[N.tags]||{}})||e[N.name],t.location=e[N.location],t.resourceKind=e[N.kind],t})),sourceQuery:D,totalRecords:B.totalRecords}}($,e)}(a,t.visibleColumns,t.manifestColumnsMap,e,m,l,t.columnDataMap,h,f,x))),t.resourcesQuery.bind(r).get({force:!0}))}},t.respectOperationsCacheBeforeArgRequest=T,t.useEdgeZones=k})),
define("MsPortalImpl/AzFramework/AzHost.Browse",["require","exports","FxHubs/ArtHelpers/ArtApis","FxHubs/ResourceCommands/BrowseCommanding","Fx","Fx/Pinner","Fx/ResourceManagement","Fx/Composition","FxHubs/RpcEndPointsCore","FxHubs/ArtHelpers/KustoQueryGenerator","MsPortalImpl/ReactViews/Browse.Prewarmer","Fx/DependencyInjection","FxHubs/ArtHelpers/ArgBrowseHelpers","FxHubs/ArtBrowse/ArtBrowseArea","Fx/Experimentation","Fx/Errors","FxHubs/Tags/TagsStartup","FxHubs/ArmClient","FxHubs/ArtHelpers/ArgBrowseHelpers","FxHubs/ArtHelpers/ZeroSubsExperience","FxHubs/RpcEndPoints","MsPortalImpl/Services/Services.Subscriptions","FxHubs/Common/UserSettingsHelper"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerBrowseHandlers=void 0;MsPortalFx.Extension;var P=MsPortalFx.Base.Diagnostics.Telemetry;const w=MsPortalFx.Resources.Strings.Browse,I=()=>i.require("FxHubs/ArmHelpers/ArmTags"),S=MsPortalFx.Base.Diagnostics.createLog(e),_={1:{column:2,facet:3},2:{column:2,facet:3},4:{column:5,facet:5},5:{column:2,facet:3},3:{column:4,facet:4},7:{column:2,facet:3},8:{column:2,facet:3}};async function F(e){const t={},s={},o=e.modelParameters.resources.map((e=>({name:e.resourceName,id:e.resourceId,type:e.resourceType,kind:e.kind}))),i=e.modelParameters.browseData.resourceTypeDetails.resourceType,n=e.modelParameters.browseData.browsePrereqs.browseQueryManifest,r=n.mergedResourceTypes?.length>0,a=()=>{o.forEach((o=>{if(o.kind){const i=o.kind,a=s[o.type?.toLowerCase()]||{};if(a[i])return;const l=r?t[o.type?.toLowerCase()]:n,c=function(e,t,s){let o=[];if(t){const i=e.kindCommandNameMapping&&e.kindCommandNameMapping[t.toLowerCase()],n=i&&e.kindCommands?.[i.toLowerCase()];o=s?n?.selectionCommands:n?.commands,o?.length||s||(o=e?.commands?.commands)}else o=s?e?.commands?.selectionCommands:e?.commands?.commands;return o||[]}(l,i,!0)?.find((t=>t.label.toLowerCase()===e.modelParameters.commandDefinition.label.toLowerCase()));a[i]=c?.armCommandDefinitionOptions?.definitions?.[o.type?.toLowerCase()],s[o.type?.toLowerCase()]=a}})),MsPortalFx.require("FxHubs/ResourceCommands/BrowseBulkCommandImpl").then((t=>{new t.BulkCommandImpl(e.lifetime,"ExecuteArmCommand",{resourceType:i,hasSelectedItems:ko.observable(e.modelParameters.hasSelectedItems),selectedBrowseItems:ko.observable(o)},e.modelParameters.commandDefinition,e.modelParameters.apiVersionsMap).execute({button:6},s)}))};if(e.experimentAssignments.getStringValue("kindspecificcommandsincombinedbrowseview")?.toLowerCase()===i?.toLowerCase())if(r)if(t[i.toLowerCase()]=n,o.some((e=>!t[e.type?.toLowerCase()]))){const e=n.mergedResourceTypes.map((e=>e.resourceTypeName))?.reduce(((e,t)=>(e.includes(t)||e.push(t),e)),[]);l.Browse.getBrowseManifestsForResourceTypesEndpoint.invoke(FxImpl.Rpc.client,"fxw",e).then((s=>{e.forEach((e=>{t[e?.toLowerCase()]=s[e]})),a()}))}else a();else a()}async function T(){const e=await i.memoizePromise((()=>v.Impl.getAllSubscriptionsCount(p.container.get(FxImpl.Rpc.Client))))();return{type:e?.type||0,value:e?.value}}async function k(e,t){const{setting:s,settingKey:o}=t,i=e.get(C.UserSettingsHelper),n=await i.readSettings([s],15);return n?.[s]?.[o]}async function D(e){const{resourceType:t,scope:s}=e,o=(t+(s?":"+r.ArmId.parse(s,!0).resourceType:"")).toLowerCase();return(await p.container.get(m.DataContext).getSavedBrowseViews(o))()}async function E(e,t,s,o){return d.columnsDataQuery.bind(e,e,t,s,o).get()}async function B(e){try{const t={...e},{listScopeArmId:s,listScope:o}=e;if(4===s?.kind){const e=await(0,x.getResourceGroup)(o,"scope location");t.listScopeLocation=e?.location}else if([6,3,8].includes(s?.kind)){const e=await(0,x.getResource)(o,"scope location");t.listScopeLocation=e?.location}return await(0,u.getCreateBlade)(t,e.scope)}catch{return}}function A(e,t){const{telemetrySource:s,resourceType:i,kind:n,browseData:r,visibility:l,excludeCommands:c}=e,d=r?.browsePrereqs?.browseQueryManifest||{},p=(r?.browsePrereqs?.assetTypes||Object.create(null))[i?.toLowerCase()||""],u=p&&MsPortalFx.replaceAll(p.assetId,"_",""),m=u&&t.getStringValue(`BrowseCommands-${u}`);let h,g;if(!(c||[]).includes("generic")){h=o.createGenericCommandDescriptors(s,d,p,i,l,m?.toLowerCase(),r?.browsePrereqs?.assetTypes[i?.toLowerCase()]?.isDisabled,n);const e=t=>{t?.forEach((t=>{switch(t.itemType){case"openMarketplace":t.bladeReference=a.BladeReferences.forMarketplace().createReference({marketplaceId:t.commandDefinition.marketplaceItemId});break;case"menu":e(t.commandItems)}}))};e(h)}return(c||[]).includes("selection")||(g=o.createSelectionCommandDescriptors(s,d,p,i,l,m?.toLowerCase(),n,!0)),Promise.resolve({genericCommands:h,selectionCommands:g})}async function N(e){const{cardDefinition:t,browseQuery:o,subscriptions:i,telemetrySource:n,reason:r,resourceType:a}=e,l=t.manifest.countQuery.replace("[[sourceQuery]]",o),c=t.extension+":"+t.manifest.id,d={query:l,options:{$top:1e3,$skipToken:""},subscriptions:i.map((e=>e.subscriptionId))};try{const e=[10,30,60,300],o=await s.getDataFromArt(d,`${n}.${c.toLowerCase()}.${r}`,256,null,!1,{retryTimeoutsInSeconds:e,notifyRetry:(e,s,o)=>{const i=t.manifest.id.charAt(0).toUpperCase()+t.manifest.id.slice(1);P.trace({source:n,action:"BrowseLoadThrottle"+n+`${i}Count`,actionModifier:P.ActionModifier.Mark,data:{resourceType:a}})},skipErrorLogging:!1}),i=o?.data;if(1===i?.rows?.length){return{count:i.rows[0][0].toString()}}}catch(e){const t=MsPortalFx.getLogFriendlyMessage(e?.content?.error||e?.jqXHR);S.warning(new g.FxError({message:`Error fetching ${c}. Error: ${t}`,innerErrors:[e]}))}return{count:"-"}}async function R(e,t){const{reason:o,subscriptions:i,managementGroups:n,kind:r,visibleColumns:a,resourceType:l,currentResourceTypes:p,showHiddenTypes:u,filter:m,filterSearchTerm:h,searchTerm:g,filters:f,telemetrySource:x,browseData:b,columnDataMap:y,scope:v,scopeParameters:M}=e,C=b?.browsePrereqs||await(0,d.getBrowsePreReqs)({resourceType:l});let P=(0,d.getColumnProjectionForFacet)(m.value),w=(0,d.getColumnType)(P);const I=t.getBooleanValue("NameSearchPrioritization"),S=(0,d.createKustoQueryGenerator)({browsePrereqs:C,columns:[],visibleColumns:a,resourceType:l,currentResourceTypes:p,kind:r,showHiddenTypes:u,searchTerm:g,filters:f?.filter((e=>e.filter.key!==m.key)),telemetrySource:x,sortColumns:w&&[{sortBy:m.value,order:1,sortFormat:null}],columnDataMap:y,scope:v,scopeParameters:M,subscriptions:i,useNamePrioritization:I}),F=(l||"").toLowerCase(),T=(0,d.useEdgeZones)(F,C.browseQueryManifest);let k=!1;if(m.key.startsWith("tags.")){k=!0;const e=S.getPostExpandMappingProviders();S.addedTagKeyClauses||e.push(...c.tagKeyClauses),P="tagValue",w=void 0,e.push("extend tagIndex=array_index_of(lowerTagKeys,tolower("+(0,c.encodeKustoValue)(m.value,!0)+"))"),e.push("extend "+P+"=iff(tagIndex==-1,'',tags[tostring(tagKeys[tagIndex])])"),S.setPostExpandMappingProviders(e);const t=S.getProjectedColumns();t.includes(P)||(t.push(P),S.setProjectedColumns(t)),S.updateQuery()}else if(!(0,d.defaultProjectedColumns)(T).includes(P)){const e=S.getProjectedColumns();e.includes(P)||(e.push(P),S.setProjectedColumns(e)),S.updateQuery()}const D=function(e,t,s,o){const i=t?.[e.toLowerCase()];if(e.startsWith("tags.")||!i)return null;if((0,d.defaultProjectedColumns)(s).includes(e))return null;const n="column"===o?_[i?.format]?.column:_[i?.format]?.facet;if(!n)return null;return(0,c.extendColumnWithCastFunctionWrappedColumn)(e,n)}(P,y,T,"facet");D&&(S.setSuffixPredicates([D]),S.updateQuery());const E={query:S.query(),options:{$top:1,$skipToken:""},facets:[{expression:P,options:{$top:100,filter:h?P+" contains "+(0,c.encodeKustoValue)(h):null,sortOrder:"asc",sortBy:P}}]};1!==b.resourceTypeDetails?.routingType&&(i?.length?E.subscriptions=i.map((e=>e.subscriptionId)):n&&(E.managementGroups=n));const B=(await s.getDataFromArt(E,`${x}.${o}`)).facets||[];if(1===B.length){const e=MsPortalFx.convertArrayToMap(B[0].data.columns,(e=>e.name),((e,t)=>t)),t=e[P],s=e.count,o=k?new Map:FxImpl.lowerCaseStringMap(),i=B[0].data.rows.reduce(((e,o)=>{const i=o[t],n=e.get(String(i))||{name:i,count:0};return n.count+=parseInt(o[s]||"0"),e.set(String(i),n),e}),o),n={};return i.forEach(((e,t)=>n[String(t)]=e)),Promise.resolve({count:B[0].count,totalRecords:B[0].totalRecords,values:n})}return Promise.resolve({count:0,totalRecords:0,values:{}})}async function L(e,t){const{columns:o,visibleColumns:i,currentResourceTypes:n,kind:r,managementGroups:a,subscriptions:l,resourceType:c,showHiddenTypes:p,telemetrySource:u,searchTerm:m,filters:h,browseData:g,maxCsvItems:f,sortColumns:x,columnDataMap:b,scope:y,scopeParameters:v}=e,M=g?.browsePrereqs||await(0,d.getBrowsePreReqs)({resourceType:c}),C=t.getBooleanValue("NameSearchPrioritization"),P=(0,d.createKustoQueryGenerator)({browsePrereqs:M,columns:o,visibleColumns:i,resourceType:c,currentResourceTypes:n,kind:r,showHiddenTypes:p,searchTerm:m,filters:h,telemetrySource:u,sortColumns:x,columnDataMap:b,scope:y,scopeParameters:v,subscriptions:l,useNamePrioritization:C});let w=0;const I=async(e,t=0)=>{const o={$top:1e3,$skipToken:e};(0,d.respectOperationsCacheBeforeArgRequest)(P,c,M,n,y);const i={query:P.query(),options:o};1!==g?.resourceTypeDetails?.routingType&&(l?.length?i.subscriptions=l.map((e=>e.subscriptionId)):a&&(i.managementGroups=a));const r=await s.getDataFromArt(i,`Browse.${u}.DownloadCsv.${w}`),p=r.data||{},m=MsPortalFx.convertArrayToMap(p.columns,(e=>e.name),((e,t)=>t)),h=p.rows.map((e=>{const t={};return(p.columns||[]).forEach(((s,o)=>{const i=MsPortalFx.replaceAll(s.name,"_",".");t[i]=e[o]})),t.resourceId=e[m.id],t.name=e[m.name],t.location=e[m.location],t.resourceKind=e[m.kind],t})),x=t+h.length;if(r.$skipToken&&x<Math.min(f,r.totalRecords)){w++;const e=await I(r.$skipToken,x);return[...h,...e]}return h.slice(0,Math.min(f-t,h.length))};return I("")}async function O(e,t){const{columns:o,visibleColumns:i,startIndex:n,currentResourceTypes:a,kind:l,managementGroups:c,pageSize:p,subscriptions:u,reason:m,resourceType:h,showHiddenTypes:g,telemetrySource:f,searchTerm:x,filters:b,browseData:y,sortColumns:v,groupByColumn:M,columnDataMap:C,scope:P,scopeParameters:w}=e,I=y?.browsePrereqs||await(0,d.getBrowsePreReqs)({resourceType:h}),S=t.getBooleanValue("NameSearchPrioritization"),_=(0,d.createKustoQueryGenerator)({browsePrereqs:I,columns:o,visibleColumns:i,resourceType:h,currentResourceTypes:a,kind:l,showHiddenTypes:g,searchTerm:x,filters:b,telemetrySource:f,sortColumns:v,groupByColumn:M,columnDataMap:C,scope:P,scopeParameters:w,subscriptions:u,useNamePrioritization:S}),F={$top:p,$skip:n,$skipToken:""},T=_.query();(0,d.respectOperationsCacheBeforeArgRequest)(_,h,I,a,P);const k={query:_.query(),options:F};1!==y?.resourceTypeDetails?.routingType&&(u?.length?k.subscriptions=u.map((e=>e.subscriptionId)):c&&(k.managementGroups=c));const D=await s.getDataFromArt(k,`${f}.${m}`),E=D.data||{},B=MsPortalFx.convertArrayToMap(E.columns,(e=>e.name),((e,t)=>t));return{resources:E.rows.map((e=>{const t={};(E.columns||[]).forEach(((s,o)=>{const i=MsPortalFx.replaceAll(s.name,"_",".");t[i]=e[o]}));const s=e[B.id];return t.resourceId=s,t.name=r.ResourceName.getDisplayName({id:s,name:e[B.name],armId:r.ArmId.parse(s,!0),tags:e[B.tags]||{}})||e[B.name],t.location=e[B.location],t.resourceKind=e[B.kind],t})),sourceQuery:T,totalRecords:D.totalRecords}}async function z(e){return d.resourcesQuery.bind(e).get({force:!0})}async function H(e){return{subscriptions:(await(e.searchTerm?Q(FxImpl.Azure.searchForSubscriptionsEndPoint.invoke(p.container.get(FxImpl.Rpc.Client),"fx",e.searchTerm)):Q(v.Impl.getInSessionDisplayedSubscriptions(p.container.get(FxImpl.Rpc.Client))))).subscriptions.map((e=>e))}}async function U(e){const{subscriptions:t,maximumTags:s,searchTerm:o}=e,n=e.existingTagMap||Object.create(null),r=await(0,f.getAllTags)(p.container,t,s,!0,o,i.isFeatureEnabled("artbrowse"));let a;const l=r.errors;return l?.length&&(a=(r.completeFailure?w.ResourceTagsListPart.completeFailureMessage:w.ResourceTagsListPart.partialFailureMessage)+"\n\n"+l.join("\n")),r.tagItems.forEach((e=>{e.name||S.warning(new g.FxError({message:`Browse.ReactModel: found tag with no name. tagItems: ${JSON.stringify(r.tagItems)}`}));const t=e.name?.toLowerCase(),s="tags."+t;if(!n[s]){const t={id:s,name:e.name};n[s]=t}})),{tagNameMap:n,isError:r.completeFailure,statusMessage:a}}function W(e){return(0,b.getVisibleBrowseColumns)(e.resourceType,e.scopeResourceType,e.version)().map((e=>"assetType"===e.id?{...e,id:"type"}:e))}async function V(e){const{telemetrySource:t}=e,s=(await MsPortalFx.Base.Security.getUserInfo()).isGitHubUser;return(0,y.getZeroSubsPanels)({telemetrySource:t,isGitHubUser:s}).map((e=>({image:e.icon,title:e.panelTitle,description:e.panelDescription,button:{label:e.buttonText,link:e.buttonClickableLink.uri()},freeServiceLink:e.freeServiceClickableLink&&e.freeServiceClickableLink?.uri(),learnMoreLink:e.learnMoreClickableLink?.uri()})))}async function j(e){const t=await I(),s=new Map;Object.keys(e).forEach((t=>{s.set(t,e[t])}));const o=await t.handleTagsContextPaneResults(s);if(!o)return;const i=Object.create(null);return o.newTagsMap.forEach(((e,t)=>{i[t]=e})),i}async function q(e){return await p.container.get(m.DataContext).getSavedBrowseView(e.id)}function $(e){n.pin([new MsPortalFx.Composition.PartReference(e.partName,{id:e.resourceId},{extensionName:e.partExtensionName})],{notify:!0})}async function G(e){await l.Browse.saveBrowseViewEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",e)}function K(e){ee({setting:"PageSize",settingKey:"PageSize",settingValue:e})}function J(e){ee({setting:"CardToolbar",settingKey:"Hidden",settingValue:!e})}function X(e){ee({setting:"HoverCards",settingKey:"Visible",settingValue:e})}async function Z(e){return p.container.get(M.SubscriptionsUserContext).setInSessionSelectedSubscriptions(e.subscriptionIds)}function Y(e){return async(...t)=>{try{return await e(...t)}catch(e){const t=FxImpl.Azure.buildSimplifiedError(e);throw{isBrowseError:!0,errorMessage:w.apiError.format(t.message),errorCode:t.status}}}}async function ee(e){const{setting:t,settingKey:s,settingValue:o}=e,i=p.container.get(C.UserSettingsHelper);let n=await i.readSettings([t],15);n=n?.[s]||Object.create(null),n[s]=o,await i.writeSettings({[t]:n},void 0,15)}t.registerBrowseHandlers=function(e,t,s,o,i,n){e.set(3201,(e=>{t(Y(d.getResourceTypeBrowseData)(n,e.resourceType,e.scope),e)})),e.set(3202,(e=>{t(Y(d.getSubscriptionsFromArg)(e),e)})),e.set(3214,(e=>{t(Y(H)(e),e)})),e.set(3203,(async e=>{const t=await i.get(h.Experimentation).shellAssignments.whenAvailable();Y(F)({modelParameters:e,lifetime:o,experimentAssignments:t})})),e.set(3204,(e=>{Y($)(e.resourceToPin)})),e.set(3205,(e=>{t(Y(j)(e.newTags),e)})),e.set(3206,(async e=>{const s=await i.get(h.Experimentation).shellAssignments.whenAvailable();t(Y(A)(e,s),e)})),e.set(3207,(e=>{t(Y(B)(e),e)})),e.set(3208,(e=>{t(Y(k)(i,{setting:"HoverCards",settingKey:"Visible"}),e)})),e.set(3224,(e=>{t(Y(k)(i,{setting:"CardToolbar",settingKey:"Hidden"}).then((e=>!e)),e)})),e.set(3209,(async e=>{const s=await i.get(h.Experimentation).shellAssignments.whenAvailable();t(Y(L)(e,s),e)})),e.set(3210,(e=>{t(Y(N)(e),e)})),e.set(3211,(async e=>{const s=await i.get(h.Experimentation).shellAssignments.whenAvailable();t(Y(R)(e,s),e)})),e.set(3212,(e=>{t(Y(U)(e),e)})),e.set(3213,(async e=>{const s=await i.get(h.Experimentation).shellAssignments.whenAvailable();t(Y(O)(e,s),e)})),e.set(3215,(e=>{Y(Z)(e)})),e.set(3216,(e=>{t(Y(D)(e),e)})),e.set(3217,(e=>{t(Y(q)(e),e)})),e.set(3218,(e=>{t(Y(G)(e),e)})),e.set(3219,(e=>{s(e,Y(W)(e))})),e.set(3220,(e=>{Y(J)(e)})),e.set(3221,(e=>{Y(X)(e)})),e.set(3222,(e=>{t(Y(T)(),e)})),e.set(3223,(async e=>{t(Y(V)(e),e)})),e.set(3225,(e=>{t(Y(k)(i,{setting:"PageSize",settingKey:"PageSize"}),e)})),e.set(3226,(e=>{Y(K)(e)})),e.set(3227,(e=>{t(Y(E)(n,e.resourceType,e.scope,e.view),e)})),e.set(3228,(e=>{t(Y(z)(n),e)}))}})),
define("_generated/Less/MsPortalImpl/Interactions/Interactions.FullScreenMode.css",["module"],(function(e){"use strict";return{css:".fxs-portal-fullscreen .fxs-sidebar,.fxs-portal-fullscreen .fxs-topbar,.fxs-portal-fullscreen .fxs-journey-breadcrumb{display:none!important}.fxs-portal-fullscreen .fxs-startboard-button{display:none}.fxs-portal-fullscreen .fxs-startboard-dropdown,.fxs-portal-fullscreen .fxs-startboard-commandBar{display:none}.fxs-portal-fullscreen .fxs-startboard-title-next,.fxs-portal-fullscreen .fxs-startboard-commandBar-fullScreen{display:block}",moduleId:e.id}})),
define("MsPortalImpl/Interactions/Interactions.FullScreenMode",["require","exports","Fx/DependencyInjection","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.FullScreenMode.css"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FullScreenMode=void 0,(0,o.injectCss)(i);const n=document.body,r=n.classList;let a=class{constructor(){this.isActive=ko.observable(!1);new MutationObserver((()=>{this.isActive(r.contains("fxs-portal-fullscreen"))})).observe(n,{attributes:!0,attributeFilter:["class"]})}enter(){r.add("fxs-portal-fullscreen")}exit(){r.remove("fxs-portal-fullscreen")}toggle(){this.isActive()?this.exit():this.enter()}};t.FullScreenMode=a,t.FullScreenMode=a=__decorate([__metadata("fx:diagnostics",[e,"FullScreenMode"]),s.Class(),__metadata("design:paramtypes",[])],a)})),
define("MsPortalImpl/ReactViews/ShellReactQueries",["require","exports","MsPortalImpl/ReactViews/ReactQueryStore","FxInternal/Experimentation"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resourceGroupsQuery=t.locationsForCreateQuery=t.initialDropdownValuesQuery=t.globalSubscriptionsQuery=t.experimentationShellAssignmentsQuery=t.essentialsResourceInfoQuery=void 0,t.essentialsResourceInfoQuery=(0,s.registerQuery)({name:"Shell::EssentialsResourceInfo",cacheOptions:{scope:"view"},getArgsKey:(e,t,s)=>`${t}:${s}`,query:(e,t,s)=>MsPortalFx.require("FxInternal/Controls/Essentials").then((o=>o.getEssentialsResourceInfo(e,t,s)))}),t.experimentationShellAssignmentsQuery=(0,s.registerQuery)({name:"Shell::ExperimentationShellAssignments",cacheOptions:{scope:"session",staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:()=>"",query:e=>e.get(o.ExperimentationManager).shellAssignments.whenAvailable().then((e=>e?e.data:{flights:[],assignmentContext:null,variables:{}}))}),t.globalSubscriptionsQuery=(0,s.registerQuery)({name:"Shell::GlobalSubscriptions",cacheOptions:{scope:"session",staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:()=>"",query:e=>MsPortalFx.require("MsPortalImpl/Services/Services.Subscriptions").then((t=>e.get(t.SubscriptionsUserContext).getInSessionDisplayedSubscriptions().then((e=>e.subscriptions))))}),t.initialDropdownValuesQuery=(0,s.registerQuery)({name:"Shell::InitialDropdownValues",cacheOptions:{scope:"session"},getArgsKey:()=>"",query:async(e,s)=>Promise.all([MsPortalFx.require("MsPortalImpl/Services/Services.ProvisioningInitialValues"),t.globalSubscriptionsQuery.bind(s,e).get()]).then((([t,s])=>t.determineInitialValues(e,s)))}),t.locationsForCreateQuery=(0,s.registerQuery)({name:"Shell::LocationsForCreate",cacheOptions:{scope:"view"},getArgsKey:({subscriptionId:e,resourceTypes:t})=>`${e}:${t?.sort().join(",")}`,query:async e=>FxImpl.Azure.getLocationsForCreate(FxImpl.Rpc.client,e)}),t.resourceGroupsQuery=(0,s.registerQuery)({name:"Shell::ResourceGroups",cacheOptions:{scope:"view"},query:async e=>MsPortalFx.require("FxInternal/ResourceManagement/ResourceGroups").then((t=>t.getArmResourceGroups(e)))})})),
define("MsPortalImpl/Services/Services.ArmEvents",["require","exports","Fx/ResourceManagement","FxHubs/ArmHelpers/ArmIds","FxHubs/RpcEndPoints","FxInternal/AsyncLoader","Fx/DependencyInjection"],(function(e,t,s,o,i,n,r){"use strict";function a(e,t){return!e==!t&&e.toLowerCase()===t.toLowerCase()}Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToArmEventHandler=t.removeArmEventSubscriptionHandler=t.matchEventsHandler=t.createResourceDeletedEventHandler=t.ArmEvents=void 0;let l=class{constructor(){this.instanceHandlers=[]}subscribeToArmEvent(e,t,s){if(!(e.operationNameRegex||e.source||e.status||e.subStatus))throw new Error("At least one criteria must be specified.");const o=MsPortalFx.getUniqueId();return this.instanceHandlers.push({cookie:o,criteria:e,callback:t,eventLimit:s}),o}removeArmEventSubscription(e){this.instanceHandlers=this.instanceHandlers.filter((t=>t.cookie!==e))}matchEvent(e,t){const s=t.operationNameRegex;if(s){if(!new RegExp(s,"gi").test(e.operationName))return!1}const o=t.source,i=t.status,n=t.subStatus;return!(o&&!a(e.source,o)||i&&!a(e.status,i)||!MsPortalFx.isNullOrUndefined(n)&&!a(e.subStatus,n))}matchEvents(e){this.instanceHandlers.slice().forEach((t=>{const s=[];e.forEach((e=>{this.matchEvent(e,t.criteria)&&s.push(e)})),t.callback(s.slice(0,t.eventLimit||s.length))}))}createResourceDeletedEvent(e){const t="microsoft.resources",i=t+"/subscriptions/resourcegroups",n="/delete",r=(e,s)=>{this.matchEvents([{operationName:s,status:"succeeded",source:t,correlationId:null,timestamp:new Date,assetId:e,isLocalEvent:!0}])};e.forEach((e=>{const t=s.ArmId.parse(e.assetId,!0);4===t.kind?r(e.assetId,i+n):o.ResourceArmIdKindMap[t.kind]&&r(e.assetId,n)}))}};t.ArmEvents=l,t.ArmEvents=l=__decorate([__metadata("fx:diagnostics",[e,"ArmEvents"]),r.Class()],l);const{createResourceDeletedEventDefinition:c,matchEventsDefinition:d,removeArmEventSubscriptionDefinition:p,subscribeToArmEventDefinition:u}=i.Events;t.createResourceDeletedEventHandler=(0,n.defineHandler)(c,(e=>e.diContainer.get(l).createResourceDeletedEvent(MsPortalFx.makeArray(e.messageArg)))),t.matchEventsHandler=(0,n.defineHandler)(d,(e=>e.diContainer.get(l).matchEvents(e.messageArg.events))),t.removeArmEventSubscriptionHandler=(0,n.defineHandler)(p,(e=>e.diContainer.get(l).removeArmEventSubscription(e.messageArg.cookie))),t.subscribeToArmEventHandler=(0,n.defineHandler)(u,(e=>{const t=e.messageArg,s=ko.observableArray();return{cookie:e.diContainer.get(l).subscribeToArmEvent(t.eventCriteria,s,t.eventLimit),events:s}}))})),
define("MsPortalImpl/Base/Base.ArmIdHelpers",["require","exports","Fx/ResourceManagement","FxHubs/ArmHelpers/ArmIds"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeId=t.isResourceAtAnyLevel=void 0,t.isResourceAtAnyLevel=function(e){return o.ResourceArmIdKindMap[e.kind]},t.sanitizeId=function(e){return 0!==s.ArmId.parse(e,!0).kind?MsPortalFx.sanitizeMessage(e):"_REDACTED_"}})),
define("MsPortalImpl/Base/Base.HistoryManager",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceState=t.pushState=void 0;const s=MsPortalFx.Base.Diagnostics.createLog(e);function o(e){return{...window?.history?.state??{},...e?.data??{}}}function i(e,t,o){try{e===history.pushState?window.history.pushState(t,"",o):e===history.replaceState&&window.history.replaceState(t,"",o)}catch(e){let t=!0;e instanceof DOMException&&(e.code!==DOMException.SECURITY_ERR&&"SecurityError"!==e.name||(t=!1)),t&&s.error(e,0)}}t.pushState=function(e){const t=o(e);i(history.pushState,t,e.url)},t.replaceState=function(e){const t=o(e);i(history.replaceState,t,e.url)}})),
define("MsPortalImpl/Base/Base.DeepLink",["require","exports","Fx/ResourceManagement","MsPortalImpl/Base/Base.ArmIdHelpers","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Base/Base.HistoryManager"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateDashboardUri=t.getDashboardIdFromUri=t.getDashboardTypeFromUri=t.isDashboardRoute=t.prependTenantToResourceDeepLink=t.rpcGetDashboardDeepLink=t.getAllServicesDeeplink=t.getDefaultDashboardDeeplink=t.getHomeDeeplink=t.getDashboardDeepLink=t.getGalleryDeepLink=t.getAssetDeepLink=t.replaceMenuIdFromDeepLink=t.getMenuIdFromDeepLink=t.parseBladeInputs=t.safeJSONParse=t.serializeBladeInputs=t.getBladeDeepLink=t.getCurrentUri=t.originalHref=t.dashboardRouteName=void 0;const a=window,l=encodeURIComponent,c=decodeURIComponent;function d(){return new i.Uri(location.href)}function p(){return d().hashQueryString}function u(e,t){let s,o,i="";return MsPortalFx.forEachKey(e,((e,n)=>{if("editScopeId"===e)return;let r=ko.unwrap(n);if(t){if("~"===e.slice(-1))return s="UnableToSerializeInputKey",void(o=e);let t,n;const a=MsPortalFx.getTypeOf(r);switch(MsPortalFx.getTypeOf(r)){case"string":n="",t=r;break;case"null":case"number":case"boolean":case"array":case"object":n="~";try{t=JSON.stringify(r)}catch(e){s="UnableToSerializeInputJSONStringifyFailed",o=JSON.stringify(e.message)}break;case"undefined":break;case"date":s="UnableToSerializeInputTypeDate",o="The input model contains a Date object which cannot be serialized in a roundtrippable way from Fx. A future upgrade will JSON stringify this input and the resulting deep link may not be navigable reliably. If using Date object to navigate to content, serialize the Date as part of the input model using the `toISOString()` method and parse this value on the initialization phase of the content.";break;default:s="UnableToSerializeInputTypeOther",o=a}void 0!==t&&void 0!==n&&(i+=`/${l(e)}${n}/${l(t)}`)}else r&&"object"==typeof r&&(r=JSON.stringify(r)),void 0!==r&&(0===r&&(r="0"),i+=`/${l(e)}/${l(r||"")}`)})),{lastFoundUnableToSerializeInputReason:s,lastFoundUnableToSerializeInputDetails:o,serializedInputs:i}}function m(e){try{return JSON.parse(e)}catch(t){return e}}function h(e){const t=e.length>=4&&e.length%2==0&&"#blade"===e[0]&&!MsPortalFx.isNullOrWhiteSpace(e[3]),s=e.length>=5&&"#view"===e[0]&&"~"===e[3]&&!MsPortalFx.isNullOrWhiteSpace(e[4]);return t||s}function g(e){return e.length%2==1&&!MsPortalFx.isNullOrWhiteSpace(e[e.length-1])}function f(e,t){return`${x(e)}dashboard/${t}`.toLowerCase()+p()}function x(e){const t=e.get(n.AuthStateManager).getSignedInUserTenant();return t?"@"+t+"/":""}function b(e){return!MsPortalFx.localeCompareIgnoreCase(e.getHashParts().category,t.dashboardRouteName)}t.dashboardRouteName="dashboard",t.originalHref=a.location.href,t.getCurrentUri=d,t.getBladeDeepLink=function(e,t,s={},o={}){const n=o.setDeepLinkContext||$.noop,r=new i.Uri(o.baseUri||"");let a="";o.selectedMenuItemId&&(a=(o.v2DeepLink?"/~/":"/")+o.selectedMenuItemId);const{lastFoundUnableToSerializeInputReason:l,lastFoundUnableToSerializeInputDetails:c,serializedInputs:d}=u(s,o.v2DeepLink);return MsPortalFx.isNullOrUndefined(l)?(a+=d,r.setHash(`#${o.v2DeepLink?"view":"blade"}/${e}/${t}${a}`).setHashQueryString(p()),r.href.length>1e6?(n(r.toString(),!1,"InputsExceedURILength"),""):(n(r.toString(),!0),r.toString())):(n(r.toString(),!1,l,c),"")},t.serializeBladeInputs=u,t.safeJSONParse=m,t.parseBladeInputs=function(e,t,s){s=s||{};const o={};try{for(let t=0;t<e.length;){let i=c(e[t++]);if(!i)throw new Error("invalid decodeKey:"+i);let n=c(e[t++]);s.v2DeepLink?"~"===i.slice(-1)&&(n=m(n),i=i.slice(0,-1)):s.parseJSON&&n&&/^\s*\{.*\}\s*$/.test(n)&&(n=m(n)),o[i]=n}}catch(e){throw new MsPortalFx.Errors.Error({message:`Deep link ${t} has illegal inputs`,innerErrors:e})}return o},t.getMenuIdFromDeepLink=function(e){const t=new i.Uri(e),s=t.getHashParts();switch(s.category){case"blade":case"view":{const e=t.hash.split("/");return h(e)?"view"===s.category?e[4]:e[3]:""}case"resource":{const e=s.rest.split("/");return g(e)?e[e.length-1]:""}}return""},t.replaceMenuIdFromDeepLink=function(e,t){const s=new i.Uri(e),o=s.getHashParts(),n=s.hash.split("/");switch(o.category){case"blade":case"view":if(h(n))return"view"===o.category?n[4]=t:n[3]=t,s.setHash(n.join("/")),s.toString();break;case"resource":if(g(o.rest.split("/")))return n[n.length-1]=t,s.setHash(n.join("/")),s.toString();break}return e||""},t.getAssetDeepLink=function(e,t,o={}){let n=t.assetId;const r=n&&"string"==typeof n&&s.ArmId.parse(n,!0);return r&&0!==r.kind&&(n=n.substring(1)),new i.Uri(o.baseUri||"").setHash("#{0}{1}/{2}/{3}/{4}".format(x(e),"asset",t.extensionName,t.assetType,n)).setHashQueryString(p()).toString()},t.getGalleryDeepLink=function(e,t={}){let s="#{0}/{1}";const o=t.model;return o&&(ko.unwrap(o.additionalConfig)||{}).preview&&(s+="/preview"),new i.Uri(t.baseUri||"").setHash(s.format("create",e)).setHashQueryString(p()).toString()},t.getDashboardDeepLink=f,t.getHomeDeeplink=function(){return"#home"+p()},t.getDefaultDashboardDeeplink=function(){return"#dashboard"+p()},t.getAllServicesDeeplink=function(e){return"#allservices/category/All"+(e?"/filter/"+e:"")+p()},t.rpcGetDashboardDeepLink=function(e,t){let i=t=MsPortalFx.trimStart(t,"/");if(!t.startsWith("dashboard/arm")&&!t.startsWith("dashboard/private")){const e=s.ArmId.parse(MsPortalFx.ensurePrefix(t,"/"),!0);i=(0,o.isResourceAtAnyLevel)(e)?MsPortalFx.ensurePrefix(t,"dashboard/arm/"):MsPortalFx.ensurePrefix(t,"dashboard/private/")}const n=window.location,r=d(),a=x(e),l=n.port;return[n.protocol,"//",r.host,l?":"+l:"",n.pathname,r.queryString,"#",a,i,p()].join("")},t.prependTenantToResourceDeepLink=function(e,t){return t&&t.startsWith("#resource/")?`#${x(e)}${t.substring(1)}`:t},t.isDashboardRoute=b,t.getDashboardTypeFromUri=function(){const e=d();return b(e)?e.getHashParts().rest.split("/")[0]:""},t.getDashboardIdFromUri=function(e=d()){return b(e)?e.getHashParts().rest:""},t.updateDashboardUri=function(e,t,s,o){const i=f(e,t);if((o=o||d()).hash.toLowerCase()!==`#${i}`){o.setHash(i);(s?r.replaceState:r.pushState)({data:{},url:o.href})}}})),
define("MsPortalImpl/Base/Base.ItemCache",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rotFind=t.rotAdd=t.ItemArrayCache=t.BaseItemCache=void 0;const s=MsPortalFx.remove,o=MsPortalFx.find,i=MsPortalFx.findIndex,n=Date.now;function r(e){return t=>e(t.item)}function a(e){return n()-e}function l(e,t){let s;return e&&(t&&(e.age=n()),s=e.item),s}t.BaseItemCache=class{constructor(e=12e4,t){this._map=t,this._maxAge=e,setTimeout((()=>this._reduceCache()),1e3)}dispose(){this.flush()}hasEntry(e){return e in this._map}getEntry(e){return l(this._map[e],!0)}peekEntry(e){return l(this._map[e])}removeEntry(e){e in this._map&&this._delete(e)}_removeEach(e){for(const t in this._map)e.call(this,t)&&this._delete(t)}removeEach(e){this._removeEach(e)}flush(){this._removeEach()}_delete(e){delete this._map[e]}_isExpired(e){return a(this._map[e].age)>this._maxAge}_reduceCache(){this._removeEach(this._isExpired)}};t.ItemArrayCache=class{constructor(e=12e4){this._cache=[],this._maxAge=e,setTimeout((()=>this._reduceCache()),1e3)}dispose(){this.clear()}first(e,t){return l(o(this._cache,r(e)),!t)}peekFirst(e){return this.first(e,!0)}pushEntry(e){this._cache.push(function(e){return{age:n(),item:e}}(e))}removeEntry(e){this.removeFirst((t=>MsPortalFx.deepEquals(t,e)))}removeFirst(e){const t=i(this._cache,r(e));t>=0&&this._cache.splice(t,1)}removeEach(e){s(this._cache,r(e))}clear(){this._cache=[]}_isEntryExpired(e){return a(e.age)>this._maxAge}_reduceCache(){s(this._cache,(e=>this._isEntryExpired(e)))}};const c=new Map;let d=1;t.rotAdd=function(e,t){const s=(d++).toString();return c.set(s,t),e.registerForDispose((()=>{c.delete(s)})),s},t.rotFind=function(e){return c.get(e)}})),
define("MsPortalImpl/Services/Services.BrowseCuration",["require","exports","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","FxInternal/AsyncLoaderCore","FxHubs/RpcEndPoints","Fx","Fx/Experimentation"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetMapResourceTypeToCategoryResourceName=t.getResourceTypesCategorizationForTest=t.initializeRpc=t.getResourceTypesCategorizationEndPoint=t.mapCategoryIdToName=t.testReset=t.getSharedCuration=t.getBrowseCuration=t.handleInvalidCurationFileError=t.getAllServicesAdditionalData=t.getMergedAssetType=t.browseCurationFile=void 0;var l=MsPortalFx.Base,c=FxImpl.Rpc,d=MsPortalFx.Hubs.Notifications;const p=window.fx.environment,u=l.Diagnostics.createLog(e),m=/^[a-z_][\w\-]*$/i,h=o.BrowseCuration,g=o.BrowseCategories,f=MsPortalFx.lowerCaseAllStrings;function x(e){if(!e||m.test(e))return e;u.warning(`Invalid curation file name: <${e}>, skipping this curation file.`)}function b(e){let s=`Failed to get the browse curation file <${t.browseCurationFile}>`;e&&e.statusText?s+=`: ${e.status||""} (${e.statusText})`:e&&e.message&&(s+=`: ${e.message}`),u.warning(s),d.ClientNotification.publish({title:h.noCurationTitle,description:h.noCuration,status:d.NotificationStatus.Warning})}t.browseCurationFile=x((0,r.getFeatureValue)("browsecuration"))||x(p.browseCuration)||"default",t.getMergedAssetType=function(e,t,s){return{base:e,associated:Array.isArray(t)?t:[t],infoTextOverride:s}},t.getAllServicesAdditionalData=(0,r.memoizePromise)((()=>MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/AllServicesCardData").then((e=>e.getAdditionalAssetTypeAndCategoryData())).catch((e=>{let t="Failed to get the additional data file";return e&&e.statusText?t+=`: ${e.status||""} (${e.statusText})`:e&&e.message&&(t+=`: ${e.message}`),u.warning(t),{}})))),t.handleInvalidCurationFileError=b,t.getBrowseCuration=(0,r.memoizePromise)((e=>MsPortalFx.require(`MsPortalImpl/Services/BrowseCuration/${t.browseCurationFile}`).then((t=>t.getCuration(e))).catch((e=>(b(e),{}))))),t.getSharedCuration=(0,r.memoizePromise)((()=>(0,t.getBrowseCuration)().then((e=>({mergedAssetTypes:f(e&&e.mergedAssetTypes)}))))),t.testReset=MsPortalFx.noop;const y={},v={};const M=/(^|[^A-Za-z0-9]*)([A-Za-z0-9]+)/g;function C(e){return g[(t=e,t.replace(M,((e,t,s)=>s&&(s||"").toLowerCase())))]||e;var t}t.mapCategoryIdToName=C,t.getResourceTypesCategorizationEndPoint=(0,i.defineHandler)(s.Curation.getResourceTypesCategorizationEndPoint,(e=>async function(e){if(MsPortalFx.isEmptyObject(v)){const s=await n.AssetTypes.getAssetTypesInformationEndPoint.invoke(c.client,"fxw",void 0),o=e.get(a.Experimentation).shellAssignments.getBooleanValue("useSubcategoryCuration");(await(0,t.getBrowseCuration)(o)).categories.forEach((e=>e.items.forEach((t=>{const s=FxImpl.Assets.getAssetTypeOrResourceTypeId(t.extensionName?.toLowerCase(),t.assetType?.toLowerCase());y[s]={categoryId:e.id||"uncurated",categoryDisplayName:C(e.id)}})))),s.forEach((e=>{const t=FxImpl.Assets.getAssetTypeOrResourceTypeId(e.extensionName?.toLowerCase(),e.assetType?.toLowerCase()),s=y[t],o=e.compositeDisplayName?.service||e.compositeDisplayName?.plural;o&&(v[e.lowerCaseResourceType]={categoryId:s?.categoryId||"uncurated",categoryDisplayName:s?.categoryDisplayName||g.uncurated,assetDisplayName:o,lowerCaseResourceType:e.lowerCaseResourceType,assetTypeIcon:e.icon,assetTypeKeywords:e.keywords})}))}return v}(e.diContainer))),t.initializeRpc=function(){s.Curation.getSharedCurationEndpoint.register(c.client,["HubsExtension","fx"],(()=>(0,t.getSharedCuration)()))}})),
define("MsPortalImpl/Services/Services.AssetTypes",["require","exports","Fx/DependencyInjection","Fx/Ajax","Fx/ResourceManagement","FxHubs/ResourceManagement","FxHubs/ArmClient","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ArmIdHelpers","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Extension/Extension.Manifest","FxHubs/ArtHelpers/ArgBrowseHelpers","MsPortalImpl/Services/Services.Settings","FxInternal/Features","ShellWorker/AssetTypeRequirements","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","Fx","MsPortalImpl/Notifications/NotificationsClientStrings","MsPortalImpl/Services/Services.BrowseCuration","FxInternal/AsyncLoader"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M,C,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AssetTypeService=t.getBrowseBladeReference=t.getBrowseBladeUri=t.getBrowseAllDeeplink=t.lowerCaseResourcesWithTagType=t.lowerCaseResourceGroupsType=t.lowerCaseResourceGroupsId=t.lowerCaseAllResourcesType=t.lowerCaseAllResourcesId=t.Internal=t.featureCardsMemo=t.assetTypesWithVariantsMemo=t.assetTypesMemo=t.createViewModelDisposedError=t.assetTypeMeetsRequirements=t.provideSubCategoryName=t.provideCategoryName=t.compareAssetId=t.registerStringProvider=t.failedToFindAssetTypePrefix=void 0;var w=MsPortalFx.Base,I=w.Constants,S=I.AssetNames,_=S.NonAssetResource,F=I.ResourceTypes,T=I.BladeNames.Hubs,k=T.ResourceMenuBlade,D=T.UnavailableAssetBlade,E=MsPortalFx.Extension,B=(E.BrowseType,w.Images),A=FxImpl.Assets,N=E.ResourceRoutingType,R=MsPortalFx.Errors,L=MsPortalFx.Helpers,O=MsPortalFx.Hubs.Notifications.NotificationStatus;const z=window.fx.environment,H=w.Diagnostics.createLog(e),U=B.Polychromatic.ResourceDefault(),W={image:B.Polychromatic.Preview(),width:40},V={icon:U,previewIcon:U,bladeName:k,bladeExtension:"HubsExtension"},j="BrowseRecentResources.ReactView";let q=e=>H.warning(e);const $="Timeout trying to load extension manifest",G=MsPortalFx.remove,K=w.Diagnostics.createIgnoreUnhandledRejectionError,J=A.getAssetTypeOrResourceTypeId,X=w.Images.Polychromatic.ResourceDefault(),Z=a.BrowseCuration.Description,Y={};t.failedToFindAssetTypePrefix="Could not find the asset type";const ee=[];function te(e){ee.push(e)}function se(e){return(e||"").toLowerCase()}function oe(e,t){return e===t||se(e)===se(t)}t.registerStringProvider=te,t.compareAssetId=function(e,t){const s=i.ArmId.parse(e,!0),o=i.ArmId.parse(t,!0);return 0!==s.kind&&0!==o.kind&&oe(e,t),MsPortalFx.deepEquals(e,t)};const ie=/(^|[^A-Za-z0-9]*)([A-Za-z0-9]+)/g;function ne(e){return e.replace(ie,((e,t,s)=>s&&se(s)))}const re=/^https?:\/\//i;function ae(e){const t=e.text||e.name,s=e.pluralDisplayName||t;return{plural:s,singular:e.singularDisplayName||t,lowerPlural:e.lowerPluralDisplayName||t,lowerSingular:e.lowerSingularDisplayName||t,service:e.serviceDisplayName||s}}function le(e){return{plural:e.pluralDisplayName,singular:e.singularDisplayName,lowerPlural:e.lowerPluralDisplayName,lowerSingular:e.lowerSingularDisplayName,service:e.serviceDisplayName}}function ce(e,t,s){let o;return ee.some((i=>(o=i.provideAssetTypeKeywords(e,t,s),!!o))),o}function de(e){const t=e.resourceType;return t&&se(t.resourceTypeName)}function pe(e,t,s=null,o=null,i=null){if(!e)return{icon:w.Images.Polychromatic.ResourceDefault(),selection:FxImpl.ViewModels.getBladeSelection("HubsExtension",k,{id:t})};const n=e.assetTypeManifest;o=o||n.bladeExtensionName||e.extension,(s=s||n.bladeName)||(s=n.resourceType?k:D,o="HubsExtension");return{icon:i||e.icon,selection:FxImpl.ViewModels.getBladeSelection(o,s,{id:t}),isPreview:e.isPreview}}function ue(e,t){const s=e.assetTypeManifest;return(0,b.assetTypeMeetsRequirements)({browseType:s?.browseType,browseLinkUri:s?.browseLinkUri,resourceType:s?.resourceType?.resourceTypeName},t)}function me(e,t,s){return K(`Asset type does not specify a resource type. Extension <${t}> : AssetType <${s}> : ${e}`)}function he(e){return K(`Resource ID <${(0,l.sanitizeId)(e)}> is not a subscription ID, resource group ID or resource ID.`)}function ge(e,t,s){return new Error(`The ${e} view model was already disposed. Extension <${t}> : ViewModel <${"string"==typeof s?s:s.name}>`)}function fe(e,t,s){const o=MsPortalFx.makeArray(t);if(o.length){const t=e.length+o.length-s;t>0&&e.splice(0,t),e.push(...o)}}function xe(e,t){return MsPortalFx.find(e,t,-1)}function be(e){let t=3;return(e.privateBrowse||(0,n.supportsAnyOption)(e.options,3))&&(t-=2),(e.isPreview||e.isDisabled)&&(t-=1),t}function ye(){return(0,v.isFeatureEnabled)("artbrowse")?"#blade/HubsExtension/BrowseAll":"#blade/HubsExtension/BrowseAllResourcesBlade/resourceType/Microsoft.Resources%2Fresources"}te({provideCategoryName:e=>(0,C.mapCategoryIdToName)(e),provideSubCategoryName:e=>a.BrowseSubCategories[ne(e)]||e,provideAssetTypeKeywords:(e,t,s)=>{const o=a.AssetTypeKeywords[function(e,t,s){return ne(e+" "+t+s||(s?" "+s:""))}(e,t,s)];return o?o.split(","):[]}}),t.provideCategoryName=function(e){let t;return ee.some((s=>(t=s.provideCategoryName(e),!!t))),t||e},t.provideSubCategoryName=function(e){let t;return ee.some((s=>(t=s.provideSubCategoryName(e),!!t))),t||e},t.assetTypeMeetsRequirements=ue,t.createViewModelDisposedError=ge,t.assetTypesMemo=(0,v.memoizePromise)((e=>e.assetTypesComplete.then((()=>e.assetTypes.map((t=>e.mapAssetTypeToResourceTypeAssetTypeInformation(t))))))),t.assetTypesWithVariantsMemo=(0,v.memoizePromise)((e=>e.assetTypesComplete.then((()=>e.assetTypes.map((t=>e.mapAssetTypeToResourceTypeAssetTypeInformation(t,!0))))))),t.featureCardsMemo=(0,v.memoizePromise)((e=>e.assetTypesComplete.then((()=>e.featureCardMap)))),t.Internal={},t.lowerCaseAllResourcesId="hubsextension_browseallresources",t.lowerCaseAllResourcesType="microsoft.resources/resources",t.lowerCaseResourceGroupsId="hubsextension_resourcegroups",t.lowerCaseResourceGroupsType="microsoft.resources/subscriptions/resourcegroups",t.lowerCaseResourcesWithTagType="microsoft.resources/resourceswithtag",t.getBrowseAllDeeplink=ye;const ve={};function Me(e,s,o,i,r,a,l,c){if(s===t.lowerCaseAllResourcesId)return Promise.resolve(ye());if(s===t.lowerCaseResourceGroupsId)return Promise.resolve((0,v.isFeatureEnabled)("artbrowse")?"#blade/HubsExtension/BrowseResourceGroups":"#blade/HubsExtension/BrowseResourceGroupBlade/resourceType/Microsoft.Resources%2Fsubscriptions%2FresourceGroups");const d=i?.assetTypeManifest;if(d?.resourceType){if(!l&&d.browseDeepLink)return Promise.resolve(d.browseDeepLink);const i=(0,n.supportsContract)(d.contracts,16384),p=!(0,n.supportsContract)(d.contracts,2)&&(d.resourceType.routingType||N.Default)===N.Default;let u=d.argBrowseOption;const m=!!u;if(c&&i&&!m&&(u=3),(i||p||m)&&(0,v.isFeatureEnabled)("artbrowse")&&4!==u){let n=o;const l=()=>{if(s===t.lowerCaseResourceGroupsId){n=`#blade/HubsExtension/${a?"ARGBrowseResourceGroupsInMenu":"BrowseResourceGroups"}`}else{n=`#blade/HubsExtension/${a?"ARGBrowseResourcesInMenu":"BrowseResource"}/resourceType/${encodeURIComponent(d.resourceType.resourceTypeName)}`,r&&(n=n+"/kind/"+encodeURIComponent(r))}};if(3===u)return l(),Promise.resolve(n);if(g.canOptIn(u,{resourceType:d.resourceType?.resourceTypeName,contracts:d.contracts,browseType:d.browseType})){return e.get(f.SettingsManager).querySetting(15,"argBrowsePreference").then((e=>{const t=e?.[s],o=!i&&p&&void 0===u?3:u;return(!0===t||void 0===t&&[2,3].includes(o))&&(l(),ve[s]!==t&&(ve[s]=t,w.Diagnostics.Telemetry.trace({source:"Shell",action:"ArgBrowseOption",name:s,data:{setting:t,argBrowseOption:o}}))),n}))}}}return Promise.resolve(o)}async function Ce(e,s){const{resourceType:o,kind:i,inMenu:n,ignoreDeepLink:r}=s,{hubsOnly_defaultToArgBrowse:a}=s,l=(o||"").toLowerCase();if(l===t.lowerCaseAllResourcesType)return Promise.resolve(function(e){return e?(0,v.isFeatureEnabled)("artbrowse")?{blade:"ARGBrowseAllInMenu",extension:"HubsExtension"}:{blade:"BrowseAllInMenu",extension:"HubsExtension",parameters:{resourceType:t.lowerCaseAllResourcesType}}:(0,v.isFeatureEnabled)("artbrowse")?{blade:"BrowseAll",extension:"HubsExtension"}:{blade:"BrowseAllResourcesBlade",extension:"HubsExtension",parameters:{resourceType:t.lowerCaseAllResourcesType}}}(n));if(l===t.lowerCaseResourceGroupsType)return Promise.resolve(function(e){return e?(0,v.isFeatureEnabled)("artbrowse")?{blade:"ARGBrowseResourceGroupsInMenu",extension:"HubsExtension"}:{blade:"BrowseGroupsInMenu",extension:"HubsExtension",parameters:{resourceType:t.lowerCaseResourceGroupsType}}:(0,v.isFeatureEnabled)("artbrowse")?{blade:"BrowseResourceGroups",extension:"HubsExtension"}:{blade:"BrowseResourceGroupBlade",extension:"HubsExtension",parameters:{resourceType:t.lowerCaseResourceGroupsType}}}(n));const c=e.get(we);return MsPortalFx.tryImmediateResolve(c.assetTypesComplete,(async()=>{const t=c.getAssetTypeByResourceType(o);if(!t)return null;const s=await Me(e,t.id.toLowerCase(),null,t,i,n,r,a)||c.getAssetTypeDeepLink(t,i,n,r);if(!s||"string"!=typeof s||!s.startsWith("#blade/")&&!s.startsWith("#view/"))return null;const l=s.split("?")[0].split("/");let d="";if(!l.length||l.length<3)return null;l.length>3&&"~"===l[3]&&l.splice(3,1),l.length%2!=1&&(d=l[l.length-1],l.pop());const p=l[1].trim(),u=l[2].trim(),m={};for(let e=3;e<l.length;e+=2)m[l[e]]=decodeURIComponent(l[e+1]);return d&&(m.menuid=d),{blade:u,extension:p,parameters:m}}))}t.getBrowseBladeUri=Me,t.getBrowseBladeReference=Ce;let Pe=class{constructor(e,t,s,o,n,r){this._diContainer=e,this._viewModelManager=t,this._manifestCache=s,this._redirectMap=o,this.assetTypes=[],this.featureCardMap=FxImpl.lowerCaseStringMap(),this._resourceTypeMap={},this._assetTypeByIdBrowseLink={},this._assetTypeByResourceTypePromises=[],this._selectionFromResourceIdPromises=[],this._bladeInfoPromises=[],this._memoizedManifestsLoadedError=MsPortalFx.memoize((e=>K(e))),this._serviceMenuEnabled=n.isEnabled("servicemenu"),this._lifetimeManager=new FxImpl.TriggerableLifetimeManager,this._cachedUser=r.getCurrentUser(),n.isEnabled("policyforrestypes")?(this._policyForResourceTypesPromise=MsPortalFx.tryImmediateResolve(Q((0,f.readUserSettings)(this._diContainer.get(f.SettingsManager),["resourceTypeRestrictions"])),(e=>{try{const t=e?.resourceTypeRestrictions;return t&&JSON.parse(t)}catch(e){return void H.warning(new R.Error({message:"Failed to deserialize resource type restrictions from user settings",innerErrors:[e]}))}})),MsPortalFx.tryImmediateResolve(Q((0,y.lazyUserDataMemo)(this._diContainer)),(e=>{MsPortalFx.tryImmediateResolve(Q(this._policyForResourceTypesPromise),(async t=>{const s=(e,t)=>(t=t||[],(e=e||[]).length===t.length&&e.every((e=>!!MsPortalFx.find(t,(t=>t?.toLowerCase()===e?.toLowerCase())))));let o,n=!0,r=e.policyForResourceTypes;if(r){const e=async()=>{const e=await this._getPolicyForResourceTypes();return!e.ignore&&(r={deny:e.policies.deny,required:e.policies.required},o=e.policies.policyObjectMap,n=!1,!0)};if(r.hasErrors)return void H.warning(new R.Error({message:"Failed loading the policy restrictions for resource types"}));if(r.isIncomplete&&(H.warning(new R.Error({message:"Did not finish loading the policy restrictions for resource types on server, retrying from client"})),!await e()))return;const l=async()=>{if(!s(t?.required,r?.required)||!s(t?.deny,r?.deny)){if(n){if(H.warning(new R.Error({message:"Policy restrictions for resource types from server did not match cached policy, retrying from client"})),!await e())return;return void await l()}const c=t?.policyObjectMap,d=[],p=[],u=[];let m=!1;if(c&&o){m=!0;const e=Object.keys(c),t=Object.keys(o);e.forEach((e=>{t.includes(e)?s(c[e].required,o[e].required)&&s(c[e].deny,o[e].deny)||u.push(e):d.push(e)})),t.forEach((t=>{e.includes(t)||p.push(t)}))}const h={required:r?.required||[],deny:r?.deny||[],policyObjectMap:o};if(h?(0,f.writeUserSettings)(this._diContainer.get(f.SettingsManager),{resourceTypeRestrictions:JSON.stringify(h)},0,0):(0,f.deleteUserSettings)(this._diContainer.get(f.SettingsManager),["resourceTypeRestrictions"]),await(0,f.flush)(this._diContainer.get(f.SettingsManager)),this.assetTypesComplete.isPending())this._policyForResourceTypesPromise=Promise.resolve(h);else{const e={oldPolicies:{required:t?.required||[],deny:t?.deny||[]},newPolicies:{required:h?.required||[],deny:h?.deny||[]}};m&&(e.newPolicyObjectMap=o,e.oldPolicyObjectMap=c),w.Diagnostics.Telemetry.trace({source:"Shell",action:"PolicyForResourceTypesUpdate",name:"Services.AssetTypes",data:e});const s=()=>{let e=a.ResourceTypeRestrictions.policyChangeDescription;if(m){const t=(e,t,s)=>{let o="<br/><br/>"+t+"<br/><br/>";return e.slice(0,4).forEach((e=>{const t=i.ArmId.parse(e);o+=s?'<a target="_blank" href="#view/Microsoft_Azure_Policy/AssignmentDetail.ReactView/id/'+encodeURIComponent(e)+'">'+t.resourceName+"</a><br/>":t.resourceName+"<br/>"})),e.length>4&&(o+=a.ResourceTypeRestrictions.additionalPolicies+"<br/>"),o};d.length&&(e+=t(d,a.ResourceTypeRestrictions.policyChangeDescriptionRemovedPoliciesFormat,!1)),p.length&&(e+=t(p,a.ResourceTypeRestrictions.policyChangeDescriptionAddedPoliciesFormat,!0)),u.length&&(e+=t(u,a.ResourceTypeRestrictions.policyChangeDescriptionChangedPoliciesFormat,!0))}return e+='<br /><br/><a target="_blank" href="#view/Microsoft_Azure_Policy/PolicyMenuBlade/~/Assignments">'+a.ResourceTypeRestrictions.seePolicies+"</a>","<div>"+e+"</div>"};this._diContainer.getAsync(P.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationHandler")).then((e=>e.showModalNotification({diContainer:this._diContainer,messageContext:{srcWindowId:I.Shell,destWindowId:I.Shell,callStack:null},messageArg:{primaryButtonClickAction:2,primaryButtonText:M.AssetTypesNotification.primaryButtonText,secondaryButtonText:M.AssetTypesNotification.secondaryButtonText,notification:{title:a.ResourceTypeRestrictions.policyChangeTitle,description:s(),descriptionAsHtml:!0,status:O.Warning,timestamp:new Date}}})))}}};await l()}}))}))):this._policyForResourceTypesPromise=Promise.resolve(void 0),this.assetTypesComplete=Q(this._listenForExtensions())}_getPolicyForResourceTypes(){const e=new MsPortalFx.Base.UriBuilder(`/providers/microsoft.management/managementgroups/${this._cachedUser.tenantId}/providers/microsoft.policyinsights/checkPolicyRestrictions?api-version=2022-03-01`);return(0,o.batch)({type:"POST",uri:e.toString(),content:{pendingFields:[{field:"type"}]},setTelemetryHeader:"PolicyForResourceTypesFromClient"}).then((e=>{const t=[],s=[];let o=0;const i={};return e?.content?.fieldRestrictions?.forEach((e=>{"type"===e?.field&&(++o,e.restrictions?.forEach((e=>{switch(e?.result){case"Deny":t.push(...e.values),i[e.policy.policyAssignmentId]={deny:e.values,required:[]};break;case"Required":s.push(...e.values),i[e.policy.policyAssignmentId]={deny:[],required:e.values}}})))})),H.verbose("Policy resource types loaded client-side. Data: "+JSON.stringify({tenantId:this._cachedUser.tenantId,source:"ARM",totalPolicies:o})),{policies:{deny:t,required:s,policyObjectMap:i}}})).catch((()=>(H.warning("Policy resource types failed to load client-side. Data: "+JSON.stringify({tenantId:this._cachedUser.tenantId})),{policies:{deny:[],required:[]},ignore:!0})))}dispose(){MsPortalFx.disposeDisposable(this._memoizedManifestsLoadedError,this._lifetimeManager,this._resourceIdSelectionCache)}getMappedBladeLocator(e,t){if(1===e.type){const t=this._mappedBrowseBlades.get(e.getExtensionName());if(t?.get(e.name))return u.resourceMenu}if(1===t?.type){const e=this._mappedBrowseBlades.get(t.getExtensionName());if(e?.get(t.name))return u.resourceMenu}return e}getAssetType(e,t,s){if(e&&t){const o=e.toLowerCase(),i=t.toLowerCase();return xe(this.assetTypes,(e=>e.lowerCaseExtension===o&&e.lowerCaseAssetType===i&&ue(e,s)))}}getAssetTypeById(e,t){if(e){const s=e.toLowerCase();return xe(this.assetTypes,(e=>e.lowerCaseAssetTypeId===s&&ue(e,t)))}}getAssetTypeByResourceType(e,t){if(e){const s=e.toLowerCase();return xe(this.assetTypes,(e=>e.lowerCaseResourceType===s&&ue(e,t)))}}getAssetTypeByResourceTypeWithFallback(e,t){let s=this.getAssetTypeByResourceType(e,t);return s||(s=MsPortalFx.clone(this.getAssetType("HubsExtension",_,t)),s.assetTypeManifest.resourceType={resourceTypeName:e}),s}getAssetTypeDeepLink(e,t,s,o){const i=e.assetTypeManifest,r=i.name,a=i.bladeName,l=e.extension,c=i.bladeExtensionName||l,p=i.resourceType,u=p?.resourceTypeName,m=(e,t)=>(0,d.getBladeDeepLink)("HubsExtension",e,t);let h="";const g=this._serviceMenuEnabled&&i.serviceMenuBlade;if(!o&&i.browseDeepLink)h=i.browseDeepLink;else if(g)h=(0,d.getBladeDeepLink)(i.serviceMenuBladeExtension||e.extension,g,{id:i.serviceMenuItemId});else{const o=FxImpl.lowerCaseStringMap();switch(o.set(F.AllResources,{blade:T.BrowseAllResourcesBlade,inMenuBlade:"BrowseAllInMenu"}),o.set(F.ResourceGroups,{blade:T.BrowseResourceGroupBlade,inMenuBlade:"BrowseGroupsInMenu"}),o.set(F.RecentResources,{blade:j,inMenuBlade:j}),i.browseType){case 1:{const e=o.get(u||F.AllResources)||{blade:T.BrowseResourceBlade,inMenuBlade:"BrowseInMenu"};h=m(s?e.inMenuBlade:e.blade,t?{resourceType:u,kind:t}:{resourceType:u});break}case 2:if("HubsExtension"===c){const e=FxImpl.lowerCaseStringMap();e.set(T.BrowseAllResourcesBlade,{resourceType:F.AllResources,bladeName:T.BrowseAllResourcesBlade}),e.set(j,{bladeName:j});const t=e.get(a);t&&(h=m(t.bladeName,t.resourceType?{resourceType:t.resourceType}:null))}else(0,n.supportsContract)(i.contracts,32768)&&(h=m(T.AssetMenuBlade,{assetName:r,extensionName:l}));if(!h){h="Dashboard"===r&&"HubsExtension"===c?"#":(0,d.getBladeDeepLink)(c,a),r===S.Gallery&&(h+="/selectedMenuItemId/home")}break;case 3:h=this.getBrowseLinkUri(e)}}return!h&&u&&H.error(`<${u}> asset type does not have a deep link. Side bar & search results will not be able to open any blades.`),h}getBrowseLinkUri(e){const t=this._assetTypeByIdBrowseLink[e.id];if(t)return t;const s=this._formatBrowseLinkUri(e.assetTypeManifest.browseLinkUri);return this._assetTypeByIdBrowseLink[e.id]=s,s}_formatBrowseLinkUri(e){const t=this._cachedUser;if(e){const s=z.links.classicPortal.format({domain:t?.tenantDomain});e=e.format({accountPortal:z.links.accountPortal,classicPortal:s,domain:t?.tenantDomain,tenantId:t?.tenantId})}return e}getAssetTypeInformation(e,s){const o=t.Internal.getAssetTypeInformationOverride;return o?o(e,s):MsPortalFx.tryImmediateResolve(this._getAssetTypePromise(e,s),(t=>{if(!t)throw K(`Asset type not found: AssetType <${e}:${s}>`);return this.mapAssetTypeToAssetTypeInformation(t)}))}getResourceTypeAssetTypeInformation(e){const s=t.Internal.getResourceTypeAssetTypeInformationOverride;if(s)return s(e);const o=(e,t)=>({resourceType:e,topLevelTenantAlias:null,topLevelResourceTypeAlias:null,extensionName:null,assetType:null,browseType:-1,compositeDisplayName:null,icon:null,viewModelLocator:null,viewModel:null,viewModelExtensionName:null,contracts:0,lowerCaseExtension:null,lowerCaseAssetType:null,lowerCaseResourceType:se(e),reason:MsPortalFx.getLogFriendlyMessage(t)}),i=[],n=[],r=FxImpl.lowerCaseStringMap();return e.forEach((e=>{e.split("/").length>=2?r.set(e,!0):n.push(e)})),i.push(...n.map((e=>o(e,"Invalid resource type")))),r.forEach(((e,t)=>{const s=MsPortalFx.tryImmediateResolve(this.assetTypesComplete,(()=>{const e=this.getAssetTypeByResourceType(t);return e?this.mapAssetTypeToResourceTypeAssetTypeInformation(e):o(t,"Asset type not found")}));i.push(s)})),Promise.all(i)}mapAssetIdToResourceId(e){const t=e.extensionName,s=e.assetType,o=e.assetId,n=i.ArmId.parse(o,!0);return 1===n.kind||4===n.kind||(0,l.isResourceAtAnyLevel)(n)?Promise.resolve(o):Promise.reject(K("Asset ID not a resource ID. "+`Extension <${t}> : AssetType <${s}> : ID _REDACTED_`))}mapResourceIdToAssetId(e){return MsPortalFx.tryImmediateResolve(this._getAssetTypeByResourceId(e),(t=>{if(!t)throw K(`Asset type not found: ResourceId <${(0,l.sanitizeId)(e)}>`);const s=t.assetTypeManifest,o=s.name,i=s.resourceType,n=t.extension;if(!i)throw me(`ResourceId <${(0,l.sanitizeId)(e)}>`,n,o);return{extensionName:n,assetType:o,assetId:e}}))}mapAssetIdToDynamicSelectionAndIcon(e,t){const s=e.extensionName,o=e.assetType,n=e.assetId;return MsPortalFx.tryImmediateResolve(this._getAssetTypePromise(s,o),(r=>{if(r){e.assetId=n&&ko.unwrap(n);const s=i.ArmId.parse(e.assetId,!0);if(function(e){return 1===e.kind||4===e.kind||(0,l.isResourceAtAnyLevel)(e)}(s)){if(0===s.kind)throw he(e.assetId);return this._getDynamicSelectionAndIconFromResourceId(r,e.assetId,s,e,t)}return this._getDynamicSelectionAndIconFromAssetId(r,e)}throw K(`Asset type not found: AssetType <${s}:${o}>`)}))}getBrowseBladeReference(e){return Ce(this._diContainer,e)}mapResourceIdToDynamicSelectionAndIcon(e,t){const s=i.ArmId.parse(e,!0);if(this._resourceIdSelectionCache=this._resourceIdSelectionCache||new c.ItemArrayCache(216e5),0===s.kind)return Promise.reject(he(e));const o=this._resourceIdSelectionCache.first((t=>oe(t.resourceId,e)));return o?Promise.resolve(o.value):MsPortalFx.tryImmediateResolve(MsPortalFx.tryImmediateResolve(this._getAssetTypeByResourceId(e),(o=>{if(!o)throw K(`Asset type not found: ResourceId <${(0,l.sanitizeId)(e)}>`);const i=o.assetTypeManifest,n=i.name;if(!i.resourceType)throw me(`ResourceId <${(0,l.sanitizeId)(e)}>`,o.extension,n);return MsPortalFx.tryImmediateResolve(this.mapResourceIdToAssetId(e),(i=>this._getDynamicSelectionAndIconFromResourceId(o,e,s,i,t)))})),(t=>(this._resourceIdSelectionCache.pushEntry({resourceId:e,value:t}),t)))}mapResourceIdAndKindToBladeInfo(e,t){e=e||"";const s=(t=t||"").toLowerCase(),o=i.ArmId.parse(e,!0),n=i.ResourceName.getDisplayName({id:e,armId:o});let r;r=1===o.kind?MsPortalFx.tryImmediateResolve(MsPortalFx.Azure.getSubscriptionInfo(o.subscription),(e=>e.displayName),(()=>n)):Promise.resolve(n);const a=e.startsWith("/")?`#resource${e}`:`#resource/${e}`,l=o.resourceType||"",c=l.toLowerCase(),d=xe(this._bladeInfoPromises,(e=>e.resourceKind===s&&e.resourceType===c));let p=d?.promise;return p||(p=MsPortalFx.tryImmediateResolve(this.getResourceTypeAssetTypeInformation([l,i.ArmId.parse(e).resourceType]),(e=>{const o=e&&e[0].assetType&&e[0]||e[1]||{},i=o.kindMap&&(o.kindMap[s]||o.kindMap[o.defaultKind]),n=i||{},r=n.singularDisplayName||o.compositeDisplayName?.singular||l,a=n.icon||o.icon||U,d=r?B.CustomImageWithOptions(a,{title:r}):a,p=(void 0!==n.isPreview?n.isPreview:o.isPreview)?B.CustomImageWithBadge(d,W):d;let u=k,m="HubsExtension";const h=n.bladeName||o.bladeName;h&&(u=h,m=n.bladeExtensionName||o.bladeExtensionName||o.extensionName);const g={icon:d,previewIcon:p,bladeName:u,bladeExtension:m};return t&&!i||fe(this._bladeInfoPromises,{resourceType:c,resourceKind:s,promise:Promise.resolve(g)},200),g}),(()=>V))),MsPortalFx.tryImmediateResolve(p,(({icon:e,previewIcon:t,bladeName:s,bladeExtension:o})=>MsPortalFx.tryImmediateResolve(r,(i=>({displayName:i,deepLink:a,icon:e,previewIcon:t,bladeName:s,bladeExtension:o})))))}mapAssetTypeToAssetTypeInformation(e){const t=e.assetTypeManifest,s=t.keywords;return{extensionName:e.extension,assetType:t.name,options:t.options,browseType:void 0!==t.browseType?t.browseType:-1,browseLinkUri:this.getBrowseLinkUri(e),compositeDisplayName:e.compositeDisplayName,icon:e.icon,viewModelLocator:t.viewModelLocator,viewModel:t.viewModel,viewModelExtensionName:t.viewModelExtensionName,contracts:t.contracts,isPreview:e.isPreview,isDisabled:t.isDisabled,privateBrowse:t.privateBrowse,keywords:s?s.split(","):void 0,hiddenCommands:t.hiddenCommands,browseCommandExperiments:t.browseCommandExperiments,extensibleCommandsApiVersions:t.extensibleCommandsApiVersions}}mapAssetTypeToResourceTypeAssetTypeInformation(e,t){const s=e.assetTypeManifest,o=s.resourceType||{},i=s.browseType,n=s.keywords;let r=o.proxyRoutingFilters;r||"microsoft_azure_marketplace"!==e.lowerCaseExtension||"galleryrpitem"!==e.lowerCaseAssetType||(r=[1,3]);const a={resourceType:o.resourceTypeName,topLevelTenantAlias:o.topLevelTenantAlias,topLevelResourceTypeAlias:o.topLevelResourceTypeAlias,apiVersion:o.apiVersion,routingType:o.routingType,bladeName:s.bladeName,bladeExtensionName:s.bladeExtensionName,partName:s.partName,partExtensionName:s.partExtensionName,kinds:o.kinds,kindMap:e.kindMap,defaultKind:e.defaultKind,proxyRoutingFilters:r,extensionName:e.extension,assetType:s.name,options:s.options,browseType:void 0!==i?i:-1,browseLinkUri:this.getBrowseLinkUri(e),compositeDisplayName:e.compositeDisplayName,icon:e.icon,viewModelLocator:s.viewModelLocator,viewModel:s.viewModel,viewModelExtensionName:s.viewModelExtensionName,contracts:s.contracts,isPreview:e.isPreview,isDisabled:s.isDisabled,noPdlCreateBlade:s.noPdlCreateBlade,noPdlCreateExtension:s.noPdlCreateExtension||e.extension,noPdlCreateParameters:s.noPdlCreateParameters,postCreateBlade:s.postCreateBlade,marketplaceItemId:s.marketplaceItemId,marketplaceMenuItemId:s.marketplaceMenuItemId,staticOverview:s.staticOverview,privateBrowse:s.privateBrowse,keywords:n?.split(","),lowerCaseAssetType:e.lowerCaseAssetType,lowerCaseExtension:e.lowerCaseExtension,lowerCaseResourceType:e.lowerCaseResourceType,description:s.description,links:s.links,armBrowseOption:s.armBrowseOption,argBrowseOption:s.argBrowseOption,browseDeepLink:s.browseDeepLink,showArgColumns:s.showArgColumns,hiddenCommands:s.hiddenCommands,hideBrowseInfoBox:s.hideBrowseInfoBox,browseCommandExperiments:s.browseCommandExperiments,extensibleCommandsApiVersions:s.extensibleCommandsApiVersions,featureCardOptions:s.featureCardOptions};return s.variant&&(a.variant=s.variant),t&&(a.variants=s.variants.map((e=>({name:e.name,compositeDisplayName:le(e),viewModel:e.viewModel,viewModelExtensionName:e.viewModelExtensionName,contracts:e.contracts,partName:e.partName,partExtensionName:e.partExtensionName,bladeName:e.bladeName,bladeExtensionName:e.bladeExtensionName,options:e.options,browseType:e.browseType,browseLinkUri:e.browseLinkUri,browseRequiresRdfe:e.browseRequiresRdfe,resourceType:e.resourceType?.resourceTypeName,topLevelTenantAlias:e.resourceType?.topLevelTenantAlias,topLevelResourceTypeAlias:e.resourceType?.topLevelResourceTypeAlias,apiVersion:e.resourceType?.apiVersion,routingType:e.resourceType?.routingType,kinds:e.resourceType?.kinds,icon:e.icon,noPdlCreateBlade:e.noPdlCreateBlade,noPdlCreateExtension:e.noPdlCreateExtension,noPdlCreateParameters:e.noPdlCreateParameters,postCreateBlade:e.postCreateBlade,marketplaceItemId:e.marketplaceItemId,marketplaceMenuItemId:e.marketplaceMenuItemId,isPreview:e.isPreview,staticOverview:e.staticOverview,keywords:e.keywords,serviceMenuBlade:e.serviceMenuBlade,serviceMenuBladeExtension:e.serviceMenuBladeExtension,serviceMenuItemId:e.serviceMenuItemId,description:e.description,links:e.links,browseDeepLink:e.browseDeepLink})))),a}_getAssetTypePromiseWorker(e){const t=e();return t?Promise.resolve(t):MsPortalFx.tryImmediateResolve(this.assetTypesComplete,(()=>e()))}_getAssetTypeByResourceId(e){const t=i.ArmId.parse(e,!0);return 0===t.kind?Promise.reject(he(e)):MsPortalFx.tryImmediateResolve(this._getAssetTypeByResourceType(t.resourceType),(t=>{if(!t){const t=i.ArmId.parse(e);return MsPortalFx.tryImmediateResolve(this._getAssetTypeByResourceType(t.resourceType),(e=>e))}return t}))}_getAssetTypeByResourceType(e,t){const s=se(e),o=xe(this._assetTypeByResourceTypePromises,(e=>e.resourceType===s&&e.requirements===t));if(o)return o.promise;const i=Q(this._getAssetTypePromiseWorker((()=>this.getAssetTypeByResourceType(e,t))));if(!i.isRejected()){const e={resourceType:s,promise:i,requirements:t};fe(this._assetTypeByResourceTypePromises,e,200),i.isPending()&&i.catch((t=>{t.message===$&&H.warning($),G(this._assetTypeByResourceTypePromises,e)}))}return i}_getDynamicSelectionAndIconFromAssetId(e,t){const s=pe(e,t.assetId);if((0,n.supportsContract)(e.assetTypeManifest.contracts,32768)){const t=s.selection;t.extension="HubsExtension",t.detailBlade=T.AssetMenuBlade,t.detailBladeInputs={assetName:e.assetTypeManifest.name,extensionName:e.extension}}return Promise.resolve(s)}_getDynamicSelectionAndIconFromResourceId(e,t,s,o,a){const l=pe(e,o.assetId),c=l.selection,d=e?.assetTypeManifest;if(1===s.kind||4===s.kind)return c.extension="HubsExtension",c.detailBlade=k,Promise.resolve(l);const p=d?.resourceType;if(p&&p.routingType===N.Extension&&!(0,n.supportsContract)(d.contracts,64))return Promise.resolve(l);if(d&&(0,n.supportsContract)(d.contracts,128))return c.extension="HubsExtension",c.detailBlade=k,Promise.resolve(l);const u=xe(this._selectionFromResourceIdPromises,(e=>e.resourceId===t));if(u)return u.promise;let m;if(d&&(!p?.kinds||(0,n.supportsContract)(d.contracts,512)&&!(0,n.supportsAnyContract)(d.contracts,13312)))m=Promise.resolve(l);else{let s;if((0,n.supportsContract)(d.contracts,64)){const o=e.assetTypeManifest.viewModelLocator||e.assetTypeManifest.viewModel,n=this._lifetimeManager.createChildLifetime();s=this._viewModelManager.getViewModel(e.extension,o,11).then((s=>{let r=!1;if(n.registerForDispose((()=>{r=!0,this._viewModelManager.releaseViewModel(s)})),!r)return s.content().getResource(t).then((e=>MsPortalFx.extend2(e,{armId:i.ArmId.parse(e.id,!0)})));throw ge("asset type service",e.extension,o)})).finally((()=>n.dispose()))}else s=(0,r.getResource)(t,a);m=MsPortalFx.tryImmediateResolve(s,(t=>{if(!d||d.name===_)return Promise.resolve(l);if((0,n.supportsOption)(d.options,2))return Promise.resolve(l);const s=e.kindMap&&(e.kindMap[(t.kind||"").toLowerCase()]||e.kindMap[(e.defaultKind||"").toLowerCase()]);if(s&&(0,n.supportsOption)(s.options,2))return Promise.resolve(l);let o=!1;return(0,n.supportsContract)(d.contracts,8)&&(c.extension="HubsExtension",c.detailBlade=k,o=!0),MsPortalFx.tryImmediateResolve(MsPortalFx.require("MsPortalImpl/Services/Services.AssetTypesDelayed"),(s=>{if(p?.kinds){let i=!1,r=!1,a=!1;if(s.getIconAndBladeFromAssetTypeInformation(t,e.kindMap,e.defaultKind,null,(e=>{e?(0,n.supportsContract)(d.contracts,16)&&(c.extension="HubsExtension",c.detailBlade=k,o=!0):o=!1}),(e=>{r||(r=!0,l.isPreview=e)}),(e=>{i||(i=!0,l.icon=e)}),((t,s)=>{a||o||(a=!0,c.extension=t||e.extension,c.detailBlade=s)})),a||o)return l}return l}))})).catch((s=>{const i=function(e,t,s){let o;return R.isInstanceOfErrorType(e,R.Error)?o=K(e,s):L.isXMLHttpRequestLike(e)?(o=K(e.message||t,e.stack,s),MsPortalFx.shallowCopyFromObject(o,e,["readyState","status","statusText","responseText"])):o=K(new R.Error({message:t,data:s,innerErrors:e})),o}(s,"_getDynamicSelectionAndIconFromResourceId have unexpected error.",{assetType:e,resourceId:t,assetId:o,telemetry:a});throw i}))}const h={resourceId:t,promise:m};return fe(this._selectionFromResourceIdPromises,h,200),m.catch((e=>{MsPortalFx.remove(this._selectionFromResourceIdPromises,h)})),m}_preventDuplicateResourceTypes(e,t,s){if(this._resourceTypeMap[e]){const o=xe(this.assetTypes,(t=>t.lowerCaseResourceType&&t.lowerCaseResourceType===e)),i=be(o.assetTypeManifest),n=be(s);if(!(i<n))return i>n||H.verbose(`Extension <${t}> has duplicate resource type <${e}> also found in <${o.extension}> extension`),!1;delete this._resourceTypeMap[e],MsPortalFx.remove(this.assetTypes,o)}return!0}_listenForExtensions(){const e=this._mappedBrowseBlades=FxImpl.lowerCaseStringMap(),s={system:!0,"v2.0,system":!0,"v12.0,system":!0},o=(0,v.isFeatureEnabled)("artbrowse");return MsPortalFx.tryImmediateResolve(Q(this._policyForResourceTypesPromise),(i=>{let r;i&&(r={required:i.required?.length&&FxImpl.lowerCaseStringMap(),deny:i.deny?.length&&FxImpl.lowerCaseStringMap()},i.required?.forEach((e=>r.required.set(e,!0))),i.deny?.forEach((e=>r.deny.set(e,!0))));const a=[];return this._manifestCache.getManifests("assetTypes",((t,i)=>{e.has(t)||e.set(t,FxImpl.lowerCaseStringMap());const l=i.assetTypes;l&&l.forEach((l=>{if(4===l.browseType)return;if(3===l.browseType&&!(l.browseLinkUri||"").match(re))return;const c=this._redirectMap.getAssetRedirect(t+"_"+l.name),d=c&&c.toExtension===t&&c.toAsset===l.name;if(c&&!d)return;const p=l.resourceType,u=p?.resourceTypeName,m=de(l);if(1===l.armBrowseOption&&!o)return void q(`Skipping asset type <${l.name}> due to lack of ARG support and ARM browse options 'no fallback'`);if(u){if(u.split("/").length<2)return void q(`Skipping asset type <${l.name}> with invalid resource type <${u}> in extension <${t}>`);if(!this._preventDuplicateResourceTypes(m,t,l))return;this._resourceTypeMap[m]=!0,a.push(u.toLowerCase())}const h=(s,o,i)=>{if(s&&i){const i=o||t;e.has(i)||e.set(i,FxImpl.lowerCaseStringMap()),e.get(i).set(s,!0)}},g=p?.kinds,f=(0,n.supportsContract)(l.contracts,8);if(g?.length){if(g.forEach((e=>{h(e.bladeName||l.bladeName,e.bladeExtensionName||l.bladeExtensionName,void 0!==e.useResourceMenu?e.useResourceMenu:f),e.filterMap=MsPortalFx.extendArrayIntoMap(Object.create(null),e.kinds||[e.name],(e=>se(e)),(e=>!0)),e.isDefault&&(e.filterMap[""]=!0)})),"SqlAzureExtension"===t&&"Database"===l.name){const e=MsPortalFx.find(g,(e=>"v12.0,user,datawarehouse"===se(e.name))),t=MsPortalFx.find(g,(e=>"v12.0,user,datawarehouse,gen2"===se(e.name)));e&&t&&(e.filterMap[se(e.name)]=!0,e.filterMap[se(t.name)]=!0,t.filterMap[se(e.name)]=!0,t.filterMap[se(t.name)]=!0)}}else h(l.bladeName,l.bladeExtensionName,f);!function(e,t){const s=(e,t)=>MsPortalFx.unique((e||"").split(",").filter((e=>!!e)).concat(t)).join(","),o=t.name,i=ce(e,o,"");i?.length&&(t.keywords=s(t.keywords,i)),((t.resourceType||{}).kinds||[]).forEach((t=>{const i=se(t.name),n=ce(e,o,i);n?.length&&(t.keywords=s(t.keywords,n))}))}(t,l),function(e,t){try{if(!e||!t?.name)return;if(!Object.keys(Y)?.length){const e=Object.keys(Z);for(const t of e)for(const e of Object.keys(Z[t])){const s=t.toLowerCase()+"_"+e.toLowerCase();if("string"==typeof Z[t][e])Y[s]=Z[t][e];else if("object"==typeof Z[t][e]){const o=Object.keys(Z[t][e]);if(o.length)for(const i of o){const o=s+"."+i.toLowerCase();Y[o]=Z[t][e][i]}}}}const s=e.split("_").join("").toLowerCase()+"_"+t.name.toLowerCase();t.description||(t.description=Y[s]);for(const e of t.resourceType?.kinds||[]){const t=s+"."+e.name.replace(/[.,]/g,"").toLowerCase();e.description||(e.description=Y[t])}}catch(e){H.verbose(`Failed to update asset type description. Error: ${e}`)}}(t,l);const x=J(t,l.name),b=function(e,t,s,o,i){const r=o.resourceType?.kinds||[],a=MsPortalFx.find(r,(e=>e.isDefault));let l=(0,n.supportsOption)(o.options,16);return!l&&i&&o.resourceType?.resourceTypeName&&(i.required&&(l=l||!i.required.has(o.resourceType?.resourceTypeName)),i.deny&&(l=l||i.deny.has(o.resourceType?.resourceTypeName))),l&&(o.isDisabled=l),{lowerCaseAssetType:se(o.name),lowerCaseExtension:se(e),lowerCaseAssetTypeId:se(t),lowerCaseResourceType:de(o)||"",kindMap:MsPortalFx.extendArrayIntoMap(Object.create(null),r,(e=>se(e.name)),MsPortalFx.identity),defaultKind:a&&se(a.name),assetTypeManifest:o,id:t,extension:e,compositeDisplayName:ae(o),icon:o?.icon||X,isPreview:s.isPreview||!!o.isPreview}}(t,x,i,l,r);void 0===l.options&&(l.privateBrowse&&(l.options=1|l.options),"microsoft.sql/servers/databases"===m&&b.kindMap&&(0,v.forEachKey)(b.kindMap,((e,t)=>{s[e]&&void 0===t.options&&(t.options=2|t.options)}))),"microsoft_azure_datafactory"!==t.toLowerCase()||"datafactory"!==l.name.toLowerCase()&&"datafactoryv2"!==l.name.toLowerCase()||void 0!==l.argBrowseOption||(l.argBrowseOption=4),this.assetTypes.push(b)}))})).then((()=>(a.unshift(t.lowerCaseAllResourcesType),a.unshift(t.lowerCaseResourcesWithTagType),(0,C.getBrowseCuration)()))).then((e=>this._manifestCache.getManifests("featureCards",((t,s)=>{const o=s?.featureCards;e.featureCardAllowList&&o?.filter((s=>-1!==e.featureCardAllowList.findIndex((e=>e.extension.toLowerCase()===t.toLowerCase()&&e.id.toLowerCase()===s.id.toLowerCase()))))?.sort(((s,o)=>e.featureCardAllowList.findIndex((e=>e.extension.toLowerCase()===t.toLowerCase()&&e.id.toLowerCase()===s.id.toLowerCase()))-e.featureCardAllowList.findIndex((e=>e.extension.toLowerCase()===t.toLowerCase()&&e.id.toLowerCase()===o.id.toLowerCase()))))?.forEach((e=>{if(e.resourceTypes){const s=FxImpl.lowerCaseStringMap();MsPortalFx.forEachKey(e.resourceTypes,((e,t)=>s.set(e,t))),a.forEach((o=>{(s.has(o)||s.has("*"))&&(this.featureCardMap.has(o)||this.featureCardMap.set(o,[]),this.featureCardMap.get(o).push({extension:t,manifest:e}))}))}}))}))))}))}_getAssetTypePromise(e,t,s){return this._getAssetTypePromiseWorker((()=>this.getAssetType(e,t,s)))}};Pe=__decorate([__metadata("fx:diagnostics",[e,"AssetTypeServiceImpl"]),s.Class(),__metadata("design:paramtypes",[s.Container,p.ViewModelManager,h.ManifestCache,h.RedirectMap,x.Features,m.AuthStateManager])],Pe);class we{static create(e){return e}}t.AssetTypeService=we,__decorate([__metadata("fx:diagnostics",[e,"AssetTypeService"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[Pe]),__metadata("design:returntype",we)],we,"create",null)})),
define("MsPortalImpl/Services/Services.ExtensionTokensManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Services/Services.SecurityTokens","FxInternal/ExtensionRuntime"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionTokensManager=void 0;var r=MsPortalFx.Base,a=r.Security,l=FxImpl.Security,c=r.Diagnostics.Telemetry;const d=r.Diagnostics.createLog(e),p=l.tokenErrors,u=p.accessDenied,m=p.sessionEnded;class h{constructor(e,t,s){this._shellTokenManager=e,this._extensions=t,this._postBootCache=s,this.createAuthTokenCache=MsPortalFx.memoize((e=>{const t=a.createAuthTokenCache((t=>this.getSecurityToken({...t,extensionName:e,resourceName:t.resourceName||"",skipCache:t.skipCache})));return{getToken:s=>{const o=s&&s.resourceName;return this._shellTokenManager.portalAuthHandlerPromise.then((i=>null!==i?this._postBootCache.get(e).then((({extensionEnvironment:i})=>{try{i="string"==typeof i?JSON.parse(i):i}catch(e){d.warning(new MsPortalFx.Errors.Error({message:"Unable to parse the extensionEnvironment configuration. Error: "+MsPortalFx.getLogFriendlyMessage(e),innerErrors:e})),i=null}let r="",a="";const l=i?.authorization,c=n.getExtensionDefinedResourceAccessInfo({resourceName:o,extensionName:e,authorization:l});return c&&(r=c.resource,a=c.useInfrastructureTenant?FxImpl.internalEnv.fxAadInfrastructureTenantId:""),t.getToken({...s,audience:r,tenantId:a})})):t.getToken(s)))}}}))}getSecurityToken(e){const{extensionName:t,resourceName:s,skipCache:o,wwwAuthHeader:i}=e,n=this._extensions[t]??{},r=n.flags,a=this._shellTokenManager.shellTokenCache,l=!!(16&r);if(s&&l)return Promise.resolve({error:u});if(this._shellTokenManager.isSessionEnded())return Promise.resolve({error:m});const d=!s&&8&r,p="telemetrytoken"===s.toLowerCase(),h=s.toLowerCase()===FxImpl.nonCaeArmAliasLowerCase;if(a&&(d||p||h)&&!o&&!e.tenantId)return a.getToken({resourceName:s,wwwAuthHeader:i,isThirdPartyExtension:l}).then((e=>({token:e})));const g=c.start({source:"ExtensionTokensManager",action:"GetToken",name:e.extensionName}),f=this._shellTokenManager.getToken({...e,extensionIsSideloaded:n.isSideloaded,isThirdPartyExtension:l});return f.then((e=>{c.endTrace(g,!!e.token,{resourceName:s})})),f}async getPopToken(e){const t=await this._shellTokenManager.getPopToken(e);return{header:t.authHeader,expiresAt:t.expiresAt}}async getSshCertToken(e){const t=await MsPortalEarly.extensionAuthMetadataInPortalConfig||{};let s;try{s=t[e.extensionName.toLowerCase()].oAuthClientId}catch(e){return Promise.reject(`Failed to get extensionClientId. Error: ${e}`)}const o=await this._shellTokenManager.getSshCertToken({...e,extensionClientId:s});return o?.token?.header?{header:o.token.header,expiresAt:o.token.expiresAt}:o.error||o.errorMessage?Promise.reject(`Failed to fetch token. Status: ${o.error}, Message: ${o.errorMessage}`):Promise.reject("Unknown error resulting in an empty token header.")}static create(e,t,s){return new h(e,FxImpl.mapValues(t.extensionsAsMap,(e=>({flags:e.flags,isSideloaded:e.isSideloaded}))),s)}}t.ExtensionTokensManager=h,__decorate([__metadata("fx:diagnostics",[e,"ExtensionTokensManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.SecurityTokensManager,o.ExtensionManagerOptions,o.PostBootCache]),__metadata("design:returntype",h)],h,"create",null)})),
define("MsPortalImpl/Services/Services.GlobalResourceFilters",["require","exports","Fx/DependencyInjection","Weave","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Subscriptions","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","FxInternal/AsyncLoader","FxInternal/ResourceManagement/GlobalResourceFilters","FxInternal/Weave","Fx/Telemetry","FxInternal/AsyncLoader"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u){"use strict";var m;Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalResourceFilterObservableHandler=t.ResourceFilterManager=void 0;var h=MsPortalFx.Base,g=h.Diagnostics.Telemetry,f=MsPortalFx.Hubs.Notifications.NotificationStatus;r.Subscriptions.CountTypeEnum;const x=h.Diagnostics.createLog(e),b="selected.subscriptions",y={currentFilterId:"",filters:Object.create(null),optedIn:void 0};function v(e,t){e.setSettings({store:19,settings:{currentFilterId:t.currentFilterId,filters:t.filters,optedIn:t.optedIn}})}let M=m=class{static async create(e){const t=await e.getAsync(i.SettingsManager),s=await async function(e){let t,s;try{t=await e.queryStore(19)}catch(e){return x.warning(`Error retrieving global resource filter settings from user settings. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`),y}if(!t)return y;try{s=t.filters||y.filters}catch(e){x.warning(new MsPortalFx.Errors.Error({message:`Error parsing global resource filter settings. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`,innerErrors:e})),s=y.filters,t.currentFilterId=y.currentFilterId}let o={currentFilterId:t.currentFilterId||y.currentFilterId,filters:s,optedIn:t.optedIn};o.currentFilterId&&!s[o.currentFilterId]&&(o={...o,currentFilterId:y.currentFilterId}),MsPortalFx.deepEquals(o,t)||v(e,o);const i=o.filters[o.currentFilterId],n={filterCount:Object.keys(o.filters).length};return i?(n.currentFilterId=i.id,n.facetCount=i.facets.length):n.currentFilterId="<default>",(0,p.trace)({source:"ResourceFilterManager",action:"getFilterSettingsFromUserSettings",data:n}),o}(t);return new m(e,s)}constructor(e,t){this._diContainer=e,this._lifetime=new FxImpl.TriggerableLifetimeManager,MsPortalImpl.sessionStorage.getItem("subscriptions_selected_migrated")&&(MsPortalImpl.sessionStorage.removeItem("subscriptions_selected_migrated"),e.getAsync(u.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((e=>e.addClientNotification({title:a.filtersOptInSuccessTitle,description:a.filtersOptInSuccessMessage,status:f.Success,timestamp:new Date}))));const s=[];MsPortalFx.forEachKey(t.filters,((e,t)=>s.push(t))),this._filters=(0,o.makeArrayComputation)(s),this._filtersMap=this._filters.compose((e=>e.reduce(((e,t)=>(e[t.id]=t,e)),Object.create(null)))),this._currentFilterId=(0,o.makeWritableComputation)(t.currentFilterId?t.currentFilterId:""),(0,o.subscribe)(this._lifetime,[this._filtersMap,this._currentFilterId],(async(e,s)=>{v(await this._diContainer.getAsync(i.SettingsManager),{filters:e||Object.create(null),currentFilterId:s||"",optedIn:t.optedIn})})),this._currentFilterComputation=(0,o.composeComputation)([this._currentFilterId,this._filtersMap],((e,t)=>t[e]||null)),this.canAddFilter=this._filters.compose((e=>e.length<10)),this.currentFilterObservable=(0,d.toObservable)(this._lifetime,this.currentFilter)}get filters(){return this._filters}get currentFilter(){return this._currentFilterComputation}activateFilter(e){if(!MsPortalFx.isNullOrUndefined(e))return""===e?this._currentFilterId(y.currentFilterId):void((0,o.evaluate)(this._lifetime,this._filtersMap)[e]?this._currentFilterId(e):x.warning(`Attempted to activate filter with ID "${e}" which does not exist.`))}addFilter(e,t,s=!1){if(this._filters.value.length>=10)return null;const o=MsPortalFx.newGuid(),i={id:o,name:e,facets:t};return this._filters.push(i),s&&this._currentFilterId(o),i}deleteFilter(e){if(!e)return;const t=MsPortalFx.findIndex(this._filters.value,(t=>t.id===e));t<0?x.warning(`Filter with ID "${e}" could not be located.`):(this._currentFilterId.value===e&&this._currentFilterId(y.currentFilterId),this._filters.splice(t,1))}updateFilter(e){if(!e)return;const t=(e||{}).id;if(!t)return;const s=MsPortalFx.findIndex(this._filters.value,(e=>e.id===t));s<0?x.warning(`Filter with ID "${t}" could not be located.`):this._filters.set(s,e)}async createSelectedSubscriptionsFilter(){const e=(0,o.evaluate)(this._lifetime,this._filtersMap)[b],t=g.startTrace({source:"ResourceFilterManager",action:"MigrateSelectedSubscriptions"}),s=await this._diContainer.getAsync(n.SubscriptionsUserContext),i=(await s.getGlobalSelectedSubscriptions())().map((e=>e.subscriptionId)),r=await s.getAllSubscriptionsCount();if(!i.length)return g.completeTrace(t,{data:{selectedSubscriptionCount:0}}),e&&(this.deleteFilter(b),this.activateFilter("")),null;if(1===r.type&&i.length===r.value)return g.completeTrace(t,{data:{allSelected:!0}}),e&&(this.deleteFilter(b),this.activateFilter("")),null;const l={id:b,name:a.UiSettings.selectedSubscriptionsFilterName,facets:[{type:"subscriptionId",operator:"==",value:i}]};return e?this.updateFilter(l):this._filters.push(l),this._currentFilterId(b),g.completeTrace(t,{data:{previouslyMigrated:!!e,selectedSubscriptionCount:i.length}}),l}};t.ResourceFilterManager=M,__decorate([__metadata("fx:diagnostics",[e,"ResourceFilterManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",Promise)],M,"create",null),t.ResourceFilterManager=M=m=__decorate([__metadata("fx:diagnostics",[e,"1"]),s.Class(),__metadata("design:paramtypes",[s.Container,Object])],M),t.getGlobalResourceFilterObservableHandler=(0,l.defineHandler)(c.getGlobalResourceFilterObservableEndPoint,(e=>e.diContainer.getAsync(M).then((e=>e.currentFilterObservable))))})),
define("MsPortalImpl/Services/Services.Permissions",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","Fx/ResourceManagement","Fx","FxHubs/Helpers/PermissionsHelpers"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PermissionsChecker=t.hasPermissionsToShell=t.PermissionsManager=t.isRDFEAction=void 0;var a=FxImpl.Extension;const l=window,c=()=>MsPortalFx.require(e.normalize("./PermissionsHelpers"));function d(e){return e&&1===e.length&&"rdfe"===e[0]}t.isRDFEAction=d;class p{static create(e){return new u(e)}}t.PermissionsManager=p,__decorate([__metadata("fx:diagnostics",[e,"PermissionsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",p)],p,"create",null);class u{constructor(e){this._diContainer=e;const t=m(((e,t)=>c().then((s=>s.getPermissions(e,t)))));this._cachedPermissionsGetter=t,this._getPermissionsCallback=(e,s)=>t.getPermissions(e,s)}hasPermission(e,t,s){if(d(t))return c().then((o=>o.hasPermissionsImpl(this._diContainer,e,t,s)));return 0===i.ArmId.parse(e,!0).kind?Promise.resolve("The entity ID for hasPermission must be a resource ID, a subscription ID or a resource group ID"):c().then((o=>o.hasPermission(e,t,null,this._getPermissionsCallback,s)))}getDiagnosticsData(){const e=[],t=this._cachedPermissionsGetter.getCachedPermissions(),s=[];return Object.keys(t).forEach((o=>{e.push(t[o]().then((e=>{s.push({entityId:o,permissions:e})})))})),Promise.all(e).then((()=>s))}}function m(e,t){if(!t&&l.fxDisableRbacCache)return{getPermissions:e,getCachedPermissions:()=>({}),clear:MsPortalFx.noop};{let t;const s=()=>(t=t||{},t);return{getPermissions:(t,o)=>{const i=s();return(i[t]||(i[t]=(0,n.memoizePromise)((t=>e(t,o)))))(t)},getCachedPermissions:s,clear:e=>{const t=s()[e];t&&t.clear()}}}}t.hasPermissionsToShell=o.defineHandler(a.hasPermissionsToShell,(e=>e.diContainer.get(p).hasPermission(e.messageArg.entityId,e.messageArg.requestedActions,e.messageContext.srcWindowId)));class h{constructor(e,t){this._permissionsCache=m((t=>c().then((s=>s.getPermissionsFromArm(t,e)))),t)}hasPermission(e,t,s,o){return d(t)?this.hasRdfePermissions(e):c().then((i=>i.hasPermission(e,t,s,(e=>this._permissionsCache.getPermissions(e,o)),o)))}getDiagnostics(){return this._permissionsCache.getCachedPermissions()}hasRdfePermissions(e){const t=i.ArmId.parse(e,!0);return 1!==t.kind?Promise.resolve(!1):MsPortalFx.Azure.getSubscriptionInfo(t.subscription).then(r.subscriptionRequiresRdfe)}static create(){return new h("HubsExtension")}}t.PermissionsChecker=h,__decorate([__metadata("fx:diagnostics",[e,"PermissionsChecker"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",h)],h,"create",null)})),
define("MsPortalImpl/Services/Services.PersistentStorage",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","FxInternal/AsyncLoader","FxInternal/RpcEndPointsCore"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllKeysHandler=t.clearHandler=t.removeSettingsHandler=t.readSettingsHandler=t.writeSettingHandler=t.StorageCapacityExceededError=t.KeySizeExceededError=t.PersistentStorageSettings=void 0;var r=MsPortalFx.Base.Diagnostics.Telemetry;const a=e=>`${e}PersistentStorage`,l=e=>`__fx_metadata__${e}`;let c=class{constructor(e){this._settingsManager=e,this._cache={}}writeSetting(e,t,s,o=[]){const i=(e,t)=>(d.error(e,0,t),Promise.reject(e.message));if(t.length>241)return i(new p,{keyLength:t.length});const n=a(e),r=this._traceAction(e,"WritePersistentSettings");return this._getCacheStorage(e).then((a=>{const c=[[t,s]];o.length&&c.push([l(t),JSON.stringify({readers:o})]);const d=c.reduce(((e,t)=>e+this._estimateExistingSize(a,t[0])),0),p=c.reduce(((e,t)=>e+this._estimateSize(t[0],t[1])),0),h=p-d,g=function(e){return m.includes(e)}(e)?102400:10240;return h+a.size>g?i(new u,{keyValuePairsSize:h,cacheSize:a.size}):Promise.all(c.map((e=>{const[t,s]=e,o=this._estimateSize(t,s);let i=0;return a.storage.has(t)&&(i=this._estimateExistingSize(a,t)),a.size+=o-i,a.storage.set(t,s),this._settingsManager.setSetting(n,t,s)}))).then((()=>{r({sizeAdded:p})}))}))}readSettings(e,t,s=e){const o=this._traceAction(e,"ReadPersistentSettings");return this._getCacheStorage(e).then((i=>{const n=t.reduce(((t,o)=>{const n=i.storage.get(o),r=i.storage.get(l(o))||"",a=r.length?JSON.parse(r):{},c=a?.readers;return(e===s||"*"===c||c?.includes(s))&&void 0!==n&&(t[o]=n),t}),{});return o({numberOfRequestedKeys:t.length,numberOfReturningPairs:Object.keys(n).length}),n}))}removeSettings(e,t){const s=a(e),o=t.concat(t.map(l)),i=this._traceAction(e,"RemovePersistentSettings");return this._getCacheStorage(e).then((e=>(o.forEach((t=>{e.storage.has(t)&&(e.size-=this._estimateExistingSize(e,t),e.storage.delete(t));const s=l(t);e.storage.has(s)&&(e.size-=this._estimateExistingSize(e,s),e.storage.delete(s))})),this._settingsManager.deleteSettings({store:s,keys:o}).then(i).catch((e=>{d.error(e)})))))}clear(e){const t=this._traceAction(e,"ClearPersistentStorage");return this.getAllSettingsKeys(e).then((s=>this.removeSettings(e,s).then((()=>{t({numberOfKeysRemoved:s.length})}))))}getAllSettingsKeys(e){return this._getCacheStorage(e).then((e=>Array.from(e.storage.keys()).filter((e=>!e.startsWith("__fx_metadata__")))))}_getCacheStorage(e){const t=Date.now();return this._cache[e]?.expires>t?Promise.resolve(this._cache[e]):this._settingsManager.querySettings({store:a(e)}).then((s=>{let o=0;const i=Object.keys(s).map((e=>(o+=this._estimateSize(e,s[e]),[e,s[e]])));return this._cache[e]={expires:t+36e5,storage:new Map(i),size:o},this._cache[e]})).catch((e=>(d.error(e),{expires:t+36e5,storage:new Map,size:0})))}_estimateSize(e,t){return 2*(e.length+t.length)}_estimateExistingSize(e,t){return e.storage.has(t)?this._estimateSize(t,e.storage.get(t)||""):0}_traceAction(e,t){const s=MsPortalFx.startTimer(),o=e=>e&&{size:e.size,numberOfKeys:Array.from(e.storage.keys()).length},i=o(this._cache[e]);return n=>{const a=o(this._cache[e]);r.trace({source:"Services.PersistentStorage",action:t,actionModifier:r.ActionModifier.Complete,name:e,data:{initialCacheState:i,finalCacheState:a,extraData:n,duration:s()}})}}};t.PersistentStorageSettings=c,t.PersistentStorageSettings=c=__decorate([__metadata("fx:diagnostics",[e,"PersistentStorageSettings"]),s.Class(),__metadata("design:paramtypes",[o.SettingsManager])],c);const d=MsPortalFx.Base.Diagnostics.createLog(e);class p extends Error{constructor(){super("Attempting to set a key/value pair that has a key size that exceeds the portal's limit: 241 characters."),this.name="KeySizeExceededError"}}t.KeySizeExceededError=p;class u extends Error{constructor(){super("Attempting to set a key/value pair which when combined with all settings would exceed the portal's limit: 10240 bytes."),this.name="StorageCapacityExceededError"}}t.StorageCapacityExceededError=u,t.writeSettingHandler=(0,i.defineHandler)(n.writeSettingEndPoint,(e=>e.diContainer.get(c).writeSetting(e.messageContext.srcWindowId,e.messageArg.key,e.messageArg.value,e.messageArg.readers))),t.readSettingsHandler=(0,i.defineHandler)(n.readSettingsEndPoint,(e=>e.diContainer.get(c).readSettings(e.messageArg.extensionName,e.messageArg.keys,e.messageContext.srcWindowId))),t.removeSettingsHandler=(0,i.defineHandler)(n.removeSettingsEndPoint,(e=>e.diContainer.get(c).removeSettings(e.messageContext.srcWindowId,e.messageArg.keys))),t.clearHandler=(0,i.defineHandler)(n.clearEndPoint,(e=>e.diContainer.get(c).clear(e.messageContext.srcWindowId))),t.getAllKeysHandler=(0,i.defineHandler)(n.getAllKeysEndPoint,(e=>e.diContainer.get(c).getAllSettingsKeys(e.messageContext.srcWindowId)));const m=["Microsoft_Azure_Health","Microsoft_AAD_IAM"]})),
define("MsPortalImpl/Services/Services.PortalIdleState",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortalIdleStateService=void 0;class o{constructor(e,t){if(this._win=e,this._defaultPollMS=t,this._state=0,this._handleId=1,this._iteration=0,this._actions=new Map,this._frameInFocus=!1,this._win.addEventListener("blur",this._blurFunc=()=>{document.activeElement instanceof HTMLIFrameElement||this._signalIdle(this._defaultPollMS)}),this._win.addEventListener("focus",this._focusFunc=()=>{this.signalBusy()}),MsPortalFx.isFeatureEnabled("displayidlestateindom")){const e=document.getElementById("web-container");e.dataset.frameinfocus=String(this._frameInFocus),e.dataset.idlestate=String(this._state)}}dispose(){const e=this._win;return!!e&&(this._win=null,e.removeEventListener("blur",this._blurFunc),e.removeEventListener("focus",this._focusFunc),this._setIdleState(0),!0)}addCallbacks(e){const t=this._handleId++;return this._actions.set(t,e),t}removeCallbacks(e){return this._actions.delete(e)}signalBusy(e=0,t){if(this._blurStartTime=null,this._setFrameInFocus(1===e),1===e){const e=document.getElementsByClassName("fxs-topbar-sidebar-collapse-button")[0];e?.offsetWidth>0&&e?.offsetHeight>0&&3!==t&&$(e).trigger("fxtogglesidebar",{collapse:!0})}1===this._state&&(this._setIdleState(2),this._processCallbacks(5e3))}signalIdle(e=0){(0===e||this._frameInFocus)&&this._signalIdle(0)}static create(){return new o(window,6e4)}_setFrameInFocus(e){this._frameInFocus=e,MsPortalFx.isFeatureEnabled("displayidlestateindom")&&(document.getElementById("web-container").dataset.frameinfocus=String(this._frameInFocus))}_setIdleState(e){this._state=e,MsPortalFx.isFeatureEnabled("displayidlestateindom")&&(document.getElementById("web-container").dataset.idlestate=String(this._state))}_signalIdle(e){this._blurStartTime||(this._blurStartTime=Date.now()),this._setIdleState(1),this._processCallbacks(e)}_processCallbacks(e){if(!this._win)return;const t=()=>{let e;switch(this._state){case 2:this._setIdleState(0),e=e=>e.onBusy?.(new Date);break;case 1:this._setIdleState(1),e=e=>e.onIdle(Math.floor((Date.now()-this._blurStartTime)/6e4));break;default:return}const t=(t,s)=>{const o=t[s],i=this._actions.get(o);i&&e(i)},s=Array.from(this._actions.keys()),o=this._actions.size,i=this._iteration%o;this._iteration++;for(let e=i;e<o+i;e++)t(s,e%o)},s=this._timeoutHandle;s&&this._win.clearTimeout(s),this._timeoutHandle=this._win.setTimeout((()=>{this._timeoutHandle=null;try{t()}finally{0!==this._state&&this._processCallbacks(this._defaultPollMS)}}),e)}}t.PortalIdleStateService=o,__decorate([__metadata("fx:diagnostics",[e,"PortalIdleStateService"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",o)],o,"create",null)})),
define("MsPortalImpl/UI/UI.BladeOpener",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BladeOpener=void 0;const i=o.getFactory("MsPortalImpl/UI/UI.BladeOpenerImpl","BladeOpener");let n=class{constructor(e){this._diContainer=e}openBlade(e,t={}){return this._diContainer.getAsync(i()).then((s=>s.openBlade(e,t)))}};t.BladeOpener=n,t.BladeOpener=n=__decorate([__metadata("fx:diagnostics",[e,"BladeOpener"]),s.Class(),__metadata("design:paramtypes",[s.Container])],n)})),
define("MsPortalImpl/UI/UI.DesktopManager",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviouslyFocusedElement=t.DesktopManagerMode=t.BladeDescriptor=void 0;let o=class{};t.BladeDescriptor=o,t.BladeDescriptor=o=__decorate([__metadata("fx:diagnostics",[e,"BladeDescriptor"]),s.Value("composition")],o);let i=class{constructor(){this.value=ko.observable(0)}};t.DesktopManagerMode=i,t.DesktopManagerMode=i=__decorate([__metadata("fx:diagnostics",[e,"DesktopManagerMode"]),s.Class()],i);let n=class{constructor(){this.value=ko.observable()}};t.PreviouslyFocusedElement=n,t.PreviouslyFocusedElement=n=__decorate([__metadata("fx:diagnostics",[e,"PreviouslyFocusedElement"]),s.Class()],n)})),
define("MsPortalImpl/UI/UI.NavigationManager.ForceSignIn",["require","exports","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forceSignIn=void 0;var r=MsPortalFx.Base,a=r.Diagnostics.Telemetry;t.forceSignIn=async function(e,t,l){const c=a.startTrace({source:"UI.NavigationManager",action:"ForceSignInHandler"}),d=e.get(s.AuthStateManager),p=await d.getUserInfo(),u={callingExtension:l,reason:t.reason,tenantSource:"Options"},m=d.getSignedInUserTenant();let h=t.tenantId;h?h.toLowerCase()!==m.toLowerCase()&&(u.newTenantId=h):(h=m,u.tenantSource="Current");const g=new MsPortalFx.Base.UriBuilder(fx.environment.applicationPath);if(g.setRelativePath(`${g.getRelativePath()}/${h}`),t.bladeDeepLink)g.fragment=MsPortalFx.sanitizeMessage(t.bladeDeepLink);else if(t.bladeReference){const e=t.bladeReference,s=(0,i.getBladeDeepLink)(e.extensionName,e.bladeName,e.parameters,{selectedMenuItemId:t.bladeReference.menuId});u.deepLink=MsPortalFx.sanitizeMessage(s),g.fragment=s}g.query=new r.QueryStringBuilder((0,n.getQueryStringSegment)(location.href)),g.query.setParameter("loginHint",MsPortalFx.isFeatureEnabled("preferredusername")?p.preferredUsername:p.email),g.query.setParameter("forcesignin","true"),g.query.setParameter("feature.msaljs",MsPortalFx.isFeatureEnabled("msaljs")+"");const f=new URLSearchParams(location.search).get("msaljslogin");if(f&&g.query.setParameters((0,s.getMsalJsLoginQueryParameters)(f+"")),t.signInParameters){const e=function(e){const t=Object.create(null);return Object.keys(e).forEach((s=>{"acr_values"!==s&&"amr_values"!==s&&"claims"!==s||(t[s]=e[s])})),t}(t.signInParameters);g.query.setParameter("signInParameters",JSON.stringify(e)),u.providedSignInParameters=Object.keys(t.signInParameters),u.effectiveSignInParameters=Object.keys(e)}a.completeTrace(c,u),e.get(o.WindowManager).redirect({uri:g.toString(),redirectAction:3,reason:"forceSignIn"})}})),
define("MsPortalImpl/Interactions/Interactions.DismissHandler",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validatePreviousFocusedElement=t.dismissByLogName=t.unregister=t.register=t.dispose=t.initialize=void 0;const s=document,o=MsPortalFx.Base.Diagnostics.createLog(e);let i=!1;const n=[];function r(e){const t=e&&"function"==typeof e.dismissFn&&function(e){const t="function";let s=!!e;return e.shouldDismissOnFocusOutFn&&(s=s&&typeof e.shouldDismissOnFocusOutFn===t),e.restoreFocus&&(s=s&&typeof e.restoreFocus===t),e.shouldDismissOnMouseDownFn&&(s=s&&typeof e.shouldDismissOnMouseDownFn===t),e.shouldDismissOnMouseWheelFn&&(s=s&&typeof e.shouldDismissOnMouseWheelFn===t),s}(e);return t||o.error("The dismiss handle object is null or malformed."),t}function a(e){if(!n.length)return;const t=n[n.length-1];try{const s=e(t);0!==s&&(t.dismissFn(),2===s&&t.restoreFocus&&t.restoreFocus())}catch(e){!function(e,t){o.error("An error occurred on dismiss. Unregister might have been forgotten on cleanup of the dismissable element. DismissHandle log name: {0}".format(t&&t.logName||"unknown"),0,e)}(e,t)}}function l(e){a((t=>t.shouldDismissOnFocusOutFn&&r(t)?t.shouldDismissOnFocusOutFn(e.target):0))}function c(e){27===e.keyCode&&a((e=>r(e)?2:0))}function d(e){a((t=>t.shouldDismissOnMouseDownFn&&r(t)?t.shouldDismissOnMouseDownFn(e.target,e):0))}function p(e){i||(i=!0,setTimeout((()=>{i=!1}),250),a((t=>t.shouldDismissOnMouseWheelFn&&r(t)?t.shouldDismissOnMouseWheelFn(e.target):0)))}function u(e){a((t=>t.shouldDismissOnMouseWheelFn&&t.shouldDismissOnScroll&&r(t)&&!$(e.target).hasClass("azc-resize")?t.shouldDismissOnMouseWheelFn(e.target):0))}let m=!1;try{window.addEventListener("test",null,{passive:!0}),window.removeEventListener("test",null),m=!0}catch(e){m=!1}function h(){return!m||{capture:!0}}function g(){return!m||{capture:!0,passive:!0}}t.initialize=function(){const e=s.body;e.addEventListener("focus",l,h()),e.addEventListener("keydown",c,h()),e.addEventListener("mousedown",d,h()),e.addEventListener("touchstart",d,g()),e.addEventListener("wheel",p,g()),e.addEventListener("scroll",u,h())},t.dispose=function(){const e=s.body;e.removeEventListener("focus",l,h()),e.removeEventListener("keydown",c,h()),e.removeEventListener("mousedown",d,h()),e.removeEventListener("touchstart",d,h()),e.removeEventListener("wheel",p,h()),e.removeEventListener("scroll",u,h()),n.length=0},t.register=function(e){if(!r(e))throw new Error("The dismiss handle object is null or malformed.");n.some((t=>t===e))||n.push(e)},t.unregister=function(e){MsPortalFx.remove(n,e)},t.dismissByLogName=function(e){n.length&&n.filter((t=>t.logName===e)).forEach((t=>{t.dismissFn(e)}))},t.validatePreviousFocusedElement=function(e,t){const s=`DismissHandle for '${e.logName}': previouslyFocusedElement`;return t?"function"==typeof t.focus||(o.error(FxImpl.createError(`${s} focus member is not a function. _previouslyFocusedElement.focus: ${t.focus}`,{data:{previous:MsPortalFx.getObjectDescriptor(t)}})),!1):(o.warning(`${s} was not defined.`),!1)}})),
define("MsPortalImpl/Services/Services.Recents",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Settings","FxHubs/RpcEndPoints","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.SecurityTokens"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.MruTokensSettingsManager=t.RecentServicesManager=t.loadRecentsFromLazyData=void 0;var l=MsPortalFx.Base.Diagnostics,c=l.Telemetry;const d=l.createLog(e),p=new Set(["Microsoft_AAD_IAM","Microsoft_AAD_UsersAndTenants","Microsoft_AAD_Devices","InternalSamplesExtension"]);t.loadRecentsFromLazyData=function(e){(0,r.lazyUserDataMemo)(e).then((e=>{e.recentResources&&n.AssetTypes.setRecentResourcesEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{recentResourcesMap:e.recentResources})}))};let u=class{constructor(e,t){this._settingsManager=e,this._assetTypesService=t}addService(e){MsPortalFx.tryImmediateResolve(this._ensureServices(),(()=>{e=e.toLowerCase();const t=this._services,s=this._assetTypesService.getAssetTypeById(e);s?.assetTypeManifest?.isDisabled||(MsPortalFx.remove(t,(t=>t.assetId===e)),t.length>=10&&t.pop(),t.unshift({assetId:e,timeStamp:Date.now()}),this._settingsManager.setSetting(16,"recentServices",{version:1,data:this._services}))}))}getServices(){return MsPortalFx.tryImmediateResolve(this._ensureServices(),(()=>this._services))}_ensureServices(){return void 0===this._services?MsPortalFx.tryImmediateResolve(Q(this._settingsManager.querySetting(16,"recentServices")),(e=>MsPortalFx.tryImmediateResolve(this._assetTypesService.assetTypesComplete,(()=>{this._services=((e||{}).data||[]).filter((e=>{const t=(e.assetId||"").split("."),s=t.length>1?t.slice(0,t.length-1).join("."):e.assetId,o=t.length>1?t[t.length-1]:void 0,i=this._assetTypesService.getAssetTypeById(s);if(!i)return!1;if(i?.assetTypeManifest?.isDisabled)return!1;const n=i.kindMap&&(o&&i.kindMap[o?.toLowerCase()]||i.kindMap[i.defaultKind?.toLowerCase()]);return n?1!=(1&n.options):1!=(1&i.assetTypeManifest.options)}))})))):Promise.resolve()}};t.RecentServicesManager=u,t.RecentServicesManager=u=__decorate([__metadata("fx:diagnostics",[e,"RecentServicesManager"]),s.Class(),__metadata("design:paramtypes",[i.SettingsManager,o.AssetTypeService])],u);let m=class{constructor(e,t){this._settingsManager=e;const s=this._mruTokensMap={},o=this._mruTokensQueue=[],i=this._mruExtensionTokensMap={};this._loadInitialSettingsPromise=this._settingsManager.querySetting(16,"mruTokens").then((e=>{MsPortalFx.forEachKey(e,((e,t)=>{t.length&&"string"==typeof t[0]?(s[e]=t.map((e=>({resource:e,audience:""}))),t.forEach((t=>{o.push({extension:e,resource:t,audience:""})}))):(s[e]=t,t.forEach((t=>{o.push({extension:e,resource:t.resource,audience:t.audience})})))}))})).then((()=>{MsPortalFx.isFeatureEnabled("msaljs")&&MsPortalFx.isFeatureEnabled("msaljsprefetch")&&MsPortalFx.forEachKey(s,((e,s)=>{s.forEach((s=>{s.audience&&t.getToken({extensionName:e,resourceName:s.resource,audience:s.audience,skipCache:!1,isBackground:!0})}))}))})),this._loadInitialExtensionMRUTokenMapPromise=this._settingsManager.querySetting(16,"mruTokensByExtension").then((e=>{const t=e?.data;MsPortalFx.forEachKey(t,(e=>{i[e]=t[e]})),this._pauseTokenPrefetchUntil=e?.pauseTokenPrefetchUntil})),t.saveMruTokenFunc=e=>{e?e.extension?e.resource&&Promise.all([this._loadInitialSettingsPromise,this._loadInitialExtensionMRUTokenMapPromise]).then((()=>{this.addMruEntry(e)})):d.warning("The 'entry.extension' to save to MRU token settings was null."):d.warning("The 'entry' to save to MRU token settings was null.")},t.prefetchTokenThrottlingHandler=()=>{this._pauseTokenPrefetchUntil=Date.now()+36e5,this._settingsManager.setSetting(16,"mruTokensByExtension",{pauseTokenPrefetchUntil:this._pauseTokenPrefetchUntil,data:this._mruExtensionTokensMap})}}addMruEntry(e){const t=e.extension,s=e.resource;if("fx"===t||!s)return;const o=this._mruTokensQueue,i=this._mruTokensMap,n=this._mruExtensionTokensMap,r=i[t]||[],a=n[t]||[];if(r.some((e=>e.resource===s)))MsPortalFx.remove(o,(e=>e.resource===s&&e.extension===t)),o.unshift(e);else{if(o.length>=5){const e=o.pop(),t=e.extension;MsPortalFx.remove(i[t],(t=>t.resource===e.resource)),i[t].length||delete i[t]}o.unshift(e),r.push({resource:s,audience:e.audience}),i[t]=r,this._settingsManager.setSetting(16,"mruTokens",i)}a.some((e=>e.resource===s))?MsPortalFx.remove(a,(e=>e.resource===s)):a.length>=(p.has(t)?5:4)&&a.pop(),a.unshift({resource:e.resource,audience:e.audience}),n[t]=a,Date.now()>this._pauseTokenPrefetchUntil&&(this._pauseTokenPrefetchUntil=void 0),this._settingsManager.setSetting(16,"mruTokensByExtension",{pauseTokenPrefetchUntil:this._pauseTokenPrefetchUntil,data:n})}getExtensionMRUList(e){if(!this._pauseTokenPrefetchUntil||Date.now()>this._pauseTokenPrefetchUntil){this._pauseTokenPrefetchUntil=void 0,this._settingsManager.setSetting(16,"mruTokensByExtension",{pauseTokenPrefetchUntil:this._pauseTokenPrefetchUntil,data:this._mruExtensionTokensMap});return(this._mruExtensionTokensMap[e]?this._mruExtensionTokensMap[e]:[]).slice(0,p.has(e)?5:4)}return c.trace({source:"Services.Recents",action:"getExtensionMRUListThrottled",data:{pauseTokenPrefetchUntil:this._pauseTokenPrefetchUntil,extensionName:e}}),null}};t.MruTokensSettingsManager=m,t.MruTokensSettingsManager=m=__decorate([__metadata("fx:diagnostics",[e,"MruTokensSettingsManager"]),s.Class(),__metadata("design:paramtypes",[i.SettingsManager,a.SecurityTokensManager])],m)})),
define("MsPortalImpl/Services/Services.FavoritesSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor","FxInternal/AsyncLoader","FxInternal/DirectoryManagement","Fx/Telemetry"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.saveUserDirectorySettingsHandler=t.getUserDirectorySettingsHandler=t.UserDirectorySettings=t.UserDirectorySettingsManager=t.FavoritesSettings=t.FavoritesSettingsManager=void 0;const l=MsPortalFx.Base.Diagnostics.createLog(e);let c=!1;class d extends i.SettingsProcessor{static create(e){return i.create(d,e,new p,8,!0)}}t.FavoritesSettingsManager=d,__decorate([__metadata("fx:diagnostics",[e,"FavoritesSettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.SettingsManager]),__metadata("design:returntype",Promise)],d,"create",null);class p{constructor(){this.favorites=ko.observable(""),this.version=ko.observable(0)}static create(e){return e.value}}t.FavoritesSettings=p,__decorate([__metadata("fx:diagnostics",[e,"FavoritesSettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[d]),__metadata("design:returntype",p)],p,"create",null);class u extends i.SettingsProcessor{static create(e){return i.create(u,e,new m,7,!0)}}t.UserDirectorySettingsManager=u,__decorate([__metadata("fx:diagnostics",[e,"UserDirectorySettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.SettingsManager]),__metadata("design:returntype",Promise)],u,"create",null);class m{constructor(){this.favoriteDirectoriesList=ko.observableArray(),this.userDefaultDirectory=ko.observable(),this.signInToLastVisitedDirectory=ko.observable(!0),this.recentDirectoriesList=ko.observableArray()}static create(e){return e.value}addRecentDirectory(e){if(c||!e)return;const t=e.toLowerCase(),s=this.recentDirectoriesList(),o=s.indexOf(t);o>-1&&s.splice(o,1),s.unshift(t),this.recentDirectoriesList(s.slice(0,3)),c=!0}}t.UserDirectorySettings=m,__decorate([__metadata("fx:diagnostics",[e,"UserDirectorySettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[u]),__metadata("design:returntype",m)],m,"create",null),t.getUserDirectorySettingsHandler=(0,n.defineHandler)(r.getUserDirectorySettingsEndPoint,(e=>{const t=e.diContainer.get(u).value;return(0,a.trace)({source:"Services.FavoritesSettings",action:"getUserDirectorySettingsRpc",data:{callingExtension:e.messageContext.srcWindowId}}),Promise.resolve({favoriteDirectoriesList:t.favoriteDirectoriesList(),userDefaultDirectory:t.userDefaultDirectory()})})),t.saveUserDirectorySettingsHandler=(0,n.defineHandler)(r.saveUserDirectorySettingsEndPoint,(e=>{const t=e.messageArg;let s=!1;const o=Object.create(null);o.callingExtension=e.messageContext.srcWindowId;try{const i=e.diContainer.get(u).value;if(t.favoriteDirectoriesList&&(o.newFavoritesCount=t.favoriteDirectoriesList.length,o.oldFavoritesCount=i.favoriteDirectoriesList().length,i.favoriteDirectoriesList(t.favoriteDirectoriesList)),t.userDefaultDirectory){const e=i.userDefaultDirectory(),s=e&&e.id;s!==t.userDefaultDirectory.id&&(o.oldDefaultId=s,o.newDefaultId=t.userDefaultDirectory.id,i.userDefaultDirectory(t.userDefaultDirectory))}s=!0}catch(e){l.error(new MsPortalFx.Errors.Error({message:`Failed to save user directory settings. Error: "${MsPortalFx.getLogFriendlyMessage(e)}"`,innerErrors:e}))}return(0,a.trace)({source:"Services.FavoritesSettings",action:"saveUserDirectorySettingsRpc",data:MsPortalFx.extend(o,{saveSuccess:s})}),Promise.resolve(s)}))})),
define("MsPortalImpl/UI/Hubs/UI.BrowseManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.AssetTypes"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowseManager=t.compareAssetTypeForSort=void 0;const i=MsPortalFx.Base.Constants.ResourceTypes.ResourceGroups.toLowerCase(),n=MsPortalFx.forEachKey;function r(e,t){const s=e.toLocaleLowerCase(),o=t.toLocaleLowerCase();return s===o?0:s<o?-1:1}t.compareAssetTypeForSort=r;let a=class{constructor(e){this._assetTypeService=e,this._browsePackages={};(this._ltm=new FxImpl.TriggerableLifetimeManager).registerForDispose((()=>{n(this._browsePackages,((e,t)=>{t.cancel(),t.dispose()}))}))}dispose(){this._ltm.dispose()}getFilteredAssetTypes(){const e=[],t=[];return this._assetTypeService.assetTypes.forEach((t=>{const s=t.assetTypeManifest;this._assetTypeMeetsRequirements(s)&&e.push(t)})),e.length&&t.push(...MsPortalFx.stableSort(e,((e,t)=>r(e.compositeDisplayName.service||e.compositeDisplayName.plural,t.compositeDisplayName.service||t.compositeDisplayName.plural)))),t}_assetTypeMeetsRequirements(e){if(!e)return!1;if(void 0===e.browseType)return!1;const t=e.resourceType;if(!t)return!0;const s=t.resourceTypeName;if(s.toLowerCase()===i)return!0;return!(s.split("/").length<2)}};t.BrowseManager=a,t.BrowseManager=a=__decorate([__metadata("fx:diagnostics",[e,"BrowseManager"]),s.Class(),__metadata("design:paramtypes",[o.AssetTypeService])],a)})),
define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/UI/Hubs/UI.BrowseManager","Weave","FxHubs/ResourceManagement","FxInternal/AsyncLoader"],(function(e,t,s,o,i,n,r,a,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FavoritesManager=t.findFavoriteItem=t.getFavoriteType=t.getAssetTypeKeywords=t.getAssetTypeIcon=t.getAssetTypeDisplayText=t.getAssetTypeKind=t.getAssetId=void 0;var u=MsPortalFx.Base,m=MsPortalFx.Extension,h=u.Constants.AssetNames,g=FxImpl.Assets,f=MsPortalFx.Hubs.Notifications.NotificationStatus,x=u.Diagnostics,b=x.Telemetry,y=(m.BrowseType,u.Promises.cancelOnDispose);const v=o.Favorites,M=v.Notification,C=(x.createLog(e),JSON.parse),P=JSON.stringify,w=/\s+/g,I=MsPortalFx.find,S={};function _(e,t,s){return t===h.BrowseResourceGroupBlade&&(t=h.ResourceGroups),g.getAssetTypeOrResourceTypeIdByWindowId(e,t)+(s?"."+s.toLowerCase():"")}function F(e,t){return t&&e.kindMap&&e.kindMap[(t||"").toLowerCase()]}function T(e,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||v.assetPlusKindFormat.format(e.compositeDisplayName.service,t.name))||e.compositeDisplayName.service}function k(e,t){return t&&t.icon||e.icon}function D(e,t){return t&&t.keywords||e.assetTypeManifest.keywords}function E(e){const t=e.diContainer.get(i.AssetTypeService),s=e.assetType.assetTypeManifest,o=s&&(0,d.supportsOption)(s.options,1),n=F(e.assetType,e.kind),r=n&&(0,d.supportsOption)(n.options,1),a=n&&(0,d.supportsOption)(n.options,4),l=n?o?!a:r:o,c=T(e.assetType,n);return{id:e.assetTypeIdWithKind||e.assetType.id,image:k(e.assetType,n),isFavorite:ko.observable(!1),isFilteredOut:ko.observable(!1),isHidden:ko.observable(l),label:c,labelId:c.replace(w,""),keywords:(D(e.assetType,n)||"").split(","),matches:ko.observable(),uri:t.getAssetTypeDeepLink(e.assetType,e.kind),opensExternal:3===s.browseType,isPreview:e.assetType.isPreview,assetType:e.assetType,kind:e.kind,resourceType:s.resourceType&&s.resourceType.resourceTypeName,boost:e.boost,relevanceScore:ko.observable(),subCategoryId:e.subCategory,isDisabled:e.assetType.assetTypeManifest.isDisabled,isPartner:e.assetType.extension.toLowerCase().startsWith(MsPortalFx.isFeatureEnabled("testpartnertag")?"internalsamplesextension":"azure_marketplace_"),commandsToolbarDetailView:ko.observable()}}function B(e,t,s,o){if(!t)return null;const i=t,r=t,a=s.get(n.RedirectMap).getAssetRedirect(t);let l,c;a&&(t=_(a.toExtension,a.toAsset,a.toKind)),a&&((o=o||s.get(A)).remove(i),o.add(t),b.trace({source:"SideBar",action:"FavoriteRedirected",name:r,data:{from:r,to:t}}));const d=t.indexOf(".");d>0&&(c=t,t=c.substring(0,d),l=c.substring(d+1));const p=t.toLowerCase(),u=MsPortalFx.find(e,(e=>e.id.toLowerCase()===p));return u&&E({assetType:u,kind:l,diContainer:s,assetTypeIdWithKind:c})}FxImpl.getAssetTypeMappingData=()=>S,t.getAssetId=_,t.getAssetTypeKind=F,t.getAssetTypeDisplayText=T,t.getAssetTypeIcon=k,t.getAssetTypeKeywords=D,t.getFavoriteType=E,t.findFavoriteItem=B;let A=class{constructor(e,t,s,o){this._assetTypeService=e,this._browseManager=t,this._diContainer=s,this.favorites=(0,c.makeArrayComputation)(),this._notificationsForItems=ko.observable(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._missingFavoritesWithIndex={},this._assetTypes=ko.observable(),this._initialFavorites=[],this.remove=e=>{const t=this._savedFavorites().length&&C(this._savedFavorites())||[],s=t.indexOf(e);-1!==s&&(t.splice(s,1),this._savedFavorites(P(t)))},this.add=e=>{const t=C(this._savedFavorites())||[];t.includes(e)||(t.push(e),this._savedFavorites(P(t)))},this.move=e=>{const t=C(this._savedFavorites())||[],s=this.favorites.value[e],o=t.indexOf(s.id);t.splice(e,0,t.splice(o,1)[0]),this._savedFavorites(P(t))},this._savedFavorites=ko.observable(""),this.initializeFavorites(o)}initializeFavorites(e){const t=this._savedFavorites=MsPortalFx.isFeatureEnabled("skipsavedfavorites")?ko.observable(""):e.favorites,s=!(!t||!t());s&&(MsPortalFx.isFeatureEnabled("skipfavoritesupgrade")||function(e,t,s){const o=[],i=[[],["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard","Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport"],["Microsoft_Azure_Expert_AzureAdvisor"]];if(s&&e.version()<i.length-1){const t=e.favorites,s=t().toLowerCase(),n=C(t());for(let t=(e.version()||0)+1;t<i.length;t++)i[t].forEach((e=>{const t=e.toLowerCase();s.indexOf(t)<0&&(n.push(e),o.push(e))}));t(P(n))}t(o),e.version(i.length-1)}(e,this._notificationsForItems,s),this._initialFavorites=C(t())),this.loadFavorites(),this._registerDependency()}loadFavorites(){const e=this._savedFavorites&&this._savedFavorites().length&&(e=>{const t=[];return e.forEach((e=>{switch(typeof e){case"string":if(e.startsWith("{"))try{const s=C(e);"string"==typeof s.typeId&&s.typeId&&t.push(s.typeId)}catch(e){}else t.push(e);break;case"object":e&&"string"==typeof e.typeId&&t.push(e.typeId)}})),this._savedFavorites(P(t)),t})(C(this._savedFavorites()))||[],t=[],s=(this._assetTypeService.assetTypesComplete.isFulfilled(),(e,s)=>{const o=B(this._assetTypes(),e,this._diContainer,this);o?(o.isFavorite(!0),t.push(o)):this._missingFavoritesWithIndex[e]=s}),o=()=>{const e=this._notificationsForItems()||[],s=e.slice(0);e.forEach((e=>{const o=I(t,(t=>e===t.id));if(o){const t=M.titleFmt.format(o.label),i=o.assetType.assetTypeManifest||{};this._diContainer.getAsync(p.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((e=>{e.addClientNotification({title:t,description:M.Description[(i.name||"").toLowerCase()]||t,status:f.Information,timestamp:new Date,uri:o.uri})})),MsPortalFx.remove(s,e)}})),this._notificationsForItems(s),this.favorites.setAll(t)};return e.length?(e.forEach(((e,t)=>{e&&s(e,t)})),o(),Promise.resolve()):y(this._ltm,(0,r.getBrowseCuration)()).then((e=>{const t=this._initialFavorites;e.favorites.forEach((e=>{const s=_(e.extensionName,e.assetType,e.kind);t.push(s)})),this._initialFavorites.forEach(((e,t)=>{s(e,t)})),this._savedFavorites(P(t)),o()}))}dispose(){this._ltm.dispose()}_registerDependency(){this._assetTypes([]),MsPortalFx.tryImmediateResolve(y(this._ltm,this._assetTypeService.assetTypesComplete),(()=>{const e=this._browseManager.getFilteredAssetTypes()||[];e.length&&this._assetTypes(e),MsPortalFx.forEachKey(this._missingFavoritesWithIndex,((t,s)=>{if(-1!==s){const o=B(e,t,this._diContainer,this);o&&(o.isFavorite(!0),s=Math.min(s,this.favorites.value.length),this.favorites.insert(s,o),this._missingFavoritesWithIndex[t]=-1)}}))}))}};t.FavoritesManager=A,t.FavoritesManager=A=__decorate([__metadata("fx:diagnostics",[e,"FavoritesManager"]),s.Class(),__metadata("design:paramtypes",[i.AssetTypeService,l.BrowseManager,s.Container,a.FavoritesSettings])],A)})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css",["module"],(function(e){"use strict";return{css:'.fxs-avatarmenu{flex:0 0 auto;box-sizing:border-box}.fxs-avatarmenu-header{position:relative;display:flex;align-items:center;height:40px}.fxs-avatarmenu-username{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;line-height:normal;max-width:160px}.fxs-avatarmenu-tenant{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:600;font-size:10px;line-height:normal;text-transform:uppercase;max-width:160px}.fxs-avatarmenu-tenant-container{text-align:right;flex:1 1 auto;padding-left:20px}.fxs-avatarmenu-imageonly .fxs-dropmenu-button .fxs-avatarmenu-tenant-container{display:none}.fxs-avatarmenu-dropdown{width:220px;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-avatarmenu-tenant-image-container{height:28px;width:28px;flex:0 0 auto;padding-left:6px;padding-right:6px;box-sizing:content-box}.fxs-avatarmenu-tenant-image{height:28px;width:28px;border:0;border-radius:28px}.fxs-avatarmenu-tenant-image-overlay{height:18px;width:18px;position:absolute;right:0;bottom:0}.fxs-avatarmenu-dropdown-item{display:flex}.fxs-avatarmenu-scrollviewer{max-height:505px;overflow:auto}html[lang^="ja"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^="ko"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^="zh"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant{font-size:11px}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css",["module"],(function(e){"use strict";return{css:".fxs-contextMenu{display:none;position:fixed;width:192px;z-index:200;max-height:100vh;overflow-x:hidden;overflow-y:auto;border-style:solid;border-width:1px}.fxs-contextMenu:focus{outline:0}.fxs-contextMenu.fxs-contextMenu-active{display:block}.fxs-contextMenu-item{display:flex;align-items:center;padding:8px;box-sizing:border-box;font-size:13px;line-height:normal;cursor:pointer}.fxs-contextMenu-text{flex:1 1 auto;margin-left:8px;overflow:hidden;text-overflow:ellipsis}.fxs-contextMenu-icon{flex:0 0 auto;height:16px;width:16px;display:flex;justify-content:center;align-items:center;align-self:flex-start;margin-top:1px}.fxs-contextMenu-icon>svg{height:16px;width:16px}.fxs-contextMenu-itemList{list-style-type:none;margin:0;padding:0}.fxs-contextMenu-extensioncommand .fxs-contextMenu-icon{display:none}.fxs-contextMenu-extensioncommand.fxs-contextMenu-itemDisabled{display:block}.fxs-contextMenu-itemDisabled{cursor:text}.fxs-contextMenu-form{padding:8px 20px;display:none}.fxs-contextMenu-form.fxs-contextMenu-active{display:block}.fxs-dialogballoon.azc-balloon{opacity:1;width:auto;max-width:550px}.fxs-dialogballoon.azc-balloon>.azc-balloon-content{margin:0;overflow:unset;height:unset}.fxs-dialogballoon.azc-balloon .azc-balloon-text,.fxs-dialogballoon.azc-balloon .fxs-messagebox,.fxs-dialogballoon.azc-balloon>.azc-balloon-content{height:100%}.fxs-dialogballoon.azc-balloon .fxs-messagebox{overflow:auto}.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-mini,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-small,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-normal,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-tall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-large,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-wide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herowide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herotall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-hero{height:20px;width:20px}.msportalfx-contextmenu-grid rect{display:none}.msportalfx-contextmenu-grid-mini .msportalfx-grid-rect-mini,.msportalfx-contextmenu-grid-small .msportalfx-grid-rect-small,.msportalfx-contextmenu-grid-normal .msportalfx-grid-rect-normal,.msportalfx-contextmenu-grid-wide .msportalfx-grid-rect-wide,.msportalfx-contextmenu-grid-tall .msportalfx-grid-rect-tall,.msportalfx-contextmenu-grid-large .msportalfx-grid-rect-large,.msportalfx-contextmenu-grid-herowide .msportalfx-grid-rect-herowide,.msportalfx-contextmenu-grid-herotall .msportalfx-grid-rect-herotall,.msportalfx-contextmenu-grid-hero .msportalfx-grid-rect-hero{display:block}.fxs-contextMenuTouchHint{position:fixed;z-index:500;border:2px solid #808080;box-sizing:border-box;background-color:rgba(255,255,255,.2);pointer-events:none}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css",["module"],(function(e){"use strict";return{css:".fxs-contextpane{display:none;height:100%;position:relative;z-index:2;overflow:auto}.fxs-contextpane-content{box-sizing:border-box;height:auto;overflow:auto}.fxs-contextpane-loadindicator{display:none;position:absolute;top:0;bottom:0;right:0;left:0;background:inherit}.fxs-contextpane-loading .fxs-contextpane-loadindicator{display:block}.fxs-contextpane-visible{display:block}.fxs-contextpane-title{font-weight:600;font-size:18px;line-height:50px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin:0}.fxs-portal-contextpane-right{position:absolute;right:0;max-width:100%;height:100%}.fxs-portal-contextpane-right .fxs-blade{box-shadow:none}.fxs-portal-contextpane-docked{flex-direction:column;height:100%;box-sizing:border-box;width:320px;z-index:2;overflow:auto;border-color:#e0e0e0}.fxs-portal-contextpane-docked-resize-curtain{width:20px;height:100%;position:absolute;border-color:#e0e0e0;resize:horizontal;z-index:1000;top:0}.fxs-blade.fxs-contextpane-content{min-width:300px}.fxs-isEdge.fxs-portal-contextpane-right{overflow:auto}.fxs-portal-contextpane-right.fxs-contextpane-loading{min-width:355px}.fxs-portal-contextpane-docked-resize-splitter{position:absolute;top:0;bottom:0;left:5px;right:0;pointer-events:none;z-index:2}@media(min-width:640px){.fxs-portal-contextpane-right{height:100%;max-width:calc(100% - 48px)}.fxs-sidebar-hamburger-mode .fxs-portal-contextpane-right{max-width:100%}}@media(min-width:1024px){.fxs-portal-contextpane-right{max-width:calc(100% - 225px)}.fxs-extension-sidebar~.fxs-portal-contextpane-right{max-width:calc(100% - 280px)}.fxs-sidebar-is-collapsed~.fxs-portal-contextpane-right,.fxs-extension-sidebar.fxs-sidebar-is-collapsed~.fxs-portal-contextpane-right{max-width:calc(100% - 48px)}}@media(min-height:500px){.fxs-contextpane-visible{display:flex;flex-flow:column nowrap}.fxs-contextpane{overflow:initial}.fxs-contextpane-content{height:100%}}@media(max-height:499.99999px){.fxs-contextpane .fxc-gc-vscroll{max-height:calc(100vh - 45px)}}.fxs-react-contextpane.fxs-react-contextpane.fxs-react-contextpane,.fxs-react-contextpane.fxs-react-contextpane .fxs-blade{background:none;pointer-events:none}.fxs-react-contextpane .fxs-header{pointer-events:auto}.fxs-react-contextpane .fxs-blade-content-container{display:none}.fxs-contextpane-floated-frame.fxs-contextpane-floated-frame{right:0;top:calc(64px - 20px - 8px);height:calc(100% - (64px - 20px - 8px));z-index:2;pointer-events:all;max-width:100%}.fxs-journey-breadcrumb.fxs-display-none+.fxs-journey-layout .fxs-contextpane-floated-frame{top:64px}.fxs-contextpane.fxs-portal-contextpane-docked .fxs-blade.fxs-bladesize-medium{width:100%;min-width:320px}.fxs-contextpane.fxs-portal-contextpane-docked .fxs-blade.msportalfx-shadow-level3{box-shadow:var(--shadowLevel1)}@media(min-width:1280px){.fxs-portal-contextpane-docked{width:480px}.fxs-contextpane.fxs-portal-contextpane-docked .fxs-blade.fxs-bladesize-medium{min-width:480px}.fxs-portal-contextpane-docked-resize-curtain{cursor:col-resize}}@media(max-width:1280px){.fxs-portal-contextpane-docked{width:320px}.fxs-contextpane.fxs-portal-contextpane-docked .fxs-blade.fxs-bladesize-medium{min-width:calc(320px - 20px)}.fxs-portal-contextpane-docked-resize-curtain{cursor:default}}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css",["module"],(function(e){"use strict";return{css:".fxc-base .fxs-tile-progress{background-color:inherit}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent{height:100%;width:100%;left:auto;top:auto}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent>div{margin:0;left:0;vertical-align:baseline}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css",["module"],(function(e){"use strict";return{css:".fxs-dropmenu{position:relative;flex:0 0 auto;box-sizing:border-box;z-index:200}.fxs-dropmenu-button{border:0;padding:0;margin:0;background:none;cursor:pointer;display:flex;position:relative;height:100%;align-items:center;justify-content:center}.fx-dropmenu-dropdown .fxs-dropmenu-list-system a{display:flex}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup){position:absolute}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) ol,.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) ul{list-style:none outside none;padding:0;margin:0}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) li{white-space:nowrap}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) li a{align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:10px 20px}.fxs-dropmenu-list-content{flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-image{flex:0 0 auto;height:16px;width:16px}.fxs-dropmenu-image img,.fxs-dropmenu-image svg{height:13px;width:13px}.fxs-dropmenu-line-separator{border-top-width:1px;border-top-style:solid}.fxs-dropmenu-content li a:hover{text-decoration:none}.fxs-dropmenu-left{right:0}.fxs-dropmenu-right{left:0}.fxs-dropmenu-hidden{display:none}.fxs-dropmenu-invisible{visibility:hidden}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css",["module"],(function(e){"use strict";return{css:'.fxs-flowlayout{position:relative}.fxs-flowlayout>.fxs-flowlayout-childcontainer{position:relative;transition:height .25s linear,width .25s linear 0s}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-element{position:absolute}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-drop-placeholder{position:absolute;background:rgba(0,0,0,.2)}.fxs-flowlayout-childcontainer>.fxs-tile{transition:height 125ms linear 125ms,width 125ms linear 0s,top 175ms ease-out,left 175ms ease-out,right 175ms ease-out}.fxs-flowlayout-resolutionguide{position:absolute;top:0;left:0;box-sizing:border-box;color:#fff;border-color:#fff;opacity:.7;border-width:1px;border-right-style:dashed;border-bottom-style:dashed;pointer-events:none;font-size:13px;line-height:normal}.fxs-mode-light .fxs-flowlayout-resolutionguide{color:inherit;border-color:inherit}.fxs-flowlayout-resolutionguide::after{position:absolute;right:8px;bottom:5px}.fxs-flowlayout-resolutionguide-1024x768{height:768px;width:1024px}.fxs-flowlayout-resolutionguide-1024x768::after{content:"1024 x 768"}.fxs-flowlayout-resolutionguide-1366x768{height:768px;width:1366px}.fxs-flowlayout-resolutionguide-1366x768::after{content:"1366 x 768"}.fxs-flowlayout-resolutionguide-1440x900{height:900px;width:1440px}.fxs-flowlayout-resolutionguide-1440x900::after{content:"1440 x 900"}.fxs-flowlayout-resolutionguide-1920x1080{height:1080px;width:1920px}.fxs-flowlayout-resolutionguide-1920x1080::after{content:"1920 x 1080"}.fxs-flowlayout-resolutionguide-3840x2160{height:2160px;width:3840px}.fxs-flowlayout-resolutionguide-3840x2160::after{content:"3840 x 2160"}.fxs-drag-surface{position:fixed;margin:0;padding:0;top:0;left:0;right:0;bottom:0;overflow:hidden;background-color:transparent;pointer-events:none;z-index:199}.fxs-drag-disableTouchAction{touch-action:none}.fxs-flowlayout-resizehandle{display:inline-block;padding:0 4px 4px 0;bottom:0;right:0}.fxs-flowlayout-resizehandle>div{height:12px;width:12px;border:2px solid rgba(125,125,125,.5);border-left-width:0;border-top-width:0}.fxs-flowlayout-resizehandle,.fxs-flowlayout-livepreview{position:absolute;cursor:se-resize;z-index:1}.fxs-flowlayout-livepreview{min-width:85px;min-height:85px;max-width:2245px;max-height:2245px;overflow:hidden}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css",["module"],(function(e){"use strict";return{css:"@keyframes fxs-search-indicator-animatedEllipses{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}.fxs-search-menu{position:absolute;top:30px;left:0;width:100%;display:none;box-sizing:border-box;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-asyncsearch-menu{position:absolute;top:30px;left:0;display:none;width:100%;box-sizing:border-box;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-search-text{white-space:normal;overflow:hidden;text-overflow:ellipsis}.fxs-search-wrapper{display:flex;align-items:center;width:100%;border-radius:2px}.fxs-search{position:relative;display:flex}.fxs-search-icon-mini{padding:0 2px 0 8px;box-sizing:border-box;height:26px;width:22px;display:flex;align-items:center}.fxs-search-icon-mini svg{height:12px;width:12px}.fxs-search-clear{height:26px;width:24px;cursor:pointer;fill:#484644;box-sizing:border-box;display:flex;align-items:center;justify-content:center}.fxs-search-clear svg{height:12px;width:12px}.fxs-search-box{height:26px;flex:1 1 auto}.fxs-search-box .azc-input{border:0;font-size:13px;height:26px;background-color:transparent;box-sizing:border-box;outline:0;padding:2px 8px 4px;width:100%}.fxs-search-indicator{display:none;align-items:center;height:26px;box-sizing:border-box}.fxs-search-indicator>div{height:7px;width:7px;animation:fxs-search-indicator-animatedEllipses 1.5s infinite;background:#aab3bd;margin:0 2.5px}.fxs-search-indicator>div:nth-child(1){animation-delay:0s}.fxs-search-indicator>div:nth-child(2){animation-delay:.2s}.fxs-search-indicator>div:nth-child(3){animation-delay:.4s}.fxs-searching .fxs-search-indicator{display:flex}.fxs-search .fxs-search-icon{display:none}.fxs-search-showmenu .fxs-search-menu{display:block}.fxs-search-showmenu .fxs-asyncsearch-menu{display:block}.fxs-topbar-state-searchcollapsed .fxs-search-icon{display:flex}.fxs-topbar-state-searchcollapsed .fxs-search-wrapper{display:none}.fxs-topbar-state-searchcollapsed .fxs-search-activated .fxs-search-icon{display:none}.fxs-topbar-state-searchcollapsed .fxs-search-activated .fxs-search-wrapper{display:flex}.fxs-topbar-state-searchcollapsed .fxs-search-activated.fxs-search-showmenu .fxs-search-menu{display:block}.fxs-topbar-state-searchcollapsed .fxs-search-showmenu .fxs-search-menu{display:none}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css",["module"],(function(e){"use strict";return{css:".fxs-sidebar{z-index:6;height:100%;font-size:13px;box-sizing:border-box;position:fixed;top:0}.fxs-sidebar-list{padding:0;margin:0;list-style:none}.fxs-sidebar-button{cursor:pointer}.fxs-sidebar-favorites{padding-bottom:20px}.fxs-sidebar-bar{width:225px;display:flex;flex-direction:column;height:100%;overflow:hidden}.fxs-sidebar-top{flex:0 0 auto}.fxs-sidebar-top>.fxs-sidebar-button{width:100%;border:0;padding:0;text-align:left}.fxs-sidebar-middle{flex:1 1 auto;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}.fxs-sidebar-favorites-section{height:32px;display:flex;align-items:center;flex:0 0 auto}.fxs-sidebar-myfavorites{text-transform:uppercase;font-weight:700;font-size:10px;word-break:keep-all;margin-left:10px}.fxs-sidebar-divider,.fxs-sidebar-divider2{border-bottom-width:1px;border-bottom-style:solid;height:0;flex:1 1 0}.fxs-sidebar-divider:first-of-type{margin-right:5px;max-width:13px}.fxs-sidebar-divider:last-of-type{margin-left:5px}.fxs-sidebar-item-link{display:flex;align-items:center;flex:1 1 auto;min-height:32px;-webkit-user-drag:none;color:inherit;box-sizing:border-box;padding:7px 0}a.fxs-sidebar-item-link:hover{text-decoration:none;color:inherit}.fxs-sidebar-icon{flex:0 0 18px;height:18px;padding-left:15px;align-self:flex-start}.fxs-sidebar-icon svg,.fxs-sidebar-icon img{height:18px;width:18px}.fxs-sidebar-hamburger .fxs-sidebar-icon{height:16px;padding-left:15px;align-self:center}.fxs-sidebar-hamburger .fxs-sidebar-icon svg{height:16px;width:16px}.fxs-sidebar-label{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;margin-left:6px}.fxs-sidebar-create,.fxs-sidebar-browse{font-size:inherit}.fxs-sidebar-create .fxs-sidebar-label,.fxs-sidebar-browse .fxs-sidebar-label{margin-right:15px}.fxs-sidebar-collapse-button{display:flex;align-items:center;height:28px}.fxs-sidebar-collapse-button svg{height:8px;width:8px;transform:rotate(-90deg);margin-left:auto;margin-right:10px}.fxs-sidebar-fav-icon svg{height:12px;width:12px;fill:#0078d4}.fxs-theme-blue .fxs-sidebar-fav-icon svg,.fxs-mode-dark .fxs-sidebar-fav-icon svg{fill:#f2f2f2}.fxs-sidebar-external{flex:0 0 12px;margin:0 10px;padding-top:3px;width:12px;fill:#bbb}.fxs-sidebar-external svg{height:12px;width:12px}.fxs-sidebar-handle{flex:0 0 20px;cursor:move;fill:#bbb}.fxs-sidebar-handle svg{display:none;height:16px;width:16px;transform:rotate(90deg)}.fxs-sidebar-item:hover .fxs-sidebar-handle svg{display:block}.fxs-extension-sidebar .fxs-sidebar-bar{background:none;width:280px;transition-property:width;transition-duration:.2s}.fxs-extension-sidebar.fxs-sidebar-is-collapsed .fxs-sidebar-bar{transition-duration:0s}.fxs-extension-sidebar .fxs-sidebar-shadow{width:0}.fxs-sidebar-is-collapsed .fxs-sidebar-bar{width:48px}.fxs-sidebar-is-collapsed .fxs-sidebar-myfavorites,.fxs-sidebar-is-collapsed .fxs-sidebar-external{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-top>.fxs-sidebar-item-link .fxs-sidebar-label,.fxs-sidebar-is-collapsed .fxs-sidebar-middle .fxs-sidebar-label{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-top>.fxs-sidebar-item-link .fxs-sidebar-favorites,.fxs-sidebar-is-collapsed .fxs-sidebar-middle .fxs-sidebar-favorites{width:48px}.fxs-sidebar-is-collapsed .fxs-sidebar-collapse-button svg{transform:rotate(90deg)}.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:68px}.fxs-sidebar-shadow{pointer-events:none;position:absolute;right:0;top:0;bottom:0}.fxs-sidebar-menu-toggle-link,.fxs-sidebar-divider2,.fxs-sidebar .fxs-sidebar-collapse-button,.fxs-sidebar.fxs-sidebar-is-collapsed,.fxs-sidebar-menu-container{display:none}.fxs-sidebar-item-link.fxs-sidebar-hamburger{display:flex;border:0;padding:0;width:100%;height:40px}.fxs-sidebar-is-collapsed .fxs-sidebar-bar.msportalfx-shadow-level3{box-shadow:none}.fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link{display:flex;align-items:center;height:32px}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link .fxs-sidebar-menu-icon{height:16px;align-self:center}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link .fxs-sidebar-menu-icon svg{height:16px;width:16px}.fxs-sidebar-menu .fxs-sidebar-divider2{display:flex;margin-top:12px;margin-bottom:8px}.fxs-sidebar-menu-activated .fxs-sidebar-menu-activated-hidden{display:none}.fxs-sidebar-menu-activated .fxs-sidebar-menu-container{display:flex;min-height:0;flex-direction:column}.fxs-sidebar-menu-activated .fxs-sidebar-menu-toggle-link svg{transform:rotate(180deg)}.fxs-sidebar .fxs-part-frame.fxs-blade-floated-frame{top:0;height:100%}.fxs-sidebar-content{height:100%;position:relative}.fxs-sidebar-menu-activated .fxs-sidebar-content{display:none}@media(min-width:640px) and (min-height:500px){.fxs-sidebar-hamburger-mode .fxs-sidebar.fxs-sidebar-is-collapsed,.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-collapse-button{display:none}.fxs-sidebar-hamburger-mode .fxs-sidebar-item-link.fxs-sidebar-hamburger{display:flex}.fxs-sidebar-hamburger-mode .fxs-sidebar{position:fixed}.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar-docked-mode .fxs-sidebar{z-index:4;position:relative;max-width:48px}.fxs-sidebar-docked-mode .fxs-sidebar .fxs-sidebar-collapse-button{display:flex}.fxs-sidebar-docked-mode .fxs-sidebar-item-link.fxs-sidebar-hamburger{display:none}.fxs-sidebar-docked-mode .fxs-sidebar.fxs-sidebar-is-collapsed{position:relative;display:flex}.fxs-sidebar-docked-mode .fxs-sidebar.fxs-sidebar-is-collapsed .fxs-sidebar-shadow{display:flex}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link,.fxs-sidebar-menu .fxs-sidebar-divider2{display:none}}@media(min-width:1024px) and (min-height:500px){.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar-hamburger-mode .fxs-sidebar{position:fixed}.fxs-sidebar-docked-mode .fxs-sidebar-bar.msportalfx-shadow-level3{box-shadow:none}.fxs-sidebar-docked-mode .fxs-sidebar{position:relative;max-width:initial}.fxs-sidebar-docked-mode .fxs-sidebar .fxs-sidebar-shadow{display:flex}}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css",["module"],(function(e){"use strict";return{css:".fxs-stacklayout{display:flex}.fxs-stacklayout-vertical{flex-direction:column}.fxs-stacklayout-horizontal{flex-direction:row}.fxs-stacklayout-child{flex:0 0 auto}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css",["module"],(function(e){"use strict";return{css:'.fxs-startboard{display:flex;flex-flow:column nowrap;overflow:auto;width:100%}.fxs-startboard .fxs-startboard-message-container{display:none}.fxs-startboard.fxs-startboard-notfound>.fxs-startboard-layout{display:none}.fxs-startboard.fxs-startboard-notfound .fxs-startboard-message-container{display:block}.fxs-startboard-header{display:flex;align-items:center;flex:0 0 auto;width:100%;height:45px;padding:0 25px 0 40px;margin-top:20px;box-sizing:border-box}.fxs-startboard-header .fxs-startboard-title-next{display:block}.fxs-startboard-header .fxs-startboard-title-content{display:flex}.fxs-startboard-header .fxs-startboard-button-text{font-size:13px}.fxs-startboard-header .fxs-startboard-button-icon{height:12px;width:12px;align-items:center;justify-content:center;flex:0 0 12px}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon,.fxs-startboard-header .fxs-startboard-title-next .fxs-startboard-button-icon{height:16px;width:16px;margin:4px 8px;flex:0 0 auto}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon>svg,.fxs-startboard-header .fxs-startboard-title-next .fxs-startboard-button-icon>svg{flex:0 0 16px}.fxs-startboard-header .fxs-startboard-title{max-width:300px;font-weight:600}.fxs-startboard-header .fxs-startboard-title-edit{padding:0 5px 2px;margin:0 -6px -2px;border-width:1px;border-style:solid;color:inherit;background-color:transparent;width:300px;transition:border .12s}.fxs-startboard-header .fxs-startboard-title-edit:active,.fxs-startboard-header .fxs-startboard-title-edit:hover{border-color:inherit}.fxs-startboard-header .fxs-startboard-button{position:relative}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-button{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left}.fxs-startboard-header .fxs-startboard-dropdown,.fxs-startboard-header .fxs-startboard-button{font-size:13px;line-height:20px}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-title-edit{font-size:18px;line-height:24px}.fxs-startboard-header .fxs-startboard-subtitle{text-align:initial;font-size:12px;line-height:14px}.fxs-startboard-header .fxs-startboard-subtitle.fxs-startboard-subtitle-shared{margin-left:32px}.fxs-startboard-header .fxs-startboard-migration{height:40px;align-items:center;display:flex;flex:0 0 auto}.fxs-startboard-customize-header{min-height:70px}.fxs-startboard-commandBar,.fxs-startboard-customize-header,.fxs-startboard-info,.fxs-startboard-warning,.fxs-startboard-error{padding:0 25px 0 40px}.fxs-startboard-commandBar-fullScreen{display:none;margin-left:10px}.fxs-startboard-actions{margin-left:30px}.fxs-startboard-actions .fxs-startboard-actions-preview,.fxs-startboard-actions .fxs-startboard-actions-save{margin-right:10px}.fxs-startboard-warning,.fxs-startboard-error{margin:0}.fxs-startboard-layout{padding:16px 40px;flex:1 1 auto}.fxs-startboard-layout .fxs-flowlayout-childcontainer{padding-bottom:25px;padding-right:25px}.fxs-startboard-dropdown{display:none;flex:0 1 auto;max-width:560px;padding:2px 0}.fxs-startboard-button{flex:0 0 auto;border:0;margin:0 5px;padding:4px 5px;height:20px;background-color:transparent;box-sizing:content-box}.fxs-startboard-button:not([aria-disabled]):hover{cursor:pointer}.fxs-startboard-button .fxs-startboard-button-text{margin-left:5px}.fxs-startboard-button .fxs-startboard-button-icon{height:16px;width:16px}.fxs-startboard-button{display:flex;align-items:center;min-width:0}.fxs-startboard-button-browse{padding:0!important}.fxs-startboard-dropdown>.fxs-dropmenu{width:100%}.fxs-startboard-dropdown>.fxs-dropmenu .fxs-dropmenu-button{width:100%}.fxs-startboard-dropdown .fxs-dropmenu-content{overflow-x:hidden;overflow-y:auto;min-width:400px;max-width:560px;min-height:35px}.fxs-startboard-dropdown .fx-dropmenu-dropdown{max-height:calc(100vh - 120px)}.fxs-startboard-item-container{display:flex;align-items:center;min-width:0}.fxs-startboard-dropdown .fxs-dropmenu-list-system .fxs-startboard-dropdown-item{padding:7px 25px 8px}.fxs-startboard-dropdown-item+.fxs-startboard-dropdown-item::before{content:"";position:absolute;top:0;width:calc(100% - 50px);border-top-width:1px;border-top-style:solid;border-color:rgba(125,125,125,.5)}.fxs-startboard-item-title{flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-startboard-item-icon{flex:0 0 auto;height:14px;width:14px;padding-right:5px}.fxs-startboard-dropdown-button{display:flex;flex-flow:column nowrap}.fxs-startboard-title-container{display:flex}.fxs-startboard-dropdown-item{position:relative;height:35px;box-sizing:border-box;cursor:pointer}.fxs-startboard-dropdown-item.fxs-startboard-dropdown-browseall{height:auto;cursor:default}.fxs-startboard-dropdown-subscriptions{white-space:normal}.fxs-startboard-migration,.fxs-startboard-dropdown{display:none}.fxs-startboard-header:not(.fxs-startboard-header-normal) .fxs-startboard-title-edit{display:none}.fxs-startboard-header-normal .fxs-startboard-dropdown{display:block}.fxs-startboard-header-normal .fxs-startboard-migration{display:none}.fxs-startboard-header-normal .fxs-startboard-title-next{display:none}.fxs-startboard-header-migration .fxs-startboard-dropdown{display:none}.fxs-startboard-header-migration .fxs-startboard-migration{display:flex}.fxs-startboard-header-migration .fxs-startboard-title-next{display:block}.fxs-startboard-message-container{padding:55px 40px}.fxs-startboard-message-title{font-size:32px;margin-bottom:20px}.fxs-startboard-message-body{font-size:17px}.fxs-startboard-notfound .fxs-startboard-button{display:none}.fxs-portal:not(.fxs-desktop-organize) .fxs-topbar-dashboard-changed .fxs-startboard-header-item{display:none}.fxs-portal:not(.fxs-desktop-organize) .fxs-topbar-dashboard-changed .fxs-startboard-title-next{display:block}.fxs-startboard-loadanimation{display:none;align-items:center;justify-content:center;position:absolute;height:100%;width:100%}.fxs-startboard-loading .fxs-startboard-loadanimation{display:flex}.fxs-startboard-loading .fxs-startboard-layout,.fxs-startboard-loading .fxs-startboard-message-container{visibility:hidden}.fxs-startboard-loading .fxs-startboard-header-item{display:none}.fxs-startboard-loading .fxs-startboard-title-next{display:block}.fxs-startboard-loading .fxs-startboard-layout .fxs-tile .fxs-part-content{display:none}@media(min-height:500px){.fxs-startboard{overflow:hidden}.fxs-startboard-layout{overflow:auto}}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css",["module"],(function(e){"use strict";return{css:".fxs-tile-progress-transparent{height:12px;position:absolute;top:0;left:0;z-index:195;overflow:hidden}.fxs-tile-progress-transparent>div{margin-left:6px}.fxs-tile-progress-transparent>div::after{height:4px;width:4px;background:#000}.fxs-startboard .fxs-tile{border-radius:2px}.fxs-startboard .fxs-tile>.fxs-part{border-radius:2px}.fxs-tile{height:175px;width:175px;position:relative;box-shadow:none}.fxs-tilesize-mini{height:85px;width:85px}.fxs-tilesize-small{height:85px;width:175px}.fxs-tilesize-tall{height:355px;width:175px}.fxs-tilesize-wide{height:175px;width:355px}.fxs-tilesize-normal{height:175px;width:175px}.fxs-tilesize-large{height:355px;width:355px}.fxs-tilesize-herotall{height:535px;width:355px}.fxs-tilesize-herowide{height:355px;width:535px}.fxs-tilesize-hero{height:535px;width:535px}.fxs-tilesize-herowidefitheight{height:auto;width:535px}.fxs-tilesize-fullwidthfitheight{height:auto;width:100%}.fxs-tilesize-fullwidthfitheight .fxs-part{height:auto}.fxs-tilesize-fullwidthfitheight .fxs-part-content{height:auto}.fxs-tilesize-herowidefitheight,.fxs-tilesize-fullwidthfitheight{margin-bottom:5px}.fxs-tilesize-herowidefitheight:last-child,.fxs-tilesize-fullwidthfitheight:last-child{margin-bottom:0}.fxs-tilesize-fittocontainer{height:100%;width:100%}.fxs-tilesize-fittocontainer>.fxs-part{overflow:visible}.fxs-tile-actionbar{z-index:196}.fxs-tile-container{width:100%;height:100%}div.fxs-tile-overlay:not(.fxs-progress){display:none;position:absolute;width:100%;top:0;bottom:0;cursor:pointer}.fxs-bladestyle-create .fxs-tile .fxs-part,.fxs-bladestyle-context .fxs-tile .fxs-part,.fxs-bladestyle-contextaction .fxs-tile .fxs-part,.fxs-bladestyle-help .fxs-tile .fxs-part{box-shadow:none}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css",["module"],(function(e){"use strict";return{css:".fxs-tile-actionbar-actionlist{display:flex;flex-flow:row nowrap;border-radius:0 2px 0 0}.fxs-tile-actionbar-actionlist:empty{height:25px;visibility:hidden}.fxs-tile-actionbar-actionlist .fxs-tile-actionbar-action:last-of-type{border-radius:0 2px 0 0}.fxs-tile-actionbar-action{flex:0 0 auto;display:flex;align-items:center;justify-content:center;box-sizing:border-box;height:25px;width:25px;padding:6px;background-color:transparent;cursor:pointer;border:0;transition:background .1s ease-out}.fxs-tile-actionbar-action>svg{height:13px;width:13px}.fxs-tile .fxs-tile-actions{position:absolute;right:0;cursor:default}.fxs-tile-actionbar-command-unpinfromstartboard{display:none}.fxs-desktop-organize .fxs-tile-actionbar-command-unpinfromstartboard{display:flex}.fxs-tile-transparent{opacity:0}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css",["module"],(function(e){"use strict";return{css:".fxs-toast{position:fixed;right:5px;width:355px;max-width:100%;box-sizing:border-box;list-style-type:none;margin:0;padding:0;padding-left:10px}.fxs-topbar-toast{position:relative;top:25px}.fxs-toast-wrapper,.fxs-toast-content{flex:1 1 auto;width:100%;padding:10px;box-sizing:border-box}.fxs-toast-item{display:flex;margin-bottom:5px;max-height:82vh;overflow-y:auto;position:relative}.fxs-toast-header{display:flex;padding-top:5px;margin-bottom:5px}.fxs-toast-icon{margin-right:4px}.fxs-toast-icon svg{height:15px;width:15px;vertical-align:middle}.fxs-toast-title{flex:1 1 auto;margin:0 4px;max-width:254px;font-weight:600;display:block;display:-webkit-box;line-height:19px;max-height:38px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow-wrap:break-word}.fxs-toast-title.fxs-toast-link:hover{text-decoration:underline}.fxs-toast-time{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60px;flex:0 0 auto}.fxs-toast-close{position:absolute;top:0;right:0;background:none;border:0;cursor:pointer;margin-left:4px;padding:0;margin-top:16px;margin-right:12px}.fxs-toast-close svg{height:12px;width:12px}.fxs-toast-description{font-size:13px;line-height:normal;max-width:100%;overflow:hidden;position:relative;text-overflow:ellipsis;white-space:pre-wrap;width:335px}.fxs-toast-progressbar{margin-top:10px;max-height:5px}.fxs-nps .fxs-gap-above{margin-top:10px}.fxs-nps .fxs-nps-title,.fxs-nps .fxs-sat-title{font-weight:600;margin-bottom:7px;width:calc(100% - 15px)}.fxs-nps .fxs-nps-title{font-size:14px;line-height:18px}.fxs-nps .fxs-nps-title-control{margin-top:25px}.fxs-nps .fxs-sat-title{margin-top:28px}.fxs-nps .fxs-nps-sat-question{margin-bottom:7px}.fxs-nps .fxs-nps-title-icon{margin-right:4px}.fxs-nps .fxs-nps-title-icon svg{height:15px;width:15px;fill:#0078d4;vertical-align:middle}.fxs-nps .fxs-red-star{color:#f00;font-size:14px;line-height:20px}.fxs-nps .fxs-nps-score{display:flex}.fxs-nps .fxs-nps-score span{flex:1 1 auto;border:1px solid #c5cbd1;text-align:center;height:23px;line-height:23px;margin-right:6px;display:inline-block;cursor:pointer}.fxs-nps .fxt-nps-sat-labels ul{font-size:10px;line-height:14px}.fxs-nps .fxs-nps-score span:hover,.fxs-nps .fxs-nps-score span.fxs-nps-score-selected{background:#00bcf2;border-color:#00bcf2}.fxs-nps .fxs-nps-score span:last-child{margin-right:0}.fxs-nps .fxs-nps-help{display:flex;margin-bottom:10px}.fxs-nps .fxs-nps-help span:last-child{margin-left:auto}.fxs-nps .fxs-nps-comments{margin-bottom:18px;margin-top:22px;width:100%;box-sizing:border-box}.fxs-nps .fxs-nps-link-wrapper{font-size:10px;line-height:14px;margin-bottom:5px;margin-top:10px}.fxs-nps .fxs-nps-disclaimer{display:inline}.fxs-nps .fxs-nps-checkbox{margin:15px 5px 0 0}.fxs-nps .fxs-nps-checkbox-contact{margin-right:3px}.fxs-nps .fxs-nps-contact-link{display:inline-block;margin-left:3px}.fxs-nps .fxs-nps-button-holder{border-top:1px solid #dcdfe2}.fxs-nps .fxs-nps-submit{display:inline-block;margin-right:10px;text-align:center}.fxs-nps .fxs-nps-close{display:inline-block;text-align:center}.fxs-nps .fxs-nps-start-hats{display:inline-block;margin-right:10px;text-align:center}.fxs-nps .fxs-nps-link-survey{text-decoration:underline}.fxs-sat .fxs-sat-title{font-weight:600;margin-bottom:7px}.fxs-sat .fxs-sat-submit{margin:15px 10px 5px 0;border:0}.fxs-copilot-toast .fxs-gap-above{margin-top:10px}.fxs-copilot-toast .fxs-copilot-toast-title{font-weight:600;font-size:14px;line-height:18px;margin-bottom:7px;width:calc(100% - 15px)}.fxs-copilot-toast .fxs-copilot-toast-title-icon{margin-right:4px}.fxs-copilot-toast .fxs-copilot-toast-title-icon svg{height:20px;width:20px;fill:#0078d4;padding-bottom:5px;vertical-align:middle}.fxs-copilot-toast .fxs-copilot-toast-description{margin-bottom:10px;min-height:40px}.fxs-copilot-toast .fxs-copilot-toast-link-wrapper{font-size:10px;line-height:14px;margin-bottom:5px;margin-top:10px}.fxs-copilot-toast .fxs-copilot-toast-button-holder{border-top:1px solid #dcdfe2}.fxs-copilot-toast .fxs-copilot-toast-optout{display:inline-block;margin-right:10px;text-align:center}.fxs-copilot-toast .fxs-copilot-toast-close{display:inline-block;text-align:center}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css",["module"],(function(e){"use strict";return{css:".fxs-topbar{height:40px;position:relative;z-index:5;flex:0 0 auto;font-size:13px}.fxs-topbar-skip-link{user-select:auto;position:absolute;display:flex;align-items:center;justify-content:center;box-sizing:border-box;overflow:hidden;width:0;height:0;font-weight:bold;color:var(--topbarAlternateTextFill);background-color:var(--searchBackground);border-color:var(--colorControlBorder);top:0}.fxs-topbar-skip-link:active,.fxs-topbar-skip-link:focus,.fxs-topbar-skip-link:focus-within{width:max-content;height:28px;padding:0 8px 2px;border-width:1px;border-style:solid;border-radius:0 0 4px 4px;z-index:1000}.fxs-topbar-preview,.fxs-topbar-brand{flex:0 1 auto;margin:0;padding:0;height:100%;min-width:0}.fxs-topbar .fxs-topbar-journey-icon{border:0}.fxs-topbar .fxs-topbar-journey-icon svg{height:16px;width:16px;margin-top:4px}.fxs-topbar-content{width:100%;height:100%;position:absolute;top:0;-webkit-app-region:drag;display:flex;align-content:center;align-items:center}.fxs-search-box,.fxs-topbar-button,.fxs-topbar-avatarmenu,.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{-webkit-app-region:no-drag}.fxs-topbar-internal{min-width:85px;box-sizing:border-box;text-align:center;flex:0 0 auto}.fxs-topbar-exitdevmode,.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{display:flex;height:40px;width:auto;flex:0 0 auto;align-items:center;justify-content:center;padding:0 5px;color:#000}.fxs-topbar-preview .fxs-topbar-home .fxs-topbar-internal,.fxs-topbar-brand .fxs-topbar-home{display:inline-block;font-size:15px;padding:0 20px;height:40px;line-height:40px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%;box-sizing:border-box}.fxs-topbar-preview .fxs-topbar-home{display:inline-block;width:100%;height:100%}.fxs-topbar-devmode .fxs-topbar-home{color:#000}a.fxs-topbar-home:hover{text-decoration:none}.fxs-topbar-button{display:flex;height:40px;width:40px;flex:0 0 auto;align-items:center;justify-content:center}.fxs-topbar-button svg{height:16px;width:16px}.fxs-topbar-button.fxs-topbar-close:hover{background-color:#ba141a}.fxs-desktop-organize .fxs-topbar-exit-customize{visibility:visible;top:0}.fxs-topbar-exit-customize-message,.fxs-topbar-dashboard-message{font-size:14px}.fxs-topbar-exit-customize-button,.fxs-topbar-dashboard .fxs-button{flex:0 0 auto;margin-left:10px}.fxs-show-startboard .fxs-topbar-dashboard-view{display:none}.fxs-portal:not(.fxs-show-startboard) .fxs-topbar-dashboard-save,.fxs-portal:not(.fxs-show-startboard) .fxs-topbar-dashboard-discard{display:none}.fxs-topbar-exit-customize,.fxs-topbar-dashboard{display:flex;align-items:center;justify-content:center;flex:1 1 auto;position:absolute;top:-40px;z-index:5;visibility:hidden;width:100%;height:100%;transition:top .3s ease .0001s}.fxs-topbar-dashboard-changed .fxs-topbar-dashboard{top:0;visibility:visible}.fxs-topbar-dashboard-changed .fxs-topbar-content{visibility:hidden}.fxs-topbar-dashboard-changed .fxs-topbar-exit-customize{display:none}.fxs-topbar-notifications{position:relative}.fxs-topbar-helpmenu{position:relative}.fxs-topbar-placeholder{flex:1 1 auto}.fxs-topbar-buttons-container{display:flex;flex:0 0 auto}.fxs-topbar-back{transform:scale(-1,1)}.fxs-topbar-search{margin-left:7px;width:800px;min-width:280px;flex:0 10000 auto}.fxs-topbar-exitdevmode.fxs-topbar-debug-button.fxs-topbar-search-activated-hidden{border:2px solid;box-sizing:border-box;height:calc(100% - 8px);border-radius:8px;background-color:#fff8!important}.fxs-topbar-copilot{gap:5px;width:auto;height:26px;padding-left:12px;padding-right:13px;border-radius:3px;background:var(--copilotIconBackground)}.fxs-topbar-copilot .fxs-topbar-copilot-text{margin-bottom:1px;font-weight:600;font-size:13px;color:var(--copilotIconTextColor)}.fxs-topbar-copilot-button-icon{height:16px}.fxs-topbar-copilot-active{background:var(--copilotIconActiveBackground)}.fxs-topbar-copilot-active .fxs-topbar-copilot-text{color:var(--copilotIconActiveTextColor)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home:hover{background:var(--copilotIconHoverBackground)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home:active{background:var(--copilotIconActiveBackground)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home:focus{background:var(--copilotIconFocusBackground)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home:focus:hover{background:var(--copilotIconHoverBackground)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home .fxs-topbar-copilot-text:hover{color:var(--copilotIconHoverTextColor)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home .fxs-topbar-copilot-text:active{color:var(--copilotIconActiveTextColor)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home .fxs-topbar-copilot-text:focus{color:var(--copilotIconFocusTextColor)}.fxs-search-back-icon{display:none}.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{margin-left:7px;height:26px;border-radius:2px;font-weight:600}.fxs-topbar-reportbug .fxs-topbar-reportbug-icon,.fxs-topbar-upgradebutton .fxs-topbar-reportbug-icon{width:16px;height:16px}.fxs-topbar-reportbug .fxs-topbar-upgradebutton-icon,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-icon{width:14px;height:14px}.fxs-topbar-reportbug .fxs-topbar-reportbug-text,.fxs-topbar-upgradebutton .fxs-topbar-reportbug-text,.fxs-topbar-reportbug .fxs-topbar-upgradebutton-text,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-text{margin-left:7px;margin-bottom:2px}.fxs-topbar-reportbug .fxs-topbar-upgradebutton-text,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-text{margin-top:1px}.fxs-topbar-state-searchcollapsed .fxs-topbar-search{width:40px;min-width:40px;flex:0 0 auto}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search{width:calc(100% - 40px - 7px*2);margin-left:7px}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-search-back-icon{display:flex}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search-activated-hidden{opacity:0;position:absolute;height:0!important;width:0!important;overflow:hidden!important}.fxs-topbar-sidebar-collapse-button{display:flex;width:48px}.fxs-topbar-wafflemenu{display:flex;width:48px}.fxs-topbar-search.fxs-search-onecolumn{justify-content:center}.fxs-topbar-search.fxs-search-onecolumn .fxs-search-wrapper,.fxs-topbar-search.fxs-search-onecolumn .fxs-search-menu{min-width:364px;max-width:520px;left:auto}@media(max-width:700px){.fxs-topbar-exit-customize-message,.fxs-topbar-dashboard-message{display:none}}@media(min-width:640px) and (min-height:500px){.fxs-topbar-sidebar-collapse-button{display:none}.fxs-sidebar-hamburger-mode .fxs-topbar-sidebar-collapse-button{display:flex}}@media(min-width:494px){.fxs-topbar-search-activated .fxs-search-back-icon{position:absolute}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search{margin:auto}}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.WidgetBase",["require","exports","MsPortalImpl/Base/Base.ElementWidgetMap","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,o.injectCss)(i,n,r,a,l,c,d,p,u,m,h,g,f,x);t.ViewModel=class{constructor(){this.disabled=ko.observable(!1)}};class b{constructor(e,t,o=!1){if(!e||0===e.length)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");this.options=t,this._ltm=new FxImpl.TriggerableLifetimeManager,this.element=$(e[0]),o||this._ltm.registerForDispose(e.setEvents([b.widgetRemoveEvent,t=>{t.target!==e[0]||this._disposeTriggered||(this._disposeTriggered=!0,this.dispose())}])),s.set(e[0],this)}setFocus(){}dispose(){this._ltm.dispose(),s.remove(this.element[0],this)}get ltm(){return this._ltm}static getWidget(e,t){const s=b.getWidgets(e,t);return s&&s[0]||null}static getWidgets(e,t){return(t?s.getAllMatch(e[0],t):s.getAll(e[0]))||[]}trigger(e,t){const s=this.options[e],o=this.element;t=t||{};const i=$.Event(e);return i.type=e,i.target=o[0],o.trigger(i,t),!($.isFunction(s)&&!1===s.apply(o[0],[i].concat(t))||i.isDefaultPrevented())}getTelemetrySource(){return null}_bindDescendants(e){const t={data:this.options,func:this},s=e?$.extend(null,t,e):t;ko.applyBindingsToDescendants(s,this.element[0])}_cleanDescendants(){ko.utils.cleanDescendantNodes(this.element)}_cleanElement(...e){this._cleanDescendants(),this._cleanElementClasses(e),this.element.empty()}_cleanElementClasses(e){e.length>0&&this.element.removeClass(e.join(" "))}_isRtl(){return"rtl"===$.querySelectorAll("html").first().attr("dir")}}t.Widget=b,b.widgetRemoveEvent="remove.fxWidget"})),
define("_generated/MsPortalImpl/Svg/Library/Polychromatic/AllServices.svg",["require","exports"],(function(e,t){"use strict";return{type:385,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><defs><linearGradient id='21c38274-7299-4e2d-b473-e94a36621c1d' x1='1.65' x2='1.65' y1='6.09' y2='3.44' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.4' stop-color='#65a227'/><stop offset='1' stop-color='#76bc2d'/></linearGradient><linearGradient id='003dbb31-9185-4029-ac52-7b359ea379ec' x1='1.65' x2='1.65' y1='10.47' y2='7.83' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.54' stop-color='#6aa928'/><stop offset='1' stop-color='#76bc2d'/></linearGradient><linearGradient id='52110254-db2e-4eb4-842e-fae860afb3ee' x1='1.65' x2='1.65' y1='15.02' y2='12.37' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.54' stop-color='#6aa928'/><stop offset='1' stop-color='#76bc2d'/></linearGradient></defs><rect width='13.97' height='1.45' x='3.73' y='4.04' fill='#8a8a8a' rx='.73'/><rect width='13.97' height='1.45' x='3.73' y='8.42' fill='#8a8a8a' rx='.73'/><rect width='13.97' height='1.45' x='3.73' y='12.97' fill='#8a8a8a' rx='.73'/><rect width='2.64' height='2.64' x='.32' y='3.44' fill='url(#21c38274-7299-4e2d-b473-e94a36621c1d)' rx='1.32'/><rect width='2.64' height='2.64' x='.32' y='7.83' fill='url(#003dbb31-9185-4029-ac52-7b359ea379ec)' rx='1.32'/><rect width='2.64' height='2.64' x='.32' y='12.37' fill='url(#52110254-db2e-4eb4-842e-fae860afb3ee)' rx='1.32'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Library/Polychromatic/Dashboard.svg",["require","exports"],(function(e,t){"use strict";return{type:350,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><defs><linearGradient id='77cc0957-ecd2-4e68-861a-8eba665dc20b' x1='9' x2='9' y1='790.787' y2='774.125' gradientTransform='matrix(1 0 0 -1 0 791.516)' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#6cc6b9'/><stop offset='.46' stop-color='#6ac4b7'/><stop offset='.64' stop-color='#62bdb0'/><stop offset='.77' stop-color='#56b1a4'/><stop offset='1' stop-color='#258277'/></linearGradient></defs><path fill='url(#77cc0957-ecd2-4e68-861a-8eba665dc20b)' d='M.549 2.636h16.912a.518.518 0 0 1 .539.489v11.75a.518.518 0 0 1-.539.489H.549A.528.528 0 0 1 0 14.875V3.145a.529.529 0 0 1 .548-.509z'/><rect width='1.532' height='9.349' x='12.459' y='4.206' opacity='.9' rx='.147' class='msportalfx-svg-c01'/><rect width='8.572' height='1.937' x='1.628' y='11.629' opacity='.6' rx='.159' class='msportalfx-svg-c01'/><rect width='1.532' height='5.524' x='14.808' y='8.031' opacity='.9' rx='.113' class='msportalfx-svg-c01'/><path d='m9.117 4.772-2.13 3.79-2.253-2.295-2.322 3.011.544.427 1.842-2.376 2.338 2.386L9.72 5.119l-.603-.347z' class='msportalfx-svg-c01'/><ellipse cx='4.761' cy='6.795' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='7.136' cy='8.979' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='9.341' cy='5.055' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='2.775' cy='9.363' rx='.876' ry='.881' class='msportalfx-svg-c01'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Home.svg",["require","exports"],(function(e,t){"use strict";return{type:335,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><defs><linearGradient id='303de2d4-acef-48d7-85d7-0a7bc92dbf9f' x1='9' x2='9' y1='17.66' y2='.34' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#0078d4'/><stop offset='.17' stop-color='#1c84dc'/><stop offset='.38' stop-color='#3990e4'/><stop offset='.59' stop-color='#4d99ea'/><stop offset='.8' stop-color='#5a9eee'/><stop offset='1' stop-color='#5ea0ef'/></linearGradient></defs><path fill='url(#303de2d4-acef-48d7-85d7-0a7bc92dbf9f)' d='M17.8 8.29 9.41.5a.61.61 0 0 0-.82 0L.2 8.29a.62.62 0 0 0 .47 1.06h1.72a.3.3 0 0 1 .3.3v7.4a.61.61 0 0 0 .61.61h11.4a.61.61 0 0 0 .61-.61v-7.4a.3.3 0 0 1 .3-.3h1.72a.62.62 0 0 0 .47-1.06z'/><path fill='#e6e6e6' d='M7.07 12.4h3.86a.36.36 0 0 1 .32.38v4.88h-4.5v-4.88a.36.36 0 0 1 .32-.38z'/><path fill='#005ba1' d='M.67 9.35h.53l7.39-6.86a.61.61 0 0 1 .82 0l7.39 6.86h.53a.62.62 0 0 0 .47-1.06L9.41.5a.61.61 0 0 0-.82 0L.2 8.29a.62.62 0 0 0 .47 1.06z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/MonochromeHome.svg",["require","exports"],(function(e,t){"use strict";return{type:398,data:"<svg viewBox='0 0 2048 2048' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m1024 165 941 942-90 90-83-82v805h-640v-640H896v640H256v-805l-83 82-90-90 941-942zm640 1627V987l-640-640-640 640v805h384v-640h512v640h384z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/MsPortalImpl/Svg/Startup/Home.svg","_generated/MsPortalImpl/Svg/Startup/MonochromeHome.svg","MsPortalImpl/Services/Services.Recents","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Services/Services.GeneralSettings","_generated/MsPortalImpl/Svg/Library/Polychromatic/Dashboard.svg","_generated/MsPortalImpl/Svg/Library/Polychromatic/AllServices.svg","Weave","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","MsPortalImpl/Base/Base.BrowserDetection"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.reorderFavorite=t.ViewModel=void 0,(0,g.injectCss)(f);var b=MsPortalFx.Base,y=b.Images,v=b.Promises.cancelOnDispose;const M=window.fx.environment,C="fxs-sidebar-bar",P="li.fxs-sidebar-item",w=i.SideBar,I="fxs-sidebar-menu-container",S=MsPortalFx.isNullOrUndefined;let _=class extends r.ViewModel{setCollapsed(e,t=!0){this.focusBehavior(t),this.isCollapsed(e)}openCreate(){F("SideBarNewMenuOpened"),this.launchBlade((0,o.getGalleryDeepLink)("hub"))}reorderFavorites(e){!function(e,t,s){const o=$(document.activeElement).parent(),i=40===s?o.next(P):o.prev(P);if(i.length>0){const s=T(i.attr("data-id"),e,t);s>=0&&Promise.resolve().then((()=>{const e=t.favoritesManager.favorites.value[s].uri,o=$.querySelectorAll(`.${C} [href|='${e}']`)[0];o&&o.focus()}))}}($(document.activeElement).parent().attr("data-id"),this,e)}openExternal(e){window.open(e,"_blank")}setWidget(e){this._widget=e}getRootElement(){return this._widget&&this._widget.element}constructor(e,t,s){super(),this.diContainer=e,this.favoritesManager=t,this._recentsManager=s,this.menuBladeId=(0,h.makeWritableComputation)(),this.menuBladePartContainer=(0,h.makeWritableComputation)(),this.allServiceLinkClicked=(0,h.makeWritableComputation)(!1),this.isCollapsed=(0,h.makeWritableComputation)(!0),this.layoutMode=(0,h.makeWritableComputation)(),this.hamburgerMode=(0,h.makeWritableComputation)(!0),this.focusBehavior=(0,h.makeWritableComputation)(!0),this.sideBarMenuIsActivated=(0,h.makeWritableComputation)(!1),this.hamburgerButton=new h.ElementRef,this.extensionSideBar=ko.observable(""),this.openFavorite=(e,t,s)=>{let o;if(o="number"==typeof e?this.favoritesManager.favorites.value[e]:e,o){if(o.opensExternal)return this.openExternal(o.uri),!0;if(!t&&!s){const e=o.assetType,t=o.kind;return e&&this._recentsManager.addService(e.id+(t?"."+t:"")),this.launchBlade(o.uri,o),!0}}};const n=MsPortalFx.isFeatureEnabled("brandingsidebar")?M.branding.browseLabel:w.allServices,r=MsPortalFx.isFeatureEnabled("monochromehomeicon")?l:a;this.topSectionLinks=[!M.chrome.hideCreateButton&&{classes:"fxs-sidebar-create",title:w.createTooltip,text:w.createResource,icon:y.Add({customClass:"msportalfx-fill-success"}),href:(0,o.getGalleryDeepLink)("hub"),onClick:()=>{F("SideBarNewMenuOpened")}},MsPortalFx.isFeatureEnabled("azurehome")&&{classes:"fxs-sidebar-home",title:i.AzureHome.azureHome,text:i.AzureHome.home,icon:r,href:(0,o.getHomeDeeplink)(),onClick:()=>{F("AzureHomeLinkClicked")}},!MsPortalFx.isFeatureEnabled("hidedashboards")&&{classes:"fxs-sidebar-dashboard",title:i.NavBar.home,text:i.NavBar.home,icon:u,href:(0,o.getDefaultDashboardDeeplink)(),onClick:()=>{F("DashboardNavigation")}},!MsPortalFx.isFeatureEnabled("hideallservices")&&{classes:"fxs-sidebar-browse",title:n,text:n,icon:m,href:(0,o.getAllServicesDeeplink)(),onClick:()=>{F("AllServicesMenuOpened"),this.allServiceLinkClicked(!0)}}].filter(MsPortalFx.identity),this.favorites=t.favorites,this.effectiveFavorites=this.favorites.cFilter((e=>!!e)),this.hamburgerMode(!(0,p.isSideBarDocked)(e)),this.extensionSideBar(e.get(FxImpl.Features).getValue("extensionsidebar"))}};function F(e,t,s){b.Diagnostics.Telemetry.trace({source:"SideBar",name:t,action:e,data:s})}function T(e,t,s){const o=s.favoritesManager.favorites,i=o.value,n=k(e,i),r=k(t,i);if(n>=0&&r>=0&&n!==r){F("SideBarFavoriteMoved",t,{oldIndex:r,newIndex:n});const e=o.value[r];return o.removeAt(r),o.insert(n,e),s.favoritesManager.move(n),n}return-1}t.ViewModel=_,t.ViewModel=_=__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),s.Class(),__metadata("design:paramtypes",[s.Container,n.FavoritesManager,c.RecentServicesManager])],_),t.reorderFavorite=T;function k(e,t){for(let s=0;s<t.length;++s)if(t[s]&&t[s].id===e)return s;return-1}t.Widget=class{constructor(e,t,s,o){this.ltm=e,this.element=t,this.options=s,this._diContainer=o,this._renderGuard=!1,s.setWidget(this);const i=this.ltm;this._lastFocusedElement=document.activeElement,this._settings=s.diContainer.get(p.GeneralSettings),s.hamburgerMode(!(0,p.isSideBarDocked)(s.diContainer)),this.render(window.innerWidth,window.innerHeight),this._settings.sideBarLayout.subscribe(i,(()=>{s.hamburgerMode(!(0,p.isSideBarDocked)(s.diContainer)),s.hamburgerMode.value||2!==s.layoutMode.value?s.setCollapsed(!0):2===s.layoutMode.value&&s.setCollapsed(this._settings.sideBarCollapsedKey()),this.render()})),(0,h.subscribe)(i,[s.isCollapsed],(e=>{e?d.unregister(this._dismissHandle):s.focusBehavior.value&&d.register(this._dismissHandle),this.render(),F("SideBarCollapsedChanged","",e?"collapsed":"expanded")}));const n=e=>!s.hamburgerMode.value&&2===s.layoutMode.value||this.element[0]===e||$.contains(this.element[0],e)?0:2;this._dismissHandle={dismissFn:()=>{s.setCollapsed(!0),d.unregister(this._dismissHandle)},shouldDismissOnFocusOutFn:n,shouldDismissOnMouseDownFn:n,shouldDismissOnMouseWheelFn:n,logName:"sidebar"};const r=()=>{x.isAndroidOrMobile||this.render(window.innerWidth,window.innerHeight)};window.addEventListener("resize",r),i.registerForDispose((()=>window.removeEventListener("resize",r))),this._attachEventHandlers()}render(e,t){if(this._renderGuard)return;this._renderGuard=!0;const s=this.options,o=s.isCollapsed,i=s.hamburgerMode,n=s.layoutMode.value;let r=n;var a;if(S(e)||S(t)||(a=e,r=t<500||a<640?0:a<1024?1:2,S(n)||r===n||F("SideBarLayoutChanged","",function(e){switch(e){case 0:return"SideBarFlyout";case 1:return"SideBarCollapsed";case 2:return"SideBarExpanded"}}(r))),r!==n&&(i.value||2!==r?s.setCollapsed(!0):2===r&&s.setCollapsed(this._settings.sideBarCollapsedKey()),(0===r||0===n)&&s.menuBladeId.value))if(0!==r){const e=this.element.find(".fxc-menu");e.detach(),e.appendTo(s.menuBladePartContainer.value)}else{const e=s.menuBladePartContainer.value.find(".fxc-menu");e.detach(),this.element.find(`.${I}`).empty(),e.appendTo(this.element.find(`.${I}`))}if(!i.value&&n!==r&&2===r){const e=document.getElementsByClassName("fxs-part-reactframe"),t=document.createEvent("Event");t.initEvent("resize",!0,!0);for(let s=0;s<e.length;s++)e[s].dispatchEvent(t)}if(s.focusBehavior.value&&(i.value||0===r))if(o.value){const e=this.element[0],t=document.activeElement;$.contains(e,t)&&d.validatePreviousFocusedElement(this._dismissHandle,this._lastFocusedElement)&&$(this._lastFocusedElement).focus()}else this.setFocus();n!==r&&s.layoutMode(r),this._renderGuard=!1}setFocus(){this._lastFocusedElement=document.activeElement,this.options.hamburgerButton.focus()}_attachEventHandlers(){v(this.ltm,Promise.all([MsPortalFx.require(e.normalize("MsPortalImpl/Widgets/Widgets.HoverCard")),MsPortalFx.require(e.normalize("MsPortalImpl/Widgets/ServiceHoverCard"))])).then((([e,t])=>{e.attach(this.ltm,this.element,".fxs-sidebar-favorite-item",(s=>{const o=this.options.favorites.value,i=o[k($(s.currentTarget).attr("data-id"),o)],n=this.element.find(`.fxs-hover-card-balloon[data-name='${i.id}']`).first(),r=new t.ViewModel(i,$(s.currentTarget),this._diContainer,"SidebarFavorite");return r.favoriteOnDismiss=!0,r.positionHint=4,b.Diagnostics.Telemetry.trace({source:"HoverCard",name:i.id,action:"InitialReveal",data:{hoverCardLocation:"SidebarFavorite"}}),new e.Widget(n,r,this._diContainer)}),this._diContainer)}))}}})),
define("MsPortalImpl/AzFramework/AzHost",["require","exports","Fx","Fx/Composition/Selectable","FxInternal/AsyncLoader","FxInternal/Controls/Essentials","FxInternal/UriScrubber","FxInternal/Weave","FxHubs/RpcEndPoints","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.ImplUtils","MsPortalFx/Globalization","MsPortalImpl/AzFramework/AzExtensionCore","MsPortalImpl/Services/Services.ArmEvents","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/Services/Services.PersistentStorage","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Permissions","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Services/Services.GlobalResourceFilters","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/ReactViews/ShellReactQueries","MsPortalImpl/AzFramework/AzHost.Browse","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/ReactViews/ReactFrame.Constants","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.NavigationManager.ForceSignIn","MsPortalImpl/Base/Themes"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M,C,P,w,I,S,_,F,T,k,D,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=void 0;var B=MsPortalFx.Base,A=MsPortalFx.Base.Diagnostics,N=A.Telemetry,R=FxImpl.TelemetryContext,L=MsPortalFx.Hubs.Notifications,O=MsPortalFx.Parts.PartSize,z=MsPortalFx.Composition.PartReference,H=MsPortalFx.Errors.Error,U=l.AssetTypes.getRecentResourcesEndPoint;const W=B.Diagnostics.createLog(e),V=N.Context.getBladeContext;function j(e){const{extensionName:t,partName:s,parameters:o,initialSize:i,resourceId:n}=e;if(n)return e;let r,a,l;return"number"==typeof i?r=i:i&&(r=O.Custom,a=i.height,l=i.width),new z(s,o||{},{extensionName:t,initialSize:r,initialHeight:a,initialWidth:l})}function q(e,t){"result"in t?e.resolve(t.result):e.reject(new Error(t.error))}function G(e,t){t.result?e.resolve(t.result):e.reject(new Error(t.error))}function K(e){let t;try{t=JSON.stringify(e,((e,t)=>{let s=t;return H.isBaseOf(t)?s={message:t.message,stack:t.stack,isError:!0,statusText:t.data?.statusText,status:t.data?.status,requestId:t.data?.requestId,uri:t.data?.uri}:t instanceof Error&&(s={message:t.message,stack:t.stack,isError:!0}),s}))}catch(e){t="<Failed to serialize error>"}return t}t.create=function({lifetime:t,getToken:O,parameters:z,defaultTokenPromise:H,telemetryContextState:J,initializedDeferred:Q,onMessageReceived:X,extensionName:Z,extensionVersion:Y,diContainer:ee,selectedSubscriptions:te,getUserInfo:se,theme:oe,frameWindow:ie,features:ne,router:re,reactFrameType:ae,extensionStorage:le,getSafeLink:ce,queryStore:de,globalResourceFilter:pe,frameId:ue,menuRenderer:me,onBladeApiCalled:he}){const ge=(()=>{const e=arguments[0];return he&&5===ae?["container","viewModel","contentRevealedDeferred","provisioningContext","setContextPaneWidth","inContextPane","bladeTelemetryData"].reduce(((e,t)=>(Object.defineProperty(e,t,{get:()=>{throw he(),new Error("Not reachable")}}),e)),{}):e})(),fe=he&&5===ae?e=>{throw he(e),new Error("Not reachable")}:()=>{};let xe;const be=J&&R.usingState((()=>(xe=V(),R.getCurrentValues())),J),ye=xe?.id;let ve,Me,Ce=te;const Pe=FxImpl.internalEnv.blockUntrustedDomains||MsPortalFx.isFeatureEnabled("blockuntrusteddomains");let we,Ie;async function Se(){return Ie||(Ie=(async()=>{const e=await FxImpl.Rpc.client.invokeRpc("MsPortalFx.Internal.Constants.RpcMethods.experimentationValuesHelper","HubsExtension",["tempTrustedDomains"]);try{return JSON.parse(e[0]||"{}")}catch(t){return W.warning(`Failed to get untrusted domains overrides from ExP. Actual value: "${e[0]}". Error details: ${MsPortalFx.getLogFriendlyMessage(t)}`),{}}})()),await Ie}const _e=async()=>ee.getAsync(i.get("MsPortalImpl/Services/Services.TourGuideManager","TourGuideManager")),Fe=e=>{if(Ce=e,!Ce){const e=ee.get(h.SubscriptionsUserContext).getInSessionSelectedSubscriptions();Ce={get:()=>e.then((e=>e())),onChangedPromise:e}}ve&&ve.dispose(),ve=t.createChildLifetime(),Ce.onChangedPromise.then((e=>e.subscribe(ve,(e=>{Be(1005,{subscriptions:e})}))))};Fe(te);const{registerFunction:Te,callRegisteredFunction:ke,validStubId:De}=function(){let e=1;const t={};function s(s,i){if(s){const n=e++;return t[n]=i?function(){o(n),s.apply(null,arguments)}:s,n}}function o(e){n(e)&&delete t[e]}function i(e){const{responseStubId:s,response:o}=e;t[s].call(null,o)}function n(e){return"number"==typeof e}return{registerFunction:s,callRegisteredFunction:i,validStubId:n}}(),Ee=[];let Be=function(e,t){Ee.push({kind:e,data:t})};function Ae(e,t){Be(1001,{stubId:e,args:t})}function Ne(e){const{bladeName:t,extensionName:s,parameters:i,marketplaceId:n,createAssetType:r,createAssetKind:a,telemetryId:l,marketplaceOptions:c,onClosed:d,referenceType:p,initialData:u,providerConfig:m,receiveResult:h,menuId:g,contentBladeReference:f}=e,x=De(d)&&((e,t)=>{Ae(d,[e,t])})||null;let b;if(1===p)b=new o.ParameterProviderBladeReference(t,s,{parameters:i,onClosed:x,supplyInitialData:u&&(()=>FxImpl.fromSerializableObject(u)),supplyProviderConfig:m&&(()=>m),receiveResult:De(h)&&(e=>{Ae(h,[e&&FxImpl.toSerializableObject(e)])})});else if(2===p){const e=f&&Ne(f);b=new o.MenuBladeReference(t,g,s,{contentBladeReference:e,parameters:i,onClosed:x})}else if(3===p){const e=r?{assetType:r,assetKind:a,marketplaceId:n,telemetryId:l}:null;b=new o.ProvisioningBladeReference(t,s,e||n||c,{parameters:i,onClosed:x})}else b=new o.PdlBladeReference(t,s,{parameters:i,onClosed:x});return FxImpl.shellInterface(b,FxImpl.shellInterface(e)),b}function Re(e){return{bladeName:e.bladeName,extensionName:e.extensionName,parameters:e.parameters}}function Le(e,t){Be(1033,{responseStubId:e.responseStubId,response:{result:t,calleeEndTime:Date.now()}})}function Oe(e){const t=e.options.onClosed;e.options.onClosed=function(e,s){pt(),t?.(e,s)}}const ze=new FxImpl.TriggerableLifetimeManager;function He(e,s){B.Promises.cancelOnDispose(ze,e).then((e=>Le(s,e))).catch((e=>{t.isDisposed()||Be(1033,{responseStubId:s.responseStubId,response:{error:K(e),calleeEndTime:Date.now()}})}))}function Ue(){const{currentTheme:e,highContrastMode:t}=oe;return{mode:e().mode,highContrastMode:t()}}function We(e,t){const s=function(e){const{inContextPane:t,fromMenu:s,options:o}=e;let i;if(o?.asNewJourney)i|=8;else if(t){i|=1;const{inContextPane:e}=ge;i|=e&&4}else s&&(i|=s&&4);i|=o?.asSubJourney&&2;const{inContextPane:n}=ge;return i|=n&&16,i|=1===o?.helpPane&&64,i|=2===o?.helpPane&&128,i}(e),o=2!==ae&&5!==ae&&ee.get(k.BladeDescriptor)?.flags,i=MsPortalFx.isFeatureEnabled("sidebarnotparent")&&!!(256&o);return{container:i?void 0:t,flags:s,telemetryName:"AzHost",context:{openedBy:i?1:0}}}const Ve=(()=>{const e=[];return{request:t=>{const{bladeReferenceStubId:s,fromMenu:o}=t,i=e[s]=Promise.withResolvers();let n=i.promise;o&&(n=i.promise.then((e=>(Oe(e),e))));const{container:r}=ge,a=We(t,r),l=ee.get(T.BladeOpener).openBlade(n,a);o&&l.then(dt),He(l,t)},response:t=>{const{responseStubId:s,response:o}=t;G(e[s],{...o,result:o.result?Ne(o.result):null})}}})(),je=e=>{e.subscribe(t,(e=>{Fe(null),w.globalSubscriptionsQuery.bind(de,ee).clear(),Be(3082,{name:e?.name})}))};let qe=pe;qe?je(qe):ee.get(h.SubscriptionsUserContext).useAdvancedFiltersPromise.then((e=>{e&&(qe?je(qe):ee.getAsync(v.ResourceFilterManager).then((e=>{qe=e.currentFilterObservable,je(qe)})))})),ee.get(m.ArmEvents).subscribeToArmEvent({status:"succeeded"},(e=>Be(1030,e))),window.azTestHooks||async function(){}();const $e=()=>location.hash?.replace("#","");ee.get(c.PortalCustomEvents).addHandler(t,"fxdeeplinkchanged",(()=>{Be(1031,$e())}));const Ge=H&&B.Promises.cancelOnDispose(t,H).then((e=>({result:e}))).catch((e=>({error:e}))),Ke=B.Promises.cancelOnDispose(t,se?se():ee.get(F.AuthStateManager).getUserInfo()).then((e=>({result:e}))).catch((e=>({error:e})));function Je(e,t){X&&X[e]&&X[e]();const s=st.get(e);s?s(t):W.error(`Handler[${e}] is undefined`,null,{extension:Z,context:be})}function Qe(e){R.usingState((()=>{A.Telemetry.trace({source:"AzHost",action:"ReactViewErrors",actionModifier:"complete",data:{frameId:ue,...e,capturedErrors:it}})}),J)}const Xe=Promise.withResolvers(),Ze=(()=>{const e=FxImpl.Rpc.client;return()=>FxImpl.Rpc.client===e&&!window.azTestHooks})(),Ye=e=>{Ze()&&FxImpl.Extension.traceToExtensionEndPoint.invoke(FxImpl.Rpc.client,Z,[e,J]),"HubsExtension"!==Z&&N.trace(e)},et=()=>"HubsExtension"===Z?"LighthousePerfVizClientTelemetry":"LighthousePerfVizExtTelemetry",tt=e=>({bladeId:ye,tableName:et(),...e&&{shellVersions:JSON.stringify(e?.shellVersions||[]),extensionVersions:JSON.stringify(e?.extensionVersions||[]),features:JSON.stringify(e?.features||[]).replace(/"/g,'\\"')}}),st=new Map,ot=()=>{Be(1,function(){const e=FxImpl.internalEnv.extensionTelemetryUri,s=FxImpl.internalEnv.extensionTraceUri,o=MsPortalFx.sessionId,i=MsPortalFx.extend2(FxImpl.getStandardHeaders(Z,Y),{"Accept-Language":p.displayLanguage,"x-ms-effective-locale":FxImpl.Intl.effectiveLocale,"x-ms-client-session-id":o}),n=ko.computed(t,(()=>Ue()));let r;if(n.subscribe(t,(e=>{const t=ee.get(E.ThemeManager).getCurrentThemeColorCssModuleId();MsPortalFx.require(t).then((t=>{Be(1004,{theme:e,cssModule:t})}))})),!window.azTestHooks){const{layoutMode:e}=ee.get(S.ViewModel),{sideBarLayout:s}=ee.get(y.GeneralSettings),o=(0,a.toObservable)(t,e);r=ko.explicitComputed(t,[o,s],(e=>(0,y.isSideBarDocked)(ee)?e:0)),r.subscribe(t,(e=>{Be(3078,e)}))}return{parameters:z,sessionId:o,diagnostics:{telemetryContext:be,headers:i,telemetryUri:e,loggingUri:s},features:ne,theme:n(),deepLink:$e(),sideBarLayoutMode:r?.(),...5!==ae&&{openedBy:ge.bladeTelemetryData?.openedBy,openedByBladeName:ge.bladeTelemetryData?.openedByBladeName}}}()),Ge.then((e=>Be(2,{token:e}))),Ke.then((e=>Be(4,{userInfo:e})))};window.azTestHooks?st.set(0,ot):ot(),st.set(1e3,(e=>{e.forEach((e=>Je(e.kind,e.data)))})),st.set(1010,(()=>{fe("revealContent");const{contentRevealedDeferred:e,container:t}=ge;e.resolve(),t.revealContent()})),st.set(1011,(()=>Q.resolve())),st.set(1012,(e=>{fe("setTitle");const t=e&&e.title,s=e&&e.subtitle;if(2===ae){const{container:e}=ge;e.partTitle(t),e.assetName(s)}else{const{viewModel:e}=ge,o=e;o.title(t),o.subtitle(s)}})),st.set(1014,(e=>{fe("openBlade");const{bladeReference:t,fromMenu:s}=e,o=Ne(t);s&&Oe(o);const{container:i}=ge,n=We(e,i),r=ee.get(T.BladeOpener).openBlade(o,n);s&&r.then(dt),He(r,e)})),st.set(1015,(e=>(fe("openBladeAsync"),Ve.request(e)))),st.set(1016,Ve.response),st.set(1028,(()=>{window.location.hash="#menu/directory"})),st.set(3006,(e=>{He(w.resourceGroupsQuery.bind(de,e.subscriptionIds).get(),e)})),st.set(3007,(e=>{const t=ee.get(b.PermissionsManager).hasPermission(`/subscriptions/${e.subscriptionId}`,["Microsoft.Resources/subscriptions/resourcegroups/write"],B.Constants.Shell).then((t=>MsPortalFx.ViewModels.getValidationResult(t?void 0:MsPortalFx.Resources.Strings.ResourceGroup.Validation.subscriptionHasNoPermissionsMessage.format(e.subscriptionId))));He(MsPortalFx.Azure.ResourceGroups.validateResourceGroupName(e.resourceGroupName,e.subscriptionId,e.existingResourceGroupNames,void 0,t).then((e=>({valid:e.valid,message:e.message}))),e)})),st.set(3004,(e=>{He(w.essentialsResourceInfoQuery.bind(de,t,e.resourceId,e.includeTags).get(),e)})),st.set(3025,(e=>{He(ee.get(x.AssetTypeService).mapResourceIdAndKindToBladeInfo(e.resourceId,e.resourceKind).then((t=>({bladeName:t.bladeName,extensionName:t.bladeExtension,parameters:{id:e.resourceId}}))),e)})),st.set(3026,(e=>{const t=new n.TagResourcesBladeReference(e);He(Promise.resolve(Re(t)),e)})),st.set(3028,(e=>{const t=new n.EditTagsBladeReference({resource:e.resourceId,tagName:e.tagName});He(Promise.resolve(Re(t)),e)})),st.set(3042,(e=>{const t=Promise.withResolvers();MsPortalFx.require("FxHubs/ArmHelpers/ArmTags").then((s=>{s.handleTagsContextPaneResults(e.resourceToTagsMap).then((s=>{if(s.armErrorsMap.get(e.resourceId))t.resolve(void 0);else{const o=s.newTagsMap.get(e.resourceId),i=Object.keys(o).map((e=>({key:e,value:o[e]})));t.resolve(i)}}))})),He(t.promise,e)})),st.set(3029,(e=>{const t=new o.PdlBladeReference("RmAddResourceWizardBlade","Microsoft_Azure_ResourceMove",{parameters:e});He(Promise.resolve(Re(t)),e)})),st.set(3060,(e=>{He(ee.get(x.AssetTypeService).getBrowseBladeReference(e.browseBladeReferenceOptions).then((e=>e&&{bladeName:e.blade,extensionName:e.extension,parameters:e.parameters})),e)})),st.set(1017,(e=>{fe("closeChildBlade");const{container:t}=ge;He(t.closeChildBlade(),e)})),st.set(1018,(e=>{fe("closeContextPane");const{container:t}=ge;He(t.closeContextBlade(),e)})),st.set(1019,(e=>{const{partReferences:t,options:s}=e;He(MsPortalFx.require("Fx/Pinner").then((({pin:e})=>e(t.map(j),{notify:s&&s.notify}))),e)}));const it=[];st.set(3059,(e=>{it.push(e)})),st.set(1020,(e=>{fe("fail");const t={...e,capturedErrors:it},{container:s}=ge;s.fail({...e,error:{data:t}}),Q.reject(t),Qe(e),ut()})),st.set(1032,(e=>{fe("handledError");const{message:t,timestamp:s}=e,{container:o}=ge;o.handledError(t??"No message"),Qe(t),ut({timestamp:s})})),st.set(1023,(e=>{fe("noData");const{message:t,timestamp:s}=e,{container:o}=ge;o.noDataMessage(t),Qe({message:t}),ut({timestamp:s})})),st.set(1021,(e=>{fe("notFound");const{message:t,timestamp:s}=e,{container:o}=ge;o.notFound(t),Qe(t),ut({timestamp:s})})),st.set(1022,(e=>{fe("unauthorized");const{message:t,timestamp:s}=e,o=t&&"string"!=typeof t?function(e){const{header:t,title:s,description:o,callToActionText:i,callToActionUri:n,imageType:r}=e;return{noticeHeader:t,noticeTitle:s,noticeDescription:o,noticeCallToActionText:i,noticeCallToActionUri:n,noticeImageType:r}}(t):t,{container:i}=ge;i.unauthorized(o),Qe({message:o}),ut({timestamp:s})})),st.set(3096,(e=>{MsPortalFx.require("MsPortalImpl/AzFramework/AzHost.Notifications").then((t=>{t.mapAndExecuteAzureAsyncOperation(e,Z)}))})),st.set(3090,(e=>{MsPortalFx.require("MsPortalImpl/AzFramework/AzHost.Notifications").then((t=>{t.mapAndPublishInternalNotification(e,Z)}))})),st.set(3091,(e=>{MsPortalFx.require("MsPortalImpl/AzFramework/AzHost.Notifications").then((t=>{t.mapAndPublishInternalPendingNotification(e,Z)}))})),st.set(3092,(e=>{MsPortalFx.require("MsPortalImpl/AzFramework/AzHost.Notifications").then((t=>{t.mapAndPublishInternalPollingNotification(e,Z)}))})),st.set(1025,(t=>{(0,d.logToExtension)(e,Z,1,"Obsolete Az.publishNotification called");const{status:s,title:o,description:i,descriptionAsHtml:n,correlationIds:r,percentComplete:a,linkTo:l}=t,c={status:s,title:o,description:i,descriptionAsHtml:n,correlationIds:r,percentComplete:a};if(l)if("string"==typeof l)c.uri=l;else if(l.assetId){const{extensionName:e,assetType:t,assetId:s}=l;c.asset={extensionName:e,assetType:t,assetId:s}}else{const e=l,{extensionName:t,bladeName:s,parameters:o}=e;c.linkedBlade={detailBlade:s,extension:t,detailBladeInputs:o||{}}}L.ClientNotification.publish(c)})),st.set(1003,ke),st.set(1006,(e=>{const{resourceName:t,isBackground:s}=e;He(O(t&&{resourceName:t,isBackground:s}),e)})),st.set(3094,(e=>{He(ee.get(M.ExtensionTokensManager).getPopToken({...e,extensionName:Z}),e)})),st.set(3114,(e=>{He(ee.get(M.ExtensionTokensManager).getSshCertToken({...e,extensionName:Z}),e)})),st.set(1007,(e=>{He(Ce.get(),e)})),st.set(3084,(e=>{He(MsPortalFx.require("Fx/Notifications/IrisNotifications").then((({getIrisContent:t})=>t(e))),e)})),st.set(3103,(e=>{He(MsPortalFx.require("MsPortalImpl/Services/Services.Copilot").then((({isCopilotEnabled:e})=>e(ee))),e)})),st.set(3085,(e=>{He(MsPortalFx.require("Fx/Notifications/IrisNotifications").then((({sendIrisSignal:t})=>t(e))),e)})),st.set(3055,(e=>{MsPortalFx.UI.AssetManager.notifyResourceDeleted(e.resourceId)})),st.set(3077,(e=>{He(ee.getAsync(i.get("MsPortalImpl/UI/Compositions/UI.Composition.BladeHistory","BladeHistory")).then((e=>e.getEntries().map((e=>{if(e.bladeReference.parameters)try{structuredClone(e.bladeReference.parameters)}catch(t){return A.Telemetry.trace({source:"AzHost",action:"GetRecentBlades",actionModifier:"stripParameters",data:{reference:{bladeName:e.bladeReference.bladeName,extensionName:e.bladeReference.extensionName},error:t&&t.message}}),{...e,bladeReference:{...e.bladeReference,parameters:void 0}}}return e})))),e)}));const nt=()=>w.globalSubscriptionsQuery.bind(de,ee).get();st.set(3001,(e=>{He(nt(),e)})),st.set(3002,(e=>{const t=Promise.withResolvers(),s=e.subscriptions.reduce(((e,t)=>(e[t.subscriptionId]=!0)&&e),{});nt().then((e=>{const o=e.map((e=>e.subscriptionId)).filter((e=>s[e]));ee.get(h.SubscriptionsUserContext).setInSessionSelectedSubscriptions(o).then((()=>t.resolve(!0)))})),He(t.promise,e)})),st.set(3095,(e=>{He(w.initialDropdownValuesQuery.bind(de,ee,de).get(),e)})),st.set(3081,(e=>{const t=qe&&qe();He(Promise.resolve(t?.name),e)})),st.set(3015,(e=>{He(w.locationsForCreateQuery.bind(de,{subscriptionId:e.subscriptionId,resourceTypes:e.resourceTypes}).get(),e)})),st.set(3080,(e=>{He((0,s.memoizePromise)((()=>MsPortalFx.Azure.getLocations()))(),e)})),st.set(3037,(e=>{He(ee.get(f.PersistentStorageSettings).writeSetting(Z,e.key,e.value,e.readers),e)})),st.set(3108,(e=>{He(_e().then((t=>t.readTourGuideSetting(e.key))),e)})),st.set(3109,(e=>{He(_e().then((t=>t.writeTourGuideSetting(e.key,e.value))),e)})),st.set(3110,(e=>{He(_e().then((t=>t.getTourGuideActiveTours(e.key))),e)})),st.set(3111,(e=>{He(_e().then((t=>t.setTourGuideActiveTours(e.key,e.value))),e)})),st.set(3112,(e=>{He(_e().then((t=>t.setTourGuideActivatedToursCount(e.count))),e)})),st.set(3038,(e=>{He(ee.get(f.PersistentStorageSettings).readSettings(e.extensionName??Z,e.keys,Z),e)})),st.set(3039,(e=>{He(ee.get(f.PersistentStorageSettings).removeSettings(Z,e.keys),e)})),st.set(3040,(e=>{He(ee.get(f.PersistentStorageSettings).clear(Z),e)})),st.set(3041,(e=>{He(ee.get(f.PersistentStorageSettings).getAllSettingsKeys(Z),e)})),st.set(3018,(e=>{He(ee.get(x.AssetTypeService).getResourceTypeAssetTypeInformation(e.resourceTypes),e)})),st.set(3019,(e=>{He(ee.get(h.SubscriptionsUserContext).getSubscription(e.subscriptionId),e)})),st.set(1026,(e=>{const{dashboardId:t}=e;re.navigateWithRoute("dashboard",null,{dashboardId:t})})),st.set(3067,(()=>{re.goToLandingPage({interactionSource:"Blade",replaceHistory:!1})})),st.set(3068,(()=>{$.querySelectorAll(".fxs-topbar-sidebar-collapse-button").trigger("fxtogglesidebar",{updateSettings:!0})})),st.set(3071,(e=>{re.route(e,{openedBy:4})})),st.set(3043,(e=>{const{reason:t,bladeReference:s,signInParameters:o,tenantId:i}=e,n=s&&Ne({extensionName:s.extensionName,bladeName:s.bladeName,parameters:s.parameters,referenceType:null,menuId:null});He((0,D.forceSignIn)(ee,{bladeReference:n,reason:t,signInParameters:o,tenantId:i},Z),e)})),st.set(1029,(e=>{const t=e.forceSvg?{customClass:"forceSvg"}:{symbol:!0};He(MsPortalFx.require("MsPortalImpl/Base/Base.ImageHelper").then((({GetImageData:s})=>s({type:e.type,options:t},{bypassCache:!0}))).then((e=>e.map((e=>e.outerHTML)).join(""))),e)})),st.set(3020,(e=>{He(MsPortalFx.require("Fx/Assets/AssetTypes").then((({getAllAssetTypes:t})=>t(e))),e)})),st.set(3117,(e=>{He(MsPortalFx.require("FxHubs/ArmHelpers/ArmApisStartup").then((({getLatestApiVersion:t})=>t(e.resourceId))),e)})),st.set(3005,(e=>{He(ee.get(g.TenantsService).getTenants().then((e=>e.tenants)),e)})),st.set(2e3,(e=>{fe("setIcon");const{viewModel:t}=ge,s=t,o=s.icon(),i=(n=e.iconUri)&&(0,u.isValidUri)(n)?B.Images.ImageUri(n):null;var n;o&&i&&o.data===i.data||s.icon(i)})),st.set(2001,(e=>{fe("setOnPin");const{stubId:s}=e,o=De(s)?()=>{const e=Promise.withResolvers();return Be(1002,{stubId:s,responseStubId:Te((t=>{G(e,{...t,result:t.result?j(t.result):null})}),!0)}),B.Promises.cancelOnDispose(t,e.promise)}:null,{viewModel:i}=ge;i.setOnPinHandler(o)})),st.set(4e3,(e=>{fe("setOnClick");const{stubId:t}=e,s=De(t)?()=>{Be(1001,{stubId:t})}:null,{viewModel:o}=ge;o.setOnClickHandler(s)})),st.set(4001,(e=>{fe("setUpdatableHeader");const{stubId:t,options:s}=e,o=De(t)?e=>{Be(1001,{stubId:t,args:[e]})}:null,{viewModel:i}=ge;i.setUpdatableHeaderHandler(o,s)})),st.set(3113,(()=>{ee.getAsync(P.FullScreenMode).then((e=>{e.toggle()}))}));const rt=(0,s.memoizePromise)((()=>{const e={};return MsPortalFx.require("FxInternal/Composition/ViewModelAdapters.DoesProvisioning").then((({setProvisioning:t})=>{const{container:s,provisioningContext:o}=ge;return o.then((o=>(t(ee,e,o,s,xe,ze),e)))}))}),{onError:t=>((0,d.logToExtension)(e,Z,2,t),!0)});5!==ae&&ge.provisioningContext.then((e=>{e&&rt()})),st.set(3008,(e=>{fe("doesProvisioning");He(rt().then((e=>({initialValues:e.initialValues,marketplaceItem:e.marketplaceItem,resourceGroupName:e.resourceGroupName,telemetryId:e.telemetryId}))),e)})),st.set(3009,(async e=>{fe("validateTemplate");He((await rt()).validateTemplate(e),e)}));const at=Object.create(null);st.set(3010,(async e=>{fe("deployTemplate");const t=(await rt()).deployTemplate(e),s=Promise.withResolvers();t.finally((()=>setTimeout(s.resolve,5e3))),He(t,e)})),st.set(3075,(async e=>{fe("deployStack");const t=(await rt()).deployStack(e),s=Promise.withResolvers();t.finally((()=>setTimeout(s.resolve,5e3))),He(t,e)})),st.set(3011,(async e=>{fe("initDeployCustom");const t=await rt(),s=Promise.withResolvers(),o=MsPortalFx.getUniqueId();at[o]=s,t.deployCustom({provisioningPromise:s.promise}),Le(e,o)})),st.set(3012,(e=>{at[e.deploymentId].resolve()})),st.set(3076,(async e=>{fe("setMarketplaceId");return(await rt()).setMarketplaceId(e)})),st.set(3013,(async e=>{fe("getArmErrorsBladeReference");const t=(await rt()).getArmErrorsBladeReference(e);Le(e,{bladeName:t.bladeName,extensionName:t.extensionName,parameters:t.parameters})})),st.set(3014,(async e=>{fe("getAutomationBladeReference");const t=(await rt()).getAutomationBladeReference(e);Le(e,{bladeName:t.bladeName,extensionName:t.extensionName,parameters:t.parameters})})),st.set(3016,(e=>{Q.resolve(e)})),st.set(3017,(e=>{He(MsPortalFx.require("MsPortalImpl/UI/UI.LinkHandler").then((s=>{const o=s.getUriAndHandler(t,ee,e,!1);return o.uriPromise?o.uriPromise().then((()=>FxImpl.ensureAbsoluteUri(o.uri()))):FxImpl.ensureAbsoluteUri(o.uri())})),e)})),st.set(2002,(e=>{fe("closeCurrentBlade");const{container:t}=ge;He(t.closeCurrentBlade(e.returnedData),e)})),st.set(2003,(e=>{fe("switchMenuItem");const{id:t,parametersOrOverrideBlade:s}=e,{container:o}=ge;o.menu.switchItem(t,s?Ne(s):null)})),st.set(2004,(e=>{fe("setMenuTitleSuffix");const t=e&&e.title,s=e&&e.subtitle,{viewModel:o}=ge,i=o.menuContent;i.title(t),i.subtitle(s)})),st.set(2005,(e=>{fe("configureAlertOnClose");const{container:t}=ge;e?t.form.configureAlertOnClose(ko.observable(e)):t.form.configureAlertOnClose(1)})),st.set(3030,(t=>{if(new MsPortalFx.Base.UriBuilder(t.url).getAuthority().includes(FxImpl.origin))return;let s;s=t.headers.Authorization&&MsPortalFx.isUriAbsolute(t.url)?(async()=>{if(FxImpl.getDomainValidator(t.extTrustedDomains,!0).validateDomain(t.url))return null;const s=new MsPortalFx.Base.UriBuilder(t.url).getAuthority().toLowerCase(),o="Security issue: Request to send auth token to untrusted domain '{0}'. Only a fixed set of domains should be configured to receive auth tokens. Command name: {1}".format(s,t.headers["x-ms-command-name"]||"<not provided>"),i=!(!FxImpl.isDevelopmentMode&&!Pe)||await async function(){return we||(we=(async()=>(await FxImpl.Rpc.client.invokeRpc("MsPortalFx.Internal.Constants.RpcMethods.experimentationHelper","HubsExtension",["blockuntrusteddomains"]))[0])()),await we}();let n=!1;if(i){const[e,o]=await Promise.all([Se(),Ke]),i="result"in o&&o.result.directoryId;if(i){const o=FxImpl.getHashCode(i.toLowerCase());if(e[o]){const i=FxImpl.getDomainValidator([...e[o]],!0);n=i.validateDomain(t.url),N.trace({source:"CorsFetch",action:"BypassTrustedDomains",actionModifier:n?"Bypassed":"Blocked",extension:Z,data:{domain:s,uri:t.url,bypassDomains:i.trustedDomainsList}})}}}return i&&!n?((0,d.logToExtension)(e,Z,1,o),new Response(o,{status:403,statusText:o})):((0,d.logToExtension)(e,Z,2,o),null)})():Promise.resolve(null);He(s.then((e=>e||window.fetch(t.url,{headers:new Headers(t.headers),method:t.method,body:t.body}))).then((e=>{const t={};return e.headers.forEach(((e,s)=>{t[s]=e})),e.text().then((s=>({responseHeaders:t,responseText:s,status:e.status,statusText:e.statusText})))})),{responseStubId:t.responseStubId})})),st.set(3098,(e=>{(async()=>{const e=await MsPortalFx.require("MsPortalImpl/Services/Services.CopilotManager");return ee.get(e.CopilotBrokerService)})().then((t=>t.postActivity(e)))})),st.set(3061,(e=>{MsPortalFx.require("FxHubs/ArtHelpers/ResourceHoverCardHelpers").then((s=>{He(s.getResourceFromArg(e.manifestColumns,e.projectedColumns,e.browseQuery,e.armId,e.resourceId,e.assetTypes,e.locations,e.directoriesMap,t),e)}))})),st.set(3062,(async e=>{const t=await l.ArtBrowse.getBrowsePrereqsEndpoint.invoke(FxImpl.Rpc.client,"fxw",{...e});Promise.all([MsPortalFx.require("FxHubs/ArtHelpers/ResourceHoverCardHelpers"),MsPortalFx.require("FxHubs/ArtHelpers/ArgBrowseHelpers"),MsPortalFx.require("FxHubs/ResourceCommands/BrowseBulkCommandConfig")]).then((([s,o,i])=>{Le(e,{browsePrereqs:t,bulkCommandDefinitions:i.BulkCommandDefinitions,defaultProperties:s.defaultProperties,columnIdToStringMap:o.columnIdToStringMap,columnIdToArgColumn:o.columnIdToArgColumn})}))})),st.set(3093,(e=>{e?window.sessionStorage.setItem(_.SESSION_STORAGE_THROTTLE,xe.id):window.sessionStorage.removeItem(_.SESSION_STORAGE_THROTTLE)})),st.set(3063,(e=>{MsPortalFx.require("FxHubs/ResourceCommands/BrowseBulkCommandImpl").then((s=>{new s.BulkCommandImpl(t,"ResourceHoverCard",{resourceType:e.resourceType,hasSelectedItems:ko.observable(!0),selectedBrowseItems:ko.observable([{name:e.resourceName,id:e.resourceId,type:e.resourceType}])},e.commandDefinition).execute({button:6})}))})),st.set(3064,(e=>{He(l.AssetTypes.isResourceFavoriteEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{resourceId:e.resourceId}),e)})),st.set(3065,(e=>{He(l.AssetTypes.removeFavoriteResourceEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{resourceId:e.resourceId,telemetrySource:e.telemetrySource}),e)})),st.set(3066,(e=>{He(l.AssetTypes.addFavoriteResourceEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{...e}),e)})),(0,I.registerBrowseHandlers)(st,He,Le,t,ee,de);const lt=ee.get(C.PortalIdleStateService);let ct;if(st.set(3052,(()=>lt.signalBusy(1,ae))),st.set(3051,(()=>lt.signalIdle(1))),!window.azTestHooks){ct=le.registerChangeListener((e=>{Be(3024,e)})),st.set(3021,(e=>{le.setItem(e)})),st.set(3022,(e=>{le.removeItem(e)})),st.set(3023,(e=>{le.clear(e)})),de.subscribe((e=>{Be(3115,e)})),st.set(3116,(e=>{de.setEntry(e)})),st.set(3031,(e=>{He(Promise.resolve({uri:ce(e.uri,Z)}),e)})),st.set(3035,(e=>{["keyup","keydown"].includes(e.type)&&window.document.dispatchEvent(new KeyboardEvent(e.type,e.event))})),st.set(3044,(e=>{fe("setContextPaneWidth");const{setContextPaneWidth:t}=ge;t?.(e)})),st.set(3045,(e=>{He(U.invoke(FxImpl.Rpc.client,"HubsExtension",{}),e)})),st.set(3047,(e=>{MsPortalFx.require("Fx/ResourceManagement").then((t=>t.addRecentResource(e)))})),st.set(3048,(e=>{He(ee.getAsync(i.get("MsPortalImpl/UI/UI.SupportContext","SupportContext")).then((t=>t.hasMenuItem(e.menuId))),e)})),st.set(3049,(e=>{Le(e,$e())})),st.set(3050,(async e=>{const t=MsPortalFx.clone(await Xe.promise,!0);if(t?.data){const e=t.data;delete e.ajaxCalls,delete e.longTasks}const{bladeTelemetryData:s}=ge;R.usingState((()=>{Ye({name:ye,source:"AzHost",action:"ReactViewReady",actionModifier:"complete",extension:Z,data:{...e.profileData,...t&&{lighthouse:t},experiments:e.experiments,startupMetrics:e.startupMetrics,frameId:ue,versions:e.versions,...s?.openedBy&&{openedBy:s.openedBy},...s?.openedByBladeName&&{openedByBladeName:s.openedByBladeName}},duration:e.duration}),N.trace({name:ye,action:"ReactViewDependencies",source:"AzHost",extension:Z,data:{dependencies:e.dependencies}})}),J)})),st.set(3057,(e=>{He((async()=>{(await ee.getAsync(i.get("MsPortalImpl/UI/UI.HelpPane","HelpPane"))).open(e,J)})(),e)})),st.set(3058,(t=>{let s;MsPortalFx.isFeatureEnabled("azureconsole")?s=ee.getAsync(i.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole")).then((e=>e.executeInCloudShell(t,J))).catch((e=>(W.error(FxImpl.createError("Failed to execute in CloudShell",{innerErrors:e})),!1))):((0,d.logToExtension)(e,Z,1,"Azure Console feature is not enabled in this environment."),s=Promise.resolve(!1)),He(s,t)}));const t=e=>{const t=e?.featureGates.reduce(((e,t)=>{const[s,o]=t.split("X");return e[s]=o,e}),{})||{};return{instanceId:e.instanceId,data:{...e.data,featureFlags:t},lighthouseMetrics:e.LighthouseMetrics}},s=async(...e)=>{const{KustoClient:t,QueryType:s}=await MsPortalFx.require("MsPortalImpl/Services/Kusto/KustoClient"),o=await ee.getAsync(t);return o.getPrimaryData.apply(o,[s[e[0]],e[1],e[2]])};st.set(3069,(e=>{He(s("LoadLighthousePerfProfiles",tt(e),!0).then((e=>e.data.map(t))),e)})),st.set(3070,(e=>{const o=e.instanceId;He(s("LoadLighthousePerfProfile",{tableName:et(),instanceId:o},!0).then((e=>{if(1===e.data.length)return t(e.data[0]);throw new Error("Load failed")})),e)})),st.set(3086,(e=>{He(Promise.all([s("LighthouseTimelineSummary",tt(e),!0),s("LighthouseScoreSummary",tt(e),!0)]).then((([e,t])=>{const s=e.data,[o]=t.data;return{profileData:s,lighthouseMetrics:o}})),e)})),st.set(3089,(()=>{const e=MsPortalFx.Resources.Strings.Azure.Subscriptions.DropDown,t=MsPortalFx.ViewModels.getValidationResultPromise;return async s=>{const o=s.subscription,i=await MsPortalFx.require("FxInternal/ResourceManagement/ArmTemplate");He(i.canRegisterSubscriptionWithRPs(ee,o.subscriptionId,s.resourceProviders).then((s=>{if(s.success)return t();{const i=o.uniqueDisplayName||o.subscriptionId,n=s.disallowedRPs||[];return n.length?t(e.subDisallowedRP.format(i,n.join(", "))):t(e.subCantRegisterWithRP.format(i,s.failedRPs.join(", ")))}})).then((t=>t||i.hasPermission(ee,`/subscriptions/${o.subscriptionId}`,s.requiredPermissions,e.requiredPermissionsValidationMessage))).catch((()=>t())),s)}})()),st.set(3079,(e=>{Me&&window.removeEventListener("message",Me),window.addEventListener("message",Me=t=>{const{signature:s,href:o}=t.data;if("OAuthRequest"===s&&"string"==typeof o){He(new Promise((e=>{const s=t.source.opener,i=t.origin,n=window.location.origin,r=s?.parent?.parent,a=/\/extensionname\/(\w+)(?=[^a-z0-9])/i.exec(o)?.[1]||"";s===ie&&i===n&&r===window&&a.toLowerCase()===Z.toLowerCase()?e(o):e("")})),e)}})})),st.set(3083,(e=>{He(s("LoadLighthousePerfProfilesMetadata",tt(),!0).then((({data:e})=>({shellVersions:e[0].shellVersions,extensionVersions:e[0].extensionVersions}))),e)})),st.set(3100,(e=>{MsPortalFx.require("MsPortalImpl/Services/Services.CopilotInteractions").then((({processCopilotInteraction:t})=>{He(t(ee,e),e)}))})),st.set(3101,(e=>{He(MsPortalFx.require("MsPortalImpl/Services/Services.CopilotManager").then((({CopilotBrokerService:t})=>ee.get(t).nudgeCopilot(e.internal))),e)})),st.set(3102,(e=>{He(MsPortalFx.require("MsPortalImpl/Services/Services.CopilotManager").then((({CopilotBrokerService:t})=>ee.get(t).addViewContextAdditionalDetailsCopilot({bladeId:ye,...e}))),e)})),(()=>{const e=e=>{const t=Promise.withResolvers();return()=>(Be(1002,{stubId:e,responseStubId:Te((e=>{G(t,{...e,result:e.result?Ne(e.result):null})}),!0)}),t.promise)};st.set(3104,(t=>{me.render(t,e)})),st.set(3105,(t=>{me.update(t,e)})),st.set(3106,(({error:e,handled:t})=>{Qe(null),me.onFailed(e,t)}))})()}let dt=MsPortalFx.noop,pt=MsPortalFx.noop,ut=MsPortalFx.noop;return{initialize:e=>{const{setOnMessage:o,reactViewOptions:n,getFirstHiddenOrOfflineTime:a}=e;if(({postMessage:Be}=e),n){const{dispose:e,onUnloaded:o,hide:l,show:c}=n,d=Promise.withResolvers();let p,u;st.set(3034,(()=>{d.resolve(void 0)})),st.set(3053,(({data:e,complete:t,valid:s})=>{p=e,t&&m(!1,s)}));const m=(e,t)=>{u||(u=!0,Xe.resolve(t?p:null),5!==ae&&FxImpl.TelemetryContext.usingState((()=>{const s=a(),o=p?.data?.interactiveTime,i=(s&&o&&s<o)??!1,n=!e&&t&&!i;Ze()&&FxImpl.Extension.onReactViewInteractiveEndPoint.invoke(FxImpl.Rpc.client,Z,{bladeInstanceId:xe.instanceId,time:n?o:void 0}),Ye({name:ye,source:"Shell",action:"BladeLighthouse",actionModifier:n?"complete":"cancel",extension:Z,data:{...p,data:{...p?.data,ajaxCalls:function(e){const t=[];if(e?.ajaxCalls){const s={},o={};for(const i of e.ajaxCalls){const{name:e,nameIsUrl:n,startTime:a,duration:l}=i,c=n?(0,r.scrubUri)(e)||"REDACTED_URL":e,d=(s[c]||0)+1;s[c]=d,d<=10?t.push({name:c,startTime:a,duration:l}):o[c]?o[c].duration+=l:o[c]={name:c,startTime:a,duration:l}}for(const e of Object.values(o)){const{name:o,startTime:i,duration:n}=e;t.push({name:`${o} [${s[o]-10} more calls]`,startTime:i,duration:n})}}return t}(p?.data),hiddenOrOfflineDuringRendering:i}}})}),J))},h=32&(2!==ae&&5!==ae&&ee.get(k.BladeDescriptor)?.flags)?ee.getAsync(i.get("MsPortalImpl/UI/UI.HelpPaneState","HelpPaneState")):void 0,g=async(t=!1)=>{const i=void 0!==h&&(await h).isMinimized();ct&&ct(),Be(3033,{waitForPendingPromises:!t,isMinimized:i});const n=d.promise.then((()=>{e(),ze.dispose()})),r=(0,s.delay)(1e3).then((()=>m(t)));await Promise.allSettled([n,r]),o()};st.set(3087,(e=>{R.usingState((()=>{A.Telemetry.trace({...e,extension:Z,source:xe.id})}),J)})),dt=l,pt=c,ut=e=>{e&&Q.resolve(e),l(),g(!0)},t.registerForDispose({dispose:()=>{const e=[];MsPortalFx.forEachKey(at,((t,s)=>e.push(s.promise))),Promise.allSettled(e).finally((()=>{g()}))}})}o(Je),Ee.forEach((e=>Be(e.kind,e.data)))},toggleDevTools:()=>Be(3046),toggleTelemetryInsights:e=>Be(3088,e),showTours:e=>Be(3107,e),executeCopilotHandler:(e,s,o)=>{const i=Promise.withResolvers();return Be(3097,{handlerId:e,conversationId:s,handlerArguments:o,responseStubId:Te((e=>{q(i,e)}),!0)}),B.Promises.cancelOnDispose(t,i.promise)},togglePerfTools:()=>{const e=Promise.withResolvers();return Be(3056,{responseStubId:Te((t=>{q(e,t)}),!0)}),B.Promises.cancelOnDispose(t,e.promise)}}}})),
define("MsPortalImpl/Base/Base.SvgHelper",["require","exports","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Sanitization"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSvgReferenceOrFallBackToData=t.SvgsPalettes=t.SvgBadgeClass=t.SvgPlaceholderClass=void 0;MsPortalFx.Base.Diagnostics;var i=MsPortalFx.encodeAttribute,n=MsPortalFx.encodeHtml;const r=window,a="http://www.w3.org/2000/svg",l=r.document;let c;function d(e,t){const s=e.getAttribute("class");e.setAttribute("class",(s?s+" ":"")+t)}function p(e,t){e.setAttribute("class",(e.getAttribute("class")||"").split(" ").filter((e=>e&&e!==t)).join(" "))}function u(e,t){for(let s=0,o=e.length;s<o;++s)t(e[s])}function m(e,s){if(s.customClass&&n(s.customClass).split(" ").filter((e=>e.startsWith("ext-")||e.startsWith("msportalfx")||e.startsWith("fxt-"))).forEach((s=>u(e.getElementsByClassName(t.SvgPlaceholderClass),(e=>d(e,s))))),s.description){const t=l.createElementNS(a,"desc");t.textContent=s.description;const o=e.getElementsByTagName("title")[0];o&&o.parentNode.insertBefore(t,o.nextSibling)}if(s.title)u(e.getElementsByTagName("title"),(e=>{e.textContent||(e.textContent=s.title)}));else{const t=[];u(e.getElementsByTagName("title"),(e=>e&&!e.textContent&&t.push(e))),t.forEach((e=>e.remove()))}return s._badgeWidth||(u(e.getElementsByClassName(t.SvgPlaceholderClass),(e=>p(e,t.SvgPlaceholderClass))),u(e.querySelectorAll("[class='']"),(e=>e.removeAttribute("class")))),c(e.firstElementChild||y.cloneNode(),e.innerHTML)}t.SvgPlaceholderClass="msportalfx-svg-placeholder",t.SvgBadgeClass="msportalfx-svg-badge",t.SvgsPalettes=[],t.SvgsPalettes[0]="",t.SvgsPalettes[2]="msportalfx-svg-palette-black",t.SvgsPalettes[3]="msportalfx-svg-palette-blue",t.SvgsPalettes[1]="msportalfx-svg-palette-white",t.SvgsPalettes[4]="msportalfx-svg-palette-green",t.SvgsPalettes[5]="msportalfx-svg-palette-gray",t.SvgsPalettes[99]="msportalfx-svg-palette-inherit",t.SvgsPalettes[100]="msportalfx-svg-disabled",c=r.SVGElement&&"outerHTML"in SVGElement.prototype?e=>e:(e,t)=>(e.outerHTML=t,e);const h=FxImpl.createElement("div",{id:"FxSymbolContainer","aria-hidden":"true",role:"presentation",style:"width: 0; height: 0; overflow: hidden"});l.body.appendChild(h);const g=MsPortalFx.getIdGenerator("FxSymbol"),f=new Map,x=l.implementation.createHTMLDocument("").body,b=Object.create(null),y=l.createElementNS(a,"svg"),v=(()=>{const e=FxImpl.createElement("div");return e.appendChild(y),e.innerHTML})(),M=l.createElementNS(a,"defs"),C=l.createElementNS(a,"svg");C.setAttribute("aria-hidden","true"),C.setAttribute("width","0"),C.setAttribute("height","0"),C.setAttribute("role","presentation"),C.setAttribute("focusable","false"),C.appendChild(M);const P=FxImpl.createElement("div",{id:"DefsContainer","aria-hidden":"true",role:"presentation",style:"width: 0; height: 0; overflow: hidden"});P.appendChild(C),l.body.appendChild(P);const w=["aria-hidden","aria-labelledby","class","clip-path","clip-rule","color-interpolation-filters","cx","cy","d","data-islogo","dy","enable-background","fill-opacity","fill-rule","fill","filter","filterUnits","flood-opacity","focusable","gradientTransform","gradientUnits","height","href","id","in","in2","mask","maskUnits","mode","offset","opacity","points","r","result","role","rx","ry","space","spreadMethod","stdDeviation","stop-color","stop-opacity","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","stroke","text-anchor","transform","viewBox","width","x","x1","x2","xlink:href","xml:space","xmlns:svg","xmlns:xlink","xmlns","y","y1","y2","values"].reduce(((e,t)=>(t&&(e[t]=!0,e[t.toUpperCase()]=!0),e)),r.Object.create(null)),I="*:not("+["circle","clipPath","defs","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","g","image","line","linearGradient","mask","path","polygon","polyline","radialGradient","rect","stop","svg","symbol","text","title","use"].join("):not(")+")";function S(e,s){const o=g(),i=y.cloneNode(),n=FxImpl.createElement("div");d(i,t.SvgPlaceholderClass),i.setAttribute("height","100%"),i.setAttribute("width","100%"),i.appendChild(l.createElementNS(a,"title")),n.appendChild(i);const r=y.cloneNode(),c=l.createElementNS(a,"defs"),u=l.createElementNS(a,"symbol"),m=l.createElementNS(a,"use");m.setAttribute("href","#"+o),i.appendChild(m);const h=s.getElementsByTagName("svg")[0]||s;for(let e=0,t=h.attributes.length;e<t;++e){const t=h.attributes[e];u.setAttribute(t.name,t.value)}for(;h.hasChildNodes();)u.appendChild(h.firstChild);u.setAttribute("id",o),u.setAttribute("data-type",e+""),p(u,t.SvgPlaceholderClass),c.appendChild(u),r.appendChild(c);const f=l.createElement("div");return f.appendChild(r),{reference:n,symbol:r,symbolContainer:f}}const _=MsPortalFx.isFeatureEnabled("fulldiagnostics"),F=MsPortalFx.isFeatureEnabled("forcesvgshadowdom"),T=/msportalfx-svg-c0(?:5|7)|-animated[\s'"]|[\s'"]ext-|fxs-svg-number/;t.getSvgReferenceOrFallBackToData=function(r,a,l,p,g){a=a||r.options||{};const C=r&&r.type,P=r&&r.data;if(0===C||!P)return c(y.cloneNode(),v);if(2===C){if(o.sanitizeUri(P,null,{diContainer:g,localRequire:e,windowContext:l})){const e=n(a.title||""),t=FxImpl.createElement("img");return e?t.setAttribute("alt",e):t.setAttribute("aria-hidden","true"),t.setAttribute("src",i(P)),t}return s.logToExtension(e,l,2,"Image has failed to load as an invalid uri was passed in : "+P),c(y.cloneNode(),v)}const k=function(t,o,i){let n=b[t];if(!n||i){n=x,n.innerHTML=t;const r=[];u(n.querySelectorAll(I),(i=>{s.logToExtension(e,o,2,"Svg contains illegal element: "+i.tagName,{contextData:{svg:t}}),r.push(i)})),r.forEach((e=>e.remove())),u(n.querySelectorAll("*"),(i=>{const n=i.attributes,r=[];for(let i=0,a=n.length;i<a;++i){const a=n[i].name;w[a]||(s.logToExtension(e,o,2,"Svg contains illegal attribute: "+a,{contextData:{svg:t}}),r.push(a))}r.forEach((e=>i.removeAttribute(e)))})),MsPortalFx.isFeatureEnabled("preservegradients")||u(n.querySelectorAll("clipPath,filter,linearGradient,mask,radialGradient"),(e=>{const t=e.getAttribute("id");if(t){const s=MsPortalFx.getUniqueId();e.setAttribute("id",s),["clip-path","fill","filter","mask"].forEach((e=>{u(n.querySelectorAll(`[${e}='url("#${t}")'],[${e}="url('#${t}')"],[${e}="url(#${t})"]`),(t=>{t.setAttribute(e,`url(#${s})`)}))}))}})),i||(u(n.querySelectorAll("clipPath,filter,linearGradient,mask,radialGradient"),(e=>M.appendChild(e))),b[t]=n.cloneNode(!0))}return n.cloneNode(!0)}(P,l,p);if(!k.hasChildNodes())return s.logToExtension(e,l,2,"Svg has failed to load, imageData: "+P),c(y.cloneNode(),v);const D=t.SvgsPalettes[a.palette];if(a.palette&&u(k.getElementsByClassName(t.SvgPlaceholderClass),(e=>d(e,D))),a.symbol)return m(S(C,k).symbolContainer,a);if(!F&&(_||!MsPortalFx.isNullOrWhiteSpace(a.customClass)||T.test(k.outerHTML))){return m(k,a)}const E=k.outerHTML;let B=f.get(E);if(B)B=B.cloneNode(!0);else{const e=S(C,k);B=e.reference,h.appendChild(e.symbol),f.set(E,B.cloneNode(!0))}return m(B,a)}})),
define("MsPortalImpl/Base/Base.ImageHelper",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.SvgHelper"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetImageData=void 0;var i=MsPortalFx.encodeAttribute,n=s.sanitizeHTML;function r(e){return"svg"===e.tagName.toLowerCase()?e:e.getElementsByTagName("svg")[0]}function a(e,t){e&&MsPortalFx.forEachKey(t,((t,s)=>e.setAttribute(t,s)))}t.GetImageData=function t(s,l){l=l||{};const{context:c,bypassCache:d,svgAttributes:p}=l,u=s&&s.type,m=s&&s.options||{};let h;if(0===u||1===u||2===u||u>=899&&u<999){const e=o.getSvgReferenceOrFallBackToData(s,m,c,d);"img"===e.tagName.toLowerCase()||e.hasChildNodes()?(a(r(e),p),h=Promise.resolve([e])):h=Promise.resolve([]),h=Promise.resolve(e.hasChildNodes()||"img"===e.tagName.toLowerCase()?[e]:[])}else{h=(s&&s.data&&Promise.resolve({[u]:s})||MsPortalFx.require("MsPortalImpl/Base/Base.ImageLibrary")).then((t=>{if(u>=999){const s=m.title?n(m.title,e,c).sanitizedMarkup:"",o=FxImpl.createElement("img");return o.setAttribute("alt",s),o.setAttribute("aria-hidden",(!m.title).toString()),o.setAttribute("src",i(t[u]&&t[u].data)),[o]}{const e=o.getSvgReferenceOrFallBackToData(t[u],m,c,d),s=r(e),i=m._badgeWidth;if(i){const t=s&&s.getAttribute("class").includes(o.SvgPlaceholderClass)&&s||e.querySelector("svg."+o.SvgPlaceholderClass);t&&(t.setAttribute("class",t.getAttribute("class").replace(o.SvgPlaceholderClass,o.SvgBadgeClass)),"number"==typeof i&&t.setAttribute("style","width:"+i+"%; height:"+i+"%"))}return a(s,p),e.childElementCount?[e]:[]}}))}if(m.badge){let e=m.badge.width;e&&"number"==typeof e||(e=40);const s=MsPortalFx.extend2(m.badge.image,{options:MsPortalFx.extend2(m.badge.image.options||{},{_badgeWidth:e})});h=Promise.all([h,t(s,{context:c})]).then((e=>[].concat(...e||[])))}return h}})),
define("MsPortalImpl/Base/Base.KeyboardHelper",["require","exports","MsPortalImpl/Base/Base.BrowserDetection"],(function(e,t,s){"use strict";var o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.setCtrlOrCommandModifier=t.isCtrlOrCommandOnly=t.isCtrlOrCommand=t.mapKeyCodeToString=t.getModifierKeys=t.isNonWrittenCharacter=t.VariableKeyCode=void 0,function(e){e[e.Equals=s.isFirefox?61:187]="Equals",e[e.Minus=s.isFirefox?173:189]="Minus"}(o||(t.VariableKeyCode=o={})),function(e){e[e.Alt=18]="Alt",e[e.Backslash=220]="Backslash",e[e.Backspace=8]="Backspace",e[e.Comma=188]="Comma",e[e.Control=17]="Control",e[e.Delete=46]="Delete",e[e.Down=40]="Down",e[e.End=35]="End",e[e.Enter=13]="Enter",e[e.Equals=o.Equals]="Equals",e[e.Escape=27]="Escape",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F10=121]="F10",e[e.Home=36]="Home",e[e.Left=37]="Left",e[e.Menu=93]="Menu",e[e.Minus=o.Minus]="Minus",e[e.PageDown=34]="PageDown",e[e.PageUp=33]="PageUp",e[e.Period=190]="Period",e[e.Right=39]="Right",e[e.Shift=16]="Shift",e[e.Slash=191]="Slash",e[e.Space=32]="Space",e[e.Tab=9]="Tab",e[e.Up=38]="Up",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.Num0=48]="Num0",e[e.Num1=49]="Num1",e[e.Num2=50]="Num2",e[e.Num3=51]="Num3",e[e.Num4=52]="Num4",e[e.Num5=53]="Num5",e[e.Num6=54]="Num6",e[e.Num7=55]="Num7",e[e.Num8=56]="Num8",e[e.Num9=57]="Num9",e[e.NumPad0=96]="NumPad0",e[e.NumPad1=97]="NumPad1",e[e.NumPad2=98]="NumPad2",e[e.NumPad3=99]="NumPad3",e[e.NumPad4=100]="NumPad4",e[e.NumPad5=101]="NumPad5",e[e.NumPad6=102]="NumPad6",e[e.NumPad7=103]="NumPad7",e[e.NumPad8=104]="NumPad8",e[e.NumPad9=105]="NumPad9",e[e.SingleQuote=222]="SingleQuote"}(i||(i={})),t.isNonWrittenCharacter=function(e){switch(e){case 18:case 17:case 40:case 35:case 27:case 36:case 37:case 34:case 33:case 39:case 16:case 9:case 38:return!0;default:return!1}},t.getModifierKeys=function(e){return(e.altKey&&1)|(e.metaKey&&2)|(e.shiftKey&&4)|(e.ctrlKey&&8)};const n=[];n[192]="~",n[219]="{",n[221]="}",n[220]="|",n[59]=":",n[188]="<",n[o.Equals]="+",n[o.Minus]="_",n[49]="!",n[50]="@",n[51]="#",n[52]="$",n[53]="%",n[54]="^",n[55]="&",n[56]="*",n[57]="(",n[48]=")",n[190]=">",n[191]="?",n[222]='"',n[32]="SHIFT+SPACE",n[40]="SHIFT+Down",n[38]="SHIFT+Up";const r=[];function a(e){return e.ctrlKey&&!e.metaKey||s.isMac&&e.metaKey&&!e.ctrlKey}r[220]="\\",r[188]=",",r[o.Minus]="-",r[49]="1",r[50]="2",r[51]="3",r[52]="4",r[53]="5",r[54]="6",r[55]="7",r[56]="8",r[57]="9",r[48]="0",r[190]=".",r[32]="SPACE",r[191]="/",t.mapKeyCodeToString=function(e,t){return(e?n:r)[t]||i[t]},t.isCtrlOrCommand=a,t.isCtrlOrCommandOnly=function(e){return!e.shiftKey&&!e.altKey&&a(e)},t.setCtrlOrCommandModifier=function(e){e.ctrlKey=!s.isMac,e.metaKey=s.isMac}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s="fxs-display-none",o=ko.bindingHandlers,i=ko.virtualElements.allowedBindings,n=ko.utils,r=n.domData,a=MsPortalFx.wrap({controlsDescendentBindings:!0});o.commands={update:function(e,t,s,o,i){const r=ko.unwrap(t());if(r&&r.group){const t=$(e),s=e=>{const s=ko.unwrap(r.viewModel),o=$.Event("rightclick",{target:e.target,clientX:e.clientX,clientY:e.clientY});t.trigger(o,{commandGroup:r.group,viewModel:s,entityType:2}),e.preventDefault(),e.stopPropagation()};t.on("fxcontextmenurequest",s),n.domNodeDisposal.addDisposeCallback(e,(e=>{t.off("fxcontextmenurequest",s)}))}}},o.visible={update:function(e,t){const o=ko.unwrap(t()),i=e.classList;i?i.toggle(s,!o):$(e).toggleClass(s,!o)}},o.keyedCss={update:function(e,t){const s=[],o=[];MsPortalFx.forEachKey(ko.unwrap(t()),((t,i)=>{const a=ko.unwrap(i);if("string"!=typeof a)MsPortalFx.forEachKey(a,((e,t)=>{ko.unwrap(t)?s.push(e):o.push(e)}));else{t="_fxCss_"+t;const i=r.get(e,t)||[],l=a.split(" ").filter(MsPortalFx.identity)||[];n.compareArrays(i,l,{sparse:!0}).forEach((e=>{void 0===e.moved&&("added"===e.status?s.push(e.value):"deleted"===e.status&&o.push(e.value))})),r.set(e,t,l)}})),$(e).removeClass(o.join(" ")).addClass(s.join(" "))}},i.vtext=i.text,o.vtext=o.text,i.text=!1,o.text={init:a,update:function(e,t){let s=ko.unwrap(t());s=void 0===s?"":s,e.textContent=s}}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.Image",["require","exports","MsPortalImpl/Base/Base.ImageHelper"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderImage=void 0;const o={"aria-hidden":"true",role:"presentation",focusable:"false"},i=!MsPortalFx.isFeatureEnabled("nokosvgcaching")&&new Map,n={controlsDescendantBindings:!0};function r(e,t){if(t){let n,r;i&&(n=JSON.stringify(t),r=i.get(n)),r||(r=s.GetImageData(t,{context:e,svgAttributes:o}).then((e=>{const t=document.createDocumentFragment();let s,o;for(s=0,o=e.length;s<o;s++)t.appendChild(e[s].cloneNode(!0));return t})),i&&i.set(n,r));const a=e.firstChild;return MsPortalFx.tryImmediateResolve(r,(t=>{a===e.firstChild&&(e.innerHTML="",e.appendChild(t.cloneNode(!0)))}))}return e.innerHTML="",Promise.resolve()}t.renderImage=r,ko.bindingHandlers.image={init:()=>n,update:function(e,t){r(e,ko.unwrap(t()))}}})),
define("MsPortalImpl/Base/Base.Timers",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=t.throttle=t.throttleByAnimationFrame=t.setupTimers=t.cancelAnimationFrame=t.requestAnimationFrame=void 0;const s=window;function o(e){if(!e&&s.requestAnimationFrame&&s.cancelAnimationFrame)t.requestAnimationFrame=e=>s.requestAnimationFrame(e),t.cancelAnimationFrame=e=>s.cancelAnimationFrame(e);else{let e=0;t.requestAnimationFrame=function(t){const s=Date.now(),o=Math.max(0,16-(s-e)),i=setTimeout((function(){t(s+o)}),o);return e=s+o,i},t.cancelAnimationFrame=function(e){clearTimeout(e)}}}t.setupTimers=o,o(!1),t.throttleByAnimationFrame=function(e){let s,o;return(...i)=>{if(s=i,!o){const i=Q.defer(),n=o=i.promise;o.timeout(2e3,"requestAnimationFrameQ timout after 2 seconds: callback:"+e).catch((()=>{n===o&&(o=null)})),(0,t.requestAnimationFrame)((()=>{try{Promise.resolve(e(...s)).then(i.resolve,i.reject)}catch(e){i.reject(e)}o=null}))}return o}};const i="function",n=MsPortalFx.memoize,r=MsPortalFx.uncurryThis(Array.prototype.slice),a=MsPortalFx.Errors,l={noDebugCheck:!0};function c(e,t,s){return new a.CanceledError({message:e,data:t&&t+"",innerErrors:s})}t.throttle=function(e,t,s){let o,a,d,p;typeof t!==i&&(s=t,t=e,e=null);const u=n((()=>{const e=d||(d=Q.defer());return(s>0?MsPortalFx.delay(s):Promise.resolve()).then((()=>e.promise.isPending()&&a())).then(e.resolve,e.reject),e.promise}),l);a=()=>(u.clear(),d=null,t.apply(null,o));const m=function(){return o=arguments.length?r(arguments):void 0,u()},h=e=>{d&&d.promise.isPending()&&d.reject(e||c("canceled",t)),d=null,p||u.clear()};return m.cancel=h,m.dispose=()=>{p=!0;const e=c("disposed",t);h(e);const s=Promise.reject(e);s.catch(MsPortalFx.noop),u.map().set(void 0,s)},e&&e.registerForDispose(m),m},t.debounce=function(e,t,s=0){let o;typeof t!==i&&(s=t,t=e,e=null);let a,d,p,u,m=0;const h=n((()=>{const e=p||(p=Q.defer()),t=Date.now(),o=m+s-t;return o>0?MsPortalFx.delay(o).then((()=>e.promise.isPending()&&d())):Promise.resolve().then((()=>e.promise.isPending()&&a())).then(e.resolve,e.reject),e.promise}),l);d=()=>(h.clear(),h()),a=()=>(h.clear(),p=null,t.apply(null,o));const g=function(...e){return m=Date.now(),o=arguments.length?r(arguments):void 0,h()};function f(e){p&&p.promise.isPending()&&p.reject(e||c("canceled",t)),p=null,u||h.clear()}return g.cancel=f,g.dispose=()=>{u=!0;const e=c("disposed",t);f(e);const s=Promise.reject(e);s.catch(MsPortalFx.noop),h.map().set(void 0,s)},e&&e.registerForDispose(g),g},ko.extenders.rateLimit.tasks.debounce=t.debounce,ko.extenders.rateLimit.tasks.throttle=t.throttle})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.FxClick",["require","exports"],(function(e,t){"use strict";function s(e,t,s,o){let i=!1;o&&o.registerForDispose((()=>i=!0)),MsPortalFx.require("MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar",(n=>{i||n.attachFxClickHandler(e,s,t,o)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.applyFxClick=void 0,ko.bindingHandlers.fxclick={init:(e,t,o,i,n)=>{s(e,t(),n,null)}},t.applyFxClick=s})),
define("MsPortalImpl/Weave/InternalUtil",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.KnockoutExtensions.FxClick","MsPortalImpl/Base/Base.Sanitization"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.matchKeyCode=t.sanitizeSrc=t.sanitizeHref=t.applyFxClickToElement=t.makeHtmlDataHandler=void 0,t.makeHtmlDataHandler=function(t,o,i){return n=>n?n.skipSanitization&&i?n.content:o.get(s.KODeniedTemplateSanitizer).sanitize({contextData:{moduleName:n.moduleName},diContainer:o,localRequire:e,value:n.content,windowContext:t}).sanitizedMarkup:""},t.applyFxClickToElement=function(e,t,s,i){(0,o.applyFxClick)(e,s,{$dicontainer:i.diContainer,$disabled:i.disabled,$tabIndex:i.tabIndex},t)},t.sanitizeHref=function(e,t){const s=(0,i.sanitizeLinkUri)(e,t);return!1===s?{valid:!1}:{valid:!0,value:s}},t.sanitizeSrc=function(e){return(0,i.validateUriOrBlank)(e)||(0,i.validateDataImage)(e)?{valid:!0,value:e}:{valid:!1}},t.matchKeyCode=function(e,t){return!0===e||Array.isArray(e)&&e.includes(t)}})),
define("MsPortalImpl/Weave/SandboxDomAgents/EntryPoint",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachSandboxDomAgent=void 0,t.attachSandboxDomAgent=function(e,t,s,i){MsPortalFx.tryImmediateResolve(o[i.type](),(o=>{t.isDisposed()||o.attachDomAgent(e,t,s,i.options)}))};const s=e=>MsPortalFx.require(e),o={tab:()=>s("MsPortalImpl/Weave/SandboxDomAgents/Tab"),splitter:()=>s("MsPortalImpl/Weave/SandboxDomAgents/Splitter"),button:()=>s("MsPortalImpl/Weave/SandboxDomAgents/Button")}})),
define("MsPortalImpl/Weave/Util",["require","exports","Weave/DirectMode","Weave","Weave/Core/Computation","FxInternal/Weave/Util","FxInternal/Weave","Weave/Core/InternalUtil","FxInternal/WeaveControls/Common"],(function(e,t,s,o,i,n,r,a,l){"use strict";function c(e,t,s){return(e.koContext?e.koContext.createChildContext(s):new ko.bindingContext(s)).extend({$disabled:(0,r.toObservable)(t,e.disabled),$tabIndex:(0,r.toObservable)(t,e.tabIndex),$index:(0,r.toObservable)(t,e.indexInLoop),$dicontainer:e.diContainer,$partName:e.partName,$extensionName:e.extensionName})}Object.defineProperty(t,"__esModule",{value:!0}),t.createFragment=t.weaveContextToKoContext=t.createControlLazyComponentForKO=t.createControlLazyComponent=t.aggregateContext=t.createControlComponentForKO=t.createControlComponentNoUIState=t.createControlComponent=t.wrapFnWaitForChangePropagation=t.isTsxElemId=t.mapWhiteSpaceToUndefined=t.tryFocusAfterChangePropagation=void 0,t.tryFocusAfterChangePropagation=function(e){const t=document.activeElement;t!==e&&(0,i.invokeAfterChangePropagation)((()=>{t!==document.activeElement&&document.activeElement!==document.body||e.focus()}))},t.mapWhiteSpaceToUndefined=function(e){return(e||"").trim()||void 0},t.isTsxElemId=function(e){return(e||"").startsWith("_weave_e_")},t.wrapFnWaitForChangePropagation=function(e,t){let s=!1;return()=>{s&&t||(s=!0,(0,i.invokeAfterChangePropagation)((()=>{s=!1,e()})))}},t.createControlComponent=function(e){return t=>s(o.GetContext,{fn:i=>((0,l.patchFieldControlVM)(i,t.vm),(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,s(o.LifetimeManagerScoped,{fn:()=>{const s=new e.widgetUIStateCtor({diContainer:i.diContainer,vm:t.vm}),o=e.innerComponent({vm:t.vm,state:s}),r=t.afterMount;return(0,n.isWeaveNodeWithParentRenderInfo)(o)?(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:l,className:[o.parentClassName,t.className],vm:void 0,tagName:void 0},o.weaveNode):(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:l,vm:void 0,tagName:void 0},o);function l(o,n){n.registerForDispose(new e.widgetCtor($(o),t.vm,{weaveContext:i,diContainer:i.diContainer},s)),r&&r(o,n)}}})))})},t.createControlComponentNoUIState=function(e){return t=>s(o.GetContext,{fn:s=>{(0,l.patchFieldControlVM)(s,t.vm);const o=t.afterMount;return(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:(i,n)=>{n.registerForDispose(new e.widgetCtor($(i),t.vm,{weaveContext:s,diContainer:s.diContainer})),o&&o(i,n)},vm:void 0,tagName:void 0},e.innerComponent({vm:t.vm})))}})},t.createControlComponentForKO=function(e){return t=>s(o.GetContext,{fn:s=>{(0,l.patchFieldControlVM)(s,t.vm);const o=t.afterMount;return(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:(i,n)=>{n.registerForDispose(new e.widgetCtor($(i),t.vm,{bindingContext:c(s,n,{}),diContainer:s.diContainer})),o&&o(i,n)},vm:void 0,tagName:void 0}))}})},t.aggregateContext=function(e,t,s){const o=(0,r.toComputation)(t.disabled);return{disabled:(0,n.aggregateDisabled)([e.disabled,s&&(0,r.toComputation)(s.disabled),o]),tabIndex:(0,n.aggregateTabindex)([e.tabIndex,s&&(0,r.toComputation)(s.tabIndex)],o)}},t.createControlLazyComponent=function(e){return t=>s(o.GetContext,{fn:i=>{(0,l.patchFieldControlVM)(i,t.vm);const r=MsPortalFx.tryImmediateResolve(e(),(e=>s(o.LifetimeManagerScoped,{fn:()=>{const s=new e.WidgetUIState({diContainer:i.diContainer,vm:t.vm}),o=e.InnerTsxComponent({vm:t.vm,state:s}),r=t.afterMount;return(0,n.isWeaveNodeWithParentRenderInfo)(o)?(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:l,className:[o.parentClassName,t.className],vm:void 0,tagName:void 0},o.weaveNode):(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:l,vm:void 0,tagName:void 0},o);function l(o,n){n.registerForDispose(new e.Widget($(o),t.vm,{weaveContext:i,diContainer:i.diContainer},s)),r&&r(o,n)}}})));return(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,s(o.PromiseFragment,{"data-odebug":"p2a",promise:r}))}})},t.createControlLazyComponentForKO=function(e){return t=>s(o.GetContext,{fn:i=>{const n=MsPortalFx.tryImmediateResolve(e(),(e=>{const s=t.afterMount,o=t.vm,n="function"==typeof o?o(e):o;(0,l.patchFieldControlVM)(i,n);return(0,l.tryWrapAggregationSourceForFieldControlVM)(n,(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:(t,o)=>{o.registerForDispose(new e.Widget($(t),n,{bindingContext:c(i,o,{}),diContainer:i.diContainer})),s&&s(t,o)},vm:void 0,tagName:void 0}))}));return s(o.PromiseFragment,{"data-odebug":"p2b",promise:n})}})},t.weaveContextToKoContext=c,t.createFragment=function(e){return s(o.Fragment,null,e)}})),
define("Viva.Controls/Util/Viva.Resize",["require","exports","MsPortalImpl/Base/Base.Timers"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.track=void 0;const o=MsPortalFx.Base.Diagnostics.createLog(e),i="fxs-vivaresize",n=.05,r=new Map,a=window?.ResizeObserver?new window.ResizeObserver(((e,t)=>{for(const t of e){const e=t.target,s=r.get(e);if(s){const{lifetime:e,debounceHandler:o,ignoreInitialState:i,inited:n,partialPixels:r}=s;if(!e.isDisposed())if(i&&!n)s.inited=!0;else{const{width:e,height:s}=c(t.contentRect,r);o(e,s)}}}})):null;function l(e){let t;return e?.endsWith("px")&&(t=parseFloat(e)),t||0}function c(e,t){let s=e.width||0,o=e.height||0;return t||(s=Math.floor(s+n),o=Math.floor(o+n)),{width:s,height:o}}window&&!a&&o.error("ResizeObserver not supported by browser. UI will not be responsive to resizing in some cases."),t.track=function(e,t,n,d){const p=$(t);if(e&&!e.isDisposed()&&a){const t=p.length;if(1!==t){const e=`Viva.Resize.track can only take an element with length of 1. Current element.length: ${t}.`;if(o.error(e),!t)return}const u=p[0],m=d?.notifyInitialSize,h=d?.ignoreInitialState,g=d?.debounceTime??100,f=d?.partialPixels??!1;if(r.has(u)){const e="Viva.Resize.track already registered for this element.";o.error(e)}p.addClass(i),e.registerForDispose((()=>{p.removeClass(i)}));let x=0,b=0;const y=(t,s,o)=>{e.isDisposed()||(!s&&!t||s===x&&t===b)&&!o||(x=s,b=t,n(t,s))},v=s.debounce(e,((e,t)=>{s.requestAnimationFrame((()=>{y(e,t)}))}),g);if(r.set(u,{lifetime:e,partialPixels:f,debounceHandler:v,ignoreInitialState:h&&!m}),a.observe(u),e.registerForDispose((()=>{a.unobserve(u),r.delete(u)})),m){const{width:e,height:t}=c(function(e){const t=getComputedStyle($(e)[0],null),s="border-box"===t.boxSizing;let o=l(t.width);o&&s&&(o-=l(t.paddingLeft),o-=l(t.paddingRight),o-=l(t.borderLeftWidth),o-=l(t.borderRightWidth));let i=l(t.height);return i&&s&&(i-=l(t.paddingTop),i-=l(t.paddingBottom),i-=l(t.borderTopWidth),i-=l(t.borderBottomWidth)),{width:o,height:i}}(u),f);y(e,t,!0)}}}})),
define("WeaveDOM/Core/InternalUtil",["require","exports"],(function(e,t){"use strict";function s(e){return document.createRange().createContextualFragment(e)}function o(e){const t=[];for(let s=20;s>0&&e;s--)8===e.nodeType?t.push(e.nodeValue||""):t.push(e.classList?.value||""),e=e.parentNode;return t.join(":")}function i(e,t){return e.nodeType===t}function n(e,t){i(e,1)&&i(t,1)?e.insertAdjacentElement("beforebegin",t):e.before?e.before(t):e.parentNode.insertBefore(t,e)}function r(e,t){return e.getElementById?e.getElementById(t):e.querySelector("#"+t)}function a(e,t){const s=e.childNodes;for(let e=0;e<s.length;++e){const o=s[e];i(o,8)&&t.set(o.textContent,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.isCommentEndId=t.isCommentStartId=t.getUniqueCommentIdPair=t.wrapFunc=t.removeAllChildren=t.performanceNow=t.attachEventListener=t.ensureNoContent=t.collectCommentNodes=t.getElementByIdInDocumentFragment=t.insertNodeBeforeNode=t.insertHtmlBeforeNode=t.isNodeType=t.removeNodesBetween=t.removeNode=t.toggleClass=t.documentFragmentFromHtml=void 0,t.documentFragmentFromHtml=s,t.toggleClass=function(e,t,s){for(const o of(t||"").split(" "))o&&(s?e.classList.add(o):e.classList.remove(o))},t.removeNode=function(e){e.remove?e.remove():e.parentNode.removeChild(e)},t.removeNodesBetween=function(e,t,s=""){if(!(e&&t&&e!==t&&e.parentNode===t.parentNode&&e.nextSibling&&t.previousSibling))throw new Error(`removeNodesBetween argument error. odebug="${s}" startClasses="${o(e)}" endClasses="${o(t)}" !start="${!e}" !end="${!t}" (start===end)="${e===t}" !start?.parentNode="${!e?.parentNode}" (start?.parentNode!==end?.parentNode)="${e?.parentNode!==t?.parentNode}" (!start?.nextSibling)="${!e?.nextSibling}" (!end?.previousSibling)="${!t?.previousSibling}"`);const i=document.createRange();i.setStartAfter(e),i.setEndBefore(t),i.deleteContents()},t.isNodeType=i,t.insertHtmlBeforeNode=function(e,t){if(i(e,1))e.insertAdjacentHTML("beforebegin",t);else{n(e,s(t))}},t.insertNodeBeforeNode=n,t.getElementByIdInDocumentFragment=r,t.collectCommentNodes=function(e,t){const s=new Map;for(const o of e){a(r(t,o),s)}return a(t,s),s},t.ensureNoContent=function(e,t,s,o){if(!s&&t.commentStart.nextSibling!==t.commentEnd)throw new Error("Node is not empty, operation invalid.");e.ensureContentDisposed(t,o)},t.attachEventListener=function(e,t,s,o){e.addEventListener(s,o),t.registerForDispose((()=>e.removeEventListener(s,o)))},t.performanceNow=function(){return window.performance.now()},t.removeAllChildren=function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},t.wrapFunc=function(e,t,s){return function(...o){for(const e of t)e.call(this);const i=e.apply(this,o);if(s)for(const e of s)e.call(this);return i}};let l=0;function c(e,t){return e.startsWith,e.startsWith(t)}t.getUniqueCommentIdPair=function(){const e=""+l++;return{commentStartId:"_weave_cstart_"+e,commentEndId:"_weave_cend_"+e}},t.isCommentStartId=function(e){return c(e,"_weave_cstart_")},t.isCommentEndId=function(e){return c(e,"_weave_cend_")}})),
define("WeaveDOM/Core/DefaultInputBindings",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultInputBindings=void 0;t.defaultInputBindings=[{name:"textInput",metadata:{eventsToListen:["input","change"],writeValueToElement:(e,t)=>{const s=e;t=""+(t||""),s.value!==t&&(s.value=t)},collectDataFromEvent:e=>({value:e.target.value})}},{name:"checkboxInput",metadata:{eventsToListen:["change"],writeValueToElement:(e,t)=>{const s=e;t=!!t,s.checked!==t&&(s.checked=t)},collectDataFromEvent:e=>({checked:e.target.checked})}}]})),
define("WeaveDOM/Core/Sanitization",["require","exports"],(function(e,t){"use strict";function s(e){const t=new Set;for(const s of e)t.add(s);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeAttributeValue=t.ensureAllowedAttribute=t.ensureNotClass=t.validateTagNameInDirectMode=t.validateTagNameInSandboxMode=t.isSelfCloseTag=t.arrayToSet=void 0,t.arrayToSet=s,t.isSelfCloseTag=function(e){return"img"===e||"input"===e||"area"===e||"br"===e||"col"===e||"hr"===e||"source"===e||"track"===e||"wbr"===e},t.validateTagNameInSandboxMode=function(e){return n.has(e)},t.validateTagNameInDirectMode=function(e){return r.has(e)},t.ensureNotClass=function(e){if("class"===e)throw new Error("class attribute not supported.")},t.ensureAllowedAttribute=function(e,t){if(!function(e,t){switch(e){case"a":return p.has(t);case"area":return u.has(t);case"audio":return h.has(t);case"button":return g.has(t);case"blockquote":return f.has(t);case"canvas":return x.has(t);case"col":case"colgroup":return b.has(t);case"del":return y.has(t);case"details":case"dialog":return C.has(t);case"embed":return v.has(t);case"form":return M.has(t);case"input":return c.has(t);case"img":return w.has(t);case"ins":return I.has(t);case"iframe":return P.has(t);case"label":return S.has(t);case"map":return _.has(t);case"meter":return F.has(t);case"ol":return T.has(t);case"optgroup":return k.has(t);case"option":return D.has(t);case"output":return E.has(t);case"progress":return B.has(t);case"q":return A.has(t);case"source":return N.has(t);case"td":return R.has(t);case"textarea":return L.has(t);case"th":return O.has(t);case"time":return z.has(t);case"track":return H.has(t);case"video":return U.has(t);default:return l.has(t)}}(e,t))throw new Error(`Attribute ${t} is not allowed for tag ${e}.`)},t.sanitizeAttributeValue=function(e,t,s){if(s)switch(e){case"src":if(s.src)return s.src(t);break;case"href":if(s.href)return s.href(t)}return{valid:!0,value:t}};const o=["a","abbr","address","area","article","aside","audio","b","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","legend","li","main","map","mark","meter","nav","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","source","small","span","strong","sub","summary","sup","table","tbody","textarea","td","tfoot","th","thead","time","tr","track","u","ul","var","video","wbr"],i=o.concat(["iframe","svg","template"]),n=s(o),r=s(i),a=["aria-atomic","aria-autocomplete","aria-checked","aria-controls","aria-current","aria-describedby","aria-disabled","aria-expanded","aria-grabbed","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-owns","aria-orientation","aria-posinset","aria-pressed","aria-readonly","aria-required","aria-selected","aria-setsize","aria-valuemin","aria-valuemax","aria-valuenow","class","data-click-telemetry","datetime","dir","draggable","focusable","hidden","id","lang","spellcheck","role","style","tabindex","title","translate"],l=s(a),c=s(a.concat(["accept","autocomplete","autofocus","capture","disabled","form","list","max","maxlength","min","minlength","multiple","name","pattern","placeholder","readonly","required","size","step","type","value"])),d=a.concat(["download","href","hreflang","media","rel","target","type"]),p=s(d),u=s(d.concat("alt","coords","shape")),m=a.concat(["autoplay","controls","crossorigin","loop","muted","preload","src"]),h=s(m),g=s(a.concat("autofocus","disabled","form","formaction","formenctype","formmethod","formnovalidate","formtarget","name","type")),f=s(a.concat("cite")),x=s(a.concat("width","height")),b=s(a.concat("span")),y=s(a.concat("cite","datetime")),v=s(a.concat("height","src","width","type")),M=s(a.concat("accept-charset","action","autocomplete","enctype","method","name","novalidate","target")),C=s(a.concat("open")),P=s(a.concat("height","name","sandbox","scrolling","seamless","src","srcdoc","width")),w=s(a.concat("alt","crossorigin","height","ismap","src","width")),I=s(a.concat("cite","datetime")),S=s(a.concat("for","form")),_=s(a.concat("name")),F=s(a.concat("form","high","low","max","min","optimum","value")),T=s(a.concat("reversed","type","start")),k=s(a.concat("label","disabled")),D=s(a.concat("disabled","label","selected","value")),E=s(a.concat("for","form","name")),B=s(a.concat("max","value")),A=s(a.concat("cite")),N=s(a.concat("src","media","type")),R=s(a.concat("colspan","headers","rowspan")),L=s(a.concat("autofocus","cols","disabled","form","maxlength","minlength","name","placeholder","readonly","required","rows","wrap")),O=s(a.concat("abbr","colspan","headers","rowspan","scope")),z=s(a.concat("datetime")),H=s(a.concat("default","kind","label","src","srclang")),U=s(m.concat("height","poster","width"))})),
define("WeaveDOM/Core/DomOperatorBase",["require","exports","WeaveDOM/Core/InternalUtil","WeaveDOM/Core/Sanitization","Weave/Core/InputBindings","Weave/Core/InternalUtil","WeaveDOM/Core/DefaultInputBindings"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectDomAgent=void 0;const a=document.createElement("style");a.textContent=".weave-display-none1,.weave-display-none2{display:none !important}",document.head.appendChild(a);function l(e,t){e.hideCount+=t;const s=t>0;return s||0!==e.hideCount?s&&e.hideCount===t?3:1:2}t.DirectDomAgent=class{constructor(){this.inputBindingsMgr=new i.InputBindingsManager,this._textHiddenContentMap=new WeakMap,this._dynamicNodeDisplayStateMap=new WeakMap,this._inputBindingDefMap=(0,n.makeMap)(r.defaultInputBindings,(e=>e.name),(e=>e.metadata))}prepareInitInputBinding(e,t){return this.inputBindingsMgr.ensureNoInputBindingExists(e,t),this.ensureInputBindingMetadata(t)}ensureInputBindingMetadata(e){const t=this._inputBindingDefMap.get(e);if(!t)throw new Error(`Input binding "${e}" is not defined.`);return t}setAttribute(e,t,s,i,n){const r=e.getAndEnsureElementNode(s).element;if(!i.startsWith("data-")){(0,o.ensureAllowedAttribute)(r.tagName.toLowerCase(),i);const e=(0,o.sanitizeAttributeValue)(i,n,t);if(!e.valid)throw new Error(`Invalid attribute value for ${i}: ${n}`);n=e.value,(0,o.ensureNotClass)(i)}r.setAttribute(i,n)}removeAttribute(e,t,s){const i=e.getAndEnsureElementNode(t).element;s.startsWith("data-")||((0,o.ensureAllowedAttribute)(i.tagName.toLowerCase(),s),(0,o.ensureNotClass)(s)),i.removeAttribute(s)}toggleClass(e,t,o,i){const n=e.getAndEnsureElementNode(t).element;(0,s.toggleClass)(n,o,i)}setStyle(e,t,s,o){e.getAndEnsureElementNode(t).element.style[s]=o||""}clear(e,t){(0,s.removeNodesBetween)(e.commentStart,e.commentEnd,t)}remove(e,t){this.clear(e,t),(0,s.removeNode)(e.commentStart),(0,s.removeNode)(e.commentEnd)}toggleDisplay(e,t,s){const o=e.getAndEnsureDynamicNode(t);if("if"!==o.type)throw new Error(`Only If node supports "toggleDisplay", ${t}, ${o.type}`);s=!!s;const i=this._getOrCreateDynamicNodeDisplayState(o.commentStart,!1);if(i.visible===s)return;i.visible=s;const n=s?-1:1;this._applyDisplayState(n,l(i,n),o.commentStart.nextSibling,o.commentEnd)}setDisplayState(e,t){const s=this._dynamicNodeDisplayStateMap.get(e);s&&0!==s.hideCount&&this._applyDisplayState(s.hideCount,3,t.firstChild,null)}_applyDisplayState(e,t,o,i){if(null===o)return;const n=[t];let r=0,a=o;for(;a!==i;){if((0,s.isNodeType)(a,8))(0,s.isCommentStartId)(a.textContent)?n[++r]=l(this._getOrCreateDynamicNodeDisplayState(a,e<0),e):(0,s.isCommentEndId)(a.textContent)&&r--;else if((0,s.isNodeType)(a,1)){const e=n[r];1!==e&&(0,s.toggleClass)(a,"weave-display-none2",3===e)}else if((0,s.isNodeType)(a,3)){const e=n[r];2===e?a.textContent=this._textHiddenContentMap.get(a):3===e&&(this._textHiddenContentMap.set(a,a.textContent),a.textContent="")}a=a.nextSibling}}_getOrCreateDynamicNodeDisplayState(e,t){let s=this._dynamicNodeDisplayStateMap.get(e);if(!s){if(t)throw new Error(`DynamicNodeDisplayState doesn't exist, ${e.textContent}`);this._dynamicNodeDisplayStateMap.set(e,s={visible:!0,hideCount:0})}return s}}})),
define("WeaveDOM/DirectRender/AttributeHandler",["require","exports","Weave/Core/InternalUtil"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onChangeHandler=t.onWheelHandler=t.onTouchStartHandler=t.onTouchMoveHandler=t.onTouchEndHandler=t.onTouchCancelHandler=t.onSelectHandler=t.onScrollHandler=t.onMouseUpHandler=t.onMouseOverHandler=t.onMouseOutHandler=t.onMouseMoveHandler=t.onMouseDownHandler=t.onFocusHandler=t.onDropHandler=t.onDragStartHandler=t.onDragOverHandler=t.onDragLeaveHandler=t.onDragExitHandler=t.onDragEnterHandler=t.onDragEndHandler=t.onDragHandler=t.onDoubleClickHandler=t.onBlurHandler=t.afterMountHandler=void 0,t.afterMountHandler=function(e,t){(0,s.isNotNullNorUndefined)(t)&&e.addDeferredBinding({handler:i,value:t})},t.onBlurHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("blur")),t.onDoubleClickHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dblclick")),t.onDragHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("drag")),t.onDragEndHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragend")),t.onDragEnterHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragenter")),t.onDragExitHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragexit")),t.onDragLeaveHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragleave")),t.onDragOverHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragover")),t.onDragStartHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragstart")),t.onDropHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("drop")),t.onFocusHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("focus")),t.onMouseDownHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mousedown")),t.onMouseMoveHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mousemove")),t.onMouseOutHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mouseout")),t.onMouseOverHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mouseover")),t.onMouseUpHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mouseup")),t.onScrollHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("scroll")),t.onSelectHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("select")),t.onTouchCancelHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchcancel")),t.onTouchEndHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchend")),t.onTouchMoveHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchmove")),t.onTouchStartHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchstart")),t.onWheelHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("wheel")),t.onChangeHandler=function(e,t,s,i,n,r){const a=n.type;"input"===r&&"file"===a&&e.addBinding({handler:o,value:t})};const o=(0,s.makeEventHandler)("change");function i(e,t,s){const o=e.getElementMetadata(t);s(o.element,o.ltm.innerLtmRoot)}})),
define("WeaveDOM/DirectRender/Common",["require","exports","WeaveDOM/Core/InternalUtil","Weave/Core/InternalUtil"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createHTMLNode=t.createTextNode=t.markParentActive=t.markInactive=t.markAttributeSealed=t.markSealed=t.ensureActive=t.ensureNotAttributeSealed=t.ensureNotSealed=void 0;t.createTextNode=function(e){return this.collectors.htmlCollector.push((0,o.encodeHtml)(e)),this};t.createHTMLNode=function(e){return this.collectors.htmlCollector.push(this.getHtmlString(e)),this}})),
define("WeaveDOM/DirectRender/DataAttribute",["require","exports","Weave/Core/InternalUtil"],(function(e,t,s){"use strict";function o(e){return i.get(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.dataHandler=t.getElementData=void 0,t.getElementData=o,t.dataHandler=(0,s.generateBindOnlyAttributeHandler)(((e,t,s)=>{i.set(e.getElementMetadata(t).element,s)}));const i=new WeakMap;(window.weaveDebug||(window.weaveDebug={})).getElementData=o})),
define("WeaveDOM/DirectRender/ForEachNodeOperations",["require","exports","WeaveDOM/Core/InternalUtil"],(function(e,t,s){"use strict";function o(e,t,i,n,r,a,l,c){if(i>=0){const d=r[i];return a(d)?function(e,t,s,i,n,r,a,l){const c=s;for(;s>=0&&r(n[s]);)--s;if(s!==c){const e=c-s,o=t(n.slice(s+1,c+1),i);for(let t=0;t<e;++t)a[t+s+1]=o[t];l.created+=e}return o(e,t,s,i,n,r,a,l)}(e,t,i,n,r,a,l,c):e(d).commentEnd===n?function(e,t,s,i,n,r,a,l){const c=s;for(;s>=0;){const t=n[s];if(!r(t)){const o=e(t);if(o.commentEnd===i){i=o.commentStart.previousSibling,--s;continue}}break}return l.skipped+=c-s,o(e,t,s,i,n,r,a,l)}(e,t,i,n,r,a,l,c):function(e,t,i,n,r,a,l,c){const d=i;for(;i>=0&&!a(r[i])&&e(r[i]).commentEnd!==n;)--i;if(i!==d){const t=document.createDocumentFragment();for(let s=i+1;s<=d;++s){const o=e(r[s]);let i=o.commentStart;const n=o.commentEnd.nextSibling;for(;i!==n;){const e=i.nextSibling;t.appendChild(i),i=e}}(0,s.insertNodeBeforeNode)(n.nextSibling,t),c.moved+=d-i}return o(e,t,i,n,r,a,l,c)}(e,t,i,n,r,a,l,c)}return n.nextSibling}Object.defineProperty(t,"__esModule",{value:!0}),t.processForEachItems=void 0,t.processForEachItems=function(e,t,i,n,r,a,l){const c=n.map((e=>r(e)?null:a(e))),d=document.activeElement,p=o(e,t,n.length-1,i.commentEnd.previousSibling,n,r,c,l);return(0,s.removeNodesBetween)(i.commentStart,p),document.activeElement!==d&&d.focus(),c}})),
define("WeaveDOM/DirectRender/NodeEditors",["require","exports","WeaveDOM/DirectRender/Common","WeaveDOM/Core/InternalUtil","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","Weave/Core/WeaveUtil"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createChildElementNode=t.createChildDynamicNode=t.ignoreDebugInfo=void 0;let a=function(e){this.state|=8;const t=(0,n.getUniqueDynamicNodeId)(),{commentStartId:i,commentEndId:d}=(0,o.getUniqueCommentIdPair)(),{selfLtm:p,contentLtm:u}=(0,n.createDynamicNodeLtms)(e.type,this.ltm);return this.collectors.dynamicBindingCollector.push({commentStartId:i,commentEndId:d,dynamicNodeId:t,initContentLtm:u,metadata:e,selfLtm:p}),this.collectors.htmlCollector.push("\x3c!--",i,"--\x3e"),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,commentEndId:d,getHtmlString:this.getHtmlString,ltm:u||p,nodeId:t,nodeType:e.type,parentEditor:this,state:1,createChildDynamicNode:a,createChildElementNode:l,createChildVirtualNode:r.returnThis,createHTMLNode:s.createHTMLNode,createTextNode:s.createTextNode,seal:c}};t.createChildDynamicNode=a;let l=function(e){return this.collectors.htmlCollector.push("<",e),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,elementBinders:void 0,elementDeferredBinders:void 0,elementId:"",debugInfo:void 0,getHtmlString:this.getHtmlString,idAttrPlaceHolderIndex:-1,ltm:this.ltm,parentEditor:this,state:1,tagName:e,addAttribute:g,addBinding:f,addDebugInfo:b,addDeferredBinding:x,seal:h,sealAttributes:d}};t.createChildElementNode=l;let c=function(){this.collectors.htmlCollector.push("\x3c!--",this.commentEndId,"--\x3e")},d=function(){const e=this.collectors.htmlCollector;if(this.elementBinders||this.elementDeferredBinders){let t=this.elementId;t||(this.elementId=t=(0,n.getUniqueElementId)(),e.push(' id="',t,'"')),this.collectors.elementBindingCollector.push({elementId:t,binders:this.elementBinders,deferredBinders:this.elementDeferredBinders,ltm:this.ltm})}else this.elementId||(this.idAttrPlaceHolderIndex=e.length,e.push(""));return(0,i.isSelfCloseTag)(this.tagName)?(e.push("/>"),{attributeSanitizer:void 0,collectors:void 0,commentEndId:void 0,getHtmlString:void 0,ltm:void 0,nodeId:void 0,nodeType:void 0,parentEditor:this,state:1,createChildDynamicNode:p,createChildElementNode:p,createChildVirtualNode:r.returnThis,createHTMLNode:p,createTextNode:p,seal:u}):(e.push(">"),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,commentEndId:void 0,getHtmlString:this.getHtmlString,ltm:this.ltm,nodeId:void 0,nodeType:void 0,parentEditor:this,state:1,createChildDynamicNode:a,createChildElementNode:l,createChildVirtualNode:r.returnThis,createHTMLNode:s.createHTMLNode,createTextNode:s.createTextNode,seal:m})};function p(){throw new Error("Operation is not supported for self-close element.")}let u=r.noop,m=function(){if(8&this.state){const e=this.parentEditor;let t=e.elementId;t||(t=e.elementId=(0,n.getUniqueElementId)(),this.collectors.htmlCollector[e.idAttrPlaceHolderIndex]=` id="${t}"`),this.collectors.commentContainerCollector.push(t)}},h=function(){(0,i.isSelfCloseTag)(this.tagName)||this.collectors.htmlCollector.push("</",this.tagName,">")},g=function(e,t){const s=(0,i.sanitizeAttributeValue)(e,t,this.attributeSanitizer);return s.valid?this.collectors.htmlCollector.push(" ",e,'="',(0,n.encodeHtml)(s.value),'"'):console.warn(`Invalid attribute value will be ignored: ${e}, ${t}`),this},f=function(e){return this.elementBinders?this.elementBinders.push(e):this.elementBinders=[e],this},x=function(e){return this.elementDeferredBinders?this.elementDeferredBinders.push(e):this.elementDeferredBinders=[e],this},b=function(e){throw new Error("addDebugInfo not supported in prod mode.")}})),
define("WeaveDOM/DirectRender/RenderAgent",["require","exports","Weave/Core/RenderAgentBase","WeaveDOM/Core/InternalUtil","WeaveDOM/DirectRender/Common","WeaveDOM/DirectRender/NodeEditors","Weave/Core/ApplyBindings","WeaveDOM/DirectRender/ForEachNodeOperations","WeaveDOM/Core/Sanitization","Weave/Core/CollectRenderInfo","WeaveDOM/DirectRender/AttributeHandler","Weave/Core/InternalUtil","Weave/Core/WeaveUtil","WeaveDOM/Core/DomOperatorBase","WeaveDOM/DirectRender/DataAttribute","Weave/Core/AttributeHandler","Weave/Core/InternalUtil"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectModeRenderEngine=void 0;let x=u.noop;class b extends s.RenderAgentBase{constructor(e){super(function(e){const t=(0,f.makeMap)(I.concat(e.customAttributeHandlers||[]),(e=>e.name),(e=>e.handler),!1);return(e,s,o,i,n,r,a)=>{const l=t.get(s);l?l(e,o,i,n,r,a):(0,g.htmlAttributeHandler)(e,s,o,0)}}(e),void 0,e.customEventDataProvider),this._options=e,this._domAgent=new m.DirectDomAgent,this._attributeSanitizer=this._options.attributeSanitizer,this._getHtmlString=this._options.htmlElementDataSerializer,this.thisInstance=this;const t=e?.weaveNode?.["data-odebug"]||"";let s;this.render(this._memoryManager.outerLtmRoot,void 0,e.weaveNode,(0,c.createInternalWeaveContext)({...e.weaveContext}),new p.AggregationRelay(e.aggregators,{}),e.afterMount,(e=>{const i=e.containerDoc;this.applyCssChanges();const n=this._options.rootElement;if("replace"===this._options.renderKind)(0,o.removeAllChildren)(n),n.appendChild(i),s=()=>(0,o.removeAllChildren)(n);else{const e=S++,r=document.createComment(`tsx_vroot_${e}_start`),a=document.createComment(`tsx_vroot_${e}_end`);n.appendChild(r),n.appendChild(a),(0,o.insertNodeBeforeNode)(a,i),s=()=>{(0,o.removeNodesBetween)(r,a,t),(0,o.removeNode)(r),(0,o.removeNode)(a)}}})),this._cleanup=s}buildNodeLookup(e){const{elementBindings:t,dynamicBindings:s,containerDoc:i,commentLookup:n}=e;for(const e of t)this._memoryManager.setElementNode({nodeId:e.elementId,ltm:e.ltm,element:(0,o.getElementByIdInDocumentFragment)(i,e.elementId)});for(const e of s){const t=e.metadata;this._memoryManager.setDynamicNode({nodeId:e.dynamicNodeId,type:t.type,commentStart:n.get(e.commentStartId),commentEnd:n.get(e.commentEndId),contentLtm:e.initContentLtm,selfLtm:e.selfLtm,itemNodesId:"forEach"===t.type?t.initRenderDomInfo.map(v):void 0})}}applyCssChanges(){const e=[],t=[];this._cssMetadataMap.forEach(((s,o)=>{0===s.oldRefCount&&s.newRefCount>0?e.push(o):s.oldRefCount>0&&0===s.oldRefCount&&t.push(o),s.oldRefCount=s.newRefCount})),(e.length||t.length)&&this._options.cssLoader(e,t)}clearVisualState(e,t){this._domAgent.clear(e,t)}createCollector(e,t){let s,o;return{attributeSanitizer:this._attributeSanitizer,collectors:{commentContainerCollector:[],dynamicBindingCollector:[],dynamicDebugInfoCollector:s,elementBindingCollector:[],elementDebugInfoCollector:o,htmlCollector:[]},commentEndId:void 0,getHtmlString:this._getHtmlString,ltm:e,nodeId:void 0,nodeType:void 0,parentEditor:void 0,state:1,createChildDynamicNode:n.createChildDynamicNode,createChildElementNode:n.createChildElementNode,createChildVirtualNode:u.returnThis,createHTMLNode:i.createHTMLNode,createTextNode:i.createTextNode,seal:x}}clearLogicalState(e,t,s){(0,o.ensureNoContent)(this._memoryManager,e,s,this._ltmRemovalCallback)}removeVisualState(e,t){this._domAgent.remove(e,t)}sealCollector(e){e.seal();const t=e.collectors,s=t.htmlCollector.join(""),i=(0,o.documentFragmentFromHtml)(s);return{commentLookup:(0,o.collectCommentNodes)(t.commentContainerCollector,i),containerDoc:i,dynamicBindings:t.dynamicBindingCollector,dynamicDebugInfos:t.dynamicDebugInfoCollector,elementBindings:t.elementBindingCollector,elementDebugInfos:t.elementDebugInfoCollector,ltm:e.ltm}}setContent(e,t,s){const i=s.commentStart,n=s.commentEnd;if(i.nextSibling!==n)throw new Error("The next sibling of start node is not end node.");this._domAgent.setDisplayState(i,e.containerDoc),(0,o.insertNodeBeforeNode)(n,e.containerDoc)}setAttribute(e,t,s){this._domAgent.setAttribute(this._memoryManager,this._attributeSanitizer,e,t,s)}removeAttribute(e,t){this._domAgent.removeAttribute(this._memoryManager,e,t)}toggleClass(e,t,s){this._domAgent.toggleClass(this._memoryManager,e,t,s)}setStyle(e,t,s){this._domAgent.setStyle(this._memoryManager,e,t,s)}toggleDisplay(e,t){this._domAgent.toggleDisplay(this._memoryManager,e.dynamicNodeId,t)}dispose(){super.dispose(),this._cleanup()}addEventListener(e,t){const{eventName:s,eventHandler:i}=t;if("input"===s)throw new Error(`${s} is not allowed through this API: addEventListener`);const n=this._memoryManager.getAndEnsureElementNode(e),r=n.ltm.innerLtmRoot;(0,o.attachEventListener)(n.element,r,s,(e=>{i(this._makeFullEventData(e,s,r,(0,p.getEventData)(e,s)))}))}setItems(e,t,s,o,i){const n=this._memoryManager.getAndEnsureDynamicNode(e);(0,p.ensureDynamicNodeOperation)(n.type,8);const r=n.itemNodesId,d=(0,l.arrayToSet)(r);for(const e of s)if("exist"===e.type){const t=e.metadata.itemId;if(!d.delete(t))throw new Error(`The ForEachItem node ${t} doesn't exists, state tracking is lost.`)}d.forEach((e=>{this.removeLogicalState(e,t)}));const u={created:0,deleted:0,skipped:0,moved:0},m=(0,a.processForEachItems)((e=>this.getDynamicNodeMetadata(e.metadata.itemId)),((e,s)=>{const r=this.createCollector(n.selfLtm,t),a=(0,c.collectForEachItemsRenderInfo)({aggregators:i.aggregators,attributesHandler:this._handleAttribute,cssMetadataMap:this._cssMetadataMap,hooksState:void 0},t,r,e.map(M),o,i),l=this.sealCollector(r);return this.applyCssChanges(),this._domAgent.setDisplayState(n.commentStart,l.containerDoc),this._renderBetweenNodes(l,s,s.nextSibling),a}),n,s,C,P,u);return u.deleted=r.length-(m.length-u.created),n.itemNodesId=m.map(w),m}getDynamicNodeMetadata(e){return this._memoryManager.getAndEnsureDynamicNode(e)}focus(e,t){const s=this._options.rootElement.getElementsByClassName(y(e))[t];s&&document.activeElement!==s&&s.focus()}setLocatorClass(e,t){this._domAgent.toggleClass(this._memoryManager,e,y(t),!0)}initTwoWayInputBinding(e,t,s){const i=this._memoryManager.getAndEnsureElementNode(e),n=this._domAgent.prepareInitInputBinding(i,t);this._domAgent.inputBindingsMgr.createInputBinding(i,{type:"twoWay",name:t});const r=i.element,a=i.ltm.innerLtmRoot;for(const e of n.eventsToListen)(0,o.attachEventListener)(r,a,e,(e=>{n.writeValueToElement(r,s(this._makeFullEventData(e,t,a,n.collectDataFromEvent(e))))}))}initValuePushInputBinding(e,t){const s=this._memoryManager.getAndEnsureElementNode(e),i=this._domAgent.prepareInitInputBinding(s,t),n={type:"valuePush",name:t,lastReceivedValue:void 0};this._domAgent.inputBindingsMgr.createInputBinding(s,n);const r=s.element,a=s.ltm.innerLtmRoot;for(const e of i.eventsToListen)(0,o.attachEventListener)(r,a,e,(()=>{i.writeValueToElement(r,n.lastReceivedValue)}))}initValueSubscribeInputBinding(e,t,s){const i=this._memoryManager.getAndEnsureElementNode(e),n=this._domAgent.prepareInitInputBinding(i,t);this._domAgent.inputBindingsMgr.createInputBinding(i,{type:"valueSubscribe",name:t});const r=i.element,a=i.ltm.innerLtmRoot;for(const e of n.eventsToListen)(0,o.attachEventListener)(r,a,e,(e=>{s(this._makeFullEventData(e,t,a,n.collectDataFromEvent(e)))}))}pushInputValue(e,t,s){const o=this._memoryManager.getAndEnsureElementNode(e),i=this._domAgent.inputBindingsMgr.resolveInputBinding(o,t,["twoWay","valuePush"]),n=this._domAgent.ensureInputBindingMetadata(t);"valuePush"===i.type&&(i.lastReceivedValue=s),n.writeValueToElement(o.element,s)}_makeFullEventData(e,t,s,o){return{...o,event:e,ltm:s,...this._customEventDataProvider(t)}}_renderBetweenNodes(e,t,s){const i=e.containerDoc;if(this.buildNodeLookup(e),t.nextSibling!==s)throw new Error("The next sibling of start node is not end node.");(0,o.insertNodeBeforeNode)(s,i),(0,r.applyBindings)(this,e.elementBindings,e.dynamicBindings)}}function y(e){return`_wv_locator_${e}`}function v(e){return e.itemId}function M(e){return e.weaveNode}function C(e){return"new"===e.type}function P(e){return e.metadata}function w(e){return e.itemId}t.DirectModeRenderEngine=b;const I=[{name:"afterMount",handler:d.afterMountHandler},{name:"autoplay",handler:g.autoplayHandler},{name:"checked",handler:g.checkedHandler},{name:"className",handler:g.classNameHandler},{name:"controls",handler:g.controlsHandler},{name:"coords",handler:g.coordsHandler},{name:"data",handler:h.dataHandler},{name:"disabled",handler:g.disabledHandler},{name:"id",handler:g.idHandler},{name:"loop",handler:g.loopHandler},{name:"muted",handler:g.mutedHandler},{name:"autofocus",handler:g.autofocusHandler},{name:"formnovalidate",handler:g.formnovalidateHandler},{name:"hidden",handler:g.hiddenHandler},{name:"open",handler:g.openHandler},{name:"novalidate",handler:g.novalidateHandler},{name:"seamless",handler:g.seamlessHandler},{name:"ismap",handler:g.ismapHandler},{name:"required",handler:g.requiredHandler},{name:"onBlur",handler:d.onBlurHandler},{name:"onChange",handler:d.onChangeHandler},{name:"onValueChange",handler:g.onValueChangeHandler},{name:"onCheckedChange",handler:g.onCheckedChangeHandler},{name:"onClick",handler:g.onClickHandler},{name:"onDoubleClick",handler:d.onDoubleClickHandler},{name:"onDrag",handler:d.onDragHandler},{name:"onDragEnd",handler:d.onDragEndHandler},{name:"onDragEnter",handler:d.onDragEnterHandler},{name:"onDragExit",handler:d.onDragExitHandler},{name:"onDragLeave",handler:d.onDragLeaveHandler},{name:"onDragOver",handler:d.onDragOverHandler},{name:"onDragStart",handler:d.onDragStartHandler},{name:"onDrop",handler:d.onDropHandler},{name:"onFocus",handler:d.onFocusHandler},{name:"onFocusIn",handler:g.onFocusInHandler},{name:"onFocusOut",handler:g.onFocusOutHandler},{name:"onKeyDown",handler:g.onKeyDownHandler},{name:"onKeyPress",handler:g.onKeyPressHandler},{name:"onKeyUp",handler:g.onKeyUpHandler},{name:"onMouseDown",handler:d.onMouseDownHandler},{name:"onMouseEnter",handler:g.onMouseEnterHandler},{name:"onMouseLeave",handler:g.onMouseLeaveHandler},{name:"onMouseMove",handler:d.onMouseMoveHandler},{name:"onMouseOut",handler:d.onMouseOutHandler},{name:"onMouseOver",handler:d.onMouseOverHandler},{name:"onMouseUp",handler:d.onMouseUpHandler},{name:"onScroll",handler:d.onScrollHandler},{name:"onSelect",handler:d.onSelectHandler},{name:"onTouchCancel",handler:d.onTouchCancelHandler},{name:"onTouchEnd",handler:d.onTouchEndHandler},{name:"onTouchMove",handler:d.onTouchMoveHandler},{name:"onTouchStart",handler:d.onTouchStartHandler},{name:"onWheel",handler:d.onWheelHandler},{name:"readonly",handler:g.readonlyHandler},{name:"ref",handler:g.refHandler},{name:"style",handler:g.styleHandler},{name:"value",handler:g.valueHandler},{name:"visible",handler:g.visibleHandler},{name:"reversed",handler:g.reversedHandler},{name:"default",handler:g.defaultHandler},{name:"multiple",handler:g.multipleHandler}];let S=0})),
define("MsPortalImpl/Weave/DirectRender",["require","exports","MsPortalImpl/Weave/Util","MsPortalImpl/Weave/InternalUtil","WeaveDOM/DirectRender/RenderAgent","MsPortalImpl/Base/Base.KnockoutExtensions.Image","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Weave/SandboxDomAgents/EntryPoint","Weave/Core/InternalUtil","FxInternal/Weave/Util","FxInternal/Weave","FxInternal/Weave/Aggregators","FxInternal/Css","MsPortalImpl/Base/Base.Timers","Weave/Core/ClassNameProcessor","WeaveDOM/Core/InternalUtil"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g){"use strict";function f(t,s){const{weaveContext:n,element:r,ltm:c}=t,d=new i.DirectModeRenderEngine({afterMount:t.afterMount,aggregators:p.aggregators,attributeSanitizer:{href:t=>(0,o.sanitizeHref)(t,{diContainer:n.diContainer,windowContext:r,localRequire:e}),src:o.sanitizeSrc},cssLoader:t.cssLoader||(e=>(0,u.injectCss)(...e||[])),customAttributeHandlers:[{name:"fxclick",handler:b},{name:"image",handler:x},{name:"onResize",handler:v},{name:"domAgent",handler:(0,l.generateDeferredBindOnlyAttributeHandler)((function(e,t,s){const{element:o,ltm:i}=e.getElementMetadata(t);(0,a.attachSandboxDomAgent)(o,i.innerLtmRoot,n.diContainer,s)}))},{name:"pcControl",handler:C},{name:"onClick",handler:w},I("onKeyDown","keydown"),I("onKeyPress","keypress"),I("onKeyUp","keyup")],customEventDataProvider:()=>({requestConfirm:M}),htmlElementDataSerializer:(0,o.makeHtmlDataHandler)(r,n.diContainer,!0),renderKind:s,rootElement:r,weaveNode:t.weaveNode,weaveContext:n});c.registerForDispose(d)}Object.defineProperty(t,"__esModule",{value:!0}),t.appendToElement=t.applyToElement=void 0,t.applyToElement=function(e){let t=e.weaveNode;return(0,c.isWeaveNodeWithParentRenderInfo)(t)&&(!function(e,t,s){if(!t.isDisposed()&&s.parentClassName){const o=(0,h.processClassName)(s.parentClassName,t);(0,g.toggleClass)(e,o.initClass,!0);const i=(0,h.applyClassBindingMetadata)(o,t,((t,s)=>(0,g.toggleClass)(e,t,s)));t.registerForDispose((()=>{for(const t of i())(0,g.toggleClass)(e,t,!1)}))}}(e.element,e.ltm,t),t=t.weaveNode),f({...e,weaveNode:t},"replace")},t.appendToElement=function(e){return f(e,"append")};const x=(0,l.generateDeferredBindOnlyAttributeHandler)((function(e,t,s){const o=e.getElementMetadata(t).element;(0,l.activateAndRun)(e,t,s,(e=>{(0,n.renderImage)(o,e)}))}));function b(e,t,s){MsPortalFx.isNullOrUndefined(t)||e.addBinding({handler:y,value:{data:t,context:s}})}function y(e,t,s){const i=e.getElementMetadata(t),n=i.ltm.innerLtmRoot;(0,o.applyFxClickToElement)(i.element,n,(0,c.valueOrComputationToValueOrObservable)(n,s.data),{diContainer:s.context.diContainer,disabled:(0,d.toObservable)(n,s.context.disabled),tabIndex:(0,d.toObservable)(n,s.context.tabIndex)})}const v=(0,l.generateDeferredBindOnlyAttributeHandler)((function(e,t,s){const o=e.getElementMetadata(t),i=e.getElementNodeLtm(t);(0,m.requestAnimationFrame)((()=>{i.isDisposed()||(0,r.track)(i.createChildLifetime(),$(o.element).first(),((e,t)=>{(e>0||t>0)&&s({ltm:i,height:t,width:e})}),{notifyInitialSize:!0,partialPixels:!0})}))}));function M(e){return new Promise((t=>{t(window.confirm(e)?"ok":"cancel")}))}function C(e,t,s){MsPortalFx.isNullOrUndefined(t)||(e.addAttribute("data-bind","pcControl: __control_vm__"),e.addDeferredBinding({handler:P,value:{vm:t,context:s}}))}function P(e,t,o){const{element:i,ltm:n}=e.getElementMetadata(t),{vm:r,context:a}=o,l=(0,s.weaveContextToKoContext)(a,n.innerLtmRoot,{__control_vm__:r});ko.applyBindings(l,i),n.innerLtmRoot.registerForDispose((()=>ko.cleanNode(i)))}const w=(0,l.generateBindOnlyAttributeHandler)((function(e,t,s){const{eventHandler:o,stopPropagation:i,preventDefault:n}="function"==typeof s?{eventHandler:s,stopPropagation:!1,preventDefault:!1}:{eventHandler:s.handler,stopPropagation:s.stopPropagation,preventDefault:s.preventDefault};e.addEventListener(t,{eventName:"click",eventHandler:e=>{i&&e.event.stopPropagation(),n&&e.event.preventDefault(),o(e)}})}));function I(e,t){return{name:e,handler:(0,l.generateBindOnlyAttributeHandler)(((e,s,i)=>{const{eventHandler:n,stopPropagation:r,preventDefault:a}="function"==typeof i?{eventHandler:i,stopPropagation:void 0,preventDefault:void 0}:{eventHandler:i.handler,stopPropagation:i.stopPropagation,preventDefault:i.preventDefault};e.addEventListener(s,{eventName:t,eventHandler:e=>{(0,o.matchKeyCode)(r,e.keyCode)&&e.event.stopPropagation(),(0,o.matchKeyCode)(a,e.keyCode)&&e.event.preventDefault(),n(e)}})}))}}})),
define("_generated/MsPortalImpl/Svg/Startup/Warning.svg",["require","exports"],(function(e,t){"use strict";return{type:9,data:"<svg viewBox='0 0 9 9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path fill='#db7500' d='M8.267 8H.733c-.6 0-.916-.623-.62-1.129L2.014 3.53 3.896.384c.302-.507.903-.514 1.197-.008L7.001 3.65l1.882 3.229C9.183 7.383 8.881 8 8.267 8z'/><circle cx='4.5' cy='6.178' r='.615' class='msportalfx-svg-c01'/><path d='M4.623 2.428H3.98l.164 2.85h.774l.165-2.85z' class='msportalfx-svg-c01'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.Common",["require","exports","Fx/DependencyInjection","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.SvgHelper","_generated/MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/Weave/DirectRender","FxInternal/Weave","Fx"],(function(e,t,s,o,i,n,r,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCssScope=t.getStringFromHtmlContent=t.isLink=t.isHtmlContent=t.getAsyncBindingHandler=t.cancelBindings=t.waitForBindings=t.registerKoTemplate=t.isElementFullyInViewport=void 0;var d=MsPortalFx.Base.Diagnostics,p=MsPortalFx.Errors;const u=window,m=u.document.implementation.createHTMLDocument(""),h=FxImpl.features.isNativePerf,g="<span class='fxs-portal-controlloadfailed'>"+n.getSvgReferenceOrFallBackToData(r).outerHTML+MsPortalFx.encodeHtml(i.PartError.title)+"</span>",f=d.createLog(e),x=[],b=new Map,y=[];function v(e){const t=MsPortalFx.find(y,(function(t){const s=t.element;return e===s||$.contains(e,s)}));if(t)return t.promise;const s=b.get(e)||MsPortalFx.find(x,(t=>$.contains(e,t.element)));return s?s.promise.then((()=>v(e))):Promise.resolve()}function M(e){return e&&e.hasOwnProperty("htmlTemplate")}t.isElementFullyInViewport=function(e,t=0,s=!1){const o=e.getBoundingClientRect(),i=document.documentElement;let n=!0;if(!s){const e=u.innerWidth||i.clientWidth;n=o.left>=0&&o.right<=e}const r=u.innerHeight||i.clientHeight;return{elementRect:o,fullyVisible:o.top+t>=0&&o.bottom+t<=r&&n}},t.registerKoTemplate=function(e,t){if(!e||!t)return void f.error(`Cannot register a template with an undefined ${e?"content":"name"}.`);if(!/^[a-z][a-z0-9]*$/i.test(e))return void f.error(`Name '${e}' is invalid. Name must start with a letter and can only contain letters and numbers.`);const s=$(u.document.body);if(s.find("#"+e).length)return void f.error(`A template with name '${e}' was already registered.`);const o=$(FxImpl.createElement("script",{id:e,type:"text/html"})).text(t);s.append(o)},t.waitForBindings=function(e){return e?$.contains(u.document.documentElement,e)?v(e):Promise.reject(new MsPortalFx.Errors.CanceledError("container is not in documentElement")):Promise.reject(FxImpl.createError("container is "+e))},t.cancelBindings=function(e){e&&$.contains(u.document.documentElement,e)&&x.filter((t=>{const s=t.element;return e===s||$.contains(e,s)})).forEach((e=>{MsPortalFx.remove(x,e),e&&e.dispose()}))},t.getAsyncBindingHandler=function(e,t){return t=t||{controlsDescendantBindings:!0},{init:function(e,s,o,i,n){return t},update:function(t,i,n,r,d){const m=ko.unwrap(i());ko.ignoreDependencies((()=>{let i;const n=Q(MsPortalFx.tryImmediateResolve(MsPortalFx.require(e),(n=>{if(!i)return function(e,t,i,n,r){const c=$(i),d=o.getWidget(c);if(null!==d&&d.dispose(),n){let o;h&&(o=MsPortalFx.getUniqueId(),u.performance.mark(`${o}_start`));const d=e.$dicontainer||s.container,p=t.WidgetUIState&&new t.WidgetUIState({diContainer:d,vm:n,sanitizationContext:i});let m,g;if(t.InnerTsxComponent||t.tryWeaveInnerContent){let s;t.InnerTsxComponent?(m=new FxImpl.TriggerableLifetimeManager,s=t.InnerTsxComponent({state:p,vm:n})):(s=t.tryWeaveInnerContent({state:p,vm:n}),void 0!==s&&(m=new FxImpl.TriggerableLifetimeManager));const o=(0,l.toComputation)(e.$disabled),u=(0,l.toComputation)(e.$enabledTabIndex),h=(0,l.toComputation)(e.$tabIndex);m&&(0,a.applyToElement)({element:i,ltm:m,weaveNode:s,weaveContext:{disabled:o,tabIndex:h,diContainer:d,partName:e.$partName,extensionName:e.$extensionName,koContext:e},opName:`control_${r}`,afterMount:t.Widget?()=>{g=new t.Widget(c,n,{weaveContext:{disabled:o,enabledTabIndex:u,tabIndex:h,diContainer:d},diContainer:d},p),g.ltm.registerForDispose(m)}:void 0})}if(!g&&t.Widget&&(g=new t.Widget(c,n,{bindingContext:e,diContainer:d},p)),h&&(u.performance.mark(`${o}_end`),u.performance.measure(r,`${o}_start`,`${o}_end`)),g){const e=g;if(e.awaitContentRevealed)return e.awaitContentRevealed()}}}(d,n,t,m,e)}),(s=>{if(!i&&!MsPortalFx.Errors.isInstanceOfErrorType(s,p.CanceledError))return function(e,t,s){if(p.isInstanceOfErrorType(e,p.CanceledError))return;let o,i;e&&(o=e.message||MsPortalFx.getLogFriendlyMessage(e),i=e.stack);let n=`Failed to load the control module '${s}'.`;o&&(n+=`\r\n Error: ${o}`),f.error(n,1);const r=$(t);r.html(g),c.nextTick((()=>{r.trigger("fxportalcontrolloadfailed",new MsPortalFx.Errors.Error({message:n,stack:i,innerErrors:e,data:e&&e.data}))}))}(s,t,e),Promise.reject(s)})));if(!n.isFulfilled()){const e=()=>{MsPortalFx.remove(x,o,-1),b.delete(t),i&&MsPortalFx.remove(y,o,-1)},s=()=>{i=!0,e()};ko.utils.domNodeDisposal.addDisposeCallback(t,s);const o={element:t,promise:n,dispose:s};n.isPending()&&(x.push(o),b.set(t,o)),o.promise=n.catch((e=>(y.push(o),Promise.reject(e)))).finally(e)}}))}}},t.isHtmlContent=M,t.isLink=function(e){return!!e&&e.hasOwnProperty("uri")},t.getStringFromHtmlContent=function(e,t,s){let o,i="";return M(t)?o=t.htmlTemplate:i=t,o&&(i=$($.parseHTML(o,m)).text()),i},t.getCssScope=function(e){const t=e.closest(".fxs-part-content");return t[0]?t[0].className.split(" ").filter((e=>e&&e.startsWith("css-scope-"))).join(" "):""}})),
define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",["module"],(function(e){"use strict";return{css:".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0;margin:-3px 0 -3px -.5px}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:2px 1px 0;margin:0;background-color:transparent;outline-width:1px}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button svg{height:90%;width:90%}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{height:22px;width:22px}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container .fxs-copyfield{display:block}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}.fxs-mode-light .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton:focus{outline:1px solid #605e5c}.fxs-mode-dark .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton:focus{outline:1px solid #fff}",moduleId:e.id}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Widgets/Widgets.Common","Fx/Controls/CopyableLabel","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/CopyField.css"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeCopyBinding=t.CopyField=void 0;var a=FxImpl.TriggerableLifetimeManager,l=MsPortalFx.Base;(0,n.injectCss)(r);l.Diagnostics.createLog(e);const c="opacity";function d(e,t,n,r){const l=$(e),d=r||new a,p=function(e,t,n,r,a){const l="fxs-copyfield",d="fxs-copyfield-copied",p=$(t),u=$(FxImpl.createElement("div",{class:`${l}-wrapper`,"data-bind":"stopBindings: true"})),m=$(FxImpl.createElement("div",{class:l,"data-bind":"pcCopyableLabel: $data"}));m.appendTo(u),u.appendTo(p);const h=i.create(e,r);return h.readOnly(!0),ko.reactor(e,(()=>{const e=ko.unwrap(n);h.value(e),p.toggleClass("fxs-copyfield-container",!MsPortalFx.isNullOrWhiteSpace(e))})),ko.applyBindingsToDescendants(h,u[0]),e.registerForDispose([p.setEvents(["fxcopybuttonclick",()=>{p.addClass(d)}],["mouseleave",()=>{p.removeClass(d)}]),()=>{u&&(a||ko.utils.cleanDescendantNodes(u),u.remove())}]),s.isIeOrEdgeNonChromium&&o.waitForBindings(m[0]).then((()=>{const t=m.find(".fxc-copyablelabel-copybutton");e.registerForDispose([t.setEvents(["keydown",e=>{const s=e.which;if(13===s||32===s){t.focus();const e=t.find(".fxc-copyablelabel-clicked")[0];e&&ko.contextFor(e).$ctl._showClickedTooltip()}}])])})),m.css(c,"0"),m}(d,e,t,n,!!r);let u=!1;const m=ko.observable(!1),h=ko.observable(!1);d.registerForDispose(l.setEvents(["focusin",()=>{m(!0)}],["focusout",()=>{m(!1)}],["mouseenter",()=>{h(!0)}],["mouseleave",()=>{h(!1)}])),ko.computed(d,[m,h],((e,t)=>{const s=e||t;s!==u&&(e=>{u=e,p.css(c,e?"1":"0")})(s)})),r||ko.utils.domNodeDisposal.addDisposeCallback(e,(()=>d.dispose()))}t.initializeCopyBinding=d,ko.bindingHandlers.copy={init:(e,t)=>d(e,t())}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Base/Base.LruMap","MsPortalImpl/Controls/ControlBindings"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTrustedFragment=void 0;var l=ko.utils,c=ko.bindingHandlers;const d=l.domData,p="htmlTemplate",u="stringOrHtmlContent",m="untrustedHtml",h="untrustedContent",g="trustedHtml",f="trustedContent",x=document.createRange(),b=new a.LruMap(1e3),y=new a.LruMap(1e3);function v(t,s,i,n,r){let a;if(s){const l=(1===i?y:b).getOrAdd(s,(s=>{if(1!==i){s=t.get(o.KOAllowedTemplateSanitizer).sanitize({diContainer:t,value:s,localRequire:e,windowContext:n,contextData:r}).sanitizedMarkup}return s&&x.createContextualFragment(s)}));l&&(a=l.cloneNode(!0))}return a}const M=e=>{const t=e.$ctl;return t?.isTrusted},C=S(0,m,M),P=S(1,g),w=[null,null,C,c.pcControl.update,P];function I(e,t,s,o,i){return{controlsDescendantBindings:!0}}function S(e,t,o){return(n,r,a,c,d)=>{const p=ko.unwrap(r());let u,m,h,g=p;null!==p&&"object"==typeof p&&(g=ko.unwrap(p.html),m=p.data,u=ko.unwrap(m),h=ko.unwrap(p.isolated)),ko.ignoreDependencies((()=>{let r=e;0===r&&o?.(d)&&(r=1);const a=v(d.$dicontainer||s.container,g,r,n,{BindingName:t});h?d=i.createIsolatedContext(u||c,d):m&&(d=d.createChildContext(u)),l.cleanDescendantNodes(n),a?(n.innerHTML="",n.appendChild(a),ko.applyBindingsToDescendants(d,n)):n.innerHTML=""}))}}function _(e,t,s,o){return(i,a,c,p,u)=>{let m=ko.unwrap(a())||"",h=1;ko.ignoreDependencies((()=>{let a=e;0===a&&s?.(u)&&(a=1);const c=d.get(i,t);if(m.controlType&&!o?h=3:m.htmlTemplate&&(h=1===a?4:2,m={html:m.htmlTemplate,data:m.viewModel}),d.set(i,t,h),3===c){n.cancelBindings(i);const e=r.getWidget($(i));MsPortalFx.disposeDisposable(e)}c&&1!==c&&l.cleanDescendantNodes(i),1===h?i.textContent=m:i.innerHTML=""})),1!==h&&w[h](i,(()=>m),c,p,u)}}c[p]={init:I,update:S(0,p)},c[m]={init:I,update:C},c[g]={init:I,update:P},c[h]={init:I,update:_(0,h,M)},c[f]={init:I,update:_(1,f)},c[u]={init:I,update:_(0,u,null,!0)},t.getTrustedFragment=function(e,t,s,o){return v(e,t,s?1:0,o)}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding",["require","exports","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});MsPortalFx.Base.Diagnostics;const i=ko.bindingHandlers;function n(t,o,i,n){const r=function(t,o,i,n){if(o&&"object"==typeof o){const r={};return Object.getOwnPropertyNames(o).forEach((a=>{if(!MsPortalFx.isSerializableProperty(a))return;const l=ko.unwrap(o[a]);if(s.getAllowListedAttr().includes(a))r[a]=l||null;else switch(a){case"href":if(l){const c="string"!=typeof l?o:s.sanitizeLinkUri(l,{diContainer:t,localRequire:e,windowContext:n});!1!==c?r[a]=c:i.push(`The value "${l}" is not a valid absolute URI or deep link, which should start with "http://" or "https://" or "#".`)}else r[a]=null;break;case"poster":case"src":l?s.validateUriOrBlank(l,null,{diContainer:t,localRequire:e,windowContext:n})||"src"===a&&s.validateDataImage(l)?r[a]=l:i.push(`The value "${l}" is not a valid absolute URI, which should start with "http://" or "https://", nor a valid "data:image" entry.`):r[a]=null;break;default:i.push("The attribute '{0}' is not allowed.".format(a))}})),r}return null}(t,ko.unwrap(o()),i,n);return()=>r}i.sanitizedAttr={init:function(e,t,s,o,r){const a=i.attr;if(a.init){const i=n(r.$dicontainer,t,[],e);return a.init(e,i,s,o,r)}return null},update:function(t,s,r,a,l){const c=[];try{const e=n(l.$dicontainer,s,c,t);return i.attr.update(t,e,r,a,l)}catch(e){c.push(e)}finally{if(c.length>0){const s=c.reduce(((e,s)=>{const o=t.getAttribute("data-bind")||"None";return e+="Sanitization error found in 'sanitizedAttr' binding\nTag name: {0}; Binding attribute: \"{1}\"\nMessage: {2}".format(String(t.tagName),o,s)+"\n"}),"");o.logToExtension(e,t,2,s)}}}}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",n=ko.bindingHandlers,r=n.css;function a(e,t){const o=function(e,t){if(e&&"object"==typeof e){const o={};return Object.getOwnPropertyNames(e).forEach((i=>{MsPortalFx.isSerializableProperty(i)&&(s.isAllowedCssClassName(i)?o[i]=e[i]:i&&t.push(i))})),o}{const o=String(e||"").split(" ");return Array.prototype.map.call(o,(e=>(e=String(e||""),s.isAllowedCssClassName(e)?e:(e&&t.push(e),"")))).join(" ")}}(ko.unwrap(e()),t);return()=>o}n.sanitizedCss={init:function(e,t,s,o,i){if(r.init){const n=a(t,[]);return r.init(e,n,s,o,i)}return null},update:function(t,s,n,l,c){const d=[],p=a(s,d);return d.length&&function(t,s,n){const r=s.getAttribute("data-bind")||"None",a=i.format(String(s.tagName),r,n.join(", "));(0,o.logToExtension)(e,s,2,a,{diContainer:t})}(c.$dicontainer,t,d),r.update(t,p,n,l,c)}}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","Fx/DependencyInjection"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=ko.bindingHandlers,n=i.html;i.sanitizedHtml={init:function(e,t,s,o,i){return n.init(e,t,s,o,i)},update:function(t,i,r,a,l){let c=ko.unwrap(i());null==c&&(c="");const d=c.toString().substring(0,1e5),p=o.container.get(s.KODeniedTemplateSanitizer).sanitize({value:d,localRequire:e,windowContext:t,diContainer:l.$dicontainer||o.container}),u=MsPortalFx.wrap(p.sanitizedMarkup);return n.update(t,u,r,a,l)}},i.html=i.sanitizedHtml})),
define("MsPortalImpl/Base/Base.Pipeline",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPipelineInstance=t.createDescriptor=t.Pipeline=t.Step=t.PipelineDescriptor=t.Task=void 0;var i=MsPortalFx.Base.Promises.cancelOnDispose;let n=1,r=class{};t.Task=r,t.Task=r=__decorate([__metadata("fx:diagnostics",[e,"Task"]),s.Value("pipeline")],r);class a{constructor(e,t,s){this.configurationClass=e,this.resourcesClass=t,this.taskArgsClass=s,this._pipelineFactories=[]}register(e){this._registerFactory((t=>this._createInstance(t,e)))}registerAsync(e,t,s,n=0){this._registerFactory(((n,r,a,l,c)=>{if(s(a,l,c))return i(r,o.get(e,t)).then((e=>this._createInstance(n,e)))}),n)}registerFactory(e,t=0){this._registerFactory(((t,s,o,i,n)=>{function r(t){return{factory:e,steps:t||[]}}const a=e(t,s,o,i,n);return Q.isPromiseAlike(a)?a.then((e=>r(e))):r(a)}))}_registerFactory(e,t=0){const s=this._pipelineFactories.length&&this._pipelineFactories[t]||[];s.push(e),this._pipelineFactories[t]=s}registerAsyncFactory(e,t,s,o){this._registerFactory((function(i,n,r,a,l){return s(r,a,l)?MsPortalFx.require(e,o).then((e=>({factory:t,steps:t(n,e,r,a,l)}))):void 0}))}getHandlers(e,t,s,o,i,n=0){return(this._pipelineFactories[n]||[]).map((n=>n(e,t,s,o,i)))}getRegisteredStepsCount(){return(this._pipelineFactories||[]).length}createPipeline(e,t,s,o){return c(e,t,this,s,o)}_createInstance(e,t){if(e.isDisposed())throw new MsPortalFx.Errors.CanceledError;const s=e.get(t);return{factory:t,steps:(Reflect.getOwnMetadata("fximpl:pipelinesteps",t.prototype)||[]).map((e=>(t,o)=>s[e](t,o)))}}}t.PipelineDescriptor=a,t.Step=function(e){return function(t,s,o){const i=Reflect.getOwnMetadata("fximpl:pipelinesteps",t)||[];i[e]=s,Reflect.defineMetadata("fximpl:pipelinesteps",i,t)}};class l{constructor(e,t,s,o,i){this._diContainer=e,this._lifetime=t,this._descriptor=s,this._configuration=o,this._resources=i}async startTask(e){const t=this._descriptor,s=this._lifetime.createChildLifetime(),o=this._diContainer.createChildContainer("pipeline"),i=n++,a=ko.observable(!1),l={pipeline:this,indicateTaskComplete:()=>{a(!0)},taskId:i,lifetime:s};o.set(r,l),t.configurationClass&&o.set(t.configurationClass,this._configuration),t.resourcesClass&&o.set(t.resourcesClass,this._resources),t.taskArgsClass&&o.set(t.taskArgsClass,e);const c=i=>function(e,t,s,o,i,n,r){const a=t.getHandlers(s,o,i,n,r,e).filter((e=>!!e));let l;return a.forEach(((e,t)=>{Q.isPromiseAlike(e)&&(l||(l=[]),l[t]=e.then((e=>{a[t]=e})))})),l?Promise.all(l.filter((e=>!!e))).then((()=>a.filter((e=>!!e)))):a}(i,t,o,s,this._configuration,this._resources,e);function d(e,t){function s(s){s.forEach((s=>{s.steps.forEach(((s,o)=>{if(o>=t){const t=e[o]||{step:o,handlers:[]};t.handlers.push(s),e[o]=t}}))}))}const o=c(t);return o instanceof Array?void s(o):o.then(s)}let p=c(0);Q.isPromiseAlike(p)&&(p=await p),await(async i=>{const n=function(e){const t=[],s=Math.max(...e.map((e=>e.steps.length)));for(let o=0;o<s;o++)e.forEach((e=>{if(e.steps[o]){const s=t[o]||{step:o,handlers:[]};s.handlers.push(e.steps[o]),t[o]=s}}));return t}(i);let r,c=!0;try{await async function(e,t,s,o,i,n,r,a){const l=new Promise((e=>{n.registerForDispose(e)}));i.registerForDispose((()=>s(!0)));const c=Math.max(e.length,a);for(let i=0;i<c&&!s();i++){if(!s()&&i){const t=r(e,i);t&&await Promise.race([t,l])}if(e[i])for(let n=0;n<e[i].handlers.length&&!s();n++){const s=e[i].handlers[n](o,t);Q.isPromiseAlike(s)&&await Promise.race([s,l])}}}(n,e,a,l,this._lifetime,s,d,t.getRegisteredStepsCount())}catch(e){c=!1,r=e}finally{if(await o.disposeAsync().then((()=>s.dispose())),!c)throw r}})(p)}}function c(e,t,s,o,i){return new l(e,t,s,o,i)}t.Pipeline=l,t.createDescriptor=function(e,t,s){return new a(e,t,s)},t.createPipelineInstance=c})),
define("MsPortalImpl/UI/Commands/Base.PortalFunctions",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowPersonalizedSurvey=t.ShowWelcomeSequence=t.ShowTelemetryInsights=t.ShowDebugTools=t.DownloadDiagnosticsJson=t.ToggleCloudShell=t.CreateJourneyForAssetFunc=t.CreateJourneyForBladeFunc=t.ReloadPartPortalFunc=t.ReplacePartPortalFunc=t.DeleteDashboardWithConfimationPortalFunc=t.PinBladePortalFunc=t.PinTilePortalFunc=t.PinTileWithOptionsPortalFunc=t.PinTilesPortalFunc=t.RoutePortalFunc=t.GetCurrentDashboardPropertiesPortalFunc=t.IsCurrentDashboarSharedPortalFunc=t.GetUserPermissionsForDashboardPortalFunc=t.UnshareDashboardToSessionPortalFunc=t.ShareDashboardToSessionPortalFunc=t.ShareCurrentDashboardPortalFunc=t.AssignTagsToDashboardPortalFunc=t.ClonePartPortalFunc=t.UpdateDashboardPortalFunc=t.CloneDashboardPortalFunc=t.ResetDashboardPortalFunc=t.SwitchDashboardPortalFunc=t.ReadDashboardPortalFunc=t.ImportDashboardPortalFunc=t.ExportDashboardPortalFunc=t.StartNewDashboardPortalFunc=t.RefreshDashboardPortalFunc=t.PortalFunction=void 0;class o{constructor(){this._eventHandlers=[]}setRegistration(e){this._handler=e}addPreInvocationEvent(e){this._eventHandlers.push(e)}invoke(e,t){if(!this._handler)throw new Error("Must register portal function before calling it.");return this._eventHandlers.forEach((e=>e(t))),this._handler(e,t)}}t.PortalFunction=o;let i=class extends o{};t.RefreshDashboardPortalFunc=i,t.RefreshDashboardPortalFunc=i=__decorate([__metadata("fx:diagnostics",[e,"RefreshDashboardPortalFunc"]),s.Class()],i);let n=class extends o{};t.StartNewDashboardPortalFunc=n,t.StartNewDashboardPortalFunc=n=__decorate([__metadata("fx:diagnostics",[e,"StartNewDashboardPortalFunc"]),s.Class()],n);let r=class extends o{};t.ExportDashboardPortalFunc=r,t.ExportDashboardPortalFunc=r=__decorate([__metadata("fx:diagnostics",[e,"ExportDashboardPortalFunc"]),s.Class()],r);let a=class extends o{};t.ImportDashboardPortalFunc=a,t.ImportDashboardPortalFunc=a=__decorate([__metadata("fx:diagnostics",[e,"ImportDashboardPortalFunc"]),s.Class()],a);let l=class extends o{};t.ReadDashboardPortalFunc=l,t.ReadDashboardPortalFunc=l=__decorate([__metadata("fx:diagnostics",[e,"ReadDashboardPortalFunc"]),s.Class()],l);let c=class extends o{};t.SwitchDashboardPortalFunc=c,t.SwitchDashboardPortalFunc=c=__decorate([__metadata("fx:diagnostics",[e,"SwitchDashboardPortalFunc"]),s.Class()],c);let d=class extends o{};t.ResetDashboardPortalFunc=d,t.ResetDashboardPortalFunc=d=__decorate([__metadata("fx:diagnostics",[e,"ResetDashboardPortalFunc"]),s.Class()],d);let p=class extends o{};t.CloneDashboardPortalFunc=p,t.CloneDashboardPortalFunc=p=__decorate([__metadata("fx:diagnostics",[e,"CloneDashboardPortalFunc"]),s.Class()],p);let u=class extends o{};t.UpdateDashboardPortalFunc=u,t.UpdateDashboardPortalFunc=u=__decorate([__metadata("fx:diagnostics",[e,"UpdateDashboardPortalFunc"]),s.Class()],u);let m=class extends o{};t.ClonePartPortalFunc=m,t.ClonePartPortalFunc=m=__decorate([__metadata("fx:diagnostics",[e,"ClonePartPortalFunc"]),s.Class()],m);let h=class extends o{};t.AssignTagsToDashboardPortalFunc=h,t.AssignTagsToDashboardPortalFunc=h=__decorate([__metadata("fx:diagnostics",[e,"AssignTagsToDashboardPortalFunc"]),s.Class()],h);let g=class extends o{};t.ShareCurrentDashboardPortalFunc=g,t.ShareCurrentDashboardPortalFunc=g=__decorate([__metadata("fx:diagnostics",[e,"ShareCurrentDashboardPortalFunc"]),s.Class()],g);let f=class extends o{};t.ShareDashboardToSessionPortalFunc=f,t.ShareDashboardToSessionPortalFunc=f=__decorate([__metadata("fx:diagnostics",[e,"ShareDashboardToSessionPortalFunc"]),s.Class()],f);let x=class extends o{};t.UnshareDashboardToSessionPortalFunc=x,t.UnshareDashboardToSessionPortalFunc=x=__decorate([__metadata("fx:diagnostics",[e,"UnshareDashboardToSessionPortalFunc"]),s.Class()],x);let b=class extends o{};t.GetUserPermissionsForDashboardPortalFunc=b,t.GetUserPermissionsForDashboardPortalFunc=b=__decorate([__metadata("fx:diagnostics",[e,"GetUserPermissionsForDashboardPortalFunc"]),s.Class()],b);let y=class extends o{};t.IsCurrentDashboarSharedPortalFunc=y,t.IsCurrentDashboarSharedPortalFunc=y=__decorate([__metadata("fx:diagnostics",[e,"IsCurrentDashboarSharedPortalFunc"]),s.Class()],y);let v=class extends o{};t.GetCurrentDashboardPropertiesPortalFunc=v,t.GetCurrentDashboardPropertiesPortalFunc=v=__decorate([__metadata("fx:diagnostics",[e,"GetCurrentDashboardPropertiesPortalFunc"]),s.Class()],v);let M=class extends o{};t.RoutePortalFunc=M,t.RoutePortalFunc=M=__decorate([__metadata("fx:diagnostics",[e,"RoutePortalFunc"]),s.Class()],M);let C=class extends o{};t.PinTilesPortalFunc=C,t.PinTilesPortalFunc=C=__decorate([__metadata("fx:diagnostics",[e,"PinTilesPortalFunc"]),s.Class()],C);let P=class extends o{};t.PinTileWithOptionsPortalFunc=P,t.PinTileWithOptionsPortalFunc=P=__decorate([__metadata("fx:diagnostics",[e,"PinTileWithOptionsPortalFunc"]),s.Class()],P);let w=class extends o{};t.PinTilePortalFunc=w,t.PinTilePortalFunc=w=__decorate([__metadata("fx:diagnostics",[e,"PinTilePortalFunc"]),s.Class()],w);let I=class extends o{};t.PinBladePortalFunc=I,t.PinBladePortalFunc=I=__decorate([__metadata("fx:diagnostics",[e,"PinBladePortalFunc"]),s.Class()],I);let S=class extends o{};t.DeleteDashboardWithConfimationPortalFunc=S,t.DeleteDashboardWithConfimationPortalFunc=S=__decorate([__metadata("fx:diagnostics",[e,"DeleteDashboardWithConfimationPortalFunc"]),s.Class()],S);let _=class extends o{};t.ReplacePartPortalFunc=_,t.ReplacePartPortalFunc=_=__decorate([__metadata("fx:diagnostics",[e,"ReplacePartPortalFunc"]),s.Class()],_);let F=class extends o{};t.ReloadPartPortalFunc=F,t.ReloadPartPortalFunc=F=__decorate([__metadata("fx:diagnostics",[e,"ReloadPartPortalFunc"]),s.Class()],F);let T=class extends o{};t.CreateJourneyForBladeFunc=T,t.CreateJourneyForBladeFunc=T=__decorate([__metadata("fx:diagnostics",[e,"CreateJourneyForBladeFunc"]),s.Class()],T);let k=class extends o{};t.CreateJourneyForAssetFunc=k,t.CreateJourneyForAssetFunc=k=__decorate([__metadata("fx:diagnostics",[e,"CreateJourneyForAssetFunc"]),s.Class()],k);let D=class extends o{};t.ToggleCloudShell=D,t.ToggleCloudShell=D=__decorate([__metadata("fx:diagnostics",[e,"ToggleCloudShell"]),s.Class()],D);let E=class extends o{};t.DownloadDiagnosticsJson=E,t.DownloadDiagnosticsJson=E=__decorate([__metadata("fx:diagnostics",[e,"DownloadDiagnosticsJson"]),s.Class()],E);let B=class extends o{};t.ShowDebugTools=B,t.ShowDebugTools=B=__decorate([__metadata("fx:diagnostics",[e,"ShowDebugTools"]),s.Class()],B);let A=class extends o{};t.ShowTelemetryInsights=A,t.ShowTelemetryInsights=A=__decorate([__metadata("fx:diagnostics",[e,"ShowTelemetryInsights"]),s.Class()],A);let N=class extends o{};t.ShowWelcomeSequence=N,t.ShowWelcomeSequence=N=__decorate([__metadata("fx:diagnostics",[e,"ShowWelcomeSequence"]),s.Class()],N);let R=class extends o{};t.ShowPersonalizedSurvey=R,t.ShowPersonalizedSurvey=R=__decorate([__metadata("fx:diagnostics",[e,"ShowPersonalizedSurvey"]),s.Class()],R)})),
define("MsPortalImpl/TsxStringMode/Tsx",["require","exports"],(function(e,t){"use strict";function s(e,t,...o){const i="string"==typeof e?e:e(),n=s.elementStringFactories[i];let r=n.createOpenTag(t);return r+=o.join(""),r+=n.createClosingTag(),r}return function(e){function t(e){const t=[];return e&&Object.keys(e).forEach((s=>{switch(s){case"data-bind":e["data-bind"]&&t.push(function(e){const t=[],s=e=>{MsPortalFx.forEachKey(e,((e,o)=>{t.push(`"${e}":`),"string"==typeof o?t.push(o):(t.push("{"),s(o),t.push("}")),t.push(",")})),t.pop()};return t.push("data-bind='"),s(e),t.push("'"),t.join("")}(e["data-bind"]));break;case"class":e.class&&t.push(`class='${"string"==typeof(o=e.class)?o:o.join(" ")}'`);break;default:!MsPortalFx.isNullOrUndefined(e[s])&&t.push(`${s}='${e[s]}'`)}var o})),t}e.Root=function(){return"Root"},e.KoIf=function(e){return"KoIf"},e.KoIfNot=function(e){return"KoIfNot"},e.KoForEach=function(e){return"KoForEach"},e.KoTemplate=function(e){return"KoTemplate"},e.KoContext=function(e){return"KoContext"},e.KoWith=function(e){return"KoWith"},e.elementStringFactories={Root:{createOpenTag:()=>"",createClosingTag:()=>""},a:{createOpenTag:e=>`<a ${t(e).join(" ")}>`,createClosingTag:()=>"</a>"},article:{createOpenTag:e=>`<article ${t(e).join(" ")}>`,createClosingTag:()=>"</article>"},aside:{createOpenTag:e=>`<aside ${t(e).join(" ")}>`,createClosingTag:()=>"</aside>"},b:{createOpenTag:e=>`<b ${t(e).join(" ")}>`,createClosingTag:()=>"</b>"},br:{createOpenTag:e=>`<br ${t(e).join(" ")}/>`,createClosingTag:()=>""},button:{createOpenTag:e=>`<button ${t(e).join(" ")}>`,createClosingTag:()=>"</button>"},canvas:{createOpenTag:e=>`<canvas ${t(e).join(" ")}>`,createClosingTag:()=>"</canvas>"},div:{createOpenTag:e=>`<div ${t(e).join(" ")}>`,createClosingTag:()=>"</div>"},fieldset:{createOpenTag:e=>`<fieldset ${t(e).join(" ")}>`,createClosingTag:()=>"</fieldset>"},"fxs-progress":{createOpenTag:e=>`<fxs-progress ${t(e).join(" ")}>`,createClosingTag:()=>"</fxs-progress>"},h1:{createOpenTag:e=>`<h1 ${t(e).join(" ")}>`,createClosingTag:()=>"</h1>"},h2:{createOpenTag:e=>`<h2 ${t(e).join(" ")}>`,createClosingTag:()=>"</h2>"},h3:{createOpenTag:e=>`<h3 ${t(e).join(" ")}>`,createClosingTag:()=>"</h3>"},h4:{createOpenTag:e=>`<h4 ${t(e).join(" ")}>`,createClosingTag:()=>"</h4>"},h5:{createOpenTag:e=>`<h5 ${t(e).join(" ")}>`,createClosingTag:()=>"</h5>"},hr:{createOpenTag:e=>`<hr ${t(e).join(" ")}>`,createClosingTag:()=>"</hr>"},header:{createOpenTag:e=>`<header ${t(e).join(" ")}>`,createClosingTag:()=>"</header>"},i:{createOpenTag:e=>`<i ${t(e).join(" ")}>`,createClosingTag:()=>"</i>"},iframe:{createOpenTag:e=>`<iframe ${t(e).join(" ")}>`,createClosingTag:()=>"</iframe>"},img:{createOpenTag:e=>`<img ${t(e).join(" ")}/>`,createClosingTag:()=>""},input:{createOpenTag:e=>`<input ${t(e).join(" ")}/>`,createClosingTag:()=>""},label:{createOpenTag:e=>`<label ${t(e).join(" ")}>`,createClosingTag:()=>"</label>"},legend:{createOpenTag:e=>`<legend ${t(e).join(" ")}>`,createClosingTag:()=>"</legend>"},li:{createOpenTag:e=>`<li ${t(e).join(" ")}>`,createClosingTag:()=>"</li>"},main:{createOpenTag:e=>`<main ${t(e).join(" ")}>`,createClosingTag:()=>"</main>"},nav:{createOpenTag:e=>`<nav ${t(e).join(" ")}>`,createClosingTag:()=>"</nav>"},ol:{createOpenTag:e=>`<ol ${t(e).join(" ")}>`,createClosingTag:()=>"</ol>"},p:{createOpenTag:e=>`<p ${t(e).join(" ")}>`,createClosingTag:()=>"</p>"},span:{createOpenTag:e=>`<span ${t(e).join(" ")}>`,createClosingTag:()=>"</span>"},table:{createOpenTag:e=>`<table ${t(e).join(" ")}>`,createClosingTag:()=>"</table>"},tbody:{createOpenTag:e=>`<tbody ${t(e).join(" ")}>`,createClosingTag:()=>"</tbody>"},td:{createOpenTag:e=>`<td ${t(e).join(" ")}>`,createClosingTag:()=>"</td>"},textarea:{createOpenTag:e=>`<textarea ${t(e).join(" ")}>`,createClosingTag:()=>"</textarea>"},th:{createOpenTag:e=>`<th ${t(e).join(" ")}>`,createClosingTag:()=>"</th>"},thead:{createOpenTag:e=>`<thead ${t(e).join(" ")}>`,createClosingTag:()=>"</thead>"},time:{createOpenTag:e=>`<time ${t(e).join(" ")}>`,createClosingTag:()=>"</time>"},tr:{createOpenTag:e=>`<tr ${t(e).join(" ")}>`,createClosingTag:()=>"</tr>"},ul:{createOpenTag:e=>`<ul ${t(e).join(" ")}>`,createClosingTag:()=>"</ul>"},video:{createOpenTag:e=>`<video ${t(e).join(" ")}>`,createClosingTag:()=>"</video>"},KoIf:{createOpenTag:e=>`\x3c!-- ko if: ${e.condition} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoIfNot:{createOpenTag:e=>`\x3c!-- ko ifnot: ${e.condition} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoForEach:{createOpenTag:e=>`\x3c!-- ko foreach: ${e.items} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoTemplate:{createOpenTag:e=>{let t;return e.templateKey?t=`'${e.templateKey}'`:e.options&&(t=e.options),`\x3c!-- ko template: ${t} --\x3e`},createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoContext:{createOpenTag:e=>`\x3c!-- ko context: ${e.context} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoWith:{createOpenTag:e=>`\x3c!-- ko with: ${e.data} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"}}}(s||(s={})),s})),
define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unregister=t.register=t.HintClassIdentifier=t.MoveTolerancePixels=t.ReactionDelayMillis=void 0,t.ReactionDelayMillis=550,t.MoveTolerancePixels=10,t.HintClassIdentifier="fxs-contextMenuTouchHint";const s=$(FxImpl.createElement("div",{class:t.HintClassIdentifier})),o=110,i=".cmtevt";let n,r={startTime:0,target:null,targetX:0,targetY:0};function a(e){const t=e.originalEvent,s=t&&t.touches,o=s&&1===s.length,i=s&&s[0];return o?i:null}function l(e,t){t.off(i),clearTimeout(n),function(e){if(e){const e={opacity:.2},t={opacity:1};s.animate(e,25).animate(t,25).animate(e,25).animate(t,25)}s.animate({width:0,height:0,top:"+="+o/2,left:"+="+o/2},75,(function(){s.detach()}))}(e),r={startTime:0,target:null,targetX:0,targetY:0}}function c(e){l(!0,$(e.currentTarget))}function d(e){const s=a(e)||{clientX:0,clientY:0},o=Math.abs(r.targetX-s.clientX),i=Math.abs(r.targetY-s.clientY);(o>t.MoveTolerancePixels||i>t.MoveTolerancePixels)&&l(!0,$(e.currentTarget))}function p(e){const s=$(e.currentTarget);if(r.startTime){if(Math.abs(Date.now()-r.startTime)>=t.ReactionDelayMillis){s.off("contextmenu"+i);const e=$.Event("contextmenu");e.clientX=r.targetX,e.clientY=r.targetY,$(r.target).trigger(e)}}l(!1,s)}function u(e){const u=a(e),m=$(e.currentTarget);u?r&&0!==r.startTime||(r={startTime:Date.now(),target:e.target,targetX:u.clientX,targetY:u.clientY},n=setTimeout((()=>{!function(){const e={width:0,height:0,top:r.targetY,left:r.targetX};s.css(e),$.querySelectorAll("body").append(s),s.animate({width:o,height:o,top:"-="+(o/2+5),left:"-="+o/2},75)}()}),t.ReactionDelayMillis),m.on("contextmenu"+i,(function(){return!1})).on("touchmove"+i,d).on("touchcancel"+i,c).on("touchend"+i,p)):l(!0,m)}t.register=function(e){e.on("touchstart",u)},t.unregister=function(e){e.off("touchstart",u),l(!0,e)}})),
define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines.css",["module"],(function(e){"use strict";return{css:".fxs-hidefocusoutline *{outline:0!important}",moduleId:e.id}})),
define("MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines",["require","exports","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines.css"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unregister=t.register=void 0,(0,s.injectCss)(o);const i=document.body,n=e=>{$(i).toggleClass("fxs-hidefocusoutline",!e).toggleClass("fxs-showfocusoutline",e)},r=()=>{n(!1)},a=e=>{const t=e.keyCode;9!==t&&13!==t&&27!==t&&32!==t&&37!==t&&38!==t&&39!==t&&40!==t||n(!0)};t.register=function(){i.addEventListener("mousedown",r,!0),i.addEventListener("pointerdown",r,!0),i.addEventListener("keydown",a,!0),r()},t.unregister=function(){i.removeEventListener("mousedown",r,!0),i.removeEventListener("pointerdown",r,!0),i.removeEventListener("keydown",a,!0),$(i).removeClass("fxs-showfocusoutline").removeClass("fxs-hidefocusoutline")}})),
define("MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip",["require","exports","MsPortalImpl/Base/Base.Timers"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unregister=t.register=void 0;const o=".msportalfx-tooltip-overflow,.msportalfx-text-ellipsis",i="fxs-autotooltip",n="title",r=(0,s.throttleByAnimationFrame)((e=>{const t=e.currentTarget,s=$(t);t.offsetWidth<t.scrollWidth&&(!t.title||s.hasClass(i))?(s.attr(n,s.text()||s.val()||s.attr("placeholder")||null),s.hasClass(i)||s.addClass(i)):t.offsetWidth>=t.scrollWidth&&s.hasClass(i)&&s.removeAttr(n).removeClass(i)}));t.register=function(e){e.on("mouseenter",o,r)},t.unregister=function(e){e.off("mouseenter",o,r)}})),
define("MsPortalImpl/Interactions/Interactions.KeyboardNavigation",["require","exports","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/JQueryHelper"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardNavigation=void 0;t.KeyboardNavigation=class{constructor(e,t){if(this._element=t.element,this._tabTriggers=t.tabTriggers||6,this._itemSelector=t.itemSelector||":tabbable",this._arrowsOnly=!(2&this._tabTriggers),this._internalLifetime=e.createChildLifetime(),this._parentTabIndexContextObservable=t.parentTabIndexContextObservable,this._setTabIndex=t.setTabIndex||((e,t)=>{e.attr("tabindex",""+t)}),this._setRootTabIndex(),this._internalLifetime.registerForDispose(this._element.setEvents(["focus",e=>{const t=this._element.find(this._itemSelector).first();this._arrowsOnly&&this._manageTabIndices(t),t.focus()}],["keydown",e=>{this._handleMenuKeyDown(e)}])),this._arrowsOnly){const e=this._element.find(this._itemSelector);this._setTabIndex(e,-1),this._internalLifetime.registerForDispose(this._element.setEvents(["focus",this._itemSelector,e=>{this._manageTabIndices($(e.target))}]))}}correctState(e){(e||this._lastTarget&&this._lastTarget.length&&this._element.find(this._itemSelector).toArray().indexOf(this._lastTarget[0])<0)&&(this._setRootTabIndex(),this._lastTarget&&(this._setTabIndex(this._lastTarget,-1),this._lastTarget=null))}dispose(){this._internalLifetime.dispose()}_handleMenuKeyDown(e){const t=s.getModifierKeys(e);let o=!1;const i=2&this._tabTriggers,n=4&this._tabTriggers,r=8&this._tabTriggers,a=0===t;i&&9===e.keyCode&&a||n&&40===e.keyCode&&a||r&&39===e.keyCode&&a?o=this._moveFocusToItem(1,e.target):(i&&9===e.keyCode&&4===t||n&&38===e.keyCode&&a||r&&37===e.keyCode&&a)&&(o=this._moveFocusToItem(-1,e.target)),o&&e.preventDefault()}_moveFocusToItem(e,t){let s=!1;const i=this._element.find(this._itemSelector),n=$(i.filter(((e,t)=>o.isElementVisible(t)))),r=n.index(t);return-1!==r&&($(n[(r+e+n.length)%n.length]).focus(),s=!0),s}_manageTabIndices(e){if(e&&e.length&&(!this._lastTarget||this._lastTarget[0]!==e[0])){const t=this._element.find(this._itemSelector);this._itemFocusLifetime&&this._itemFocusLifetime.dispose(),this._itemFocusLifetime=this._internalLifetime.createChildLifetime(),this._lastTarget=e,t.index(this._lastTarget[0])>=0&&(this._parentTabIndexContextObservable?this._parentTabIndexContextObservable.subscribeAndRun(this._itemFocusLifetime,(e=>{this._setTabIndex(t,-1);const s=this._lastTarget||this._element.find(this._itemSelector).first();s&&this._setTabIndex(s,e)})):(this._setTabIndex(t,-1),this._setTabIndex(this._lastTarget,0))),this._clearRootTabIndex();const s=e=>{this._setRootTabIndex()},o=this._lastTarget[0];ko.utils.domNodeDisposal.addDisposeCallback(o,s),this._itemFocusLifetime.registerForDispose((()=>{ko.utils.domNodeDisposal.removeDisposeCallback(o,s)}))}}_setRootTabIndex(){this._parentTabIndexContextObservable?(this._rootFocusLifetime&&this._rootFocusLifetime.dispose(),this._rootFocusLifetime=this._internalLifetime.createChildLifetime(),this._parentTabIndexContextObservable.subscribeAndRun(this._rootFocusLifetime,(e=>{this._setTabIndex(this._element,e)}))):this._setTabIndex(this._element,0)}_clearRootTabIndex(){this._rootFocusLifetime&&this._rootFocusLifetime.dispose(),this._setTabIndex(this._element,-1)}}})),
define("MsPortalImpl/Widgets/Widgets.ContextMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Widgets/Widgets.WidgetBase","WeaveDOM/DirectRender/DataAttribute","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,p.injectCss)(u);var m=MsPortalFx.Base.Diagnostics;const h=window,g=m.createLog(e),f="fxs-contextMenu",x="fxs-contextMenu-active",b="fxs-contextMenu-item",y="fxs-popup",v="fxs-portal-bg-txt-br",M="msportalfx-shadow-level2",C=s(o.Root,null,s("ul",{role:"menu",class:"fxs-contextMenu-itemList","data-bind":{attr:{"aria-label":"ariaLabel"}}},s(o.KoForEach,{items:"commands"},s("li",{role:"menuitem",class:"fxs-contextMenu-item msportalfx-command-like-button",tabindex:"0","data-bind":{css:{"fxs-portal-hover":"enabled","fxs-contextMenu-itemDisabled msportalfx-command-like-button-disabled":"!enabled()","fxs-contextMenu-extensioncommand":"!!$data._extension"},attr:{title:"$data.tooltip()","aria-disabled":"!enabled()","aria-label":"ariaLabel","aria-posinset":"$index() + 1","aria-setsize":"$parent.commands().length"}}},s("div",{class:"fxs-contextMenu-icon","data-bind":{image:"icon"}}),s("div",{class:"fxs-contextMenu-text msportalfx-text-ellipsis","data-bind":{text:"text"}})))));function P(e,t){return t||g.error(`ContextMenuViewModel.${e} is not accessible. Please call registerForCleanup first.`),t}function w(e){return e.isShellCommand}class I extends c.ViewModel{constructor(){super(),this.visible=ko.observable(!1),this.menuItems=ko.observableArray(),this.topOffsetCorrection=0}getOrderedMenuItemsCommandsComputed(){return P("orderedMenuItemsCommands",this._orderedMenuItemsCommands)}getOrderedMenuItemsComputed(){return P("orderedMenuItems",this._orderedMenuItems)}get hasVisibleCommands(){return P("hasVisibleCommands",this._hasVisibleCommands)}registerForCleanup(e){const t=this.menuItems,s=this._ltm=e.createChildLifetime(),o=this._orderedMenuItemsCommands=t.filter(s,(e=>e.visible()&&!w(e)&&!e.hasPopup())),i=this._orderedMenuItems=t.filter(s,(e=>e.visible()&&w(e)&&e.enabled()));this._hasVisibleCommands=ko.computed(s,(()=>o().length+i().length>0)),s.registerForDispose((()=>{this._ltm=this._orderedMenuItemsCommands=this._orderedMenuItems=this._hasVisibleCommands=null}))}}t.ViewModel=I;class S extends c.Widget{constructor(e,t,s){super(e,t),this._newRenderFlag=s,this._lastShowArgs=ko.observable(null);const o=this.ltm,i=e=>{const t=this.element[0];return t===e||$.contains(t,e)?0:2},a={dismissFn:()=>{this.hide()},shouldDismissOnMouseDownFn:i,shouldDismissOnMouseWheelFn:i,logName:"contextmenu"};s||(t.registerForCleanup(o),e.html(C).addClass(`${f} ${y} ${v} ${M}`),this._bindDescendants({ariaLabel:n.ContextMenu.ariaLabel,commands:ko.explicitComputed(o,[t.getOrderedMenuItemsComputed(),t.getOrderedMenuItemsCommandsComputed()],((e,t)=>e.concat(t)))}));const l=new MutationObserver((()=>this.updateRenderedPositionFromLastShow()));l.observe(e.find(".fxs-contextMenu-itemList")[0],{childList:!0}),o.registerForDispose((()=>l.disconnect())),this._initializeHandlers(),t.visible.subscribeAndRun(o,(e=>{const t=this.element;if(e){const e=document.activeElement;a.restoreFocus=()=>{r.validatePreviousFocusedElement(a,e)&&e.focus()},t.css(this._ensureInViewPort(this._lastShowArgs())).addClass(x),this.setFocus(),r.register(a)}else this._lastShowArgs(null),t[0].contains(document.activeElement)&&a.restoreFocus&&a.restoreFocus(),t.removeClass(x),r.unregister(a)}))}dispose(){this.hide(),this._cleanElement(f,y,v,M),super.dispose()}hide(){this.options.visible(!1)}show(e=0,t=0,s=!1){i.isFullscreen()?this.hide():(this._lastShowArgs({xCoord:e,yCoord:t,forceLeft:s}),this.options.visible(!0))}updateRenderedPositionFromLastShow(){const e=this._lastShowArgs();e&&this.element.css(this._ensureInViewPort(e))}setFocus(){Promise.resolve().then((()=>{this.element.find("[tabindex=0]:first-of-type").focus()}))}_initializeHandlers(){const e=this.element,t=this.ltm,s=e=>{if(e.stopPropagation(),e.preventDefault(),$(e.currentTarget).hasClass("fxs-contextMenu-itemDisabled"))return;this.hide();const t=this._newRenderFlag?(0,d.getElementData)(e.currentTarget):ko.dataFor(e.target);t&&t.enabled()&&t.execute(!0)};new a.KeyboardNavigation(this.ltm,{element:e}),l.register(e),ko.computed(t,(()=>{this._lastShowArgs()&&(this.options.menuItems().forEach((e=>{e.enabled()})),this.updateRenderedPositionFromLastShow())})),t.registerForDispose([()=>{l.unregister(e)},e.setEvents(["contextmenu",e=>!1]),e.find("ul").setEvents(["click",`.${b}`,s],["keydown",`.${b}`,e=>{13===e.which&&s(e)}])])}_ensureInViewPort(e){const{xCoord:t,yCoord:s,forceLeft:o}=e;let i=s,n="auto";const r=this.element,a=r.outerHeight(),l=r.outerWidth();this._isRtl()?(n=t-l,(o||n-l<0)&&(n+=l,i+=this.options.topOffsetCorrection)):(n=t,(o||n+l>h.innerWidth)&&(n-=l,i+=this.options.topOffsetCorrection));const c=h.innerHeight;return i+a>c&&(i-a>=0?i-=a:i=a<c?MsPortalFx.truncate((c-a)/2):0,i+=this.options.topOffsetCorrection),{top:i,left:n}}}t.Widget=S})),
define("MsPortalImpl/Interactions/Interactions.PortalReader",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortalReader=void 0;const s=document;if(!s.getElementById("PortalReader")){s.body.appendChild(FxImpl.createElement("div",{id:"PortalReader",class:"fxs-hide-accessible-label","aria-atomic":"false","aria-live":"polite"}))}const o=s.getElementById("PortalReader");t.PortalReader=class{constructor(e,t){this._nextId=MsPortalFx.getUniqueIdGenerator(t?.idPrefix);const s=t?.removalDelayMs>=0?t?.removalDelayMs:6e4;this._expirationDelayMs=t?.expirationDelayMs>=0?t?.expirationDelayMs:2e4;const i=this._liveRegion=FxImpl.createElement("div",{id:this._nextId(),class:"fxs-hide-accessible-label","aria-live":"polite","aria-atomic":"false","aria-relevant":"additions"});o.appendChild(i),e.registerForDispose((()=>{setTimeout((()=>{o.removeChild(i)}),s)}))}read(e){const t=FxImpl.createElement("div",{id:this._nextId()});t.textContent=e,this._liveRegion.appendChild(t),setTimeout((()=>{t.remove()}),this._expirationDelayMs)}}})),
define("MsPortalImpl/Widgets/Widgets.UIElementBase",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0;const o="Not implemented in base class.";class i extends s.ViewModel{constructor(e){super(),this.locked=ko.observable(!0),this.id=e}getViewSettings(){throw new Error(o)}applyViewSettings(e){throw new Error(o)}}t.ViewModel=i;const n=new WeakMap;class r extends s.Widget{constructor(e,t,s=!1){if(super(e,t,s),!t.id||"string"!=typeof t.id)throw new Error("An unique identifier is required and it must be a string.");r.attachId(e,t.id)}dispose(){r.detachId(this.element),super.dispose()}static attachId(e,t){const s=e[0];s&&n.set(s,t)}static detachId(e){const t=e[0];t&&n.delete(t)}static getId(e){const t=e[0];return t&&n.get(t)}addChild(e){throw new Error(o)}insertChild(e,t){throw new Error(o)}removeChild(e){throw new Error(o)}moveChild(e,t,s,i){throw new Error(o)}saveViewSettings(){throw new Error(o)}setSize(e,t){throw new Error(o)}discardStateOfUnusedChildren(){return{stateDiscarded:!1}}}t.Widget=r,r.viewSettingsChanged="viewSettingsChanged"})),
define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.BrowserDetection","Weave","Fx/Experimentation","FxInternal/AsyncLoader","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0;var m=MsPortalFx.Base.Diagnostics.Telemetry;(0,p.injectCss)(u);const h="fxs-react-contextpane",g="fxs-contextpane-content",f="fxsContextPaneTitle",x=$(document),b=window;class y extends o.ViewModel{constructor(e){super("fxs-contextpane-identifier"),this.diContainer=e,this.opened=(0,l.makeWritableComputation)(!1),this.loading=(0,l.makeWritableComputation)(!1),this.enableResize=(0,l.makeWritableComputation)(!1),this.hideExpandButton=(0,l.makeWritableComputation)(!0),this.openedFromTopBar=(0,l.makeWritableComputation)(!1),this.childElementCount=(0,l.makeWritableComputation)(0),this.close=MsPortalFx.noop}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget.element}}t.ViewModel=y;class v extends o.Widget{constructor(e,t){super(e,t,!0),this._prewarmContextPanes=!1,this._announce=new n.PortalReader(this.ltm,{idPrefix:"contextpane"}),t.setWidget(this),this._$progress=$(e[0].querySelector(".fxs-contextpane-loadindicator"));const s=this.element.find(".fxs-portal-contextpane-docked-resize-curtain"),o=this.element.find(".fxs-portal-contextpane-docked-resize-splitter");(0,l.subscribe)(this.ltm,[t.loading],(e=>{e?this._announce.read(r.Shell.Reader.contextPaneLoading):this._announce.read(r.Shell.Reader.contextPaneReady)})),(0,l.subscribe)(this.ltm,[t.opened],(e=>{e||this._announce.read(r.Shell.Reader.contextPaneClosed)})),(0,l.subscribe)(this.ltm,[t.enableResize],(t=>{t?(s.removeClass("fxs-display-none"),o.removeClass("fxs-display-none"),$(s).attr({"aria-label":r.ContextPane.Resize.ariaLabel,"aria-valuenow":e.width().toString(),"aria-valuemin":this.getContextPaneWidth().toString(),"aria-valuemax":920<b.innerWidth?920..toString():b.innerWidth.toString()})):s.addClass("fxs-display-none")})),t.diContainer.get(c.Experimentation).shellAssignments.whenAvailable().then((e=>this._prewarmContextPanes=e.getBooleanValue("PrewarmContextPanes"))),s.on("mousedown",(t=>{const i=t.clientX,n=e.width();let r,a,l=!1;o.css("pointerEvents","all"),x.on("mousedown",(e=>{e.preventDefault(),l=!0})).on("mousemove",a=t=>{if(t.preventDefault(),s.css("cursor","col-resize"),l){l=!1;const s=n+i-t.clientX;l=this._resizeContextPane(e,s)}}).on("mouseup",r=()=>{m.trace({source:"Shell",action:"SideCarResized",data:{eventType:"mousemove",resizedWidth:e.width().toString()}}),s.attr("aria-valuenow",e.width().toString()),o.css("pointerEvents","none"),x.off("mousemove",a),x.off("mouseup",r),l=!1})})),s.on("keydown",(t=>{if(!(t.ctrlKey||t.altKey||t.shiftKey||37!==t.keyCode&&39!==t.keyCode&&36!==t.keyCode&&35!==t.keyCode&&13!==t.keyCode)){let o=e.width();switch(t.keyCode){case 37:o=e.width()+20;break;case 39:o=e.width()-20;break;case 36:o=this.getContextPaneWidth();break;case 35:o=920;break;case 13:o=e.width()===this.getContextPaneWidth()?920:this.getContextPaneWidth()}if(o!==e.width()){this._resizeContextPane(e,o)&&(t.stopPropagation(),s.attr("aria-valuenow",e.width().toString()))}}})).on("keyup",(t=>{m.trace({source:"Shell",action:"SideCarResized",data:{eventType:"keydown",resizedWidth:e.width().toString()}})}))}dispose(){this._cleanElementClasses([h]),this._disposeHandler(),super.dispose()}hasContent(){return!!this._$content}addChild(e){this._addChild(e)}insertChild(e,t){this._addChild(e,t)}_addChild(e,t){if(!e)throw new Error("Can't add null child.");if($(b).on("resize",this._resizeWindowHandler=()=>{const e=$.querySelectorAll(".fxs-portal-region")?.find(".fxs-portal-contextpane-docked.fxs-contextpane-visible");e?.length>0&&(this._currentViewPortWidth()<1280||this._currentViewPortWidth()>=1280&&e.width()<this.getContextPaneWidth())&&e.width(this.getContextPaneWidth())}),this._prewarmContextPanes&&async function(e,t){if(!t)return!1;const s=t.name;let o=s?.toLowerCase().endsWith(".ReactView".toLowerCase());if(o)return!0;if(!s?.toLowerCase().endsWith("_dx"))return!1;const[n,r]=await Promise.all([d.get("MsPortalImpl/Extension/DxDefinitionCache","getRuntimeBlade"),e.getAsync(i.ExtensionManagerOptions)]),a=t.extensionName,l=r.getNormalizedMetadata(a,!0),c=await n(e,l,s);return o=c?.bladeName?.toLowerCase().endsWith(".ReactView".toLowerCase()),o}(this.options.diContainer,e.options?.bladeName).then((e=>{this.element.toggleClass(h,e)})),this.hasContent()&&!t&&this.removeChild(null),t>=0){const e=$(this._getChildElement()[t-1]);e&&e.addClass("fxs-display-none")}const o=this._$content=e.element?e.element:e;o.addClass(g).insertBefore(this._$progress),s.waitForBindings(o[0]).then((()=>{const e=o.find(".fxs-contextpane-title, .fxs-blade-title-titleText"),t=e.attr("id");t?this.element.attr("aria-labelledby",t):(this.element.attr("aria-labelledby",f),e.attr("id",f))})),this.options.hideExpandButton(!o.hasClass("fxs-partgallery-container")),this.options.childElementCount(this.options.childElementCount.value+1)}_resizeContextPane(e,t){return this._currentViewPortWidth()<1280&&(t=this.getContextPaneWidth()),t<this.getContextPaneWidth()?t=this.getContextPaneWidth():t>920&&(t=920),e.width(t),e.addClass("fxs-contextpane-docked-resized"),!0}removeChild(e,t){const s=this._$content;if(!s)return!0;t?s.detach():s.remove(),s.removeClass(g);const o=this.options.childElementCount;if(o(Math.max(o.value-1,0)),o.value>0){const e=$(this._getChildElement()[o.value-1]);e.removeClass("fxs-display-none"),this._$content=e}else this._$content=null;return this._disposeHandler(),!0}clear(){return this.removeChild(null)}setFocus(){if(!a.isAndroidOrMobile){const e=this._$content;e&&s.waitForBindings(this.element[0]).then((()=>{let t;const s=e.find(".fxs-blade-content-container");s&&(t=s.findFirstTabbable()),s&&0!==t.length||(t=e.findFirstTabbable()),0!==t.length&&t.focus()}))}}getBladeHost(e,t){return MsPortalFx.require("MsPortalImpl/Widgets/Widgets.Blade").then((s=>{const o=new s.ViewModel(MsPortalFx.getUniqueId(),this.options.diContainer);o.title(t.title),o.defaultContent.title(t.title),o.defaultContent.bladeStyle(4),o.defaultContent.bladeWidth(t.bladeWidth),o.defaultContent.reflowReady(!0);const i=s.createBladeWidget($(FxImpl.createElement("section")),o);return i.initializeLayout(),i.getContentWidget().initializeLayout(),i.getContentWidget().addChild(e),o.loaded(!0),o.defaultContent.loaded(!0),o.close=e=>{this.options.close(e)},i}))}getContextPaneWidth(){return this._currentViewPortWidth()>1280?480:320}_currentViewPortWidth(){return $.querySelectorAll(".fxs-portal-region").width()}_getChildElement(){return this.element.children(".fxs-contextpane-content")}_disposeHandler(){this._resizeWindowHandler&&($(b).off("resize",this._resizeWindowHandler),this._resizeWindowHandler=null)}}t.Widget=v})),
define("MsPortalImpl/Widgets/Widgets.Portal.State",["require","exports","Fx/DependencyInjection","Weave"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortalState=void 0;let i=class{constructor(){this.displayMode=(0,o.makeWritableComputation)("None"),this.inOrganizeMode=ko.observable(!1),this.settingsFlyoutState=(0,o.makeWritableComputation)(0)}};t.PortalState=i,t.PortalState=i=__decorate([__metadata("fx:diagnostics",[e,"PortalState"]),s.Class()],i)})),
define("MsPortalImpl/Services/Services.Storage",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StorageService=t.ComponentName=void 0;const o=MsPortalFx.Base.Diagnostics.createLog(e),i=JSON.stringify;var n;!function(e){e[e.DesktopManager=2]="DesktopManager",e[e.AssetMruList=3]="AssetMruList",e[e.ExtensionManager=4]="ExtensionManager",e[e.Router=5]="Router",e[e.UserSettings_Journeys=6]="UserSettings_Journeys",e[e.UserSettings_EditScopes=7]="UserSettings_EditScopes",e[e.Relex=8]="Relex",e[e.ManifestVersions=9]="ManifestVersions",e[e.Redirect=10]="Redirect",e[e.Cdn=11]="Cdn",e[e.UserSettings_NewJourneys=12]="UserSettings_NewJourneys",e[e.Telemetry=13]="Telemetry",e[e.Dashboard=14]="Dashboard",e[e.Avatar=15]="Avatar",e[e.UserSettingsService=16]="UserSettingsService",e[e.AppBanner=19]="AppBanner",e[e.IEBanner=20]="IEBanner",e[e.Menu=21]="Menu"}(n||(t.ComponentName=n={}));const r=MsPortalFx.getEnumArray(n),a={};r.forEach((e=>{a[e.name]={count:0,keySize:0,valueSize:0}}));class l{constructor(e,t){function s(e){return n[e]+"_"}function l(e,t){return s(e)+(t||"")}function c(s){return 1===s?e:t}function d(e,t,s){for(let o=0;o<e.length;o++){const i=e.key(o);t.call(s,e.getItem(i),i,e)}}function p(e){const t=(r.forEach((e=>{const t=a[e.name];t.count=t.keySize=t.valueSize=0})),a);let s,o=0,n="";d(e,((e,s)=>{const a=MsPortalFx.find(r,(e=>MsPortalFx.startsWith(s,e.name)));if(a){const r=t[a.name];r.count++,r.keySize+=s.length;const l=i(e).length;r.valueSize+=l,l>o&&(o=l,n=s)}}));try{s=i(t)}catch(e){s=`Could not stringify the summary. Exception: ${MsPortalFx.getLogFriendlyMessage(e)}`}return"Summary: {0}. The longest value (key == {1}) took {2} bytes. The total storage length is {3}.".format(s,n,o,e.length)}this.getValue=(e,t,s)=>c(s).getItem(l(e,t)),this.getAllComponentItems=(e,t)=>{const o=s(e),i=c(t),n={},r=o.length;return d(i,((e,t)=>{if(t.startsWith(o)){const s=t.substring(r,t.length);n[s]=e}})),n},this.setValue=(e,t,s,i)=>{const n=c(i),r=l(e,t);try{n.setItem(r,s)}catch(e){const s=new Error("Storage.setItem failed.");s.innerError=e,s.storageState=p(n),s.key=r||t,o.error(s)}},this.clearValue=(e,t,s)=>{const o=c(s),i=l(e,t),n=o.getItem(i);return o.removeItem(i),n},this.clearAllComponentItems=(e,t)=>{const o=s(e),i=c(t),n=[];d(i,((e,t)=>{t.startsWith(o)&&n.push(t)})),n.forEach((e=>i.removeItem(e)))},this.clearAll=()=>{t.clear(),e.clear()}}static create(){return new l(MsPortalImpl.sessionStorage,MsPortalImpl.localStorage)}}t.StorageService=l,__decorate([__metadata("fx:diagnostics",[e,"StorageService"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",l)],l,"create",null)})),
define("MsPortalImpl/Widgets/Widgets.ContextMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","Weave","FxInternal/Weave","FxInternal/Weave/Util"],(function(e,t,s,o,i,n,r){"use strict";function a(e){return e+1}Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMenu=void 0,t.ContextMenu=function(e){const{vm:t,className:l}=e,c=(0,i.composeComputation)([(0,n.toComputation)(t.getOrderedMenuItemsComputed()),(0,n.toComputation)(t.getOrderedMenuItemsCommandsComputed())],((e,t)=>e.concat(t)));return s("div",{className:["fxs-contextMenu","fxs-popup","fxs-portal-bg-txt-br","msportalfx-shadow-level2","msportalfx-unselectable",l]},s("ul",{role:"menu",className:"fxs-contextMenu-itemList","aria-label":o.ContextMenu.ariaLabel},s(i.ForEach,{collection:c,fn:({item:e,index:t,length:o})=>{const i=(0,n.toComputation)(e.enabled),l=i.compose(r.negation),c=t.compose(a);return s("li",{role:"menuitem",className:["fxs-contextMenu-item msportalfx-command-like-button",{"fxs-portal-hover":i,"fxs-contextMenu-itemDisabled":l,"msportalfx-command-like-button-disabled":l,"fxs-contextMenu-extensioncommand":e._extension}],tabindex:"0",title:(0,n.toComputation)(e.tooltip),"aria-disabled":l,"aria-label":(0,n.toComputation)(e.ariaLabel),"aria-posinset":c,"aria-setsize":o,data:e},s("div",{className:"fxs-contextMenu-icon",image:(0,n.toComputation)(e.icon)}),s("div",{className:"fxs-contextMenu-text"},(0,n.toComputation)(e.text)))}})))}})),
define("MsPortalImpl/Widgets/Widgets.ContextPane.Component",["require","exports","Weave/DirectMode","FxInternal/Weave/Components/LoadingIndicator"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextPane=void 0,t.ContextPane=function(e){const{vm:t,className:i}=e,n=t.opened,r=t.loading;return s("div",{className:["fxs-contextpane fxs-portal-bg-txt-br az-noprint",i,{"fxs-contextpane-visible":n,"fxs-contextpane-loading":r}],role:"complementary","aria-labelledby":"fxsContextPaneTitle"},s("div",{className:"fxs-contextpane-loadindicator"},s(o.LoadingIndicator,null)),s("div",{className:"fxs-portal-contextpane-docked-resize-curtain fxs-display-none",role:"separator",tabindex:"0"}),s("div",{className:"fxs-portal-contextpane-docked-resize-splitter fxs-display-none"}))}})),
define("_generated/MsPortalImpl/Svg/Library/ArrowRight.svg",["require","exports"],(function(e,t){"use strict";return{type:262,data:"<svg viewBox='0 0 14.2 9.7' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m8.6 9 3.7-3.6H0v-1h12.3L8.6.7l.8-.7 4.8 4.9-4.8 4.8z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/DoubleChevron.svg",["require","exports"],(function(e,t){"use strict";return{type:345,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14.65 15.53 8 8.88l-6.65 6.65-.7-.71L8 7.47l7.35 7.35-.7.71z'/><path d='M14.65 8.53 8 1.88 1.35 8.53l-.7-.71L8 .47l7.35 7.35-.7.71z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg",["require","exports"],(function(e,t){"use strict";return{type:176,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M2 7a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 2 7zm6 0a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 8 7zm6 0a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 14 7z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Hamburger.svg",["require","exports"],(function(e,t){"use strict";return{type:313,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M1 4.5v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg",["require","exports"],(function(e,t){"use strict";return{type:31,data:"<svg viewBox='0 0 16 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14.3 1H10V0h6v6h-1V1.7l-8 8-.7-.7z'/><path d='M11 8v5a.9.9 0 0 1-1 1H2a.9.9 0 0 1-1-1V6a.9.9 0 0 1 1-1h6l1-1H2a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Star.svg",["require","exports"],(function(e,t){"use strict";return{type:283,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m6 .3 1.5 4.3 4.5.1-3.6 2.7 1.3 4.3L6 9.1l-3.7 2.6 1.3-4.3L0 4.7l4.5-.1z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.SideBar.Component",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Widgets/Widgets.SideBar","_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg","_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Services/Services.GeneralSettings","_generated/MsPortalImpl/Svg/Library/ArrowRight.svg","_generated/MsPortalImpl/Svg/Startup/DoubleChevron.svg","_generated/MsPortalImpl/Svg/Startup/Star.svg","_generated/MsPortalImpl/Svg/Startup/Hamburger.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.BladeOpener","Fx/Composition/Selectable"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SideBar=void 0;const b=window.fx.environment;t.SideBar=function(e){const{vm:t,className:y}=e,v=n,M=r,C=t.isCollapsed,P=t.extensionSideBar(),w=(0,o.composeComputation)([t.hamburgerMode,C],((e,t)=>!(e&&t||P)));let I;const S=t.sideBarMenuIsActivated.compose((e=>e?g.SideBar.menuCollapse:g.SideBar.menuExpand)),_=(0,o.composeComputation)([t.menuBladeId,t.layoutMode],((e,t)=>!!e&&0===t));if(P){const[,e,s]=P.split("/");t.diContainer.get(f.BladeOpener).openBlade(new x.PdlBladeReference(s,e),{flags:512})}return s(o.GetContext,{fn:({diContainer:e})=>s(o.LifetimeManagerScoped,{fn:n=>((0,o.subscribeAndRun)(n,[_],t.sideBarMenuIsActivated),s("div",{className:[y,P&&"fxs-extension-sidebar fxs-portal-background",{"fxs-sidebar-menu-activated":t.sideBarMenuIsActivated,"fxs-sidebar-menu":_,"fxs-sidebar-is-collapsed":C,"fxs-display-none":!!b.chrome.hideSidebarNav}],role:"presentation",onDragOver:({event:e})=>{e.preventDefault()},onDrop:({event:e})=>{const s=e.target,o=$(s).closest(".fxs-sidebar-droppable")[0];e.preventDefault(),o&&(0,i.reorderFavorite)(o.getAttribute("data-id"),I,t)},afterMount:s=>{new i.Widget(n,$(s),t,e)}},s("nav",{className:"fxs-sidebar-bar msportalfx-shadow-level3","aria-label":l.SideBar.svcNavLabel,onKeyDown:({event:e})=>{if(32===e.keyCode&&4!==(0,c.getModifierKeys)(e)){const t=e.target;t.click(),t.classList.contains("fxs-sidebar-filter-input")||e.preventDefault(),e.stopPropagation()}}},s("div",{className:"fxs-sidebar-header"},s("button",{className:"fxs-sidebar-item-link fxs-sidebar-hamburger fxs-sidebar-button",title:l.SideBar.hamburger,"aria-label":l.SideBar.hamburger,onClick:T,ref:t.hamburgerButton},s("div",{className:"fxs-sidebar-icon",image:h})),s("a",{className:"fxs-sidebar-menu-toggle-link",href:"#",title:S,"aria-label":S,onClick:({event:e})=>{e.preventDefault(),t.sideBarMenuIsActivated(!t.sideBarMenuIsActivated.value)}},s("div",{className:"fxs-sidebar-menu-icon fxs-sidebar-icon",image:MsPortalFx.Base.Images.CustomImageWithOptions(p,{palette:99})}),s("div",{className:"fxs-sidebar-menu-text fxs-sidebar-label"},S)),s("div",{className:"fxs-sidebar-divider2"})),s(o.Once,{"data-odebug":"16",condition:w,trueFn:()=>s(o.Fragment,null,s("div",{className:"fxs-sidebar-top fxs-sidebar-menu-activated-hidden"},s("button",{className:"fxs-sidebar-collapse-button fxs-sidebar-button",title:C.compose((e=>e?l.SideBar.expand:l.SideBar.collapse)),image:u,onClick:()=>{const e=!t.isCollapsed.value;2===t.layoutMode.value&&t.diContainer.get(d.GeneralSettings).sideBarCollapsedKey(e),t.setCollapsed(e)}}),t.topSectionLinks.map((e=>s("a",{className:"fxs-sidebar-item-link "+e.classes,href:e.href,title:e.title,"aria-label":e.title,onClick:()=>{e.onClick(),T()}},s("div",{className:"fxs-sidebar-icon",image:e.icon}),s("div",{className:"fxs-sidebar-label"},e.text))))),MsPortalFx.isFeatureEnabled("hidefavoritesdivider")?null:s("div",{className:"fxs-sidebar-favorites-section fxs-sidebar-menu-activated-hidden"},s("div",{className:"fxs-sidebar-divider"}),s("div",{className:"fxs-sidebar-fav-icon",image:m}),s("span",{className:"fxs-sidebar-myfavorites"},l.SideBar.myFavorites),s("div",{className:"fxs-sidebar-divider"})),s("div",{className:"fxs-sidebar-middle fxs-sidebar-menu-activated-hidden"},s("ul",{className:"fxs-sidebar-favorites fxs-sidebar-list","aria-label":l.SideBar.svcList,afterMount:(e,t)=>{const s=new MutationObserver((()=>{if(!e.querySelector('.fxs-sidebar-item-link[tabindex="0"]')){const t=e.querySelector(".fxs-sidebar-item-link");t&&t.setAttribute("tabindex","0")}}));s.observe(e,{childList:!0}),t.registerForDispose((()=>s.disconnect())),new a.KeyboardNavigation(t,{element:$(e),tabTriggers:12,itemSelector:".fxs-sidebar-item-link"})}},s(o.ForEach,{collection:t.effectiveFavorites,fn:({item:e})=>s("li",{className:"fxs-sidebar-item fxs-sidebar-favorite-item fxs-sidebar-draggable fxs-sidebar-droppable",draggable:"true","data-id":e.id,onDragStart:F},s("a",{tabindex:"-1",className:"fxs-sidebar-item-link",href:e.uri,title:e.label,"aria-label":e.label,onClick:k},s("div",{className:"fxs-sidebar-icon",image:e.image}),s("div",{className:"fxs-sidebar-label"},e.label),e.opensExternal?s("div",{className:"fxs-sidebar-external",image:v}):null,s("div",{className:"fxs-sidebar-handle",image:M})),s("div",{className:"fxs-hover-card-balloon",style:{display:"hidden"},"data-name":e.id,"data-source":"SidebarFavorite"}))})))),falseFn:()=>s("div",{className:"fxs-sidebar-content"})}),s("div",{className:"fxs-sidebar-menu-container"}),s("div",{className:"fxs-sidebar-shadow"}))))})});function F(e){const t=e.event,s=t.dataTransfer;s&&(s.setData("text","fxs-draganddrop"),s.effectAllowed="move"),I=t.currentTarget.getAttribute("data-id")}function T(){(t.hamburgerMode.value||2!==t.layoutMode.value)&&t.setCollapsed(!0)}function k(e){const s=e.event,o=s.currentTarget.parentElement.getAttribute("data-id"),i=t.favorites.value,n=i[function(e,t){for(let s=0;s<t.length;++s)if(t[s]&&t[s].id===e)return s;return-1}(o,i)];if(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"SideBar",name:o,action:"SideBarItemOpened",data:{isFavorite:n.isFavorite()}}),(0,c.isCtrlOrCommandOnly)(s)||s.shiftKey)return!0;t.openFavorite(n)&&s.preventDefault(),T()}}})),
define("MsPortalImpl/Utilities/UrlUtilities",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUnsafeParams=t.isTestEnvironment=void 0,t.isTestEnvironment=function(){return location.hostname.endsWith("azure-test.net")||"localhost"===location.hostname||"onestb.cloudapp.net"===location.hostname||"local-prod.portal.azure.com"===location.hostname},t.getUnsafeParams=function(e){const t=["clientoptimizations","feature.customportal","l","feature.consoletelemetry","feature.telemetryinsights","feature.usertype"],s=new URLSearchParams(new URL(location.href).search),o=new Map;for(const[e,i]of s)t.includes(e.toLowerCase())||o.set(e,i);return e?new Map(Array.from(o).slice(0,e)):o}})),
define("MsPortalImpl/Resources/Resources.Images",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=[{MsPortalImpl:[{AdvisorNotifications:[{AdvisorDashboard:["cscz.svg","dede.svg","enus.svg","eses.svg","frfr.svg","huhu.svg","itit.svg","jajp.svg","kokr.svg","nlnl.svg","plpl.svg","ptbr.svg","ptpt.svg","ruru.svg","svse.svg","trtr.svg","zhcn.svg","zhtw.svg"]}]},{AvatarMenu:[{AvatarMenu:["defaultAvatarSmall.png"],Badge:["github.png"]}]},{Blade:[{Blade:["icon.gif"]}]},{ControlsWizard:[{ControlsWizard:["loadingImage.gif"]}]},{General:[{FlowLayout:["gridShadow.png"]}]},{Notice:[{Notice:["comingSoon.png","noSubscription.png","unauthorized.png"]}]},{PartError:[{PartError:["icon.png"]}]},{PartGallery:[{PartGallery:["collectionPartWithRollup.svg","collectionSummary.svg","donutChart.svg","donutChartPartial.svg","extensions.svg","gridWithMoreData.svg","map.svg","multiLineChartMultiTrendLine.svg","multiScatterChart.svg","multiStackedBarChart.svg","mutliLineChart.svg","pricingTier.svg","quotaGauge.svg","resourceMap.svg","singleAreaChart.svg","singleAreaChartSingleThreshold.svg","singleAreaChartSingleTrendline.svg","singleBarChartLarge.svg","singleBarChartSmall.svg","singleLineChart.svg","singleScatterChart.svg","singleScatterSingleThreshold.svg","singleValueGauge.svg","splitBarChart.svg","stackedAreaChart.svg"]}]},{ProvisioningPart:[{ProvisioningPart:["running.gif"]}]}]}];["AdvisorDashboard","AvatarMenu","Badge","Blade","ControlsWizard","FlowLayout","Notice","PartError","PartGallery","ProvisioningPart"].forEach((e=>{var o;t["get"+e]=(o=e,()=>MsPortalFx.getImages(s,o))}))})),
define("MsPortalImpl/Widgets/Widgets.DropMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","Fx/Telemetry","MsPortalImpl/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css"],(function(e,t,s,o,i,n,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,c.injectCss)(d);const p="fxs-dropmenu-button",u="fxs-dropmenu-hidden",m="fxs-dropmenu-is-open",h="fxs-dropmenu-invisible",g="aria-label",f=s(o.Root,null,s("div",{class:"fxs-dropmenu",role:"presentation"},s("button",{class:"fxs-dropmenu-button","aria-haspopup":"true","aria-expanded":"false"}),s("div",{class:"fxs-dropmenu-content fxs-text-link",role:"menu"})));class x extends n.ViewModel{constructor(e,t,s,o,i){super(),this.isMenuOpen=ko.observable(!1),this.buttonLabel=ko.observable(),this.buttonDescribedBy=ko.observable(),this.buttonTooltip=ko.observable(),this.menuLabel=ko.observable(),this.buttonTemplate=e,this.menuTemplate=t,this.togglesVisibility=!!o,this.itemSelector=s,this.telemetrySource=i,this.autoDismissMenu=!0}open(){this.isMenuOpen(!0)}close(){this.isMenuOpen(!1)}toggle(){this.isMenuOpen(!this.isMenuOpen.peek())}}t.ViewModel=x;class b extends n.Widget{constructor(e,t,s,o=!1){super(e,t,o),this._newRender=s;const i=this.ltm;if(s){const t=e[0].querySelector(".fxs-dropmenu"),s=t.querySelector(".fxs-dropmenu-button"),o=t.querySelector(".fxs-dropmenu-content");this._dropMenu=$(t),this._dropMenuButton=$(s),this._dropMenuContent=$(o)}else{const s=MsPortalFx.getUniqueId(),o=this._dropMenu=$(FxImpl.createElement("div",{trustedInnerHTML:f}).children[0]);this._dropMenuButton=o.find(`.${p}`).attr("id",t.buttonId||null).addClass(t.buttonClass).addClass("fxs-popup-button").html(t.buttonTemplate).attr("aria-controls",s),this._dropMenuContent=o.find(".fxs-dropmenu-content").html(t.menuTemplate).attr("id",s).addClass("fxs-popup").addClass("fxs-portal-bg-txt-br").addClass("msportalfx-shadow-level2").addClass(0===t.alignMenu?"fxs-dropmenu-right":"fxs-dropmenu-left"),e.append(this._dropMenu)}const n=this._dropMenuButton,r=this._dropMenuContent,l=this._dropMenu;if(t.isMenuOpen[s?"subscribe":"subscribeAndRun"](i,(e=>{e?(t.telemetrySource&&(0,a.trace)({source:t.telemetrySource,action:"DropMenuOpened"}),this._show()):this._hide()})),!s){let e,s;ko.reactor(i,(()=>{n.attr("title",t.buttonTooltip()).attr(g,t.buttonLabel()),r.attr(g,t.menuLabel())}));const o="click";l.on(o,`.${p}`,e=e=>{e.preventDefault(),t.toggle()}),r.on(o,t.itemSelector,s=e=>{t.close()}),i.registerForDispose((()=>{l.off(o,`.${p}`,e),r.off(o,t.itemSelector,s)}))}let c;window.addEventListener("resize",(()=>{this.options.close()}));const d="contextmenu";e.on(d,c=e=>{if(t.isMenuOpen())return!1}),i.registerForDispose((()=>{e.off(d,c)}))}_show(){this._newRender||(this._dropMenuButton.attr("aria-expanded",!0),this._dropMenuContent.removeClass(`${h} ${u}`).addClass(m).attr("aria-hidden",!1));const e=this._dropMenuContent;if(this.options.autoDismissMenu){if(!this._dismissHandle){const e=e=>$.contains(this._dropMenu[0],e)?0:2;this._dismissHandle={dismissFn:()=>{this.options.close()},shouldDismissOnFocusOutFn:()=>$.contains(this._dropMenu[0],document.activeElement)?0:1,shouldDismissOnMouseDownFn:e,shouldDismissOnMouseWheelFn:e,restoreFocus:()=>{this._dropMenuButton[0].focus()},logName:"dropMenu"}}if(!this._dismissLifetime||this._dismissLifetime.isDisposed()){const t=this._dismissLifetime=this.ltm.createChildLifetime(),s=this._dismissHandle;i.register(s),new r.KeyboardNavigation(this._dismissLifetime,{element:e,tabTriggers:12,itemSelector:this.options.itemSelector}),t.registerForDispose([()=>{i.unregister(s)}])}}else this._dismissLifetime&&this._dismissLifetime.dispose();this.options.containInViewport&&requestAnimationFrame((()=>{const e=window.innerWidth-this._dropMenuContent[0].getBoundingClientRect().right-20;e<0&&this._dropMenuContent.css({left:`${e}px`})})),this.options.setItemFocusWhenOpen&&(this._newRender?(0,l.tryFocusAfterChangePropagation)(e[0]):e.focus())}_hide(){this._newRender||(this._dropMenuButton.attr("aria-expanded",!1),this._dropMenuContent.addClass(this.options.togglesVisibility?h:u).removeClass(m).attr("aria-hidden",!0)),this.options.containInViewport&&this._dropMenuContent.css({left:""}),this._dismissLifetime&&this._dismissLifetime.dispose()}setFocus(){this.options.isMenuOpen.peek()?this._newRender?(0,l.tryFocusAfterChangePropagation)(this._dropMenuContent[0]):this._dropMenuContent.focus():this._newRender?(0,l.tryFocusAfterChangePropagation)(this._dropMenuButton[0]):this._dropMenuButton.focus()}}t.Widget=b})),
define("MsPortalImpl/Widgets/Widgets.DropMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.DropMenu","FxInternal/Weave","Weave","FxInternal/Weave/Util"],(function(e,t,s,o,i,n,r){"use strict";function a(e){const t=e.vm,o=MsPortalFx.getUniqueId(),a=(0,i.toComputation)(t.isMenuOpen),l=a.compose(r.negation),c=MsPortalFx.getUniqueId(),d=(0,i.toComputation)(t.buttonDescribedBy);return s("div",{className:"fxs-dropmenu",role:"presentation"},s("button",{id:t.buttonId,"aria-controls":o,className:["fxs-dropmenu-button","fxs-popup-button",t.buttonClass],"aria-haspopup":"true","aria-expanded":a,title:(0,i.toComputation)(t.buttonTooltip),"aria-label":e.buttonLabel||(0,i.toComputation)(t.buttonLabel),"aria-describedby":d.compose((e=>e?c:null)),onClick:({event:e})=>{e.preventDefault(),t.toggle()}},e.button),s(n.If,{condition:d,concealmentBehavior:"remove",trueFn:()=>s("div",{id:c,className:"az-display-none"},d)}),s("div",{id:o,className:["fxs-dropmenu-content","fxs-text-link","fxs-popup","fxs-portal-bg-txt-br","msportalfx-shadow-level2",0===t.alignMenu?"fxs-dropmenu-right":"fxs-dropmenu-left",{"fxs-dropmenu-is-open":a,[t.togglesVisibility?"fxs-dropmenu-invisible":"fxs-dropmenu-hidden"]:l}],role:"menu","aria-hidden":l,"aria-label":(0,i.toComputation)(t.menuLabel),onClick:({event:e})=>{const s=e.currentTarget;let o=e.target;for(o&&!o.matches&&(Element.prototype.matches=Element.prototype.msMatchesSelector);o&&!o.matches(t.itemSelector)&&o!==s;)o=o.parentElement;o&&o.matches(t.itemSelector)&&t.close()}},e.content))}Object.defineProperty(t,"__esModule",{value:!0}),t.DropMenu=t.DropMenuInner=void 0,t.DropMenuInner=a,t.DropMenu=function(e){return s("div",{className:e.className,afterMount:(t,s)=>{s.registerForDispose(new o.Widget($(t),e.vm,!0))}},s(a,{button:e.button,buttonLabel:e.buttonLabel,content:e.content,vm:e.vm}))}})),
define("MsPortalImpl/Widgets/Widgets.AvatarMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.DropMenu.Component","FxInternal/Weave","Weave","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Resources/Resources.Images"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AvatarMenu=void 0,t.AvatarMenu=function(e){const{vm:t,className:l}=e;let c,d=0;const p=()=>c&&c(),u=a.getAvatarMenu().defaultAvatarSmall,m=(0,n.composeComputation)([t.userIdentity,t.avatarImage],((e,t)=>e&&!e.isAnonymous&&(t||e.defaultAvatarUri||"").trim()||u)),h=s("div",{className:["fxs-avatarmenu-header",{"fxs-avatarmenu-open":(0,i.toComputation)(t.dropMenuOptions.isMenuOpen)}],title:t.tooltip,onTouchStart:f,onMouseDown:f,onTouchEnd:p,onMouseUp:p},s("div",{className:"fxs-avatarmenu-tenant-container"},s("div",{className:"fxs-avatarmenu-username"},t.displayName),s("div",{className:"fxs-avatarmenu-tenant"},t.tenantDisplayName)),s("div",{className:"fxs-avatarmenu-tenant-image-container"},s("img",{className:"fxs-avatarmenu-tenant-image",src:m,alt:""}),t.userIdentity.compose((e=>e?.gitHubUserId?s("img",{className:"fxs-avatarmenu-tenant-image-overlay",src:MsPortalFx.Base.Resources.getVersionlessContentUri("Content/static/MsPortalImpl/AvatarMenu/badge_github.png"),alt:""}):"")))),g=s("div",{className:"fxs-flyout"});return s(n.GetContext,{fn:({diContainer:e})=>s("div",{className:["fxs-avatarmenu",l],afterMount:(s,o)=>{c=()=>{d&&Date.now()-d>t.showDiagnosticsDelay&&MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((o=>{o.showDebugPrompt(e,s,t)})),d=0},o.registerForDispose((()=>c=null))}},s(o.DropMenuInner,{vm:t.dropMenuOptions,buttonLabel:(0,n.composeComputation)([t.displayName,t.tenantDisplayName],((e,t)=>`${r.AvatarMenu.label} ${t?r.AvatarMenu.userWithTenantLabel.format(e,t):r.AvatarMenu.userLabel.format(e)}`)),button:h,content:g}))});function f(){d=Date.now()}}})),
define("_generated/MsPortalImpl/Svg/Startup/Close.svg",["require","exports"],(function(e,t){"use strict";return{type:55,data:"<svg viewBox='0 0 15.8 15.8' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m8.7 7.9 7.1 7.1-.8.8-7.1-7.1-7.1 7.1L0 15l7.1-7.1L0 .8.8 0l7.1 7.1L15 0l.8.8z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Search.svg",["require","exports"],(function(e,t){"use strict";return{type:248,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m10.5 0 1.5.2a3.8 3.8 0 0 1 1.3.6l1.1.8.9 1.1a6.9 6.9 0 0 1 .5 1.3 7.7 7.7 0 0 1 .2 1.5 7.7 7.7 0 0 1-.2 1.5 6.9 6.9 0 0 1-.5 1.3l-.9 1.1-1.1.9-1.3.5-1.5.2a5.8 5.8 0 0 1-1.9-.3 5.4 5.4 0 0 1-1.6-1L.9 15.9H.1a.8.8 0 0 1 0-.8L6.3 9a5.4 5.4 0 0 1-1-1.6A5.8 5.8 0 0 1 5 5.5 7.7 7.7 0 0 1 5.2 4a3.8 3.8 0 0 1 .6-1.3 4.4 4.4 0 0 1 .8-1.1L7.7.8A3.8 3.8 0 0 1 9 .2zm0 10a3.9 3.9 0 0 0 1.8-.4 4.2 4.2 0 0 0 1.4-.9 4.2 4.2 0 0 0 .9-1.4 3.9 3.9 0 0 0 .4-1.8 3.3 3.3 0 0 0-.4-1.7 3.8 3.8 0 0 0-.9-1.5 4.2 4.2 0 0 0-1.4-.9 3.9 3.9 0 0 0-1.8-.4 3.3 3.3 0 0 0-1.7.4 3.8 3.8 0 0 0-1.5.9 3.8 3.8 0 0 0-.9 1.5A3.3 3.3 0 0 0 6 5.5a3.9 3.9 0 0 0 .4 1.8 4.2 4.2 0 0 0 .9 1.4 3.8 3.8 0 0 0 1.5.9 3.3 3.3 0 0 0 1.7.4z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.Search.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Weave/Util","FxInternal/Weave","Weave","_generated/MsPortalImpl/Svg/Startup/Search.svg","_generated/MsPortalImpl/Svg/Startup/Close.svg"],(function(e,t,s,o,i,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Search=void 0,t.Search=function(e){const{vm:t,className:c}=e,d=o.KeyboardShortcuts.search,p=(0,n.toComputation)(t.filter).compose(i.negation),u=MsPortalFx.isFeatureEnabled("asyncsearch")||MsPortalFx.isFeatureEnabled("globalsearch")?o.Search.globalPlaceholder:o.Search.placeholder,m=new r.ElementRef;return s("div",{className:["fxs-search",c,{"fxs-search-activated":t.isExpanded,"fxs-search-showmenu":(0,n.toComputation)(t.showMenu)}],role:"search"},s("div",{className:["fxs-search-wrapper",{"fxs-searching":(0,n.toComputation)(t.showSearching)}]},s("div",{"aria-hidden":"true",className:"fxs-search-icon-mini",image:a}),s("div",{className:"fxs-search-box fxs-topbar-input"},s("input",{"aria-autocomplete":"list",type:"text",className:"azc-input","aria-label":u,placeholder:u,autocomplete:"off",maxlength:100,ref:m})),s("div",{className:"fxs-search-indicator"},s("div",null),s("div",null),s("div",null)),s("div",{role:"presentation",className:["fxs-search-clear",{"fxs-display-none":p}],image:l})),s("a",{href:"#",className:"fxs-search-icon fxs-topbar-button",role:"button",title:d,"aria-label":d,image:a,onFocus:h,onMouseDown:h}),s("div",{className:"fxs-search-menu fxs-dropmenu-content fxs-portal-background msportalfx-shadow-level4"}));function h(e){e.event.preventDefault(),t.isExpanded(!0),m.focus()}}})),
define("MsPortalImpl/Resources/PortalNotificationsTelemetry",["require","exports"],(function(e,t){"use strict";var s,o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.ActionModifier=t.ActionModifierInternal=t.Action=t.ActionInternal=t.Source=void 0,function(e){e.HatsHelper="HatsHelper",e.HaTSurvey="HaTSurvey",e.NotificationHub="NotificationHub",e.PortalNotifications="PortalNotifications",e.ToastTray="ToastTray",e.UIActionableNotifications="UI.ActionableNotifications",e.UpdateContactabilityDialog="UpdateContactabilityDialog"}(s||(s={})),t.Source=s,function(e){e.AdvisorNotificationShown="AdvisorNotificationShown",e.ConvertedLinksInNotificationDescription="ConvertedLinksInNotificationDescription",e.CopilotButtonClicked="CopilotButtonClicked",e.CopilotButtonAdded="CopilotButtonAdded",e.CopilotToastClicked_ManageAccess="CopilotToastClicked_ManageAccess",e.CopilotToastDismissed="CopilotToastDismissed",e.CopilotToastLaunched="CopilotToastLaunched",e.CopilotToastLoaded="CopilotToastLoaded",e.CopilotToastNotLaunched="CopilotToastNotLaunched",e.CopilotToastShown="CopilotToastShown",e.CustomOverrideFailed="CustomOverrideFailed",e.DeprecatedNotificationApiCalled="DeprecatedNotificationApiCalled",e.DevSATDismissed="DevSATDismissed",e.DevSATLaunched="DevSATLaunched",e.DevSATNotShown="DevSATNotShown",e.DevSATShown="DevSATShown",e.ExtensionDisposed="ExtensionDisposed",e.ExtensionExtended="ExtensionExtended",e.FeedbackClicked="FeedbackClicked",e.FetchHatsExtensionTasks="FetchHatsExtensionTasks",e.FrameworkSurveys_SATCloseClicked="FrameworkSurveys_SATCloseClicked",e.FrameworkSurveys_SATDismissed="FrameworkSurveys_SATDismissed",e.FrameworkSurveys_SATScoreClicked="FrameworkSurveys_SATScoreClicked",e.FrameworkSurveys_SATSubmitFailed="FrameworkSurveys_SATSubmitFailed",e.FrameworkSurveys_SATSubmitted="FrameworkSurveys_SATSubmitted",e.FrameworkSurveys_LaunchingHatsFromSATToast="FrameworkSurveys_LaunchingHatsFromSATToast",e.HatsFailedToSetLastTimeShownSetting="HatsFailedToSetLastTimeShownSetting",e.FrameworkSurveys_SATLoaded="FrameworkSurveys_SATLoaded",e.FrameworkSurveys_SATNeverLoaded="FrameworkSurveys_SATNeverLoaded",e.HatsPaneDismissed="HatsPaneDismissed",e.HatsPaneOpened="HatsPaneOpened",e.LaunchingHatsFromNPS="LaunchingHatsFromNPS",e.InProgressNotification="InProgressNotification",e.IrisNotification="IrisNotification",e.IrisAdvisor="IrisAdvisor",e.IrisBillingDownload="IrisBillingDownload",e.ModalDialogDismissed="ModalDialogDismissed",e.ModalDialogOpened="ModalDialogOpened",e.NotificationApiCalled="NotificationApiCalled",e.NotificationClicked="NotificationClicked",e.NotificationDismissAllClicked="NotificationDismissAllClicked",e.NotificationDismissedFromPane="NotificationDismissedFromPane",e.NotificationMenuClosed="NotificationMenuClosed",e.NotificationMenuOpen="NotificationMenuOpen",e.NotificationMoreEventsLinkClicked="NotificationMoreEventsLinkClicked",e.NPSAdminPolicies="NPSAdminPolicies",e.NPSCloseClicked="NPSCloseClicked",e.NPSDismissed="NPSDismissed",e.NPSScoreClicked="NPSScoreClicked",e.NPSShown="NPSShown",e.NPSNeverShown="NPSNeverShown",e.NPSSubmitFailed="NPSSubmitFailed",e.NPSSubmitted="NPSSubmitted",e.PollingNotification="PollingNotification",e.PrivacyPolicyClick="PrivacyPolicyClick",e.RecommendationAdded="RecommendationAdded",e.RecommendationClicked="RecommendationClicked",e.RecommendationSurfaced="RecommendationSurfaced",e.SatisfactionAreaClicked="SatisfactionAreaClicked",e.SatisfactionOverallClicked="SatisfactionOverallClicked",e.ServerEventMappedToNotification="ServerEventMappedToNotification",e.ServiceHealthAlertNotification="ServiceHealthAlertNotification",e.ToastAdded="ToastAdded",e.ToastClicked="ToastClicked",e.ToastDismissed="ToastDismissed",e.UpdateContactabilityCountryInfo="UpdateContactabilityCountryInfo",e.UpdateContactabilityCheckboxChanged="UpdateContactabilityCheckboxChanged",e.UpdateContactabilityUpdateEmailClick="UpdateContactabilityUpdateEmailClick"}(o||(t.ActionInternal=o={})),t.Action=o,function(e){e.ActionsBeaconCall="ActionsBeaconCall",e.ActionsBeaconCallFailed="ActionsBeaconCallFailed",e.ActionsBeaconCallSuccess="ActionsBeaconCallSuccess",e.AdvisorNotificationReceived="AdvisorNotificationReceived",e.BillingDownloadNotificationReceived="BillingDownloadNotificationReceived",e.Cancelled="Cancelled",e.Completed="Completed",e.ContactabilityNotificationReceived="ContactabilityNotificationReceived",e.ControlNotificationReceived="ControlNotificationReceived",e.ExtensionHasNoSurveyTasks="ExtensionHasNoSurveyTasks",e.ExtensionMissingTasks="ExtensionMissingTasks",e.FailedToFetchNotificationsFromStorage="FailedToFetchNotificationsFromStorage",e.FailedToTransferStoredNotification="FailedToTransferStoredNotification",e.FailedToWriteNotificationsToStorage="FailedToWriteNotificationsToStorage",e.FeedbackDislike="FeedbackDislike",e.FeedbackLike="FeedbackLike",e.FrameworkSurveys_SATNotLoaded="FrameworkSurveys_SATNotLoaded",e.FrameworkSurveys_SATScoreInvalid="FrameworkSurveys_SATScoreInvalid",e.FrameworkSurveys_SATScoreValid="FrameworkSurveys_SATScoreValid",e.HatsPaneFailed="HatsPaneFailed",e.HatsPaneLaunched="HatsPaneLaunched",e.ImpressionsBeaconCall="ImpressionsBeaconCall",e.ImpressionsBeaconCallFailed="ImpressionsBeaconCallFailed",e.ImpressionsBeaconCallSuccess="ImpressionsBeaconCallSuccess",e.IncorrectlyStoredPollingNotificationData="IncorrectlyStoredPollingNotificationData",e.InProgressFinished="InProgressFinished",e.InProgressStarted="InProgressStarted",e.InvalidBillingDownloadContent="InvalidBillingDownloadContent",e.InvalidIrisTelemetryUri="InvalidIrisTelemetryUri",e.Mark="Mark",e.NoExtensionTaskMatches="NoExtensionTaskMatches",e.NotificationNotShown_BillingAccountInvoiceList="NotificationNotShown_BillingAccountInvoiceList",e.NotificationNotShown_BillingDownloadFailed="NotificationNotShown_BillingDownloadFailed",e.NotificationNotShown_InvalidContent="NotificationNotShown_InvalidContent",e.NotificationNotShown_InvalidGetPollUriStatus="NotificationNotShown_InvalidGetPollUriStatus",e.NotificationNotShown_InValidNotificationType="NotificationNotShown_InValidNotificationType",e.NotificationNotShown_LoadBillingDownloadHelperFailed="NotificationNotShown_LoadBillingDownloadHelperFailed",e.NotificationNotShown_NoNotificationsOrCultureMismatch="NotificationNotShown_NoNotificationsOrCultureMismatch",e.NotificationNotShown_NoTitleOrDescription="NotificationNotShown_NoTitleOrDescription",e.NotificationNotShown_NoValidInvoicesInList="NotificationNotShown_NoValidInvoicesInList",e.NotificationNotShown_PollingForBillingDownloadUriFailed="NotificationNotShown_PollingForBillingDownloadUriFailed",e.NotificationNotShown_SubscriptionInvoiceList="NotificationNotShown_SubscriptionInvoiceList",e.NotificationDismissed="NotificationDismissed",e.NotificationShown="NotificationShown",e.NPSNotShown="NPSNotShown",e.NPSScoreInvalid="NPSScoreInvalid",e.NPSScoreValid="NPSScoreValid",e.PoliciesFetched="PoliciesFetched",e.PoliciesFetchFailed="PoliciesFetchFailed",e.PollingError="PollingError",e.PollingFailed="PollingFailed",e.PollingNotificationNotFound="PollingNotificationNotFound",e.PollingRegistered="PollingRegistered",e.PollingTimedOut="PollingTimedOut",e.PublishIrisNotification="PublishIrisNotification",e.SATScoreValid="SATScoreValid",e.SmallModalsHidden="SmallModalsHidden",e.UpdateEmailFailed="UpdateEmailFailed",e.UpdateEmailSucceeded="UpdateEmailSucceeded"}(i||(t.ActionModifierInternal=i={})),t.ActionModifier=i})),
define("MsPortalImpl/Notifications/IrisNotificationsTelemetry",["require","exports","Fx/Ajax","FxHubs/RpcEndPoints","Fx/DependencyInjection","MsPortalImpl/Resources/PortalNotificationsTelemetry","FxInternal/AsyncLoader"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.irisTelemetryHandler=t.IrisNotificationsTelemetry=t.scrapeIrisValue=t.replaceActionWithAction=void 0;var a=MsPortalFx.Base.Diagnostics,l=a.Telemetry;const c=a.createLog(e);function d(e,t){return t.includes("{ACTION}")?t.replace("{ACTION}",encodeURIComponent(e)):(m(n.Action.IrisNotification,n.ActionModifier.InvalidIrisTelemetryUri,{originalAction:e,originalUri:((t||"").split("?")[0]||"")+""+(t.includes("?")?"?_QUERY_PARAMS_REDACTED_":"")}),"")}function p(e,t){const s=((e||"").split("?")[1]||"").split("&").filter((e=>!!e));for(let e=0;e<s.length;e++){const o=s[e].split("=");if((o[0]||"").toLowerCase()===t)return o[1]||""}return""}t.replaceActionWithAction=d,t.scrapeIrisValue=p;let u=class{constructor(){this._irisMessageLimit=Number(MsPortalFx.getFeatureValue("irismessagelimit")||1)}_logIrisNotificationTelemetry(e){const t=(e=e||{}).action,o=e.irisNotificationDetails;if(t&&o){const e=o.actionBeaconUri,i=o.impressionsUri,r=t===n.ActionModifier.NotificationShown||t===n.ActionModifier.ControlNotificationReceived?n.ActionModifier.ImpressionsBeaconCall:n.ActionModifier.ActionsBeaconCall,a=r===n.ActionModifier.ImpressionsBeaconCall?i:d(t,e||"");let l;try{l=new URL(a).host}catch(e){return c.error(`Invalid telemetryUri. (telemetryUri=${a})`),Promise.reject(`Invalid telemetryUri. ${MsPortalFx.getLogFriendlyMessage(e)}`)}const u={actionASID:p(e,"asid"),actionPID:p(e,"pid"),impressionASID:p(i,"asid"),impressionPID:p(i,"pid"),messageLimit:this._irisMessageLimit,originalModifier:t,notificationId:o?.notificationId,beaconHost:l};return m(n.Action.IrisNotification,t,u),(0,s.ajax)({type:"POST",uri:MsPortalFx.Base.Resources.getAppRelativeUri("/api/iris/beacon"),isBackgroundTask:!0,setAuthorizationHeader:!0,headers:{Accept:"application/json","x-ms-correlation-id":MsPortalFx.newGuid(),"Content-Type":"application/json","x-ms-tracking-id":MsPortalFx.newGuid()},data:JSON.stringify({beaconUri:a})}).then((()=>{const e=r+"Success";m(n.Action.IrisNotification,e,u)})).catch((e=>{const t=r+"Failed";u.error=JSON.stringify(e?.jqXHR),m(n.Action.IrisNotification,t,u)}))}}logIrisNotificationTelemetry(e){return this._logIrisNotificationTelemetry(e)}};function m(e,t,s){l.trace({source:n.Source.PortalNotifications,action:e,actionModifier:t,data:s||{}})}t.IrisNotificationsTelemetry=u,t.IrisNotificationsTelemetry=u=__decorate([__metadata("fx:diagnostics",[e,"IrisNotificationsTelemetry"]),(0,i.Class)("")],u),t.irisTelemetryHandler=(0,r.defineHandler)(o.Impl.irisTelemetryEndpoint,(e=>{e.diContainer.get(u).logIrisNotificationTelemetry(e.messageArg)}))})),
define("MsPortalImpl/Weave/Components",["require","exports","Weave","WeaveDOM/Core/InternalUtil","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Weave/Util"],(function(e,t,s,o,i,n){"use strict";function r(e){return"string"==typeof e.content?a(e.content,e.require,e.skipSanitization||!1):e.content?e.content.compose((t=>a(t,e.require,e.skipSanitization||!1))):void 0}function a(e,t,s){return{type:"html",data:{content:e,moduleName:t.normalize(),skipSanitization:s}}}function l(e){return{type:"external",applyBindingHandler:d,content:e.content,skipSanitization:e.skipSanitization||!1}}function c(e,t,s){return e?"string"==typeof e?s?e:r({skipSanitization:!1,content:e,require:t}):l({skipSanitization:!1,content:e,require:t}):null}function d(t,r,a){const l=r.dynamicNodeId,c=this.skipSanitization,d=t.getDynamicNodeMetadata(l),u=d.selfLtm.innerLtmRoot,{commentStart:m,commentEnd:h}=d;let g;(0,s.subscribeAndRun)(u,[this.content],(s=>{if(g&&g.dispose(),g=u.createChildLifetime(),p(m,h),t.clear(r),s&&s.htmlTemplate){const t=c?s.htmlTemplate:a.diContainer.get(i.KOAllowedTemplateSanitizer).sanitize({value:s.htmlTemplate,localRequire:e,windowContext:$(m.parentElement),diContainer:a.diContainer,contextData:{weaveCommentNodeText:d.commentStart.textContent}}).sanitizedMarkup;(0,o.insertHtmlBeforeNode)(h,t),function(e,t,s,o){if(ko.isObservable(t)){let i;t.subscribeAndRun(e,(t=>{if(i&&i.dispose(),i=e.createChildLifetime(),ko.isObservable(t)){let e;t.subscribeAndRun(i,(t=>{e&&e.dispose(),e=i.createChildLifetime(),o((0,n.weaveContextToKoContext)(s,e,t))}))}else o((0,n.weaveContextToKoContext)(s,i,t))}))}else o((0,n.weaveContextToKoContext)(s,e,t))}(g,s.viewModel,a,(e=>{p(m,h),function(e,t,s){const i=t.nextSibling;let n=i;const r=ko.bindingProvider.instance,a=r.preprocessNode;if(a){for(;n&&n!==s;){const e=ko.virtualElements.nextSibling(n);a.call(r,n),n=e}n=i}for(;n&&n!==s;){const t=ko.virtualElements.nextSibling(n);((0,o.isNodeType)(n,1)||(0,o.isNodeType)(n,8))&&ko.applyBindings(e,n),n=t}}(e,m,h)}))}})),u.registerForDispose((()=>{p(m,h)}))}function p(e,t){let s=e.nextSibling;for(;s!==t;){const e=s.nextSibling;ko.cleanNode(s),s=e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TextOrKo=t.HtmlOrKo=t.Ko=t.ShellHtml=void 0,t.ShellHtml=r,t.Ko=l,t.HtmlOrKo=function(e){return(0,s.isComputation)(e.content)?e.content.compose((t=>c(t,e.require,!1))):c(e.content,e.require,!1)},t.TextOrKo=function(e){return(0,s.isComputation)(e.content)?e.content.compose((t=>c(t,e.require,!0))):c(e.content,e.require,!0)}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ModalToast.css",["module"],(function(e){"use strict";return{css:".fxs-modaltoast-item{position:absolute;top:50%;left:50%;padding:24px;transform:translate(-50%,-50%);width:400px;border-radius:2px;overflow-y:auto;max-width:calc(90% - 32px);max-height:calc(90% - 32px)}.fxs-modaltoast-modalimage{padding-top:8px;padding-bottom:12px}.fxs-modaltoast-description{padding-bottom:12px;width:100%}.fxs-modaltoast-title{font-size:18px;font-weight:600;width:100%;padding-bottom:4px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.fxs-modaltoast-inlineform{text-align:center}.fxs-modaltoast-inlineform .fxc-section{display:flex}.fxs-modaltoast-inlineform .fxc-simplebutton{margin-right:5px}.fxs-modaltoast-inlineform .fxc-simplebutton .fxs-button{display:inline-flex;max-width:100%}.fxs-modaltoast-inlineform .fxs-button-text{display:inline-block;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-modaltoast-close{position:absolute;top:8px;right:8px;background:none;border:0;cursor:pointer}.fxs-modaltoast-close svg{height:12px;width:12px}.fxs-mode-dark .fxs-modaltoast-close{background-color:#323130}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.ModalToast",["require","exports","Weave/DirectMode","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.DismissHandler","_generated/Less/MsPortalImpl/Widgets/Widgets.ModalToast.css","Weave","MsPortalImpl/Weave/Components","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,s,o,i,n,r,a,l){"use strict";let c;Object.defineProperty(t,"__esModule",{value:!0}),t.ModalToast=void 0;const d="msportalfx-modalimage-hideonzoom";t.ModalToast=function(t){const{vm:p}=t,u=p.modalToast;let m;const h={dismissFn:()=>{g()},logName:"modalToast"},g=()=>{m.dispose(),i.unregister(h);const e=u.value;e&&e.onDismissFn&&e.onDismissFn(!1),c.focus()};return i.register(h),s("div",{className:"fxs-portal-shield"},s(r.Css,{css:n}),s("div",{className:"fxs-portal-modaltoast",role:"presentation",afterMount:(e,t)=>{m=new o.KeyboardNavigation(t,{element:$(e)}),c=$(document.activeElement);const s=$(e).find(".fxs-modaltoast-description").findFirstTabbable();if(s.length>0)return s.focus();const i=$(e).find(".fxs-modaltoast-inlineform").findFirstTabbable();i.length>0?i.focus():$(e).findFirstTabbable().focus()}},s(r.If,{condition:u,trueFn:()=>s("div",{className:"fxs-modaltoast-item fxs-portal-bg-txt-br fxs-popup msportalfx-shadow-level3",style:{width:u.value.modalNotificationData?.width||"400px"}},s("button",{tabindex:0,className:"fxs-modaltoast-close fxs-portal-svg fxs-button-default","aria-label":l.ModalToast.closeModal,image:MsPortalFx.Base.Images.Close(),onClick:({event:e})=>{g(),e.preventDefault()},title:l.NotificationMenu.dismissModalToast},l.NotificationMenu.dismissModalToast),s(r.If,{condition:u.compose((e=>e.modalNotificationData?.image?.imageUrl)),trueFn:()=>{const e=u.value.modalNotificationData.image;return s("div",{className:"fxs-modaltoast-modalimage",afterMount:(e,t)=>{const s=$(e);if(s.children("img").hasClass(d)){let e=0,o=0;const i=new ResizeObserver((t=>{if((0===e&&s.outerHeight()>0||e<s.outerHeight())&&(e=s.outerHeight()),e>0){const e=t[0].target.clientHeight,i=document.querySelector(".fxs-modaltoast-item");i.scrollHeight>i.clientHeight&&(0===o&&(o=i.scrollHeight),s.attr("hidden",!0)),.9*e>o+32&&s.attr("hidden",!1)}}));i.observe(document.body),t.registerForDispose((()=>{i.unobserve(document.body)}))}}},s("img",{src:e.imageUrl,alt:e.alternativeText||"",className:!0===e.showOnZoom||"true"===e.showOnZoom?"":d,style:{width:e.imageWidth||"100%",height:e.imageHeight||"auto"},role:"image"}))}}),s("div",{className:"fxs-modaltoast-title fxs-portal-text",tabindex:"-1"},u.compose((e=>e.title))),s("div",{className:"fxs-modaltoast-description fxs-portal-title",tabindex:"-1"},s(a.ShellHtml,{content:u.compose((e=>"string"==typeof e.description?e.description:e.description.htmlTemplate)),require:e})),u.compose((e=>e.formSection?e.formSection.section("msportalfx-form fxs-modaltoast-inlineform"):null)))})))}})),
define("MsPortalImpl/Widgets/Widgets.ModalToastViewModel",["require","exports","Weave"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewModel=void 0;t.ViewModel=class{constructor(){this.modalToast=(0,s.makeWritableComputation)()}addModalToast(e){if(!this.modalToast.value){this.modalToast(e);const t=e.formSection;if(t){const s=t.buttons;s.forEach(((t,o)=>{const i=s[o].onClick;s[o].onClick=()=>{i(),e.onDismissFn&&e.onDismissFn(!0,o)}}))}}}}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationsPane.css",["module"],(function(e){"use strict";return{css:"@keyframes fxs-notificationmenu-indeterminate-progress{from{left:-100%}to{left:150%}}.fxs-notificationspane-progressbar{position:absolute;overflow:hidden;height:2px;top:35px;left:1px;bottom:1px;right:1px;transition:opacity 1.5s ease-in-out 1s}.fxs-notificationspane-progressbar>div{position:absolute;width:60%;height:100%;animation:fxs-notificationmenu-indeterminate-progress 1.5s linear infinite;background-color:#00bcf2}.fxs-notificationspane-button-unreadcount{font-size:10px;position:absolute;top:5px;right:5px;border-radius:16px;text-align:center}.fxs-notificationspane-button-unreadcount-circle{height:16px;width:16px}.fxs-notificationspane-button-unreadcount-oval{width:28px}.fxs-notificationspane-header{padding:0 20px 10px}.fxs-notificationspane{width:525px;max-width:100%;height:100%;box-sizing:border-box;font-size:13px;line-height:normal;display:flex;flex-direction:column;overflow:hidden}.fxs-notificationspane-label{color:#fff;padding-bottom:3px}.fxs-notificationspane-top{overflow:auto;width:100%;padding:0 20px;box-sizing:border-box}.fxs-notificationspane-top .nodata-content{padding:15px 0;text-align:center;font-weight:bold;font-size:14px}.fxs-notificationspane-dismisscontainer{margin-left:auto;display:flex}.fxs-notificationspane-dismissitem{display:flex}.fxs-notificationspane-list{overflow:hidden;list-style:none;padding:0;margin:0;width:100%}.fxs-notificationmenu-notification-wrapper{padding:10px 5px 10px 10px;display:flex;position:relative}.fxs-notificationmenu-notification-li.fxs-portal-border{border-top-width:1px;border-top-style:solid}.fxs-notificationmenu-notification-li.fxs-portal-border:last-child{border-bottom-width:1px;border-bottom-style:solid}.fxs-notificationmenu-notificationclick:hover{text-decoration:underline}.fxs-notificationmenu-notification-dismissIcon{cursor:pointer;background-color:transparent;border:0;margin:0;padding:0;height:14px;width:10px;opacity:.4;margin-left:4px;padding-right:15px;padding-bottom:8px;flex:0 0 auto;position:absolute;top:8px;right:0;opacity:1}.fxs-notificationmenu-notification-dismissIcon svg{padding:5px}.fxs-mode-light .fxs-notificationmenu-notification-dismissIcon svg{fill:#605e5c}.fxs-notificationmenu-notification-expandIcon{cursor:pointer;background-color:transparent;border:0;margin:0;padding:0;height:8px;width:8px;opacity:.4}.fxs-notificationmenu-notification-dismissIcon:hover,.fxs-notificationmenu-notification-expandIcon:hover{opacity:1}.fxs-notificationmenu-notification-details{margin-top:10px;text-decoration:underline;cursor:pointer}.fxs-notificationmenu-notification-iconVerticalTransform{transform:scale(-1,-1);background-color:rgba(255,255,255,.3);padding-bottom:9px}.fxs-notificationmenu-notification-title{display:flex;padding-bottom:2px;max-width:calc(100% - 20px)}.fxs-notificationmenu-notification-title-icon{margin-right:4px;min-width:16px}.fxs-notificationmenu-notification-title-icon svg{height:16px;width:16px;vertical-align:middle}.fxs-notificationmenu-notification-title-text{font-size:14px;display:block;display:-webkit-box;line-height:19px;max-height:38px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow-wrap:break-word;margin:0 4px;flex:1 0 0;font-weight:600}.fxs-notificationmenu-notification-title-subtitle{font-size:13px;line-height:normal}.fxs-notificationmenu-notification-description{font-size:13px;line-height:normal;display:block;line-height:18px;max-height:144px;overflow:hidden;position:relative;padding-top:5px;text-overflow:ellipsis;white-space:pre-wrap;width:100%}.fxs-notificationmenu-notification-expandedDescription{max-height:100%;overflow-y:auto}.fxs-notification-inlineform{padding-top:15px}.fxs-notification-inlineform .fxc-section{display:flex}.fxs-notification-inlineform .fxc-simplebutton{display:grid;margin-right:5px}.fxs-notification-inlineform .fxc-simplebutton .fxs-button{display:inline-flex;max-width:100%}.fxs-notification-inlineform .fxs-button-text{display:inline-block;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-notification-inlineform:has(.ext-copilot-error-notification-icon) .fxs-button-icon{display:flex;height:20px;width:20px}.fxs-notificationmenu-notification-progressbar{margin-top:10px}.fxs-notification-dropdown-button-icon{height:14px;width:14px;display:flex;align-items:center;justify-content:center;cursor:pointer}.fxs-notification-dropdown-button-icon>svg{height:100%;width:100%}.fxs-notification-dropdown-button-container{display:flex;align-items:center}.fxs-notification-dropdown-button{margin:4px 5px 0;padding:4px 5px;opacity:.7;border:0;width:100%;text-align:left}.fxs-notifications-empty{display:flex;flex-direction:column;align-items:center;justify-content:center}.fxs-notifications-emptyicon{height:100px;width:100px;padding-top:40px;padding-bottom:20px;opacity:.4}.fxs-notification-header-content{display:flex;flex:1 1 auto;padding-top:15px}.fxs-notification-action-menu{margin-top:-5px}.fxs-notification-user-time-info{min-height:20px;padding-top:10px;text-decoration:#7a7a7a;display:flex}.fxs-notification-user-time-info .fxs-notification-user-time-info-part{margin-left:auto}.fxs-notification-user-time-info .fxs-notification-user-time-info-part:first-child{margin-left:0}.fxs-notification-seemore-link{display:flex;width:fit-content}.fxs-notification-feedback-wrapper{float:right;margin-left:auto;min-height:20px;padding-top:10px}.fxs-notification-is-this-helpful,.fxs-notification-thank-you{color:#292827;display:inline-flex;font-size:12px;font-weight:normal;line-height:15px}.fxs-notification-is-this-helpful{margin-right:6px}.fxs-notification-like-button,.fxs-notification-dislike-button{color:#0078d4;cursor:pointer;display:inline-block;fill:#0078d400;height:11px;margin:-1px 0 0 7px;stroke:#0078d4;width:13px;transform:scale(-1,1)}.fxs-notification-like-button:focus,.fxs-notification-dislike-button:focus{color:#106ebe;fill:#106ebe00;stroke:#106ebe;transform:scale(-1.1,1.1)}.fxs-notification-like-button:hover,.fxs-notification-dislike-button:hover{color:#106ebe;fill:#106ebe00;stroke:#106ebe;transform:scale(-1.1,1.1)}.fxs-notification-like-button.fxs-notification-feedback-selected,.fxs-notification-dislike-button.fxs-notification-feedback-selected{color:#106ebe;fill:#106ebe;stroke:#106ebe}.fxs-notification-dislikeButton{margin:3px 0 0 14px}.fxs-notification-hide{display:none}.fxs-notification-see-more-less{padding-right:5px}.fxs-notificationmenu-notification{width:100%}.fxs-notificationmenu-arrow{padding-top:2px;padding-left:3px;height:10px;width:10px}",moduleId:e.id}})),
define("MsPortalImpl/UI/Hubs/UI.NotificationHelper",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.ModalToastViewModel","MsPortalImpl/Widgets/Widgets.ModalToast","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Notifications/IrisNotificationsTelemetry","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Weave/Components","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationsPane.css"],(function(e,t,s,o,i,n,r,a,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.updateNotificationCount=t.showToastAndUpdateCount=t.updateUnreadCountOnButton=t.constructDescription=t.iconMap=void 0,(0,d.injectCss)(p);var u=MsPortalFx.Base,m=u.Diagnostics,h=u.Images.StatusBadge,g=MsPortalFx.Hubs.Notifications.NotificationStatus;const f=m.createLog(e),x="fxs-notificationspane-button-unreadcount",b="fxs-notificationspane-button-unreadcount-oval",y="fxs-notificationspane-button-unreadcount-circle";t.iconMap={},t.iconMap[g.Information]=h.Info(),t.iconMap[g.Warning]=h.Warning(),t.iconMap[g.Error]=h.Error(),t.iconMap[g.InProgress]=u.Images.Loading.EllipsisSquare(),t.iconMap[g.Success]=h.Success();let v=0,M=0,C=!1;const P=MsPortalFx.isFeatureEnabled("enablecustomnotificationsprovider");function w(e,t,s,o){const i=t.irisNotificationDetails;i?(0,a.irisTelemetryHandler)({diContainer:e,messageArg:{irisNotificationDetails:i,action:s},messageContext:null}):m.Telemetry.trace({source:o,action:s,data:{notificationId:t.notificationId}})}function I(e){const t=$.querySelectorAll(".fxs-topbar-notifications");M=e,t.attr("aria-label",s.NotificationMenu.overflowTitle.format(e)),t.find(`.${x}`).remove(),e>20?t.append(FxImpl.createElement("div",{class:`${x} ${b}`},MsPortalFx.encodeHtml(s.NotificationMenu.overflowCountMessage))):e&&t.append(FxImpl.createElement("div",{class:`${x} ${y}`},e+""))}t.constructDescription=function(t,s){return"string"==typeof t?s?(0,c.ShellHtml)({skipSanitization:!1,content:t,require:e}):t:(0,c.ShellHtml)({skipSanitization:!1,content:t.htmlTemplate,require:e})},t.updateUnreadCountOnButton=I,t.showToastAndUpdateCount=function(e,a,c,d){if(3===a.status&&(v++,(0,o.unhide)($.querySelectorAll(".fxs-topbar-notifications>.fxs-notificationspane-progressbar"))),4===a.toastDuration){if(!C){C=!0;const t=new i.ViewModel,s=new FxImpl.TriggerableLifetimeManager;return t.addModalToast({modalNotificationData:a.modalNotificationData,title:a.title,description:a.description,formSection:a.formSection,onDismissFn:(t,o)=>{s.dispose(),w(e,a,t?r.Action.NotificationClicked+(a.inlineForm?.buttons[o]?.id||o):r.ActionModifier.NotificationDismissed,r.Source.ToastTray)}}),void(0,l.appendToElement)({element:$.querySelectorAll("body")[0],ltm:s,weaveContext:{diContainer:e},weaveNode:(0,n.ModalToast)({vm:t})})}f.warning(`Modal toast already shown. Showing current toast as sticky. Details: ${JSON.stringify(a.irisNotificationDetails)}; Correlation ids: ${a.correlationIds.join(",")}`)}c.isPaneOpen()?(a.inlineForm?.buttons||a.actions||[]).forEach((e=>{e.id=r.Action.NotificationClicked+e.id})):((a.inlineForm?.buttons||a.actions||[]).forEach((e=>{e.id=r.Action.ToastClicked+e.id})),!P&&a.timestamp.getTime()>=c.lastPaneOpenedTime()&&I(++M),d.addToasts({notificationId:a.notificationId,icon:t.iconMap[a.status],title:a.title,description:a.description||"",descriptionAsHtml:a.descriptionAsHtml,time:a.timestamp.toString({hour:"numeric",minute:"numeric"}),ids:a.correlationIds,descriptiveText:s.Toast.description.format(a.title),data:a,clickable:!!(a.asset||a.linkedBlade||a.uri||a.linkTo),formSection:a.formSection,duration:a.toastDuration,onDismissFn:()=>{w(e,a,r.Action.ToastDismissed,r.Source.ToastTray)},uri:a.uri}))},t.updateNotificationCount=function(e,t){!P&&!t.isPaneOpen()&&e.timestamp.getTime()>=t.lastPaneOpenedTime()&&M&&I(--M),3===e.status&&(--v||(0,o.hide)($.querySelectorAll(".fxs-topbar-notifications>.fxs-notificationspane-progressbar")))}})),
define("MsPortalImpl/Widgets/Widgets.ToastViewModel",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addToasts=t.ViewModel=t.clearItemTimeout=void 0;FxImpl.Hubs.Notifications.ToastDuration;function a(e){const t=e&&e.timeoutID;t&&clearTimeout(t.value)}t.clearItemTimeout=a;class l extends n.ViewModel{constructor(e={}){super(),this.items=(0,r.makeArrayComputation)(),this.eventHandlers=ko.observableArray(),this.addOSToast=null,this.displayCount=e.displayCount||4}static create(){return new l}addToasts(e){d(this,e)}removeToast(e){a(e),c(e),this.items.remove(e)}removeAllToasts(){this.items.value.forEach((e=>{a(e),c(e)})),this.items.clear()}startRemoveTimer(e){const t=e.duration?e.duration.value:0;2!==t&&e.timeoutID(setTimeout((()=>{this.items.remove(e),c(e)}),1===t?3e4:5e3))}}function c(e){const t=e?.data?.value||null,s=(t||Object.create(null)).inlineForm,i=(t||Object.create(null)).actions;(s?.buttons||i||[]).forEach((e=>{e.id&&e.id.startsWith(o.Action.ToastClicked)&&(e.id=o.Action.NotificationClicked+e.id.substring(o.Action.ToastClicked.length))}))}function d(e,t){const s=Array.isArray(t)?t:[t];s.length&&s.forEach((t=>{const s=e.items.value,n=t.icon,l=t.title,c=t.description,d=t.descriptionAsHtml,p=t.uri,u=t.time,m=t.ids||[],h=t.data||null,g=t.duration||0,f=t.htmlContent||"",x=!1!==t.clickable,b=t.descriptiveText||i.Toast.description.format(t.title),y=t.notificationId;if(3===g)return;let v;if(m.length>0&&(v=MsPortalFx.find(s,(e=>{const t=e.ids.value;return m.some((e=>t.indexOf(e)>-1))}))),v)v.icon(n),v.title(l),v.description(c),v.descriptionAsHtml(d),v.uri(p),v.time(u),v.ids(m),v.data(h),v.clickable(x),v.htmlContent(f),v.descriptiveText(b),v.duration(g),v.formSection(t.formSection),a(v),e.startRemoveTimer(v);else{const o={icon:(0,r.makeWritableComputation)(n),title:(0,r.makeWritableComputation)(l),description:(0,r.makeWritableComputation)(c),descriptionAsHtml:(0,r.makeWritableComputation)(d),uri:(0,r.makeWritableComputation)(p),time:(0,r.makeWritableComputation)(u),ids:(0,r.makeWritableComputation)(m),data:(0,r.makeWritableComputation)(h),htmlContent:(0,r.makeWritableComputation)(f),timeoutID:(0,r.makeWritableComputation)(null),clickable:(0,r.makeWritableComputation)(x),onDismissFn:t.onDismissFn,descriptiveText:(0,r.makeWritableComputation)(b),duration:(0,r.makeWritableComputation)(g),formSection:(0,r.makeWritableComputation)(t.formSection),notificationId:y};(s.length<e.displayCount||function(e,t){const s=e.items.value;for(let o=0;o<=t+0;o++)for(let t=s.length-1;t>=0;t--){const i=s[t];if(i.duration.value===o)return e.removeToast(i),!0}return!1}(e,g))&&e.items.unshift(o);const i=h||{},a=i.actions&&i.actions.slice(0,3)||i.inlineForm?.buttons&&i.inlineForm?.buttons.slice(0,3),v=t.formSection,M=v&&v.buttons&&v.buttons.slice(0,3);M?.length&&a&&MsPortalFx.isArrayOrObservableArray(a)&&a.forEach(((t,s)=>{if(!t.endpoint){const t=M[s].onClick;M[s].onClick=()=>{t(),e.removeToast(o)}}})),e.startRemoveTimer(o)}MsPortalFx.Base.Diagnostics.Telemetry.trace({source:o.Source.ToastTray,action:o.Action.ToastAdded,data:{notificationId:y}}),e.addOSToast&&e.addOSToast(t)}))}t.ViewModel=l,__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),(0,s.Factory)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",l)],l,"create",null),t.addToasts=d})),
define("MsPortalImpl/Widgets/Widgets.Toast.Component",["require","exports","MsPortalImpl/Widgets/Widgets.ToastViewModel","Weave/DirectMode","_generated/MsPortalImpl/Svg/Startup/Close.svg","MsPortalImpl/Resources/PortalNotificationsTelemetry","WeaveDOM/DirectRender/DataAttribute","Weave","FxInternal/Weave/Util","FxInternal/Weave","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Weave/Components","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","MsPortalImpl/UI/Hubs/UI.NotificationHelper"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Toast=void 0,(0,m.injectCss)(h);var f=n.Source,x=n.Action;t.Toast=function(t){const n=MsPortalFx.getFeatureValue("rapidtoasts");if("0"===n||"true"===n)return null;const{vm:m,className:h}=t;return o(a.GetContext,{fn:({diContainer:t})=>{const n=(0,c.toComputation)(t.get(d.GeneralSettings).notificationToastEnabledKey);return o(a.Once,{"data-odebug":"22",condition:(0,a.composeComputation)([n,m.items],((e,t)=>e&&t&&t.length>0)),trueFn:()=>o("div",{role:"presentation",className:h,afterMount:(e,t)=>{const s=$(e);m.eventHandlers.map(t,((e,t)=>{e.registerForDispose(s.setEvents([t.events,t.selector,e=>t.handler(e,(0,r.getElementData)($(e.target).closest(".fxs-toast-item")[0]))]))}))}},o("ul",{role:"presentation",className:["fxs-toast",{"fxs-display-none":n.compose(l.negation)}]},o(a.ForEach,{collection:m.items,fn:({item:t})=>{const n=()=>(0,s.clearItemTimeout)(t),r=()=>t.duration&&m.startRemoveTimer(t);return o("li",{data:t,className:"fxs-toast-item fxs-popup fxs-portal-bg-txt-br msportalfx-shadow-level4",role:"alert","aria-live":"polite","aria-atomic":"true","aria-label":t.descriptiveText,onFocusIn:n,onFocusOut:r,onMouseEnter:n,onMouseLeave:r},o(a.If,{condition:t.htmlContent,concealmentBehavior:"remove",trueFn:()=>o("div",{className:"fxs-toast-content","aria-hidden":"true"},o(u.ShellHtml,{content:t.htmlContent,skipSanitization:!0,require:e})),falseFn:()=>o("div",{className:"fxs-toast-wrapper"},o("div",{className:"fxs-toast-header"},o("div",{className:"fxs-toast-icon",image:t.icon}),o(a.If,{condition:t.clickable,concealmentBehavior:"remove",trueFn:()=>o("a",{href:"#",className:"fxs-toast-title fxs-toast-link",onClick:({event:e})=>{e.preventDefault(),t.clickable.value&&(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:f.ToastTray,action:x.ToastClicked,data:{notificationId:t.notificationId||t.data&&t.data.value.notificationId}}),$(e.currentTarget).trigger("fxtoastclick"),m.removeToast(t))}},t.title),falseFn:()=>o("div",{className:"fxs-toast-title fxs-portal-text"},t.title)})),o("div",{className:"fxs-toast-description fxs-portal-title"},t.description.compose((e=>(0,g.constructDescription)(e,t.descriptionAsHtml.value)))),t.formSection?t.formSection.compose((e=>e?e.section("msportalfx-form fxs-notification-inlineform"):null)):null)}),o("button",{className:"fxs-toast-close fxs-portal-svg","aria-label":p.NotificationMenu.dismissToast,image:i,title:p.NotificationMenu.dismissToast,onClick:({event:e})=>{e.preventDefault(),t.onDismissFn?t.onDismissFn():MsPortalFx.Base.Diagnostics.Telemetry.trace({source:f.ToastTray,action:x.ToastDismissed,data:{notificationId:t.notificationId}}),m.removeToast(t)}}))}})))})}})}})),
define("_generated/MsPortalImpl/Svg/Internal/AzureCopilot.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 17 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M12.17 1.99A1.46 1.46 0 0 0 10.788 1h-.9c-.701 0-1.303.499-1.433 1.188l-.931 4.945.463-1.584a1.458 1.458 0 0 1 1.4-1.049h2.878l1.244 1.629L14.617 4.5h-.552c-.624 0-1.18-.398-1.38-.99l-.516-1.52Z' fill='url(#1dfd8642-43b8-497c-830f-9664b714cd4f)'/><path d='M5.003 14.004c.199.595.756.996 1.383.996h1.466c.796 0 1.445-.638 1.458-1.434l.073-4.431-.385 1.317a1.458 1.458 0 0 1-1.4 1.048h-2.89l-1.23-1.085L2.57 11.5h.547c.628 0 1.184.401 1.383.996l.503 1.508Z' fill='url(#72bc9312-6c81-420d-93fe-5c78e7c10a4d)'/><path d='M10.5 1H4.668C3 1 2 3.202 1.334 5.405c-.79 2.609-1.823 6.099 1.167 6.099h2.69c.65 0 1.223-.431 1.402-1.058a769.97 769.97 0 0 1 1.855-6.402c.306-1.034.561-1.922.953-2.474.22-.31.585-.57 1.1-.57Z' fill='url(#d26909eb-6976-40f8-bab9-c9f1a0b03832)'/><path d='M10.5 1H4.668C3 1 2 3.202 1.334 5.405c-.79 2.609-1.823 6.099 1.167 6.099h2.69c.65 0 1.223-.431 1.402-1.058a769.97 769.97 0 0 1 1.855-6.402c.306-1.034.561-1.922.953-2.474.22-.31.585-.57 1.1-.57Z' fill='url(#1934dfaa-452b-457a-b1f7-d9d3fbe09e3f)'/><path d='M6.5 15h5.832C14 15 15 12.798 15.665 10.596c.79-2.61 1.824-6.098-1.166-6.098h-2.69c-.651 0-1.223.43-1.402 1.057a771.726 771.726 0 0 1-1.855 6.401c-.306 1.034-.561 1.922-.953 2.475-.22.31-.586.569-1.1.569Z' fill='url(#4173e6ac-4e7c-49b9-9b62-0b65b4157795)'/><path d='M6.5 15h5.832C14 15 15 12.798 15.665 10.596c.79-2.61 1.824-6.098-1.166-6.098h-2.69c-.651 0-1.223.43-1.402 1.057a771.726 771.726 0 0 1-1.855 6.401c-.306 1.034-.561 1.922-.953 2.475-.22.31-.586.569-1.1.569Z' fill='url(#ddebd8ac-abb5-47aa-80d7-51a01fe69279)'/><defs><radialGradient id='1dfd8642-43b8-497c-830f-9664b714cd4f' cx='0' cy='0' r='1' gradientUnits='userSpaceOnUse' gradientTransform='rotate(-128.772 8.512 .33) scale(6.41931 6.01261)'><stop offset='.096' stop-color='#00AEFF'/><stop offset='.773' stop-color='#2253CE'/><stop offset='1' stop-color='#0736C4'/></radialGradient><radialGradient id='72bc9312-6c81-420d-93fe-5c78e7c10a4d' cx='0' cy='0' r='1' gradientUnits='userSpaceOnUse' gradientTransform='matrix(3.56223 4.4232 -4.3144 3.4746 3.806 11.066)'><stop stop-color='#FFB657'/><stop offset='.634' stop-color='#FF5F3D'/><stop offset='.923' stop-color='#C02B3C'/></radialGradient><radialGradient id='4173e6ac-4e7c-49b9-9b62-0b65b4157795' cx='0' cy='0' r='1' gradientUnits='userSpaceOnUse' gradientTransform='matrix(-4.6081 13.17265 -15.78492 -5.52192 14.799 3.47)'><stop offset='.066' stop-color='#8C48FF'/><stop offset='.5' stop-color='#F2598A'/><stop offset='.896' stop-color='#FFB152'/></radialGradient><linearGradient id='d26909eb-6976-40f8-bab9-c9f1a0b03832' x1='4.318' y1='2.273' x2='5.151' y2='11.9' gradientUnits='userSpaceOnUse'><stop offset='.156' stop-color='#0D91E1'/><stop offset='.487' stop-color='#52B471'/><stop offset='.652' stop-color='#98BD42'/><stop offset='.937' stop-color='#FFC800'/></linearGradient><linearGradient id='1934dfaa-452b-457a-b1f7-d9d3fbe09e3f' x1='5.046' y1='1' x2='5.5' y2='11.504' gradientUnits='userSpaceOnUse'><stop stop-color='#3DCBFF'/><stop offset='.247' stop-color='#0588F7' stop-opacity='0'/></linearGradient><linearGradient id='ddebd8ac-abb5-47aa-80d7-51a01fe69279' x1='15.259' y1='3.856' x2='15.253' y2='6.717' gradientUnits='userSpaceOnUse'><stop offset='.058' stop-color='#F8ADFA'/><stop offset='.708' stop-color='#A86EDD' stop-opacity='0'/></linearGradient></defs></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Internal/UpdateIcon.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 14 14' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><circle cx='7' cy='7' r='6.5' fill='none' stroke='#000'/><g fill='none' stroke='#000' clip-path='url(#66f8bdbe-38c0-4e5c-b989-c6247f310ed9)'><path d='M4.778 6.611 7 4.39l2.222 2.22M7 4.389v5.778'/></g><defs><clipPath id='66f8bdbe-38c0-4e5c-b989-c6247f310ed9'><path d='M3 3.5h8v8H3z' class='msportalfx-svg-c01'/></clipPath></defs></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Bug.svg",["require","exports"],(function(e,t){"use strict";return{type:391,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><rect width='10' height='12' x='4' y='5' fill='none' stroke='#000' rx='5'/><path fill='none' stroke='#000' d='M14 8.25a2 2 0 0 1 2 2v1.5m-14 0v-1.5a2 2 0 0 1 2-2M14.5 2.5V4a2 2 0 0 1-2 2H12M6 6h-.5a2 2 0 0 1-2-2V2.5m10.5 10a3 3 0 0 1 0 4m-10 0a3 3 0 0 1 0-4M6 1l1.5 1.5M12 1l-1.5 1.5M7.65 5.4a2 2 0 0 1 0-3 2 2 0 0 1 2.7 0 2 2 0 0 1 0 3'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Waffle.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 20 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M5.25 4a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0Zm12 12a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0ZM16 11.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5ZM17.25 4a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0ZM10 17.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5ZM11.25 10a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0ZM10 5.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5ZM5.25 16a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0ZM4 11.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5Z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.TopBar.Component",["require","exports","Weave","MsPortalImpl/Resources/ImplScriptResources","_generated/MsPortalImpl/Svg/Startup/Bug.svg","_generated/MsPortalImpl/Svg/Startup/Hamburger.svg","_generated/MsPortalImpl/Svg/Startup/Waffle.svg","_generated/MsPortalImpl/Svg/Library/ArrowRight.svg","_generated/MsPortalImpl/Svg/Internal/UpdateIcon.svg","_generated/MsPortalImpl/Svg/Internal/AzureCopilot.svg","MsPortalImpl/Services/Services.GeneralSettings","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.Search.Component","MsPortalImpl/Widgets/Widgets.AvatarMenu.Component","MsPortalImpl/Widgets/Widgets.Toast.Component","FxInternal/Weave/Util","FxInternal/Weave","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.AuthStateManager","FxInternal/Weave/Components/Button","Fx/Experimentation","MsPortalImpl/Utilities/UrlUtilities"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TopBar=void 0;var C=MsPortalFx.Base;const P=window.fx.environment;function w({event:e}){let t;e?.preventDefault&&e.preventDefault(),I("SkipLinkClicked");const s=$.querySelectorAll(".fxs-portal-main"),o=s.find(".fxs-contextpane.fxs-portal-contextpane-right");if(o.hasClass("fxs-contextpane-visible")){const e=o.find("iframe.fxs-part-frame").first();t=e[0]?e:o.findFirstTabbable()}else{const e=s.find("iframe.fxs-part-frame.fxs-reactview-frame-active").first();t=e[0]?e:s.find(".fxs-panorama .fxs-blade").last().find(".fxs-bladecontent").findFirstTabbable()}$(document.activeElement).blur(),t.focus()}function I(e,t){C.Diagnostics.Telemetry.trace({source:"TopBar",action:e,data:t})}t.TopBar=function(e){const{vm:t}=e,C=t.loadingIdList.compose(g.isEmptyArray);return p(s.LifetimeManagerScoped,{fn:e=>p(s.GetContext,{fn:S=>{const _=S.diContainer,F=_.get(FxImpl.Features),T=(0,M.getUnsafeParams)(),k=_.get(v.Experimentation).shellAssignments.getBooleanValue("showUnsafeURLCustomizationWarning"),D=T.size>0&&!(0,M.isTestEnvironment)()&&k,E=F.isEnabled("canmodifyextensions")||F.isEnabled("renderdevmodeux"),B=F.isEnabled("hideSkipLink")||MsPortalFx.isFeatureEnabled("hideSkipLink"),A=_.get(b.AuthStateManager),N=F.getValue("showbugreportlink"),R="force"===N||"true"===N&&A.isInternal&&!F.isEnabled("ci"),L=(0,s.makeWritableComputation)(),O=(0,s.makeWritableComputation)();_.get(d.GeneralSettings).landingPage.subscribeAndRun(e,(()=>{const e=(0,d.isLandingPageDashboard)(_);L(e?o.Dashboard.defaultTitle:o.AzureHome.home),O(e?"#dashboard":"#home")}));const z=()=>{I("CustomizeModeExited",{dashboardChanged:!!t.dashboardChanged.value,onDashboard:!!t.dashboardVisible.value}),t.exitOrganizeMode()},H=_.get(x.DesktopManagerMode).value,U=(0,s.composeComputation)([t.dashboardChanged,t.newDashboardSaveEnabled,t.displayMode],((e,t,s)=>t&&e&&"Dashboard"!==s||e&&!t)),W=(0,s.composeComputation)([t.dashboardVisible,t.newDashboardSaveEnabled],((e,t)=>e&&!t)),V=(0,s.composeComputation)([(0,f.toComputation)(H),t.newDashboardSaveEnabled],((e,t)=>1===e&&!t));return p("div",{className:["fxs-topbar az-noprint msportalfx-unselectable",{"fxs-topbar-devmode fxs-bg-warning":E||D,"fxs-topbar-dashboard-changed":U,"fxs-topbar-dashboard-visible":W,"fxs-topbar-search-activated":t.searchViewModel.isExpanded}],role:"presentation"},B?null:p("a",{href:"#","aria-label":o.TopBar.skipLink,title:o.TopBar.skipLink,role:"button",onClick:w,onKeyDown:({event:e})=>{32!==e.keyCode&&13!==e.keyCode||(w({event:e}),e.stopPropagation())},className:"fxs-topbar-skip-link"},o.TopBar.skipLink),p(s.Once,{"data-odebug":"23",condition:V,trueFn:()=>p("div",{className:"fxs-topbar-exit-customize"},p("div",{className:"fxs-topbar-exit-customize-message"},o.TopBar.exitCustomizeText),p(y.Button,{className:"fxs-topbar-exit-customize-button",text:o.ShellCommands.exitOrganizeMode,onClick:z,style:0}))}),p("div",{className:["fxs-topbar-content",{"fxs-hide-in-customize":t.newDashboardSaveEnabled.compose(g.negation)}],role:"banner","aria-labelledby":"bannerlabel"},F.isEnabled("wafflemenu")?p("a",{href:"#","aria-label":o.TopBar.waffle,title:o.TopBar.waffle,className:["fxs-topbar-wafflemenu","fxs-topbar-button"],image:r,role:"button",onClick:({event:e})=>{e.preventDefault(),I("WaffleMenuButtonClicked"),$(e.currentTarget).trigger("fxshowwaffle")},onKeyDown:({event:e})=>{32===e.keyCode&&($(e.currentTarget).trigger("click"),e.preventDefault(),e.stopPropagation())}}):null,p("div",{className:"fxs-microsoft-cloud-menu"}),P.chrome.hideSidebarNav?null:p("a",{href:"#","aria-label":o.TopBar.hamburger,title:o.TopBar.hamburger,className:["fxs-topbar-sidebar-collapse-button","fxs-topbar-button msportalfx-svg-flip-horizontal fxs-topbar-search-activated-hidden"],image:n,role:"button",onClick:({event:e})=>{e.preventDefault(),I("TopBarHamburgerButtonClicked"),$(e.currentTarget).trigger("fxtogglesidebar")},onKeyDown:({event:e})=>{32===e.keyCode&&($(e.currentTarget).trigger("click"),e.preventDefault(),e.stopPropagation())}}),p("h1",{className:("false"!==F.getValue("internalonly")?"fxs-topbar-preview":"fxs-topbar-brand")+" fxs-topbar-search-activated-hidden",id:"bannerlabel"},p("a",{className:"fxs-topbar-home",title:fx.environment.branding.productName,href:O,role:"link",onClick:()=>I("BannerButtonClicked")},"false"!==F.getValue("internalonly")?p(s.Fragment,null,p("div",{className:"fxs-topbar-internal fxs-internal-short"},o.TopBar.internalText),p("div",{className:"fxs-topbar-internal fxs-internal-full"},fx.environment.branding.productName," (",o.TopBar.internalText,")")):`${fx.environment.branding.productName}`)),E||D?p("a",{className:"fxs-topbar-exitdevmode fxs-topbar-debug-button fxs-topbar-search-activated-hidden",href:"#",role:"button",onClick:({event:e})=>{e.preventDefault(),t.exitDevMode()}},o.TopBar.exitDevModeLinkText):null,R?p("a",{href:"#",className:"fxs-topbar-reportbug fxs-topbar-debug-button fxs-topbar-search-activated-hidden",role:"button",title:o.TopBar.reportBugTitle,"aria-label":o.TopBar.reportBug,onClick:({event:e})=>{e.preventDefault(),t.reportBug()}},p("span",{className:"fxs-topbar-reportbug-icon",image:i}),p("span",{className:"fxs-topbar-reportbug-text"},o.TopBar.reportBug)):null,p(s.If,{condition:t.canUpgradeSubscription,concealmentBehavior:"remove",trueFn:()=>p("a",{href:t.upgradeableSubscription.compose((e=>`#blade/Microsoft_Azure_Billing/SubscriptionUpgradeBlade/azureSubscriptionId/${e.subscriptionId}/appId/AzPortal_UpgradeBtn`)),className:"fxs-topbar-upgradebutton fxs-topbar-search-activated-hidden",role:"button",title:o.TopBar.upgradeText,"aria-label":o.TopBar.upgradeButtonText,onClick:()=>{MsPortalFx.Base.Diagnostics.Telemetry.trace({action:"FreeTrialUpgradeClicked",source:"TopBar",data:{subscriptionId:t.upgradeableSubscription.value.subscriptionId,creditsRemaining:t.upgradeableSubscription.value.remaining}})}},p("span",{className:"fxs-topbar-upgradebutton-icon",image:l}),p("span",{className:"fxs-topbar-upgradebutton-text"},o.TopBar.upgradeButtonText))}),p("div",{className:"fxs-topbar-placeholder fxs-topbar-search-activated-hidden"}),p("a",{href:"#",tabindex:"-1",className:"fxs-search-back-icon fxs-topbar-button msportalfx-svg-flip-horizontal",role:"button",title:o.TopBar.back,"aria-label":o.TopBar.back,image:a,onClick:({event:e})=>e.preventDefault()}),p(u.Search,{className:"fxs-topbar-search",vm:t.searchViewModel}),p(s.If,{condition:(0,f.toComputation)(t.copilotEnabled),trueFn:()=>p("a",{href:"#",className:["fxs-topbar-button","fxs-topbar-copilot","fxs-topbar-home",(0,f.toComputation)(t.isCopilotOpen).compose((e=>e?" fxs-topbar-copilot-active":""))],role:"button",title:o.TopBar.copilot,"aria-label":o.TopBar.copilot,onClick:({event:e})=>{e.preventDefault(),t.settingsFlyoutState(0),MsPortalFx.require("MsPortalImpl/Services/Services.CopilotShellAPIs").then((e=>{_.get(e.CopilotShellAPIs).toggleCopilotBlade()}))}},p("span",{image:c,className:"fxs-topbar-copilot-button-icon"}),p("span",{className:["fxs-topbar-copilot-text"]},o.TopBar.copilot))}),p("div",{className:"fxs-topbar-buttons-container fxs-topbar-search-activated-hidden"},t.actionDefinitions.map((e=>e.showNotification?p("div",{className:(0,f.toComputation)(e.active||ko.observable(!1)).compose((t=>e.classNames+(t?" fxs-topbar-active":""))),onClick:({event:t})=>{t.preventDefault(),e.clickHandler()}},p("a",{href:"#",className:"fxs-topbar-button",role:"button",title:e.name,"aria-label":e.name,image:(0,f.toValueOrComputation)(e.icon)}),p("div",{className:"fxs-notificationspane-progressbar fxs-display-none"},p("div",null)),(0,f.toComputation)(e.showNotification).compose((e=>e?p("div",{className:"fxs-notificationspane-button-unreadcount fxs-notificationspane-button-unreadcount-circle"}):null))):p("a",{href:"#",className:["fxs-topbar-button",e.classNames],role:"button",title:e.name,"aria-label":e.name,"aria-expanded":e.ariaExpanded,"aria-controls":e.ariaControls,image:(0,f.toValueOrComputation)(e.icon),onClick:({event:t})=>{t.preventDefault(),e.clickHandler()}})))),p(h.Toast,{className:"fxs-topbar-toast",vm:t.toastViewModel}),p("div",{className:"fxs-topbar-actionsmenu fxs-topbar-search-activated-hidden"}),p(m.AvatarMenu,{className:["fxs-topbar-avatarmenu","fxs-topbar-search-activated-hidden"],vm:t.avatarMenuVM})),p(s.Once,{"data-odebug":"24",condition:U,trueFn:()=>{const e=t.dashboardWritable.compose((e=>e?o.TopBar.saveDashboardButton:o.TopBar.saveDashboardCopyButton)),i=t.dashboardWritable.compose((e=>e?o.TopBar.saveMessage:o.TopBar.saveCopyMessage)),n=t.displayMode,r=(0,s.composeComputation)([(0,f.toComputation)(t.isInOrganizeMode),n],((e,t)=>e&&"Dashboard"===t)),a=n.compose((e=>"Dashboard"!==e)),l=(0,s.composeComputation)([r,a],((e,t)=>!e&&t)),c=n.compose((e=>"Dashboard"===e)),d=c.compose(g.negation),u=(0,s.composeComputation)([r,a,c],((e,t,s)=>!e&&!t&&s));return p("div",{className:"fxs-topbar-dashboard"},p("div",{className:"fxs-topbar-dashboard-message",role:"alert","aria-live":"assertive","aria-atomic":!0},i),p(y.Button,{className:["fxs-topbar-dashboard-done-customize",{"fxs-display-none":r.compose(g.negation)}],text:o.TopBar.exitCustomizeButton,onClick:z,style:0,visible:r}),p(y.Button,{className:["fxs-topbar-dashboard-view",{"fxs-display-none":a.compose(g.negation)}],text:o.TopBar.viewDashboardButton,style:l.compose((e=>e?0:1)),onClick:()=>{I("DashboardView"),MsPortalFx.ViewModels.navigateToDashboardEndPoint.invoke(FxImpl.Rpc.client,"fx",["TopBar"])}}),p(y.Button,{className:["fxs-topbar-dashboard-save",{"fxs-display-none":d}],text:e,style:u.compose((e=>e?0:1)),onClick:()=>{const e=t.dashboardWritable.value,s=e?1:2;I(e?"DashboardPublish":"DashboardSaveACopy"),t.finishDashboardEdit(s,"TopBar")}}),p(y.Button,{className:["fxs-topbar-dashboard-discard",{"fxs-display-none":d}],text:o.TopBar.discardDashboardButton,style:1,onClick:()=>{I("DashboardDiscard"),t.finishDashboardEdit(3)}}))}}),p("div",{className:["fxs-loading5dots-container fxs-blade-progress-translucent",{"fxs-display-none":C}]},p("div",null),p("div",null),p("div",null),p("div",null),p("div",null)))}})})}})),
define("MsPortalImpl/Widgets/Widgets.Portal.html",["require","exports","Weave/DirectMode","Weave","Weave/Core/Computation","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.SideBar.Component","MsPortalImpl/Widgets/Widgets.ContextPane.Component","MsPortalImpl/Widgets/Widgets.ContextMenu.Component","FxInternal/Weave/Components/LoadingIndicator","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Widgets/Widgets.TopBar.Component","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.BrowseCuration"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Journey=t.renderPortal=void 0;var f=MsPortalFx.Base.Diagnostics.Telemetry;const x=fx?.environment?.writesDisallowedTenants||[];t.renderPortal=function(e,t,i,r){const d=window.fx.getTimestamp(),g=m.isIOS&&!m.isSafari&&MsPortalFx.getEnvironmentValue("branding").iosAppId&&!function(e){const t=e.get(h.StorageService).getValue(h.ComponentName.AppBanner,"dismiss",0);return t&&parseInt(t)>=Date.now()-6048e5}(i),f=i.get(FxImpl.Features).isEnabled("outagebanner"),x=i.get(FxImpl.Features).isEnabled("infobanner"),b=function(e){if(e.isEnabled("electrondeprecationbannerforce"))return!0;return(window.portalAppApi||window.nodeRequire)&&e.isEnabled("electrondeprecationbanner")}(i.get(FxImpl.Features)),v=s(o.PromiseFragment,{"data-odebug":"p5",promise:I(x)});t.contextMenuViewModel.registerForCleanup(r);const M=s(o.Fragment,null,g?s(o.PromiseFragment,{"data-odebug":"p6",promise:P()}):null,s(o.PromiseFragment,{"data-odebug":"p7",promise:S(!1)}),v,s(u.TopBar,{vm:t.topBar}),s("div",{className:"fxs-global-notification-banner fxs-blade-statusbg fxs-bg-warning az-noprint"},f?s(o.PromiseFragment,{"data-odebug":"p8a",promise:_(i)}):null),b?s(o.PromiseFragment,{"data-odebug":"p8b",promise:w()}):null,s("div",{className:"fxs-portal-tip az-noprint"}),s("div",{className:"fxs-portal-region"},s("div",{className:"fxs-portal-main-region"},s("div",{className:["fxs-portal-main",{"fxs-topbar-dashboard-changed":t.topBar.dashboardChanged}]},s(a.SideBar,{className:"fxs-sidebar az-noprint msportalfx-unselectable",vm:t.sideBar}),s(y,{vm:t}),s(l.ContextPane,{className:"fxs-portal-contextpane-right msportalfx-shadow-level3",vm:t.rightContextPane}),s(l.ContextPane,{className:"fxs-portal-contextpane-shell msportalfx-shadow-level3",vm:t.shellContextPane})),s("div",{className:"fxs-portal-console az-noprint",id:"consoleRegionId",role:"presentation"})),s("div",null,s(l.ContextPane,{className:"fxs-portal-contextpane-docked",vm:t.dockedContextPane}))),s(c.ContextMenu,{className:"fxs-commands-contextMenu az-noprint",vm:t.contextMenuViewModel}),s(o.PromiseFragment,{"data-odebug":"p9",promise:S(!0)})),C=window.fx.getTimestamp();(0,n.applyToElement)({element:e,ltm:r,weaveNode:M,weaveContext:{diContainer:i},opName:"portal"}),i.get(p.PortalStartupMarkers).portalTsx={beforeStart:d,tsxFnEnd:C}};const b=MsPortalFx.isFeatureEnabled("allServicesWithOverview");function y(e){const{vm:t}=e;return s("main",{className:"fxs-panorama fxs-portal-content"},s(o.Fragment,null,s(o.Once,{"data-odebug":"15",condition:t.displayMode.compose((e=>"AllServices"===e)),trueFn:()=>s(o.PromiseFragment,{"data-odebug":"p10",promise:M(t),whilePending:s(d.LoadingIndicator,null)})}),s(o.If,{condition:t.settingsFlyoutState,trueFn:()=>s(o.PromiseFragment,{"data-odebug":"p11",promise:C(t),whilePending:s(d.LoadingIndicator,null)})}),s("div",{className:["fxs-startboard fxs-startboard-target fxs-theme-context-start fxs-portal-text",{"fxs-startboard-notfound":t.startboardNotFound,"fxs-startboard-loading":t.startboardLoading}],"aria-label":r.Dashboard.ariaLabel}),s("div",{className:"fxs-home-target"}),s(v,null)))}function v(){return s("div",{className:"fxs-journey-target"},s("div",{className:["fxs-journey-breadcrumb","fxs-portal-bg-txt-br","az-noprint","msportalfx-unselectable","fxs-display-none"]}),s("div",{className:"fxs-journey-layout"}))}async function M(e){const[t,n]=await Promise.all([MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AllServicesMenu"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AllServicesMenu.Component"),b&&MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/AllServicesCardData"),MsPortalFx.require(`MsPortalImpl/Services/BrowseCuration/${g.browseCurationFile}`).catch((e=>{(0,g.handleInvalidCurationFileError)(e)}))]),r=f.start({source:"AllServicesMenu",action:"AllServicesMenuLoad"});return performance.mark("AllServicesMenuLoadStart"),s(o.GetContext,{fn:a=>{const l=a.diContainer,c=n.AllServicesMenu,d=new t.ViewModel;return d.filterInputValue=e.allServicesMenuInput.filter,d.categoryInputValue=e.allServicesMenuInput.category,s("div",{className:"fxs-sidebar-flyout fxs-portal-background",role:"presentation",afterMount:(e,s)=>{const n=new t.Widget($(e),d,l),a=s.createChildLifetime();s.registerForDispose(n),(0,o.subscribeAndRun)(a,[d.isLoading],(e=>{e||(a.dispose(),(0,i.invokeAfterChangePropagation)((()=>{performance.mark("AllServicesMenuLoadEnd"),performance.measure("AllServicesMenuLoad","AllServicesMenuLoadStart","AllServicesMenuLoadEnd"),f.completeTrace(r)})))}))}},s(c,{vm:d}))}})}async function C(e){return(await MsPortalFx.require("MsPortalImpl/Weave/Components/SettingsFlyout.Component")).getFlyoutComponent(e.settingsFlyoutState)}async function P(){const{AppBanner:e}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AppBanner.Component");return s(e,null)}async function w(){const{ElectronDeprecatedBanner:e}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.ElectronDeprecatedBanner.Component");return s(e,null)}async function I(e){if(e){const e=await MsPortalFx.Base.Security.getUserInfo();if(!!~x.indexOf(e?.directoryId)){const{GlobalInfoBanner:e}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalInfoBanner.Component");return s(e,null)}}return null}async function S(e){const t=await MsPortalEarly.preload,o=t&&t.securityClassification;if(o){const{GlobalSecurityBanner:t}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalSecurityBanner.Component");return s("div",e?{className:"fxs-global-security-banner-bottom"}:{className:"fxs-global-security-banner-top"},s(t,{classification:o}))}return null}async function _(e){const t=await MsPortalEarly.preload,o=t&&t.outages||[],{GlobalNotificationBanner:i}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalNotificationBanner.Component");return s(i,{notifications:o,container:e})}t.Journey=v})),
define("MsPortalImpl/Interactions/Interactions.RightClick",["require","exports","MsPortalImpl/Base/Base.KeyboardHelper"],(function(e,t,s){"use strict";var o;return function(e){const t="fx-rightClick";e.setup=function(e,o,i){let n,r,a,l=i&&i.formTarget;function c(){e.removeClass(t);const s=o();s&&s.forEach((e=>{e.dispose()})),n&&(e.off("fxcontextmenurequest",n),n=null),r&&(e.off("keydown",r),r=null),a&&(e.off("remove",a),a=null)}function d(t){const s=o();s&&s.length>0&&(t.preventDefault(),t.stopPropagation(),function(t,s){const i=$.Event("fxcontextmenu");i.clientX=t,i.clientY=s,l||(l=e.hasClass("fxs-bladecontent")?e:null);e.trigger(i,{commands:o(),formTarget:l,srcElement:e[0]})}(t.clientX,t.clientY))}return e.addClass(t),e.on("fxcontextmenurequest",n=(e,t)=>{d(e)}),e.on("keydown",r=(e,t)=>{if(121===e.which&&4===s.getModifierKeys(e)){const t=e.target.getClientRects()[0];e.clientX=t&&t.left,e.clientY=t&&t.top,d(e)}}),e.on("remove",a=c),{dispose:c}}}(o||(o={})),o})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSize",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAdaptiveWidth=t.isVariableSize=t.isFixedSize=t.getSize=t.getDefaultSize=t.getCorrespondingStandardSize=t.getGridPixelSize=t.AllCssClasses=t.AllSizes=t.GridSpacingHeight=t.GridSpacingWidth=t.CellSpacingHeight=t.CellSpacingWidth=t.CellHeight=t.CellWidth=void 0;var s=MsPortalFx.Parts,o=s.PartSize;function i(e,t,s){return e<0?-1:0===e?0:Math.max(0,e*t+(e-1)*s)}function n(e,s){return{width:i(e,t.CellWidth,t.CellSpacingWidth),height:i(s,t.CellHeight,t.CellSpacingHeight)}}function r(e,t,s){return Math.ceil(e/(t+s))}function a(e){return $.extend(!0,{},MsPortalFx.find(t.AllSizes,(t=>t&&t.name===e)))}function l(e){return t=>t===e}t.CellWidth=85,t.CellHeight=85,t.CellSpacingWidth=5,t.CellSpacingHeight=5,t.GridSpacingWidth=t.CellWidth+t.CellSpacingWidth,t.GridSpacingHeight=t.CellHeight+t.CellSpacingHeight,t.AllSizes=(()=>{const e=[],t=(t,o,i)=>{e[t]={name:t,css:"fxs-tilesize-"+s.PartSize[t].toLowerCase(),size:n(o,i),span:{colSpan:o,rowSpan:i}}};return t(o.Mini,1,1),t(o.Small,2,1),t(o.Normal,2,2),t(o.Wide,4,2),t(o.Tall,2,4),t(o.HeroWide,6,4),t(o.HeroTall,4,6),t(o.HeroWideFitHeight,6,0),t(o.FullWidthFitHeight,-1,0),t(o.FitToContainer,-1,-1),t(o.Large,4,4),t(o.Hero,6,6),t(o.Custom,0,0),e})(),t.AllCssClasses=t.AllSizes.map((e=>e.css)),t.getGridPixelSize=function(e,t){const s=e=>Math.ceil(Math.min(Math.max(e,1),25));return n(s(e),s(t))},t.getCorrespondingStandardSize=function(e,s){let i=MsPortalFx.find(t.AllSizes,(t=>{const o=t&&t.size;return t&&o.width===e&&o.height===s}));return i||(i=a(o.Custom),i.size={width:e,height:s},i.span=function(e,s){return{colSpan:r(e,t.CellWidth,t.CellSpacingWidth),rowSpan:r(s,t.CellHeight,t.CellSpacingHeight)}}(e,s)),$.extend(!0,{},i)},t.getDefaultSize=function(){return a(o.Normal)},t.getSize=a;const c=[o.Mini,o.Small,o.Normal,o.Wide,o.Tall,o.Large,o.HeroWide,o.HeroTall,o.Hero,o.Custom];t.isFixedSize=function(e){const t=l(e);return c.some(t)};const d=[o.HeroWideFitHeight,o.FullWidthFitHeight,o.FitToContainer];t.isVariableSize=function(e){const t=l(e);return d.some(t)};const p=[o.FullWidthFitHeight,o.FitToContainer];t.isAdaptiveWidth=function(e){const t=l(e);return p.some(t)}})),
define("MsPortalImpl/Widgets/Widgets.LayoutBase",["require","exports"],(function(e,t){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Orientation=void 0,function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(s||(t.Orientation=s={}))})),
define("MsPortalImpl/Widgets/Widgets.TileActionBar.Component",["require","exports","Weave/DirectMode","FxInternal/Weave","Weave","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileActionBar=void 0,t.TileActionBar=function(e){const{vm:t}=e,r=n.ContextMenu.partActions;return s("div",{className:"fxs-tile-actionbar-actionlist fxs-portal-background",role:"menubar","aria-label":(0,i.composeComputation)([t.ariaLabel,t.partTitle],((e,t)=>`${e||t} ${r}`))},s(i.Once,{"data-odebug":"21",condition:t.visible,trueFn:()=>s(i.ForEach,{collection:t.actions.cFilter((e=>(0,o.toComputation)(e.command.enabled))),fn:({item:e})=>{const t=e.command;return s("button",{type:"button",className:["fxs-tile-actionbar-action fxs-portal-svg",e.className],role:"menuitem",title:(0,o.toComputation)(t.text),"aria-label":(0,o.toComputation)(t.text),image:(0,o.toComputation)(t.icon),onClick:({event:e})=>{e.stopPropagation(),MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"TileAction",action:"TileActionClicked",name:t.commandName}),t.execute(!1)}})}})}))}})),
define("MsPortalImpl/Widgets/Widgets.Tile.Component",["require","exports","Weave/DirectMode","FxInternal/Weave/Components/LoadingIndicator","Weave","MsPortalImpl/Widgets/Widgets.TileActionBar.Component"],(function(e,t,s,o,i,n){"use strict";function r(e){const t=e.vm,r=(0,i.composeComputation)([t.isInBlockingLoadingState,t.hasOngoingOperation],((e,t)=>{let s=0;return e?s=2:t&&(s=1),s}));return s(i.Fragment,null,s("div",{className:"fxs-tile-actionbarcontainer"},s("div",{className:"fxs-tile-actions"},s(n.TileActionBar,{vm:t.actionBarViewModel})),s("div",{className:"fxs-tile-actions-contextmenu"})),s("div",{className:"fxs-tile-overlay"}),s("div",{className:["fxs-tile-progress-transparent fxs-loading5dots-container",{"fxs-display-none":r.compose((e=>1!==e))}]},s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"})),s(o.LoadingIndicator,{className:["fxs-tile-progress fxs-portal-background",{"fxs-display-none":r.compose((e=>2!==e))}]}))}Object.defineProperty(t,"__esModule",{value:!0}),t.TileInner=t.Tile=void 0,t.Tile=function(e){const t=e.vm;return s("div",{id:t.tsxRootElementId,className:"fxs-tile fxs-portal-bg-txt-br"},s(r,{vm:t}))},t.TileInner=r})),
define("MsPortalImpl/Widgets/Widgets.TileActionBar",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Base/Base.BrowserDetection","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","Weave"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=t.TileActionViewModel=t.actionClassName=t.widgetClassName=void 0,(0,n.injectCss)(r);const l="fxs-tile-actionbar-actionlist",c="fxs-tile-actionbar",d=[];t.widgetClassName=c,t.actionClassName="fxs-tile-actionbar-action";t.TileActionViewModel=class{};class p extends s.ViewModel{constructor(){super(...arguments),this.actions=(0,a.makeArrayComputation)(),this.visible=(0,a.makeWritableComputation)(!1),this.partTitle=(0,a.makeWritableComputation)(),this.ariaLabel=(0,a.makeWritableComputation)()}update(){this.visible.value&&this.actions.value.forEach((e=>{e.command.activate(),e.bindCommand()}))}}t.ViewModel=p;class u extends s.Widget{constructor(e,t,s,i){super(e,s);const n=this.options,r=this.ltm;d.push(this),e.addClass(c);const p=new o.ViewModel;p.topOffsetCorrection=25;const u=this.contextMenuWidget=new o.Widget(t,p);r.registerForDispose(e.setEvents(["click","."+l,e=>{const t=e.target;$(t).hasClass(l)&&(i(t),e.preventDefault(),e.stopPropagation())}])),(0,a.subscribeAndRun)(r,[n.visible],(t=>{if(!t){const e=document.activeElement;this.has(e)&&i(e)}t?n.update():u.hide(),$(e).toggleClass("fxs-tile-transparent",!t),t&&d.forEach((e=>{e!==this&&e.options.visible(!t)}))})),r.registerForDispose((()=>{u.dispose(),p.menuItems.removeAll(),this.contextMenuWidget=null,MsPortalFx.remove(d,this)})),this._bindDescendants()}dispose(){this._cleanElement(c),super.dispose()}showTileManagementContextMenu(){this.options.actions.value.forEach((e=>{const t=e.command;"function"==typeof t._getActionClassIdentifier&&"opencontextmenu"===t._getActionClassIdentifier()&&t.execute(!1)}))}setFocus(){!i.isAndroidOrMobile&&this.options.visible.value&&this.element.findFirstTabbable().focus()}has(e){return!(!this.element.has(e).length&&!this.contextMenuWidget.element.has(e).length)}}t.Widget=u})),
define("MsPortalImpl/Widgets/Widgets.Tile",["require","exports","Weave/DirectMode","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.TileActionBar","MsPortalImpl/Widgets/Widgets.UIElementBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.Tile.Component","Weave","Fx"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.createTileWidget=t.ViewModel=t.actionBarContainerClassName=t.overlayClassName=t.widgetClassName=void 0,(0,a.injectCss)(l);var m=MsPortalFx.Base.Diagnostics,h=MsPortalFx.Parts.PartSize;const g=m.createLog(e),f="fxs-tile",x="fxs-tile-overlay",b="fxs-portal-bg-txt-br";t.widgetClassName=f,t.overlayClassName=x,t.actionBarContainerClassName="fxs-tile-actionbarcontainer";let y=0;class v extends r.ViewModel{constructor(e,t){super(e),this.isInBlockingLoadingState=(0,p.makeWritableComputation)(!1),this.hasOngoingOperation=(0,p.makeWritableComputation)(!1),this.size=ko.observable(),this.gridHeight=ko.observable(),this.gridWidth=ko.observable(),this.supportedSizes=ko.observableArray(),this.commands=[],this.actionBarViewModel=new n.ViewModel,this.selected=ko.observable(!1),this.selectedFromHover=ko.observable(!1),this.userResizable=ko.observable(!1),this.inLockedContext=!1,this.tsxRootElementId=`__tile_${y++}__`,this.applyViewSettings(t)}getViewSettings(){return{NormalState:{size:this.size()}}}applyViewSettings(e){e&&e.NormalState&&void 0!==e.NormalState.size&&(this.size=ko.observable(e.NormalState.size))}}t.ViewModel=v,t.createTileWidget=function(e,t,s,o,i){return new M(e,t,s,o,i)};class M extends r.Widget{constructor(e,t,n,r,a){super(e,t),this._tsxRender=r,this._getActions=a;const l=this.ltm;t.size&&void 0!==t.size()||(g.warning("No initial size was set on the Tile view model."),t.size=ko.observable(i.getDefaultSize().name));const p=i.getSize(t.size());if(e.addClass(p&&p.css),r||((0,c.applyToElement)({element:e[0],ltm:this.ltm,weaveNode:s(d.TileInner,{vm:t}),weaveContext:{diContainer:n}}),e.addClass(f).addClass(b)),h.Custom===p.name){const s=i.getGridPixelSize(t.gridWidth(),t.gridHeight());e.css({width:s.width,height:s.height})}else i.isFixedSize(t.size())&&(t.gridWidth(p.span.colSpan),t.gridHeight(p.span.rowSpan));this._attachEventHandlers();const u=o.setup(e,ko.observableArray(t.commands));l.registerForDispose(u)}dispose(){this._actionBarWidget&&(this._actionBarWidget.dispose(),this._actionBarWidget=null),this._tsxRender?this.element.removeClass(i.AllCssClasses.join(" ")):this._cleanElement(i.AllCssClasses.join(" "),f,b),super.dispose()}addChild(e){if(!e)throw new Error("Can't add null child.");(e.element||e).insertBefore($(this.element).find(`.${x}`))}removeChild(e){return!1}saveViewSettings(){return this.options.getViewSettings()}setSize(e,t){let s=i.getCorrespondingStandardSize(e,t);s||(s=i.getDefaultSize());const o=s.size,n=this.options,r=n.size(),a=this.element;if(r&&r===s.name){if(r!==h.Custom)return;if(parseInt(a.css("height"))===o.height&&parseInt(a.css("width"))===o.width)return}n.size(s.name),n.gridHeight(s.span.rowSpan),n.gridWidth(s.span.colSpan),a.css({height:"",width:""}).removeClass(i.AllCssClasses.join(" ")).addClass(s.css),s.name===h.Custom&&a.css({height:o.height,width:o.width});a.handleTransitionEndOnce("height",300,(e=>{!this.ltm.isDisposed()&&a.trigger("fxsizechanged",[s.name])}))}get actionBarWidget(){return this._actionBarWidget}setFocus(e){const t=this._actionBarWidget;if(!e&&t&&t.options.visible.value)t.setFocus();else{const e=this.element.find(".fxs-part");e&&e.focus()}}showTileManagementContextMenu(){const e=this.options,t=this.actionBarWidget;!e.locked()&&e.selected()&&t&&t.showTileManagementContextMenu()}_createActionBarWidget(){if(!this._actionBarWidget){const e=this.element,t=this.options,s=t.actionBarViewModel,o=this._getActions;s.actions.setAll(o&&o()),this._actionBarWidget=new n.Widget(e.find(".fxs-tile-actions"),e.find(".fxs-tile-actions-contextmenu"),s,(s=>{e[0].contains(s)&&(this.setFocus(!0),u.nextTick((()=>{t.selectedFromHover(!1)})))}))}}_attachEventHandlers(){const e=this.element,t=this.options,s=this.ltm;if(t.size.subscribe(s,(()=>{e.trigger(r.Widget.viewSettingsChanged,this.saveViewSettings())})),t.userResizable.subscribeAndRun(s,(e=>{e&&MsPortalFx.tryImmediateResolve(MsPortalFx.require("MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize"),(e=>{e.addUserResizeBehavior(this)}))})),ko.computed(s,t.locked,(t=>{e.trigger("fxsizechanged")})).extend({deferred:!0}),ko.computed(s,(()=>{const s=t.selected(),o=t.selectedFromHover(),i=s||o;ko.ignoreDependencies((()=>{i&&this._createActionBarWidget()})),t.actionBarViewModel.visible(i),e.toggleClass("fxs-tile-selected",s)})),!t.inLockedContext){const o=e=>{t.selectedFromHover()||t.selectedFromHover(!0)},i=e=>{!t.selectedFromHover()||this.actionBarWidget&&this.actionBarWidget.has(document.activeElement)||t.selectedFromHover(!1)};let n=!1;const r=t=>{const s=e[0],o=s.contains(t.target)&&(s.contains(t.relatedTarget)||n);return n=!1,o},a=e=>{!r(e)&&o(e)},l=e=>{!r(e)&&i(e)},c=e[0],d=e=>{27===e.keyCode&&e.target&&c.contains(e.target)&&this.setFocus(!0)},p=e=>{n=!0};e.on("mouseenter",o).on("mouseleave",i).on("keydown",".fxs-tile-actionbar-action",d).on("mousedown",".fxs-tile-actionbar-action",p),c.addEventListener("focus",a,!0),c.addEventListener("blur",l,!0),s.registerForDispose((()=>{e.off("mouseenter",o).off("mouseleave",i).off("keydown",d).off("mousedown",p),c.removeEventListener("focus",a,!0),c.removeEventListener("blur",l,!0)}))}}}t.Widget=M})),
define("MsPortalImpl/Widgets/Widgets.FlowLayout",["require","exports","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","Weave","MsPortalImpl/Widgets/Widgets.Tile.Component","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","FxInternal"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowLayoutPositionConflictResolver=t.FlowLayoutPositioningEngine=t.Widget=t.ViewModel=t.validateGrid=t.calculateSize=t.calculateSpan=void 0;var g=MsPortalFx.Base.Diagnostics,f=MsPortalFx.Parts.PartSize,x=i.Orientation;(0,u.injectCss)(m);const b=g.createLog(e),y=r.Widget.getId,v=o.Widget.getWidget,M="fxs-flowlayout",C="fxs-flowlayout-childcontainer",P="fxs-flowlayout-element";t.calculateSpan=(e,t,s)=>Math.min(25,Math.ceil((e+s)/(t+s)));t.calculateSize=(e,t,s)=>e*t+(e-1)*s,t.validateGrid=function(e){const t=new F;let s,o=!0;for(let i=0;i<e.length;i++){const n=e[i],r=n.position,a=r.row,l=r.col,c=n.rowSpan,d=n.colSpan;if(!t.isRectangleFree(l,a,c,d)){o=!1,s={misplacedPart:n.id,overlappedParts:[]};for(let e=l;e<l+d;e++)for(let o=a;o<a+c;o++){const i=t.getItemAt(e,o);i&&!s.overlappedParts.includes(i.id)&&s.overlappedParts.push(i.id)}break}t.markOccupancy(n)}return{success:o,result:s}};const w={38:1,39:2,40:3,37:4};class I extends r.ViewModel{constructor(e,t){super(e),this._positions=[],this.minColumns=(0,l.makeWritableComputation)(1),this.minRows=(0,l.makeWritableComputation)(1),this.maxColumns=(0,l.makeWritableComputation)(999),this.maxRows=(0,l.makeWritableComputation)(999),this.columnSize=a.CellWidth,this.rowSize=a.CellHeight,this.gutterSize=a.CellSpacingWidth,this.orientation=x.Horizontal,this.allowReorder=!1,this.allowOverflow=!1,this.allowGaps=!1,this.resolutionGuides=!1,this.resolutionGuidesOffset={x:0,y:0},this.childContainerHeight=(0,l.makeWritableComputation)(""),this.childContainerWidth=(0,l.makeWritableComputation)(""),this.positionUpdatedSignal=ko.observable(0),this.applyViewSettings(t)}getViewSettings(){return{positions:this.positions}}applyViewSettings(e){e&&e.positions&&(this.positions=e.positions,this.positionUpdatedSignal(this.positionUpdatedSignal()+1))}get positions(){return this._positions}set positions(e){this._positions=e||[]}}t.ViewModel=I;class S extends r.Widget{constructor(e,t,s){super(e,t,s),this._tsxRender=s,this._dropPlaceholder=null,this._childContainer=null,this._engine=new k(t),this._engine.positions=t.positions,s||(e.addClass(M).html("<div class='"+C+"'></div>"),t.resolutionGuides&&this._addResolutionGuides()),this._childContainer=$(this.element[0].querySelector("."+C)),this._initializeComputed(),s||this._relayoutPositions(),this._attachEventHandlers()}dispose(){this._childElements.forEach((e=>{e.removeClass(P),ko.cleanNode(e[0]),e.remove()})),ko.cleanNode(this._childContainer[0]),this._childContainer.remove(),this.element.removeClass(M),super.dispose()}get _childElements(){const e=this._childContainer.children("."+P),t=[];return $.each(e,(function(e,s){t.push($(s))})),t}get dropPlaceholder(){return this._dropPlaceholder}createTiles(e,t){if(0===e.length)return[];const s=new Array(e.length),o=(0,p.createFragment)(e.map(((e,t)=>(0,l.Once)({condition:s[t]=(0,l.makeWritableComputation)(!1),falseFn:()=>(0,c.Tile)({vm:e.vm})})))),i=this.ltm.createChildLifetime();return(0,l.subscribeAndRun)(i,[(0,l.makeLiftedArrayComputation)(s).cEvery(h.identity)],(e=>{e&&i.dispose()})),(0,d.appendToElement)({element:this._childContainer[0],ltm:i,weaveNode:o,weaveContext:{diContainer:t},opName:"Tiles"}),e.map(((e,o)=>{const i=$(document.getElementById(e.vm.tsxRootElementId)),r=n.createTileWidget(i,e.vm,t,!0,e.getActions),a=s[o];return r.ltm.registerForDispose((()=>a(!0))),this._postProcessAddChild(i),r}))}addChild(e){if(!e)throw new Error("Cannot add a null child.");const t=e.element?e.element:e;this._childContainer.append(t),this._postProcessAddChild(t)}_postProcessAddChild(e){e.css("visibility","hidden"),e.addClass(P);const t=this._getChildDimensions(e),s=this.options;try{s.positions=this._engine.append(y(e),t.rowSpan,t.colSpan)}catch(t){return b.warning("New element could not be appended to the grid. {0}".format(t.toString())),e.removeClass(P),void e.remove()}s.positions=this._engine.positions,this._refreshElementSize(e),this._setContainerSize(),this._relayoutPositions(),this.element.trigger("layoutUpdated"),e.css("visibility","")}removeChild(e,t){const o=MsPortalFx.findIndex(this._childElements,(function(t){return y(t)===e})),i=this._childElements[o];if(!i)return!1;return this.options.positions=this._engine.remove(e),this.element.trigger("layoutUpdated"),s.hide(i).removeClass(P),t?i.detach():i.remove(),this._setContainerSize(),this._relayoutPositions(),!0}resizeChild(e,s,o,i){const n=this.options,a=n.rowSize,l=n.columnSize,c=n.gutterSize,d=MsPortalFx.find(this._childElements,(function(t){return y(t)===e}));if(!d)return;const p=MsPortalFx.find(this._engine.positions,(function(t){return t.id===e}));s=Math.max(s,l),o=Math.max(o,a);const u=(0,t.calculateSpan)(o,a,c),m=(0,t.calculateSpan)(s,l,c),h=this._engine.resize(e,m,u,i);n.positions=h;const g=MsPortalFx.find(h,(function(t){return t.id===e})),f=(0,t.calculateSize)(g.rowSpan,a,c),x=(0,t.calculateSize)(g.colSpan,l,c);if(this._setContainerSize(!0),this._relayoutPositions(),i){p.rowSpan===g.rowSpan&&p.colSpan===g.colSpan||this.element.trigger("layoutUpdated");const e=v(d,r.Widget);this._setElementSize(e,d,x,f)}}moveChild(e,t,s,o){const i=y(e),n=this._getChildDimensions(e),r=this._engine.move(i,{col:t,row:s},n.colSpan,n.rowSpan,o);this.options.positions=r,this._setContainerSize(!0),this._relayoutPositions(),o&&this.element.trigger("layoutUpdated")}refreshLayout(){this.options.positions=this._engine.positions,this._setContainerSize(),this._relayoutPositions(),this._refreshSizes()}saveViewSettings(){const e=this.options;return e.positions=this._engine.positions,e.getViewSettings()}createDropPlaceholder(e,t){this._dropPlaceholder&&this.disposeDropPlaceholder(),this._dropPlaceholder=$(FxImpl.createElement("div",{class:"fxs-flowlayout-drop-placeholder"})).css({width:e,height:t}),this._childContainer.append(this._dropPlaceholder)}disposeDropPlaceholder(){this._dropPlaceholder&&this._dropPlaceholder.remove(),this._dropPlaceholder=null}moveDropPlaceholder(e){this._setElementPositioningCss(this.dropPlaceholder,e)}resizeDropPlaceholder(e,s){const o=this.options,i=o.rowSize,n=o.columnSize,r=o.gutterSize,a=(0,t.calculateSpan)(s,i,r),l=(0,t.calculateSpan)(e,n,r),c=(0,t.calculateSize)(a,i,r),d=(0,t.calculateSize)(l,n,r);this._dropPlaceholder.css({width:d,height:c})}getDomOrderedChildren(){return this._engine.getNaturalDomElementOrder()}discardStateOfUnusedChildren(){let e=[];const t={stateDiscarded:!1};return this._engine&&(e=e.concat(this._engine.discardUnusedPositions())),e.length&&(t.stateDiscarded=!0,t.message="Removed Positions: "+JSON.stringify(e)),t}_initializeComputed(){const e=this.options,t=this.ltm;(0,l.subscribeAndRun)(t,[e.minRows,e.maxRows,e.minColumns,e.maxColumns],(()=>this._setContainerSize())),e.positionUpdatedSignal.subscribe(t,(()=>{this._engine.positions=e.positions}))}_getChildDimensions(e){const s=this.options,o=v(e,n.Widget),i=o&&o.options,r=i&&i.size();let l,c;a.isFixedSize(r)?(l=a.getSize(r),c=r===f.Custom?a.getGridPixelSize(i.gridWidth(),i.gridHeight()):l.size):c=this._getChildAccurateDimensions(e);return{rowSpan:(0,t.calculateSpan)(c.height,s.rowSize,s.gutterSize),colSpan:(0,t.calculateSpan)(c.width,s.columnSize,s.gutterSize)}}_getChildAccurateDimensions(e){if(!e[0])return b.warning("Attempted to measure a non-existant item in _getChildAccurateDimensions. Assuming 0 as size."),{height:0,width:0};const t=e[0].getBoundingClientRect();return{height:Math.round(t.height),width:Math.round(t.width)}}_setContainerSize(e){const s=this.options,o=this._engine.getMaxOccupiedPositions(e?s.positions:null),i=Math.max(s.minRows.value,o.row),n=Math.max(s.minColumns.value,o.col),r=(0,t.calculateSize)(i,s.rowSize,s.gutterSize),a=(0,t.calculateSize)(n,s.columnSize,s.gutterSize);this._tsxRender?(s.childContainerHeight(r+"px"),s.childContainerWidth(a+"px")):this._childContainer.css({height:r,width:a})}_relayoutPositions(){let e,t,s,o;for(let i=0;i<this._childElements.length;i++)t=this._childElements[i],e=y(t),s=MsPortalFx.find(this.options.positions,(function(t){return t.id===e})),o=s?s.position:{row:0,col:0},this._setElementPositioningCss(t,o)}_setElementPositioningCss(e,t){const s=this.options,o=t.col*(s.columnSize+s.gutterSize),i=t.row*(s.rowSize+s.gutterSize);let n;n=this._isRtl()?{right:o,top:i}:{left:o,top:i},e.css(n)}_refreshSizes(){this._childElements.forEach(this._refreshElementSize,this)}_refreshElementSize(e){const s=this.options,o=v(e,r.Widget);if(o){const i=y(e),n=MsPortalFx.find(s.positions,(function(e){return e.id===i})),r=(0,t.calculateSize)(n.rowSpan,s.rowSize,s.gutterSize),a=(0,t.calculateSize)(n.colSpan,s.columnSize,s.gutterSize);this._setElementSize(o,e,a,r)}}_setElementSize(e,t,s,o){e?e.setSize(s,o):t.css({width:s,height:o})}_moveFocusInDirection(e){const t=$(document.activeElement).closest("."+n.widgetClassName),s=y(t);if(!s)return;const o=this._engine.getAdjacentElement(s,e),i=MsPortalFx.find(this._childElements,(e=>o===y(e)));if(!i)return;const r=v(i,n.Widget);r&&r.setFocus()}_attachEventHandlers(){const e=this.element,t=(e,t,s,o,i)=>{this.resizeChild(t,s,o,void 0===i||i),e.stopPropagation()},s=e=>{const t=$(e.target);if(t.is("input[type=text], textarea, select")||t.closest(".fxs-contextMenu").length)return;const s=e.which,o=w[s]||0;0!==o&&(e.preventDefault(),e.stopPropagation(),this._moveFocusInDirection(o))};e.on("fxsizechange",t),e.on("keydown",s),this.ltm.registerForDispose((()=>{e.off("fxsizechange",t),e.off("keydown",s)}))}_addResolutionGuides(){const e=this.options.resolutionGuidesOffset;[{x:1024,y:768},{x:1366,y:768},{x:1440,y:900},{x:1920,y:1080},{x:3840,y:2160}].forEach((t=>{const s=$(FxImpl.createElement("div",{class:`fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-${t.x}x${t.y} fxs-hide-in-normal`}));(e.x||e.y)&&s.css({top:e.y+"px",left:e.x+"px"}),this.element.prepend(s)}))}}var _;t.Widget=S,function(e){e.top=function(e){return e.position.row},e.bottom=function(e){return e.position.row+e.rowSpan},e.left=function(e){return e.position.col},e.right=function(e){return e.position.col+e.colSpan}}(_||(_={}));class F{constructor(){this._occupancyGrid=[]}reset(e){this._occupancyGrid.length=0,e&&e.forEach((e=>{this.markOccupancy(e)}))}isRectangleFree(e,t,s,o){const i=e+o,n=t+s;for(let s=e;s<i;s++)for(let e=t;e<n;e++)if(this.isPositionOccupied(s,e))return!1;return!0}isPositionOccupied(e,t){return!!this._occupancyGrid[e]&&!!this._occupancyGrid[e][t]}getItemAt(e,t){const s=this._occupancyGrid[e];return s?s[t]:null}markOccupancy(e,t){const s=_.top(e),o=_.bottom(e),i=_.left(e),n=_.right(e),r=this._occupancyGrid;for(let a=i;a<n;a++)for(let i=s;i<o;i++)r[a]||(r[a]=[]),r[a][i]||(r[a][i]=null),r[a][i]=t?null:e}}const T={};class k{constructor(e){this._occupancyGrid=new F,this._items=[],this._filledPositions={},this._gridOptions=e}append(e,t,s){let o=this._getExistingItem(e);if(this._filledPositions[e]=!0,o)return this._items;const i=this._maxRows(),n=this._maxCols();if(!this._gridOptions.allowOverflow&&(t>i||s>n))throw new Error("The element cannot fit in this grid. ElementRowSpan: {0}, ElementColSpan: {1}, GridMaxRowSpan: {2}, GridMaxColSpan: {3}".format(t,s,i,n));const r=this._findNextAvailablePositionForRectangle(t,s);if(!r)throw new Error("The element cannot fit in the remaining space available in the grid.");return o={id:e,position:r,rowSpan:t,colSpan:s},this._items.push(o),this._occupancyGrid.markOccupancy(o),this._items}move(e,t,s,o,i){const n={id:e,position:t,colSpan:s,rowSpan:o};let r;this._applyGridConstraints(n);const a=new D(this._items,n,this._gridOptions);return r=a.resolved?a.getItems():this._items,i&&(a.resolved&&(this._items.length=0,this._items.push(...r||[])),this._occupancyGrid.reset(this._items),this.collapseGaps()),r}resize(e,t,s,o){const i=this._getExistingItem(e),n=i.position,r={id:i.id,position:{col:n.col,row:n.row},colSpan:t,rowSpan:s},a=r.position;let l;if(this._applyGridConstraints(r),a.row<0||a.col<0)return this._items;const c=Math.max(0,t-i.colSpan),d=Math.max(0,s-i.rowSpan);let p=a.col,u=a.row;this._gridOptions.allowGaps||(p=Math.min(p,Math.max(0,n.col-c)),u=Math.min(u,Math.max(0,n.row-d)));for(let o=p;o<=a.col;o++){for(let i=u;i<=a.row;i++){const n={id:e,position:{col:o,row:i},colSpan:t,rowSpan:s},r=new D(this._items,n,this._gridOptions);if(r.resolved&&((!l||r.shiftCost<l.shiftCost)&&(l=r),l&&0===l.shiftCost))break}if(l&&0===l.shiftCost)break}const m=l?l.getItems():this._items;return o&&(l&&(this._items.length=0,this._items.push(...m||[])),this._occupancyGrid.reset(this._items),this.collapseGaps()),m}remove(e){const t=this._getExistingItem(e);this._filledPositions[e]=!1;const s=this._items.indexOf(t);return-1===s||(this._items.splice(s,1),this._occupancyGrid.markOccupancy(t,!0),this.collapseGaps()),this._items}collapseGaps(){if(this._gridOptions.allowGaps)return;const e={grid:this,isPositionOccupied:function(e,t){return this.grid._occupancyGrid.isPositionOccupied(e,t)},getMaxPositions:function(){return this.grid.getMaxOccupiedPositions()},getMinSize:function(){return{col:this.grid._minCols(),row:this.grid._minRows()}},getItemAt:function(e,t){return this.grid._occupancyGrid.getItemAt(e,t)},shiftItem:function(e,t){e.position.col-=t}},t={grid:this,isPositionOccupied:function(e,t){return this.grid._occupancyGrid.isPositionOccupied(t,e)},getMaxPositions:function(){const e=this.grid.getMaxOccupiedPositions();return{col:e.row,row:e.col}},getMinSize:function(){return{col:this.grid._minRows(),row:this.grid._minCols()}},getItemAt:function(e,t){return this.grid._occupancyGrid.getItemAt(t,e)},shiftItem:function(e,t){e.position.row-=t}};this._orientation()===x.Horizontal?(this._collapseGapsWithGridVisitor(e),this._collapseGapsWithGridVisitor(t)):(this._collapseGapsWithGridVisitor(t),this._collapseGapsWithGridVisitor(e))}getNaturalDomElementOrder(){const e=[],t=this.getMaxOccupiedPositions();for(let s=0;s<t.row;s++)for(let o=0;o<t.col;o++){const t=this._occupancyGrid.getItemAt(o,s);if(t){const s=t.id;e.includes(s)||e.push(s),o+=t.colSpan-1}}return e}getAdjacentElement(e,t){const s=this._getExistingItem(e);if(!s)return e;const o=T[t];return(o?o(this,s):s).id}get positions(){return this._items}set positions(e){this._items.length=0,this._items=e||[],this._occupancyGrid.reset(this._items)}discardUnusedPositions(){const e=[];return this._items.slice(0).forEach((t=>{this._filledPositions[t.id]||(e.push(t),this.remove(t.id))})),e}_orientation(){return this._gridOptions.orientation}_minRows(){return this._gridOptions.minRows.value}_maxRows(){return this._gridOptions.maxRows.value}_minCols(){return this._gridOptions.minColumns.value}_maxCols(){return this._gridOptions.maxColumns.value}getMaxOccupiedPositions(e){let t;const s=e||this._items;let o=0,i=0;for(t=0;t<s.length;t++){const e=s[t],n=e.position;o=Math.max(o,n.col+e.colSpan),i=Math.max(i,n.row+e.rowSpan)}return{col:o,row:i}}_getExistingItem(e){return MsPortalFx.find(this._items,(function(t){return t.id===e}))}_applyGridConstraints(e){let t;if(this._gridOptions.allowOverflow)return;const s=e.position;t=_.bottom(e)-this._maxRows(),t>0&&(s.row-=t),t=_.right(e)-this._maxCols(),t>0&&(s.col-=t)}_findNextAvailablePositionForRectangle(e,t){const s=this._maxCols()-t+1,o=this._maxRows()-e+1;let i,n;if(this._orientation()===x.Horizontal){for(n=0;n<s;n++)for(i=0;i<o;i++)if(this._isRectangleFree(n,i,e,t))return{col:n,row:i};if(this._gridOptions.allowOverflow){return{col:0,row:this.getMaxOccupiedPositions().row}}}else{for(i=0;i<o;i++)for(n=0;n<s;n++)if(this._isRectangleFree(n,i,e,t))return{col:n,row:i};if(this._gridOptions.allowOverflow){return{col:this.getMaxOccupiedPositions().col,row:0}}}}_isRectangleFree(e,t,s,o){const i=e+o,n=t+s;return!(!this._gridOptions.allowOverflow&&(n>this._maxRows()||i>this._maxCols()))&&this._occupancyGrid.isRectangleFree(e,t,s,o)}_collapseGapsWithGridVisitor(e){let t=e.getMaxPositions(),s=t.col,o=t.row;const i=[];let n,r,a=!1;if(!(s<=e.getMinSize().col))for(let l=0;l<s;l++){r=null;for(let t=0;t<o;t++){a=!1,i[t]=this._findGap(t,l,s,e);const o=i[t].colSpan;if(0===o)return;if((!r||o<r)&&(r=o),t>0&&!this._gapsAreContiguous(i[t-1],i[t]))break;a=!0}if(a){n={};for(let t=0;t<o;t++)for(let o=_.right(i[t]);o<s;o++){const s=e.getItemAt(o,t);s&&(n[s.id]=s)}$.each(n,((t,s)=>{e.shiftItem(s,r)})),this._occupancyGrid.reset(this._items),t=e.getMaxPositions(),s=t.col,o=t.row}}}_gapsAreContiguous(e,t){const s=_.left(t),o=_.right(t),i=_.left(e);return _.right(e)>=s&&i<=o}_findGap(e,t,s,o){let i=t;const n={id:"",position:{row:e,col:0},rowSpan:1,colSpan:0};for(;i<s&&o.isPositionOccupied(i,e);)i++;for(n.position.col=i;i<s&&!o.isPositionOccupied(i,e);)n.colSpan++,i++;return n}static _scanAdjacentUp(e,t){const s=t.position,o=s.col,i=s.row-1,n=s.col+t.colSpan;for(let t=i;t>=0;t--)for(let s=o;s<n;s++){const o=e._occupancyGrid.getItemAt(s,t);if(o)return o}return t}static _scanAdjacentRight(e,t){const s=t.position,o=s.col+t.colSpan,i=s.row,n=e.getMaxOccupiedPositions().col,r=s.row+t.rowSpan;for(let t=o;t<n;t++)for(let s=i;s<r;s++){const o=e._occupancyGrid.getItemAt(t,s);if(o)return o}return t}static _scanAdjacentDown(e,t){const s=t.position,o=s.col,i=s.row+t.rowSpan,n=s.col+t.colSpan,r=e.getMaxOccupiedPositions().row;for(let t=i;t<r;t++)for(let s=o;s<n;s++){const o=e._occupancyGrid.getItemAt(s,t);if(o)return o}return t}static _scanAdjacentLeft(e,t){const s=t.position,o=s.col-1,i=s.row,n=s.row+t.rowSpan;for(let t=o;t>=0;t--)for(let s=i;s<n;s++){const o=e._occupancyGrid.getItemAt(t,s);if(o)return o}return t}}t.FlowLayoutPositioningEngine=k,T[1]=k._scanAdjacentUp,T[2]=k._scanAdjacentRight,T[3]=k._scanAdjacentDown,T[4]=k._scanAdjacentLeft;class D{constructor(e,t,s){this.shiftCost=0,this.resolved=!1,this._resolvedItems=[],this._occupancyGrid=new F,this._gridOptions=s,e.forEach((e=>{let s;t.id!==e.id&&(s=$.extend(!0,{},e),this._resolvedItems.push(s),this._occupancyGrid.markOccupancy(s))})),this.resolved=this._resolveConflict(t);const o=$.extend(!0,{},t);this._resolvedItems.push(o),this._occupancyGrid.markOccupancy(o)}getItems(){return this._resolvedItems}_orientation(){return this._gridOptions.orientation}_maxRows(){return this._gridOptions.maxRows.value||999}_maxCols(){return this._gridOptions.maxColumns.value||999}_resolveConflict(e){let t=!1;return this._orientation()===x.Horizontal?(t=this._tryMoveConflictsLeft(e,{})||t,t=this._tryMoveConflictsUp(e,{})||t,t=this._tryMoveConflictsDown(e,{})||t,t=this._tryMoveConflictsRight(e,{})||t):(t=this._tryMoveConflictsUp(e,{})||t,t=this._tryMoveConflictsLeft(e,{})||t,t=this._tryMoveConflictsRight(e,{})||t,t=this._tryMoveConflictsDown(e,{})||t),t}_tryMoveConflictsUp(e,t){t[e.id]=!0;for(let s=_.left(e);s<_.right(e);s++)for(let o=_.top(e);o<_.bottom(e);o++){const i=this._occupancyGrid.getItemAt(s,o);if(i&&!t[i.id]){t[i.id]=!0,o=_.bottom(i);const s=_.top(e)-_.bottom(i),n=this._getConflictArea(i,0,s);if(_.bottom(n)>this._maxRows()||_.top(n)<0)return!1;if(!this._tryMoveConflictsUp(n,t))return!1;this._moveItem(i,0,s),t[i.id]=!1}}return!0}_tryMoveConflictsDown(e,t){t[e.id]=!0;for(let s=_.left(e);s<_.right(e);s++)for(let o=_.bottom(e)-1;o>=_.top(e);o--){const i=this._occupancyGrid.getItemAt(s,o);if(i&&!t[i.id]){t[i.id]=!0,o=_.top(i);const s=_.bottom(e)-_.top(i),n=this._getConflictArea(i,0,s);if(_.bottom(n)>this._maxRows()||_.top(n)<0)return!1;if(!this._tryMoveConflictsDown(n,t))return!1;this._moveItem(i,0,s),t[i.id]=!1}}return!0}_tryMoveConflictsLeft(e,t){t[e.id]=!0;for(let s=_.top(e);s<_.bottom(e);s++)for(let o=_.left(e);o<_.right(e);o++){const i=this._occupancyGrid.getItemAt(o,s);if(i&&!t[i.id]){t[i.id]=!0,o=_.right(i);const s=_.left(e)-_.right(i),n=this._getConflictArea(i,s,0);if(_.right(n)>this._maxCols()||_.left(n)<0)return!1;if(!this._tryMoveConflictsLeft(n,t))return!1;this._moveItem(i,s,0),t[i.id]=!1}}return!0}_tryMoveConflictsRight(e,t){t[e.id]=!0;for(let s=_.top(e);s<_.bottom(e);s++)for(let o=_.right(e)-1;o>=_.left(e);o--){const i=this._occupancyGrid.getItemAt(o,s);if(i&&!t[i.id]){t[i.id]=!0,o=_.left(i);const s=_.right(e)-_.left(i),n=this._getConflictArea(i,s,0);if(_.right(n)>this._maxCols()||_.left(n)<0)return!1;if(!this._tryMoveConflictsRight(n,t))return!1;this._moveItem(i,s,0),t[i.id]=!1}}return!0}_getConflictArea(e,t,s){const o=s<0,i=t<0,n=e.position;return{id:e.id,position:{row:o?n.row+s:n.row,col:i?n.col+t:n.col},rowSpan:e.rowSpan+Math.abs(s),colSpan:e.colSpan+Math.abs(t)}}_moveItem(e,t,s){this._occupancyGrid.markOccupancy(e,!0);const o=e.position;o.col+=t,o.row+=s,this._occupancyGrid.markOccupancy(e),this.shiftCost+=e.colSpan*e.rowSpan}}t.FlowLayoutPositionConflictResolver=D})),
define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.Timers","MsPortalImpl/UI/UI.DesktopManager","Viva.Controls/Util/Viva.Resize","Weave","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,m.injectCss)(h);const g=MsPortalFx.Base.Diagnostics.createLog(e),f=s.Dashboard,x=window.fx.environment;class b extends l.ViewModel{constructor(e,t,o,i,l,c,d){super(e),this.loading=l,this.notFound=c,this.diContainer=d,this.title=(0,u.makeWritableComputation)(s.Dashboard.defaultTitle),this.dashboardList=(0,u.makeWritableComputation)(),this.headerMode=(0,u.makeWritableComputation)(0),this.isShared=(0,u.makeWritableComputation)(!1),this.notFoundMessage=(0,u.makeWritableComputation)(""),this.subscriptionsInfo=(0,u.makeWritableComputation)(""),this.dashboardErrorMessage=(0,u.makeWritableComputation)(""),this.dashboardChanged=(0,u.makeWritableComputation)(!1),this.dashboardSaveInProgress=(0,u.makeWritableComputation)(!1),this.userPermissions=(0,u.makeWritableComputation)({canModify:!1,canDelete:!1}),this.finishDashboardEdit=$.noop,this.locked(!1);const p=this.flowLayoutOptions=new r.ViewModel("fxs-flowlayout-instanceid");p.allowReorder=!0,p.allowOverflow=!0,p.allowGaps=!0,p.resolutionGuides=!0,p.resolutionGuidesOffset.y=-88,p.orientation=a.Orientation.Vertical,p.minColumns(4),p.maxColumns(6),p.minRows(4),p.locked(!1),this.filtersWidgetViewModel=o,this.dashboardDropMenuViewModel=new n.ViewModel(void 0,void 0,".fxs-startboard-dropdown-dashboard, .fxs-startboard-button-browse"),this.dashboardDropMenuViewModel.alignMenu=0,this.dashboardDropMenuViewModel.telemetrySource="Dashboard",this.commands=i,this.applyViewSettings(t)}getViewSettings(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}}applyViewSettings(e){e&&e.NormalState&&e.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(e.NormalState.layoutSettings)}setWidget(e){this._widget=e}getWidget(){return this._widget}exitOrganizeMode(){this.diContainer.get(d.DesktopManagerMode).value(0);const e=this._widget.element.find(".fxs-startboard-button-edit>.azc-toolbarButton-container");e.length&&e.focus()}}t.ViewModel=b;class y extends l.Widget{constructor(e,t,n){super(e,t,!0),this._focusToDropMenu=n,this._layout=null,this._setFocusOnAnimationFrame=c.throttleByAnimationFrame((()=>{let e;if(this._$lastFocused&&$.contains(this.element[0],this._$lastFocused[0])&&i.isVisible(this._$lastFocused)&&(this._$lastFocused.focus(),e=!0),!e){const e=this._layout.element.findFirstTabbable();1===e.length?e.focus():this._focusToDropMenu()}})),t.setWidget(this);const a=this.ltm;let l;this._features=t.diContainer.get(FxImpl.Features),(0,u.subscribeAndRun)(a,[t.title],(e=>{document.title=s.Portal.windowTitleFormat.format(e,x.branding.title)})),this._layout=new r.Widget($(e[0].querySelector(".fxs-startboard-layout")),t.flowLayoutOptions,!0);const m=e=>{l=e;const s=Math.max(6,Math.floor((e-420)/90));t.flowLayoutOptions.maxColumns(s)},h=t.diContainer.get(d.DesktopManagerMode).value;h.subscribe(this.ltm,(e=>{1===e&&m(this.element.width())})),p.track(this.ltm,this.element.first(),(e=>{1===h()&&l!==e&&m(e)})),this._initializeCommands(a,e),this._attachEventHandlers(e),a.registerForDispose([o.setup(e,ko.observableArray(t.commands))])}dispose(){this._layout.dispose(),super.dispose()}createTiles(e){return this._layout.createTiles(e,this.options.diContainer)}addChild(e){if(!e)throw new Error("Can't add null child.");this._layout.addChild(e)}removeChild(e){return this._layout.removeChild(e)}moveChild(e,t,s,o){this._layout.moveChild(e,t,s,o)}setFocus(){this._features.isEnabled("skipautofocus")||this._setFocusOnAnimationFrame()}saveViewSettings(){return this.options.getViewSettings()}discardStateOfUnusedChildren(){return g.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}}getDomOrderedChildren(){return this._layout.getDomOrderedChildren()}_attachEventHandlers(e){this.ltm.registerForDispose(e.setEvents(["layoutUpdated",t=>{e.trigger(l.Widget.viewSettingsChanged,this.saveViewSettings()),t.stopPropagation()}],["focusout",e=>{this._$lastFocused=$(e.target)}]))}_initializeCommands(e,t){const s=this.options,o=s.dashboardDropMenuViewModel,i=c.debounce((()=>{this._focusToDropMenu()}));o.isMenuOpen.subscribe(e,(e=>{e&&s.refreshDashboardList&&(s.dashboardList(void 0),s.refreshDashboardList((e=>{s.dashboardList(e),i()})))})),(0,u.subscribeAndRun)(this.ltm,[s.title],(e=>{o.buttonTooltip(e),o.buttonLabel(f.switcherLabel),o.buttonDescribedBy(f.switcherDescribedby.format(e))}))}}t.Widget=y})),
define("MsPortalImpl/Services/Services.Copilot",["require","exports","MsPortalImpl/UI/UI.AuthStateManager","Fx/Experimentation","FxInternal/RpcEndPointsCore","FxInternal/AsyncLoader"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCopilotEnabledHandler=t.isCopilotEnabled=void 0;function r(e){const t=e.get(s.AuthStateManager).getCurrentUser(),i=e.get(o.Experimentation).shellAssignments,n=MsPortalFx.isFeatureEnabled("unifiedcopilot");let r=i.getBooleanValue("unifiedcopilot");const a=i.getBooleanValue("copilotmanageability");let l=1;for(;!r&&l<=50;){const e="unifiedcopilot"+l;r=i.getBooleanValue(e),l+=1}const c=!!(n||r||a),d=!t.objectId;return c&&!d}t.isCopilotEnabled=r,t.isCopilotEnabledHandler=(0,n.defineHandler)(i.isCopilotEnabledEndpoint,(({diContainer:e})=>r(e)))})),
define("MsPortalImpl/Widgets/Widgets.AsyncSearch",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave","Weave/Core/Computation","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=t.searchBoxClass=t.searchClass=void 0;var l=MsPortalFx.Base.Images;(0,r.injectCss)(a),t.searchClass="fxs-search",t.searchBoxClass="fxs-search-box";const c=s.Search,d=s.SideBarFlyout.disabledMessage;class p extends o.ViewModel{constructor(){super(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._dropdownInitialized=Promise.withResolvers(),this.isExpanded=(0,i.makeWritableComputation)(!1),this.showMenu=ko.observable(!1),this.showResults=ko.observable(!1),this.showSearching=ko.observable(!1),this.showNoResults=ko.observable(!1),this.noResultsMessage=ko.observable(),this.noResultsChangeSubscriptionsText=c.Pills.noResultsMessageWithLinks.format(`<a href="#settings/directory">${c.Pills.directoryAndSubscriptionSettings}</a>`),this.showChangeSubscriptions=ko.observable(!1),this.isSearchComplete=ko.observable(!1),this.text={...c,DisabledByPolicyMessage:d},this.filter=ko.observable(""),this.searchInFilterText=ko.observable(),this.subscriptionSummary=ko.observable(),this.mruItems=ko.observableArray(),this.searchHistory=ko.observableArray(),this.recentServices=ko.observableArray(),this.additionalSearchProviders=ko.observableArray(),this.resultsPanel=ko.observableArray(),this.pillsCollection=ko.observable(),this.currentPill=ko.observable(),this.menuId=MsPortalFx.getUniqueId(),this.showAzureCopilotLink=ko.observable(!1),this.azureCopilotLinkHtml=ko.observable(),this.icons={hyperlink:l.Hyperlink(),favorite:l.Star({palette:99}),notFavorite:l.Favorite({palette:99})}}isDropdownInitialized(){return this._dropdownInitialized.promise}dispose(){this._ltm.dispose()}setFocus(){this._widget&&this._widget.setFocus()}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget.element}}t.ViewModel=p;class u extends o.Widget{constructor(e,s,o){super(e,s,!0),this._documentCategoryDisplayName=c.documentation,s.setWidget(this),s.showMenu.subscribe(this.ltm,(e=>{e||(s.filter(""),this._textField&&this._textField.val(""))})),window.fx.environment.chrome.hideSearchBox&&e.addClass("fxs-display-none"),this._textField=$(e[0].querySelector(`.${t.searchBoxClass} input`));const i=e=>{n.dispose(),s.showMenu(!0),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AsyncSearchDeferred").then((e=>{e.initialize(this.ltm,o,s,this._textField),s._dropdownInitialized.resolve()}))};e[0].addEventListener("focusin",i);const n=this.ltm.createChildLifetime();n.registerForDispose((()=>e[0].removeEventListener("focusin",i)))}setFocus(){this.options.isExpanded(!0);const e=document.activeElement;(0,n.invokeAfterChangePropagation)((()=>{e===document.activeElement&&this._textField.focus()}))}}t.Widget=u})),
define("MsPortalImpl/Dialogs/MessageBoxInternal",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageBoxExtended=void 0;var s=MsPortalFx.ViewModels.Dialogs;class o extends s.MessageBox{}t.MessageBoxExtended=o})),
define("_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css",["module"],(function(e){"use strict";return{css:".fxs-messagebox{font-size:14px;min-width:120px;box-sizing:border-box;border-width:1px;border-style:solid;line-height:normal;position:relative;overflow:hidden}.fxs-progressbox{color:#fff}.fxs-messagebox-title{padding:12px 20px 7px;margin:0;border-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-progressbox-text,.fxs-modal-template,.fxs-messagebox-template,.fxs-messagebox-text{padding:0 20px 8px;word-wrap:break-word}.fxs-messagebox-title.fxs-display-none+.fxs-modal-template,.fxs-messagebox-title.fxs-display-none+.fxs-messagebox-template,.fxs-messagebox-title.fxs-display-none+.fxs-messagebox-text{padding-top:12px}.fxs-messagebox-buttons{padding:8px 20px 16px}.fxs-messagebox-buttons .fxs-button{margin-right:8px}.fxs-progressbox-progressbar{padding:7px 20px 24px}.azc-balloon-dialog .fxs-messagebox{box-shadow:unset;border:0}.fxs-messagebox-confirmation{padding:10px 20px 0;display:block}.fxs-formdialog-description{padding:0 0 15px}.fxs-formdialog-form{max-width:458px}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","Fx/Controls/Button","Fx/Controls/CheckBox","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css","MsPortalImpl.Controls/Controls/SimpleButton"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageBoxWithCallback2=t.createMessageBoxWithCallback=t.Widget=t.ViewModel=t.setFocusOnMessageBox=void 0,(0,u.injectCss)(m);const h=MsPortalFx.Base.Diagnostics.createLog(e),g=MsPortalFx.getIdGenerator("messagebox"),f=n.Dialogs.ButtonText,x=[];x[0]=f.abort,x[1]=f.cancel,x[2]=f.ignore,x[3]=f.no,x[4]=f.ok,x[5]=f.retry,x[6]=f.yes;const b="fxs-portal-bg-txt-br",y="msportalfx-shadow-level2",v="fxs-popup",M="fxs-messagebox",C="fxs-messagebox-text",P=s("div",null,s("h2",{"data-bind":{text:"data.title",visible:"!data.hideTitle"},class:"fxs-messagebox-title az-text-header1 msportalfx-tooltip-overflow"}),s(o.KoIf,{condition:"data.trustedTemplate"},s(o.KoIfNot,{condition:"data.template"},s("div",{"data-bind":{sanitizedHtml:"data.text"},class:C})),s(o.KoIf,{condition:"data.template"},s("div",{class:"fxs-modal-template","data-bind":{trustedHtml:{html:"data.template",data:"data.templateViewModel",isolated:"true"}}}))),s(o.KoIfNot,{condition:"data.trustedTemplate"},s(o.KoIfNot,{condition:"data.template"},s("div",{"data-bind":{text:"data.text"},class:C})),s(o.KoIf,{condition:"data.template"},s("div",{class:"fxs-messagebox-template","data-bind":{untrustedHtml:{html:"data.template",data:"data.templateViewModel",isolated:"true"},keyedCss:{scopingClasses:"data.scopeClass"}}}))),s(o.KoIf,{condition:"data.confirmationRequired"},s("div",{"data-bind":{pcControl:"func.checkboxVm"},class:"fxs-messagebox-confirmation"})),s("div",{class:"msportalfx-form fxs-messagebox-buttons","data-bind":{foreach:"func.buttonVms",visible:"func.buttonVms().length >= 1"}},s("div",{"data-bind":{pcControl:"$data.vm",attr:{"data-result":"$data.result"}}})));let w=document.activeElement;function I(e,t){const s=e.closest(`.${M}`);s.length>0&&c.waitForBindings(s[0]).then((()=>{setTimeout((()=>{const e=l.Widget.getWidget(s,_);let t=s.findFirstTabbable();0!==t.length||MsPortalFx.isNullOrUndefined(e)||(t=e.element),t.closest(".fxs-messagebox-buttons").length>0?(e.element.find(".fxs-portal-button-primary")&&e.element.find(".fxs-portal-button-primary").focus(),e.element.find(".fxs-portal-button-danger")&&e.element.find(".fxs-portal-button-danger").focus()):t.focus()}),10)})).catch($.noop);let o=t||document.activeElement;for(;o&&"function"!=typeof o.focus;)o=$(o).closest("[tabindex]")[0];w=o}t.setFocusOnMessageBox=I;class S extends l.ViewModel{constructor(){super(...arguments),this.title=ko.observable(),this.text=ko.observable(),this.template=ko.observable(),this.templateViewModel=ko.observable(),this.trustedTemplate=!1,this.modal=!1,this.buttons=1,this.confirmationRequired=!1,this.hideTitle=!1,this.scopeClass=""}get onButtonClick(){return this._buttonClick}set onButtonClick(e){if(this._buttonClick)throw new Error("The onButtonClick callback has already been set.");this._buttonClick=e}}t.ViewModel=S;class _ extends l.Widget{constructor(e,t){super(e,t),this.buttonVms=ko.observableArray([]),e.html(P).addClass(M).addClass(v).addClass(b).addClass(y),e.closest(".azc-balloon-dialog").attr("role",null);const s=this.ltm,o=e=>{const t=this.element[0],s=$(e).closest(".azc-dockedballoon-balloon").attr("id");return!(this.options.modal||t===e||$.contains(t,e)||s&&(this.element.find(`.azc-dockedballoon-anchor[aria-owns='${s}']`).length||this.element.find(`.azc-dockedballoon-anchor[aria-controls='${s}']`).length))?2:0};this._dismissHandle={dismissFn:()=>{this.cancelBtn&&this.cancelBtn!==this.defaultBtn?ko.unwrap(this.cancelBtn.onClick)():"function"==typeof this.options.onButtonClick&&this.options.onButtonClick(1)},shouldDismissOnMouseDownFn:o,shouldDismissOnMouseWheelFn:o,restoreFocus:()=>{const e=this.element[0],t=document.activeElement;($.contains(e,t)||t===e)&&r.validatePreviousFocusedElement(this._dismissHandle,w)&&w.focus()},logName:"messagebox"},t.confirmationRequired&&(this.checkboxVm=p.create(s,{label:t.confirmationMessage,labelOnRight:!0})),this._getButtonHtml(t.buttons,s),this._bindDescendants(),this._setAria();let i=document.activeElement;t.sourceTarget&&(this.element[0]===t.sourceTarget||t.sourceTarget.contains(document.activeElement)||(i=t.sourceTarget)),new a.KeyboardNavigation(this.ltm,{element:e,tabTriggers:2}),I(e,i),r.register(this._dismissHandle),s.registerForDispose((()=>{this._dismissHandle.restoreFocus(),r.unregister(this._dismissHandle)})),t.confirmationRequired&&(this.checkboxVm.value(!1),ko.reactor(s,(()=>{this.defaultBtn.disabled(!this.checkboxVm.value())})))}dispose(){this._cleanElement(M,v,b,y),super.dispose()}generateBtns(e,t){if(0===t.length)return;const s=this.buttonVms,o=(e,t,s)=>d.create(e,{text:s.text,style:t,disabled:s.disabled,onClick:()=>{"function"==typeof this.options.onButtonClick&&this.options.onButtonClick(s.result),this._dismissHandle.restoreFocus()}});s().forEach((e=>{e.vm.dispose()})),s().length=0,s([]),this.defaultBtn=null,this.cancelBtn=null,this.extraBtn=null,t.forEach(((t,i)=>{switch(0===i&&1!==t.kind&&4!==t.kind&&h.error("The first button should be the default button for this dialog."),!this.defaultBtn||1!==t.kind&&4!==t.kind||h.error("Only one default button should be defined."),this.cancelBtn&&2===t.kind&&h.error("Only one cancel button should be defined."),t.kind){case 1:s.push({vm:o(e,0,t),result:t.result}),this.defaultBtn=MsPortalFx.last(s()).vm;break;case 2:s.push({vm:o(e,1,t),result:t.result}),this.cancelBtn=MsPortalFx.last(s()).vm;break;case 4:s.push({vm:o(e,2,t),result:t.result}),this.defaultBtn=MsPortalFx.last(s()).vm;break;default:s.push({vm:o(e,1,t),result:t.result}),this.extraBtn=MsPortalFx.last(s()).vm}})),1===t.length&&(this.cancelBtn=this.defaultBtn),MsPortalFx.isNullOrUndefined(this.cancelBtn)&&h.error("Cancel button should be defined.")}_getButtonHtml(e,t){const s=this.options;if(s.customBtns)this.generateBtns(t,s.customBtns);else{switch(e){case 0:this.generateBtns(t,[{kind:1,text:f.retry,result:5},{kind:2,text:f.abort,result:0},{kind:3,text:f.ignore,result:2}]);break;case 1:this.generateBtns(t,[{kind:1,text:f.ok,result:4}]);break;case 2:this.generateBtns(t,[{kind:1,text:f.ok,result:4},{kind:2,text:f.cancel,result:1}]);break;case 3:this.generateBtns(t,[{kind:1,text:f.retry,result:5},{kind:2,text:f.cancel,result:1}]);break;case 4:this.generateBtns(t,[{kind:1,text:f.yes,result:6},{kind:2,text:f.no,result:3}]);break;case 5:this.generateBtns(t,[{kind:1,text:f.yes,result:6},{kind:3,text:f.no,result:3},{kind:2,text:f.cancel,result:1}]);break;case 6:this.generateBtns(t,[{kind:4,text:f.delete,result:7},{kind:2,text:f.cancel,result:1}]);break;case 7:this.generateBtns(t,[{kind:4,text:f.delete,result:7},{kind:2,text:f.goBack,result:8}]);break;default:throw new Error("Could not locate message box button of type {0}.".format(e))}this.defaultBtn&&s.defaultButtonText&&this.defaultBtn.text(s.defaultButtonText),this.cancelBtn&&s.cancelButtonText&&this.cancelBtn.text(s.cancelButtonText),this.extraBtn&&s.extraButtonText&&this.extraBtn.text(s.extraButtonText)}}_setAria(){const e=this.element,t=e.find(`.${C}`),s=g(),o=g();e.attr({role:"dialog","aria-labelledby":o,"aria-describedby":t.length?s:null}),e.find("h2").attr("id",o),t.attr("id",s),this.ltm.registerForDispose((()=>{e.removeAttr("role aria-labelledby aria-describedby tabindex")}))}}t.Widget=_,t.createMessageBoxWithCallback=function(e,t,s,o){const i=new S;return i.title(s.title),s.templateViewModel?(i.template(s.text),i.templateViewModel(s.templateViewModel)):i.text(s.text),i.buttons=s.buttons,i.onButtonClick=e=>{t(e)},i.modal=o.modal,i.trustedTemplate=o.trustedTemplate,i.defaultButtonText=s.defaultButtonText,i.cancelButtonText=s.cancelButtonText,i.extraButtonText=s.extraButtonText,i.confirmationRequired=s.confirmationRequired,i.confirmationMessage=s.confirmationMessage,i.hideTitle=s.hideTitle,i.scopeClass=o.scopeClass,i.sourceTarget=o.sourceTarget,new _(e,i)},t.createMessageBoxWithCallback2=function(e,t,s,o){s.positionHint=s.positionHint||3;const n=new S;n.title(s.title),"object"==typeof s.content?(n.template(s.content.htmlTemplate),n.templateViewModel(s.content.viewModel)):"string"==typeof s.content&&n.text(s.content),Array.isArray(s.buttons)?(n.customBtns=[],s.buttons.forEach((e=>{const t=e.displayText||x[e.button];n.customBtns.push({kind:3,text:t,result:e.button,disabled:e.disabled})})),n.customBtns.length&&(n.customBtns[0].kind=1,n.customBtns.length>1&&(MsPortalFx.last(n.customBtns).kind=2))):n.buttons=s.buttons,n.modal=o.modal,n.trustedTemplate=o.trustedTemplate,n.hideTitle=s.hideTitle,n.scopeClass=o.scopeClass;const r=new _(e,n),a=r.buttonVms()[0],l=a&&a.result;return n.onButtonClick=s=>{l===s?i.ensureFormFieldValidation(e,!0).then((o=>{o?t(s):i.focusOnFirstInvalidField(e)})).catch($.noop):t(s)},r}})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","FxInternal/Controls/Section","Fx/Controls/Section","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css"],(function(e,t,s,o,i,n,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFormDialogWithCallback=t.Widget=t.ViewModel=void 0,(0,c.injectCss)(d);const p="fxs-formdialog",u=s(o.Root,null,s("div",{class:"fxs-formdialog-description fxs-messagebox-text","data-bind":{text:"description"}}),s("div",{class:"fxs-formdialog-form msportalfx-form","data-bind":{pcControl:"formSection"}}));class m extends n.ViewModel{constructor(e,t){if(super(),this.diContainer=t,this.lifetime=new FxImpl.TriggerableLifetimeManager,MsPortalFx.isNullOrUndefined(e))throw new Error("dialogOptions must be specified for rendering a form dialog.");const s=[[e.row1column1,e.row1column2],[e.row2column1,e.row2column2]],o=this.lifetime,i=s.map((e=>{const t=e.filter(MsPortalFx.identity).map((e=>r.create(o,{style:0,children:[e]})));if(t.length)return r.create(o,{style:3,children:t})})).filter(MsPortalFx.identity),n=a.create(o,{children:i});this.title(e.title),this.customBtns=[{kind:1,result:4,text:l.Dialogs.okButtonText,disabled:ko.computed(o,(()=>!n.valid()))},{kind:2,result:1,text:l.Dialogs.cancelButtonText}],this.template(u),this.templateViewModel({description:e.description,formSection:n}),this.trustedTemplate=!0}dispose(){this.lifetime.dispose()}}t.ViewModel=m;class h extends n.Widget{constructor(e,t){super(e,t),e.addClass(p)}dispose(){this.options.dispose(),this._cleanElement(p),super.dispose()}}t.Widget=h,t.createFormDialogWithCallback=function(e,t,s){const o=new m(s);return o.onButtonClick=s=>{4===s?i.ensureFormFieldValidation(e,!0).then((o=>{o?t(s):i.focusOnFirstInvalidField(e)})):t(s)},new h(e,o)}})),
define("_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup.css",["module"],(function(e){"use strict";return{css:".fxs-listpopup{display:inline-block;cursor:default;position:absolute;left:0;width:200px;max-height:300px;z-index:200;overflow-y:auto;box-sizing:border-box}.fxs-listpopup-list{list-style-type:none;padding:0;max-height:300px}.fxs-listpopup-item{font-size:13px;line-height:normal;display:flex;align-items:center;flex:0 0 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:relative;box-sizing:border-box;padding:0 10px;border:0;overflow:visible;text-align:left;height:35px;cursor:pointer}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup.css","Fx"],(function(e,t,s,o,i,n,r,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListPopupWithCallback=t.Widget=t.ViewModel=void 0,(0,a.injectCss)(l);var d=MsPortalFx.Base.Diagnostics;const p=".fxs-commandBar-item",u=".azc-toolbarButton-container:first",m="fxs-listpopup",h=d.createLog(e),g="fxs-portal-bg-txt-br",f="msportalfx-shadow-level2",x="fxs-popup",b="fxs-listpopup-list",y="fxs-listpopup-item",v=`.${y}`,M=s("ul",{class:b,"data-bind":{foreach:"func._items"},role:"menu"},s("li",{role:"menuitemradio",class:[y,"fxs-portal-hover"],tabindex:"-1","data-bind":{text:"text",css:{"fxs-listpopup-item-selected fxs-portal-selected fxs-portal-activated fxs-br-primary":"text === $root.data.dialogOptions.selectedItem()"},event:{click:"onClick",keydown:"onKeyDown"},attr:{title:"text","aria-setsize":"$parent.func._items().length","aria-posinset":"$index() + 1","aria-checked":'text === $root.data.dialogOptions.selectedItem() ? "true" : "false"'}}}));class C extends r.ViewModel{}t.ViewModel=C;class P extends r.Widget{constructor(e,t){super(e,t),t.dialogOptions||h.error("dialogOptions must be specified for rendering a list popup.");const s=document.activeElement,r=t=>t===s||$.contains(s,t)||e[0]===t||$.contains(e[0],t)?0:2,a=this._dismissHandle={dismissFn:()=>{const e=t.onLostFocus;e&&e()},shouldDismissOnFocusOutFn:r,shouldDismissOnMouseDownFn:r,shouldDismissOnMouseWheelFn:r,restoreFocus:()=>{o.validatePreviousFocusedElement(a,s)&&s.focus()},logName:"listpopup"};this._items=ko.computed(this.ltm,(()=>{const e=e=>{"function"==typeof t.onItemSelected&&(t.dialogOptions.selectedItem(e),t.onItemSelected(),a.restoreFocus())};return t.dialogOptions.listItems().map((t=>({text:t,onClick:(s,o)=>{o.stopPropagation(),e(t)},onKeyDown:(s,o)=>{if(13!==o.keyCode&&32!==o.keyCode||0!==i.getModifierKeys(o))return!0;o.stopPropagation(),e(t)}})))})),e.addClass(`${m} ${x} ${g} ${f}`).html(M),new n.KeyboardNavigation(this.ltm,{element:e.find(`.${b}`),tabTriggers:12,itemSelector:v}),e.closest(p).find(u).attr("aria-expanded","true"),this._bindDescendants(),c.nextTick((()=>{this.setFocus()})),o.register(a)}dispose(){o.unregister(this._dismissHandle),this._cleanElement(m,x,g,f),this.element.removeAttr("tabindex").closest(p).find(u).attr("aria-expanded","false"),super.dispose()}setFocus(){this.element.find(v).first().focus()}}t.Widget=P,t.createListPopupWithCallback=function(e,t,s,o){const i=new C;return i.dialogOptions=o,i.onItemSelected=()=>{s(4)},i.onLostFocus=e,new P(t,i)}})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createProgressBox=t.Widget=t.ViewModel=void 0,(0,r.injectCss)(a);const l=i.Dialogs.ProgressBar,c="fxs-progressbox",d=s(o.Root,null,s("div",{"data-bind":{text:"data.text"},class:"fxs-progressbox-text fxs-messagebox-text"}),s("div",{"data-bind":{text:"data.completionText"},class:"fxs-progressbox-progressbar"}));class p extends n.ViewModel{constructor(e,t){super(),this.text=ko.observable(),this.completionPercentage=ko.observable(-1),ko.isObservable(e)&&(this.text=e),ko.isObservable(t)&&(this.completionPercentage=t),this.completionText=ko.pureComputed((()=>{const e=this.completionPercentage();return e<0||e>100?"":l.percentComplete.format(e)})),this.template(d),this.templateViewModel({data:{text:this.text,completionText:this.completionText}}),this.trustedTemplate=!0}}t.ViewModel=p;class u extends n.Widget{constructor(e,t){super(e,t),e.addClass(c)}dispose(){this._cleanElement(c),super.dispose()}}t.Widget=u,t.createProgressBox=function(e,t){const s=new p(t.text,t.completionPercentage);return s.title(t.title),s.customBtns=[],new u(e,s)}})),
define("_generated/MsPortalImpl/Svg/Startup/Error.svg",["require","exports"],(function(e,t){"use strict";return{type:77,data:"<svg viewBox='0 0 2048 2048' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M960 0q133 0 255 34t230 96 194 150 150 195 97 229 34 256q0 133-34 255t-96 230-150 194-195 150-229 97-256 34q-133 0-255-34t-230-96-194-150-150-195-97-229T0 960q0-133 34-255t96-230 150-194 195-150 229-97T960 0zm0 1792q114 0 220-30t199-84 169-130 130-168 84-199 30-221q0-114-30-220t-84-199-130-169-168-130-199-84-221-30q-115 0-221 30t-198 84-169 130-130 168-84 199-30 221q0 114 30 220t84 199 130 169 168 130 199 84 221 30zM896 512h128v640H896V512zm0 768h128v128H896v-128z'/></g></svg>"}})),
define("MsPortalImpl/UI/UI.DialogManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Dialogs/MessageBoxInternal","MsPortalImpl/Base/Themes","MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog","MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox","_generated/MsPortalImpl/Svg/Startup/Error.svg","_generated/MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/Base/Base.SvgHelper","FxInternal/Composition/ContainerViewModel"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DialogManager=t.MessageBox=void 0;var f=MsPortalFx.Base,x=f.Diagnostics,b=x.Telemetry;const y=$(window.document.body),v=x.createLog(e),M="Shell";function C(e){return"The {0} used to render the dialog was not specified.".format(e)}t.MessageBox=o.MessageBoxExtended;class P{constructor(e,t){this._portalIdleService=e,this._diContainer=t}get hasOpenDialog(){return!!this._dismissOpenDialog}dismissOpenDialog(e){this._dismissOpenDialog&&(this._dismissOpenDialog(e),this._dismissOpenDialog=null)}showModalDialog(e){const s=$(FxImpl.createElement("div",{class:"fxs-portal-shield-icon"})),o=$(FxImpl.createElement("div")),i=$(FxImpl.createElement("div",{class:"fxs-portal-shield-modaldialog"}));i.append(s,o);const n=$(FxImpl.createElement("div",{class:"fxs-portal-shield-middle"})),r=$(FxImpl.createElement("div",{class:"fxs-portal-shield"}));let a,l;n.append(i),r.append(n),y.append(r),e.showErrorIcon?(a=h.getSvgReferenceOrFallBackToData(MsPortalFx.extend2(c,{data:I(c.data,"msportalfx-svg-c22")})),l="fxs-portal-shield-icon-error"):(a=h.getSvgReferenceOrFallBackToData(MsPortalFx.extend2(d,{data:I(d.data,"msportalfx-svg-c10")})),l="fxs-portal-shield-icon-warning"),s.empty().addClass(l).append(a),this._currentCancelToken&&(this._currentCancelToken.cancel(),this._currentCancelToken=null);const p=new t.MessageBox(e.title,e.description,e.buttons);return p.defaultButtonText=e.defaultButtonText,p.cancelButtonText=e.cancelButtonText,p.templateViewModel=e.templateViewModel,this._showDialog(o,p,{modal:!0,trustedTemplate:!0,locator:null}).then((t=>{const o=e.uiShield&&e.uiShield.hidePromise;return o?(this._currentCancelToken=new f.Promises.CancelationToken,f.Promises.makeCancelable(o,this._currentCancelToken).then((()=>{r.remove()}))):r.remove(),s.removeClass(l),t})).finally((()=>{this._portalIdleService.signalBusy()}))}showDialog(e,t,s,o){if(!e)throw new Error(C("dialogOptions"));if(!t)throw new Error(C("formTarget"));if(!s)throw new Error(C("sourceTarget"));(o=o||{}).modal=!1,o.sourceTarget=s,this.dismissOpenDialog();const i=$(F(t.getForm())),n=this._showDialog(i,e,o,t);return t.showForm(s,{modal:!1,positionHint:e.positionHint||6}),n}showShellDialog(e,t,s,o){if(!e)return Promise.reject(C("dialogOptions"));if(!t)return Promise.reject(C("formTarget"));if(!s)return Promise.reject(C("sourceTarget"));const i=Promise.withResolvers();o=o||{},this.dismissOpenDialog();const{element:n,ltm:r}=function(e){if(e)return e instanceof Element?{element:e,ltm:(ko.dataFor(e).func||ko.contextFor(e).$ctl).ltm}:e}(t.getForm()),a=$(n),l=this._showDialog(a,e,o,t);return t.showForm(s,{modal:o.modal||!1,positionHint:e.positionHint||6}),r.registerForDispose([a.setEvents(["closed",()=>{i.resolve(1)}])]),l.then(i.resolve).catch(i.reject),i.promise}_showDialog(e,t,s,o){return MsPortalFx.tryImmediateResolve(this._diContainer.getAsync(i.ThemeManager),(()=>{const i=Promise.withResolvers(),a=e=>{s.syncCallback&&s.syncCallback(e),i.resolve(e)},c=()=>{o&&o.hideForm()},d=t.telemetryName;let h=s.locator;h||s.modal||(h=function(e,t){const s=e.closest(".fxs-tile").data(p.CompositionInstanceDataName);let o;s&&(0,p.isPartComposition)(s)?o=s.locator:t||v.error("Unable to determine the extension that opened the dialog. "+MsPortalFx.getCurrentCallStack(!0));return o}(e,s.sideload)),4!==t.type&&(e=function(e){const t=e.closest(".fxs-bladecontent"),s=u.Widget.getWidgets(t);if(s&&s.length){const t=s[0];e=$(F(t.getForm()))}return e}(e));const f=function(e,t,s,o,i){let a;switch(s.type){case 1:a=m.createMessageBoxWithCallback(t,i,s,o);break;case 2:a=l.createProgressBox(t,s);break;case 4:a=r.createListPopupWithCallback((()=>{e.dismissOpenDialog()}),t,i,s);break;case 3:a=n.createFormDialogWithCallback(t,i,s);break;case g.Dlg2:a=m.createMessageBoxWithCallback2(t,i,s,o)}return a}(this,e,t,s,a);return function(e,t){_("DialogOpened",e,t)}(h,d),f?(this._dismissOpenDialog=e=>{f.dispose(),c(),MsPortalFx.isNullOrUndefined(e)?(S(h,"Dismissed",d),i.reject()):(a(e),S(h,e,d))},i.promise.then((e=>(f.dispose(),this._dismissOpenDialog=null,c(),S(h,e,d),e)))):(c(),S(h,"InvalidDialogType",d),i.reject("Invalid type specified in dialogOptions.")),i.promise}))}}class w{static create(e,t){return new P(e,t)}}function I(e,t){const s=MsPortalFx.getUniqueId();return MsPortalFx.replaceAll(MsPortalFx.replaceAll(MsPortalFx.replaceAll(e,t,s),"msportalfx-svg-c01",t),s,"msportalfx-svg-c01")}function S(e,t,s){_("DialogClosed",e,s,t+"")}function _(e,t,s,o){s=s?"/"+s:"fxDefault";const i=`${t&&t.toFriendlyString()}/${s}`;b.trace({source:M,name:i,action:e,extension:t&&t.getExtensionName(),data:o})}function F(e){return e&&(e instanceof Element?e:e.element)}t.DialogManager=w,__decorate([__metadata("fx:diagnostics",[e,"DialogManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[a.PortalIdleStateService,s.Container]),__metadata("design:returntype",w)],w,"create",null)})),
define("MsPortalImpl/UI/UI.PassthroughUser",["require","exports","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.DialogManager","Fx/Telemetry","MsPortalImpl/UI/UI.AuthStateManager"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.launchPassthroughModalDialog=t.checkPassthroughUserWithNoSubs=void 0;MsPortalFx.ViewModels;const a=o.Passthrough;t.checkPassthroughUserWithNoSubs=async function(e){if(FxImpl.features.isEnabled("forcecheckpassthroughuser"))return!0;if(!FxImpl.features.isEnabled("checkpassthroughuser"))return!1;const[t,o]=await Promise.all([e.get(r.AuthStateManager).getCurrentUser(),e.get(s.SubscriptionsUserContext).getAllSubscriptionsCount()]),i=!t.objectId&&t.tenantId!==FxImpl.internalEnv.fxAadInfrastructureTenantId&&!t.hasAaiClaim&&[4,1].includes(o.type)&&0===o.value;return(0,n.trace)({source:"UI.PassthroughUser",action:"PassthroughUser",data:{isPassthroughUser:i}}),i},t.launchPassthroughModalDialog=async function(e,t){const s=await e.getAsync(i.DialogManager);if(3===await s.showModalDialog({title:a.dialogTitle,description:a.dialogContent,buttons:4,defaultButtonText:a.dialogDefaultButtonText,cancelButtonText:a.dialogCancelButtonText}))return t()}})),
define("_generated/MsPortalImpl/Svg/Library/Feedback.svg",["require","exports"],(function(e,t){"use strict";return{type:228,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M7.484 10.375a5.6 5.6 0 0 1 1.438.828 5.376 5.376 0 0 1 1.109 1.2 5.682 5.682 0 0 1 .711 1.461A5.5 5.5 0 0 1 11 15.5v.5h-1v-.5a4.385 4.385 0 0 0-.352-1.75 4.459 4.459 0 0 0-.968-1.43 4.654 4.654 0 0 0-1.43-.961A4.458 4.458 0 0 0 5.5 11a4.385 4.385 0 0 0-1.75.352 4.459 4.459 0 0 0-1.43.968 4.654 4.654 0 0 0-.961 1.43A4.458 4.458 0 0 0 1 15.5v.5H0v-.5a5.391 5.391 0 0 1 .969-3.1 5.7 5.7 0 0 1 1.109-1.187 5.614 5.614 0 0 1 1.438-.836 3.359 3.359 0 0 1-.633-.563 3.551 3.551 0 0 1-.477-.687 3.387 3.387 0 0 1-.3-.781A3.858 3.858 0 0 1 2 7.5a3.391 3.391 0 0 1 .273-1.359 3.525 3.525 0 0 1 1.86-1.86A3.5 3.5 0 0 1 5.5 4a3.391 3.391 0 0 1 1.359.273 3.525 3.525 0 0 1 1.86 1.86A3.5 3.5 0 0 1 9 7.5a3.424 3.424 0 0 1-.1.836 3.311 3.311 0 0 1-.3.781 4.035 4.035 0 0 1-.477.695 3.076 3.076 0 0 1-.639.563ZM5.5 10a2.424 2.424 0 0 0 .969-.2 2.523 2.523 0 0 0 .789-.532 2.6 2.6 0 0 0 .539-.8 2.478 2.478 0 0 0 .008-1.946 2.46 2.46 0 0 0-.539-.789 2.746 2.746 0 0 0-.8-.539A2.348 2.348 0 0 0 5.5 5a2.424 2.424 0 0 0-.969.2A2.537 2.537 0 0 0 3.2 6.531a2.505 2.505 0 0 0 0 1.938 2.631 2.631 0 0 0 .532.8 2.436 2.436 0 0 0 .8.539A2.484 2.484 0 0 0 5.5 10ZM16 0v8h-2l-3 3V8h-1V7h2v1.586L13.586 7H15V1H5v1.8a8.641 8.641 0 0 0-.5.078 2.926 2.926 0 0 0-.5.141V0Z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Library/LaunchCurrent.svg",["require","exports"],(function(e,t){"use strict";return{type:227,data:"<svg viewBox='0 0 16 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14.3 1H10V0h6v6h-1V1.7l-8 8-.7-.7z'/><path d='M11 8v5a.9.9 0 0 1-1 1H2a.9.9 0 0 1-1-1V6a.9.9 0 0 1 1-1h6l1-1H2a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Library/Mail.svg",["require","exports"],(function(e,t){"use strict";return{type:267,data:"<svg viewBox='0 0 16 10' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M16 0v10H0V0zm-1 9V2.1L8 5.6 1 2.1V9zM1.1 1 8 4.4 14.9 1z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Library/Person.svg",["require","exports"],(function(e,t){"use strict";return{type:44,data:"<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M9.4 9.4a6.9 6.9 0 0 1 1.9 1 7.5 7.5 0 0 1 1.5 1.6 5.6 5.6 0 0 1 .9 1.9A7.1 7.1 0 0 1 14 16h-1a6.4 6.4 0 0 0-.5-2.4 7.6 7.6 0 0 0-1.2-1.9 7.6 7.6 0 0 0-1.9-1.2A6.4 6.4 0 0 0 7 10l-1.6.2-1.5.6-1.2.9-.9 1.2-.6 1.5A7.8 7.8 0 0 0 1 16H0a8.3 8.3 0 0 1 .3-2.2 6.4 6.4 0 0 1 1-1.8 7 7 0 0 1 1.4-1.6l1.9-1-1.1-.8-.8-1a5 5 0 0 1-.5-1.3A5.1 5.1 0 0 1 2 5a4.1 4.1 0 0 1 .4-1.9 3.8 3.8 0 0 1 1.1-1.6A3.8 3.8 0 0 1 5.1.4 4.1 4.1 0 0 1 7 0a4.1 4.1 0 0 1 1.9.4 3.8 3.8 0 0 1 1.6 1.1 3.8 3.8 0 0 1 1.1 1.6A4.1 4.1 0 0 1 12 5a5.1 5.1 0 0 1-.2 1.3 5 5 0 0 1-.5 1.3l-.8 1zM3 5a4.1 4.1 0 0 0 .3 1.6 3.4 3.4 0 0 0 .9 1.2 3.4 3.4 0 0 0 1.2.9A4.1 4.1 0 0 0 7 9a4.1 4.1 0 0 0 1.6-.3 3.4 3.4 0 0 0 1.2-.9 3.4 3.4 0 0 0 .9-1.2A4.1 4.1 0 0 0 11 5a4.1 4.1 0 0 0-.3-1.6 3.4 3.4 0 0 0-.9-1.2 3.4 3.4 0 0 0-1.2-.9A4.1 4.1 0 0 0 7 1a4.1 4.1 0 0 0-1.6.3 3.4 3.4 0 0 0-1.2.9 3.4 3.4 0 0 0-.9 1.2A4.1 4.1 0 0 0 3 5z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Library/Signout.svg",["require","exports"],(function(e,t){"use strict";return{type:226,data:"<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m9.2 2.3 1.9 1a12.1 12.1 0 0 1 1.6 1.6 6.6 6.6 0 0 1 .9 1.9A5.7 5.7 0 0 1 14 9a12.3 12.3 0 0 1-.2 1.9 8 8 0 0 1-.8 1.6 3.8 3.8 0 0 1-1.1 1.4 3.8 3.8 0 0 1-1.4 1.1l-1.6.8L7 16l-1.9-.2-1.6-.8a3.8 3.8 0 0 1-1.4-1.1A3.8 3.8 0 0 1 1 12.5a4.6 4.6 0 0 1-.7-1.6A6.3 6.3 0 0 1 0 9a5.7 5.7 0 0 1 .4-2.2 6.6 6.6 0 0 1 .9-1.9 12.1 12.1 0 0 1 1.6-1.6l1.9-1 .4 1a4.6 4.6 0 0 0-1.7.9 5.7 5.7 0 0 0-1.4 1.3 8 8 0 0 0-.8 1.6A5.8 5.8 0 0 0 1 9a7.8 7.8 0 0 0 .2 1.6l.6 1.4a4 4 0 0 0 1 1.2 4 4 0 0 0 1.2 1l1.4.6L7 15l1.6-.2 1.4-.6a4 4 0 0 0 1.2-1 4 4 0 0 0 1-1.2l.6-1.4A7.8 7.8 0 0 0 13 9a5.8 5.8 0 0 0-.3-1.9 8 8 0 0 0-.8-1.6 5.7 5.7 0 0 0-1.4-1.3 4.6 4.6 0 0 0-1.7-.9zM7.5 8h-1V0h1z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg",["require","exports"],(function(e,t){"use strict";return{type:392,data:"<svg viewBox='0 0 19.723 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M3.578 0a1.766 1.766 0 0 0-.744.166A2.153 2.153 0 0 0 2.217.6a2.13 2.13 0 0 0-.433.621 1.762 1.762 0 0 0-.165.739V4H0v1.418h1.619v6.589H0v1.415h1.619v2.044a1.893 1.893 0 0 0 .154.762 1.969 1.969 0 0 0 .42.623 1.944 1.944 0 0 0 .625.421 1.91 1.91 0 0 0 .75.152h7.459v-1.415H6.485V1.416h9.13v6h1.415V0zm1.5 16.009H3.7a.645.645 0 0 1-.26-.051.686.686 0 0 1-.212-.144.711.711 0 0 1-.145-.214 1.861 1.861 0 0 1-.047-.387v-1.791h.7v-1.415h-.7V5.418h.7V4h-.7V2.084a.493.493 0 0 1 .054-.22.88.88 0 0 1 .39-.391.5.5 0 0 1 .22-.057h1.382z'/><path d='M19.514 8.63H8.826v1.894l.061.061 3.454 4.442V20h3.867v-4.973l3.454-4.442.061-.061V8.63zm-4.637 5.755-.061.061v4.164h-1.085v-4.168l-.061-.061-3.376-4.364h7.961z'/></g></svg>"}})),
define("MsPortalImpl/ViewModels/AvatarMenuCommon",["require","exports","_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg","_generated/MsPortalImpl/Svg/Library/Feedback.svg","MsPortalImpl/Resources/ImplScriptResources","_generated/MsPortalImpl/Svg/Library/LaunchCurrent.svg","_generated/MsPortalImpl/Svg/Library/Mail.svg","_generated/MsPortalImpl/Svg/Library/Person.svg","_generated/MsPortalImpl/Svg/Library/Signout.svg","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave"],(function(e,t,s,o,i,n,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewModel=void 0;var p=MsPortalFx.Base.Images;const u=fx.environment;class m extends c.ViewModel{constructor(){super(...arguments),this.avatarImage=(0,d.makeWritableComputation)(),this.contactInfoEnabled=ko.observable(!1),this.hideTenant=(0,d.makeWritableComputation)(),this.icons={contactInfo:r,feedback:o,launchCurrent:n,person:p.CustomImageWithOptions(a,{palette:99}),signout:l,switchDirectory:s},this.links=u.links,this.listOfTenants=(0,d.makeArrayComputation)(),this.showDiagnosticsDelay=2e3,this.text=i.AvatarMenu,this.userIdentity=(0,d.makeWritableComputation)(),this.userInfo=(0,d.makeWritableComputation)(),this.gitHubUserInfo=(0,d.makeWritableComputation)()}}t.ViewModel=m})),
define("MsPortalImpl/Widgets/Widgets.SimpleAvatarMenuFlyout",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","Weave"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=void 0;const a=s("div",{class:"fxs-avatarmenu-dropdown"},s("ul",{class:"fxs-avatarmenu-list-system fxs-portal-border fxs-dropmenu-line-separator",role:"presentation"},s("li",{class:"fxs-portal-hover",role:"presentation"},s("a",{href:"",class:"fxs-avatarmenu-signout fxs-avatarmenu-dropdown-item",role:"menuitem","data-bind":{attr:{title:"data.text.signOutLabel"}}},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.signOutLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-fill-error","data-bind":{image:"data.icons.signout"}})))),s("div",{class:"fxs-avatarmenu-scrollviewer"},s("div",{class:"fxs-avatarmenu-list-system"},s("ul",{role:"presentation"},s("li",{class:"fxs-portal-hover","data-bind":{visible:"changePasswordLink"},role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-changepassword fxs-avatarmenu-dropdown-item",role:"menuitem",target:"_blank",rel:"noopener noreferrer","data-bind":{attr:{href:"changePasswordLink",title:"data.text.changePasswordLabel"}}},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.changePasswordLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.launchCurrent"}}))),s("li",{class:"fxs-portal-hover","data-bind":{visible:"data.contactInfoEnabled"},role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-contactinfo fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.contactInfo"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.contactInfo"}}))),s("li",{class:"fxs-portal-hover",role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-myaccess fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.myAccessLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.person"}}))),s("li",{class:"fxs-portal-hover","data-bind":{visible:"!!data.links.submitAnIdea"},role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-feedback fxs-avatarmenu-dropdown-item",role:"menuitem",href:"",target:"_blank",rel:"noopener noreferrer","data-bind":{attr:{href:"data.links.submitAnIdea",title:"data.text.feedbackLabel"}}},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.feedbackLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.feedback"}}))),s("li",{class:"fxs-portal-hover","data-bind":{visible:"data.links.accountPortal"},role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-billing fxs-avatarmenu-dropdown-item",role:"menuitem",href:"",rel:"noopener noreferrer"},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.billingLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{visible:"data.links.accountPortal && data.links.accountPortal.startsWith('#')"}}))),s(o.KoIf,{condition:"showSwitchDirectoryOption"},s("li",{class:"fxs-portal-hover",role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-switchdirectory fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.switchDirectoryLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.switchDirectory"}}))))))));class l extends i.Widget{constructor(e,t){super(e,t);const s=this.ltm;e.html(a);const o=ko.observable();(0,r.subscribeAndRun)(s,[t.userIdentity],(e=>{e&&o(e.changePasswordUri)})),this._bindDescendants({changePasswordLink:o,showSwitchDirectoryOption:!MsPortalFx.isFeatureEnabled("hideswitchdiroption")}),this._attachEventHandlers()}dispose(){this._cleanElement("fxs-avatarmenu-dropdown"),super.dispose()}_attachEventHandlers(){const e=this.options,t=e.links,s=this.element,o="click";this.ltm.registerForDispose(s.setEvents([o,".fxs-avatarmenu-signout",t=>{e.signedOut(),t.preventDefault()}],[o,".fxs-avatarmenu-billing",s=>{e.openAccountPortal(),t.accountPortal.startsWith("#")&&s.preventDefault()}],[o,".fxs-avatarmenu-switchdirectory",t=>{t.preventDefault(),e.switchDirectory()}],[o,".fxs-avatarmenu-myaccess",t=>{t.preventDefault(),e.showMyAccessBlade()}],[o,".fxs-avatarmenu-contactinfo",t=>{t.preventDefault(),e.showContactInfoBlade()}]))}setFocus(){n.waitForBindings(this.element[0]).then((()=>{this.element.find(".fxs-avatarmenu-signout").focus()}))}}t.Widget=l})),
define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/ViewModels/AvatarMenuCommon","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.SimpleAvatarMenuFlyout","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Services/Services.FavoritesSettings","Weave","FxInternal/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","MsPortalImpl/UI/UI.PassthroughUser"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,p.injectCss)(u);var h=MsPortalFx.Base.Diagnostics,g=h.Telemetry;const f=fx.environment.meControl,x=h.createLog(e),b="TopBar",y=g.start,v=g.endTrace,M=g.completeTrace,C=s("div",{class:"fxs-flyout","data-bind":{stopBindings:"true"}}),P=s("div",{class:"fxs-avatarmenu-header","data-bind":{attr:{title:"tooltip"},css:{"fxs-avatarmenu-open":"isMenuOpen"}}},s("div",{class:"fxs-avatarmenu-tenant-container"},s("div",{class:"fxs-avatarmenu-username","data-bind":{text:"displayName"}}),s("div",{class:"fxs-avatarmenu-tenant","data-bind":{text:"currentTenantDisplayName"}})),s("div",{class:"fxs-avatarmenu-tenant-image-container"},s("img",{class:"fxs-avatarmenu-tenant-image","data-bind":{attr:{src:"avatarUri"}},alt:""})));function w(e){return(e||"").toLowerCase()}const I=/^(?:f(?:irst)?|l(?:ast)?)\s?name$/i;class S extends o.ViewModel{constructor(){var e,t;super(),this.displayName=this.userIdentity.compose((e=>(e=e||{}).preferredUsername||e.emailAddress||function(e){const t=e.firstName||"",s=e.lastName||"";return!t&&!s||I.test(t)&&I.test(s)?"":i.AvatarMenu.displayNameFormat.format(t,s)}(e)||this.text.defaultDisplayName)),this.tenantDisplayName=(0,c.makeWritableComputation)(""),this.dropMenuOptions=new a.ViewModel(P,C,".fxs-avatarmenu-dropdown-item"),this.dropMenuOptions.buttonId="fxs-avatarmenu-button",this.dropMenuOptions.buttonClass="fxs-menu-account",this.tooltip=(e=this,t=this.dropMenuOptions.buttonTooltip,(0,c.composeComputation)([e.userIdentity,e.hideTenant,e.listOfTenants],((s,o,i)=>{if(!s)return"";const n=e.text.Tooltip,r=n.tenant,a=[];(s.firstName||s.lastName)&&a.push(n.name.format(s.firstName||"",s.lastName||""));const l=s.preferredUsername||s.emailAddress;if(l&&a.push(n.email.format(l)),!o){const e=MsPortalFx.find(i,(e=>s.tenantId===e.id));if(e&&!o){a.push(r.format(e.displayName,e.id));const t=e.domainName||"",o=s.tenantDomain;a.push(o&&w(t)!==w(o)?r.format(t,o):n.domain.format(t))}}const c=a.join("\n");return t(c),c})))}}t.ViewModel=S;class _ extends r.Widget{constructor(e,t,s){super(e,t,!0),this._isMeControlOpen=ko.observable(!1),this.meControlState=0;const o=this.ltm,n=(0,d.hasValueAsync)(o,t.userIdentity);let r;!MsPortalFx.isFeatureEnabled("usesimpleavatarmenu")&&f.baseUri&&f.aadAuthority&&(this.meControlState=1);const p=t.dropMenuOptions;this._dropMenuWidget=new a.Widget(e,p,!0,!0),p.isMenuOpen.subscribe(o,(e=>{const t=this.element.find(".fxs-flyout"),i=(e,s)=>{this.element.find("#mectrl_main_body").parent().parent().remove(),v(s,"failed",{message:e.message,stack:e.stack}),x.warning(MsPortalFx.getLogFriendlyMessage(e)),this.meControlState=2,r&&r.dispose(),this._loadSimpleAvatarMenu(t)};if(1===this.meControlState){if(!r&&e){const e=y({source:b,action:"MeControlAvatarMenuOpen"});n.then((i=>MsPortalFx.Base.Promises.cancelOnDispose(o,(()=>MsPortalFx.require("MsPortalImpl/Widgets/Widgets.MeControl"))).then((n=>(r=new n.Widget(t,this.options,s,i,this._isMeControlOpen),o.registerForDispose(r),r.getInitializedPromise().then((()=>{M(e)}))))))).catch((t=>{i(t,e)}))}}else this._loadSimpleAvatarMenu(t)}));const u=t.tenantDisplayName;Promise.all([(0,d.hasValueAsync)(o,t.userInfo),(0,m.checkPassthroughUserWithNoSubs)(s)]).then((([e,o])=>{const n=e.directoryId&&e.directoryId.toLowerCase(),r=e.uniqueDirectoryName||"";o?u(i.AvatarMenu.passthrough):t.hideTenant.value?u(""):r&&r.toLowerCase()!==n?u(r):s.getAsync(l.UserDirectorySettings).then((e=>{const t=e.userDefaultDirectory()||{};(t.id||"").toLowerCase()===n&&u(t.displayName)}))})),(0,c.subscribe)(this.ltm,[t.displayName,u],(()=>{this.trigger("fxavatartextchange")}))}_loadSimpleAvatarMenu(e){if(this.ltm&&!this.ltm.isDisposed()){const t=y({source:b,action:"SimpleAvatarMenuOpen"});this._simpleFlyout||(this._simpleFlyout=new n.Widget(e,this.options),this.ltm.registerForDispose(this._simpleFlyout)),this._dropMenuWidget.setFocus(),M(t)}}dispose(){this._dropMenuWidget.dispose(),this._cleanElementClasses(["fxs-avatarmenu"]),super.dispose()}getDropMenuOpenObservable(){return 1===this.meControlState?this._isMeControlOpen:this._dropMenuWidget.options.isMenuOpen}}t.Widget=_})),
define("_generated/MsPortalImpl/Svg/Startup/Chevron.svg",["require","exports"],(function(e,t){"use strict";return{type:158,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m8.2 6-5.5 5.5.6.5 6-6-6-6-.6.5z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/MsPortalImpl/Svg/Startup/Search.svg","_generated/MsPortalImpl/Svg/Startup/Close.svg","_generated/MsPortalImpl/Svg/Startup/Chevron.svg","Weave","Weave/Core/Computation","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(e,t,s,o,i,n,r,a,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=t.searchBoxClass=t.searchClass=void 0,(0,d.injectCss)(p),t.searchClass="fxs-search",t.searchBoxClass="fxs-search-box";const u=o.Search;class m extends i.ViewModel{initOptions(e){this._initOptions=e}constructor(){super(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._dropdownInitialized=Promise.withResolvers(),this.isExpanded=(0,l.makeWritableComputation)(!1),this.showMenu=ko.observable(!1),this.showResults=ko.observable(!1),this.showSearching=ko.observable(!1),this.showExternalColumn=ko.observable(!1),this.showAllSubscriptionsSearch=ko.observable(!1),this.showChangeSubscriptions=ko.observable(!1),this.icons={search:n,close:r,chevron:a,hyperlink:s},this.text=u,this.filter=ko.observable(),this.searchInFilterText=ko.observable(),this.subscriptionSummary=ko.observable(),this.mruItems=ko.observableArray(),this.results=ko.observableArray()}isDropdownInitialized(){return this._dropdownInitialized.promise}dispose(){this._ltm.dispose()}setFocus(){this._widget&&this._widget.setFocus()}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget.element}}t.ViewModel=m;class h extends i.Widget{constructor(e,s,o){super(e,s),s.setWidget(this),window.fx.environment.chrome.hideSearchBox&&e.addClass("fxs-display-none"),this._textField=$(e[0].querySelector(`.${t.searchBoxClass} input`));const i=t=>{e.off("focusin",i),s.showMenu(!0);const o=s._initOptions;(o&&o()||Promise.resolve(void 0)).then((()=>{MsPortalFx.require("MsPortalImpl/Widgets/Widgets.SearchDeferred").then((e=>{s._dropdownInitialized.resolve(),e.initialize(this.ltm,s,this._textField)}))}))};this.ltm.registerForDispose(e.setEvents(["focusin",i]))}setFocus(){this.options.isExpanded(!0);const e=document.activeElement;(0,c.invokeAfterChangePropagation)((()=>{e===document.activeElement&&this._textField.focus()}))}}t.Widget=h})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopbarActionsMenu.css",["module"],(function(e){"use strict";return{css:".fxs-topbaractions-item{display:flex}.fxs-topbaractions-item .fxs-dropmenu-image{padding-left:10px}.fxs-topbaractions-flyout{max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.TopbarActionsMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopbarActionsMenu.css"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,r.injectCss)(a);const l=s("div",{class:"fxs-topbaractions-dropmenu"}),c=s("div",{class:"fxs-topbaractions-button fxs-topbar-button","data-bind":{image:"ellipsis",css:{"fxs-topbar-active":"isMenuOpen"}}}),d=s("div",{class:"fxs-topbaractions-flyout"},s("ul",{class:"fxs-topbaractions-list-commands",role:"presentation","data-bind":{foreach:"topbarActions"}},s("li",{class:"fxs-portal-hover",role:"presentation"},s("a",{href:"#",class:"fxs-topbaractions-item",role:"menuitem","data-bind":{attr:{"aria-label":"name",title:"name"},css:"classNames",click:"clickHandler"}},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"name"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"menuIcon"}})))));class p extends o.ViewModel{constructor(e){super(),this.ariaLabel=ko.observable(),this.dropMenuOptions=new i.ViewModel(c,d,".fxs-topbaractions-item"),this.topbarActions=e||[]}}t.ViewModel=p;class u extends o.Widget{constructor(e,t){super(e,t);const s=this.element;s.html(l),t.dropMenuOptions.setItemFocusWhenOpen=!0,t.dropMenuOptions.buttonTooltip(t.ariaLabel()),t.dropMenuOptions.buttonLabel(t.ariaLabel()),this.ltm.registerForDispose(new i.Widget(e.find(".fxs-topbaractions-dropmenu"),t.dropMenuOptions,!1,!0)),ko.applyBindingsToDescendants({topbarActions:t.topbarActions,ellipsis:n,isMenuOpen:t.dropMenuOptions.isMenuOpen},s[0])}openMenu(e=!0){this.element.hasClass("fxs-display-none")||(e||(this.options.dropMenuOptions.autoDismissMenu=!1),this.options.dropMenuOptions.open(),e||(this.options.dropMenuOptions.autoDismissMenu=!0))}closeMenu(){this.options.dropMenuOptions.close()}}t.Widget=u})),
define("_generated/MsPortalImpl/Svg/Library/Gear.svg",["require","exports"],(function(e,t){"use strict";return{type:103,data:"<svg viewBox='0 0 15.9 15.9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M13.9 7.7V8l2 1.3-1.2 3-2.4-.3-.3.3.5 2.4-3 1.2-1.3-2h-.5l-1.3 2-3-1.2.6-2.4-.4-.3-2.4.5-1.2-3 2-1.3v-.4L0 6.4l1.2-3 2.4.6a.8.8 0 0 1 .4-.4l-.6-2.4 3-1.2 1.3 2h.5l1.3-2 3 1.2-.5 2.4.3.4 2.4-.6 1.2 3zm-.9 1V7.2l1.8-1.1-.7-1.7-2.1.5a1.2 1.2 0 0 0-.5-.5 1.2 1.2 0 0 0-.5-.5l.5-2.1-1.7-.7-1.1 1.8H7.2L6.1 1.1l-1.7.7.5 2.1a1.2 1.2 0 0 0-.5.5 1.2 1.2 0 0 0-.5.5l-2.1-.5-.7 1.7 1.8 1.1v1.5L1.1 9.8l.7 1.7 2.1-.5.5.5.5.5-.5 2.1 1.7.7L7.2 13h1.5l1.1 1.8 1.7-.7L11 12l.5-.5.5-.5 2.1.5.7-1.7zM8 5l1.1.2a2.2 2.2 0 0 1 .9.7 3.1 3.1 0 0 1 .7.9 4.3 4.3 0 0 1 .2 1.2 4.3 4.3 0 0 1-.2 1.1 2.2 2.2 0 0 1-.7.9 2.2 2.2 0 0 1-.9.7l-1.1.2-1.2-.2a3.1 3.1 0 0 1-.9-.7 2.2 2.2 0 0 1-.7-.9A4.3 4.3 0 0 1 5 8a4.3 4.3 0 0 1 .2-1.2 3.1 3.1 0 0 1 .7-.9 3.1 3.1 0 0 1 .9-.7zm0 5h.8l.6-.5.5-.6A2.5 2.5 0 0 0 10 8a2.8 2.8 0 0 0-.1-.9l-.5-.6-.6-.4a1.3 1.3 0 0 0-.8-.2 1.5 1.5 0 0 0-.9.2l-.6.4-.4.6a1.5 1.5 0 0 0-.2.9 1.3 1.3 0 0 0 .2.8l.4.6.6.5z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Console.svg",["require","exports"],(function(e,t){"use strict";return{type:333,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M15 2v12H1V2h14m1-1H0v14h16V1z'/><path d='M12.5 12h-4c-.3 0-.5-.2-.5-.5s.2-.5.5-.5h4c.3 0 .5.2.5.5s-.2.5-.5.5zM7.8 8.1s0-.1 0 0v-.5L3.7 4.3c-.2-.2-.5-.2-.7 0-.2.3-.1.6.1.7l3.5 3-3.5 3c-.2.2-.2.5-.1.7.1.1.2.2.4.2.1 0 .2 0 .3-.1l3.9-3.3v-.1c.2-.2.2-.2.2-.3 0 .1 0 0 0 0z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg",["require","exports"],(function(e,t){"use strict";return{type:393,data:"<svg viewBox='0 0 19.723 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M19.514 8.63H8.826v1.894l.061.061 3.454 4.442V20h3.867v-4.973l3.454-4.442.061-.061V8.63zm-4.637 5.755-.061.061v4.164h-1.085v-4.168l-.061-.061-3.376-4.364h7.961z'/><path d='m13.67 14.381.061.061v4.168h1.086v-4.164l.06-.061 3.378-4.369h-7.962l3.377 4.365z' class='msportalfx-svg-c33'/><path d='M3.578 0a1.766 1.766 0 0 0-.744.166A2.153 2.153 0 0 0 2.217.6a2.13 2.13 0 0 0-.433.621 1.762 1.762 0 0 0-.165.739V4H0v1.418h1.619v6.589H0v1.415h1.619v2.044a1.893 1.893 0 0 0 .154.762 1.969 1.969 0 0 0 .42.623 1.944 1.944 0 0 0 .625.421 1.91 1.91 0 0 0 .75.152h7.459v-1.415H6.485V1.416h9.13v6h1.415V0zm1.5 16.009H3.7a.645.645 0 0 1-.26-.051.686.686 0 0 1-.212-.144.711.711 0 0 1-.145-.214 1.861 1.861 0 0 1-.047-.387v-1.791h.7v-1.415h-.7V5.418h.7V4h-.7V2.084a.493.493 0 0 1 .054-.22.88.88 0 0 1 .39-.391.5.5 0 0 1 .22-.057h1.382z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Feedback.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M7.484 10.375a5.6 5.6 0 0 1 1.438.828 5.376 5.376 0 0 1 1.109 1.2 5.682 5.682 0 0 1 .711 1.461A5.5 5.5 0 0 1 11 15.5v.5h-1v-.5a4.385 4.385 0 0 0-.352-1.75 4.459 4.459 0 0 0-.968-1.43 4.654 4.654 0 0 0-1.43-.961A4.458 4.458 0 0 0 5.5 11a4.385 4.385 0 0 0-1.75.352 4.459 4.459 0 0 0-1.43.968 4.654 4.654 0 0 0-.961 1.43A4.458 4.458 0 0 0 1 15.5v.5H0v-.5a5.391 5.391 0 0 1 .969-3.1 5.7 5.7 0 0 1 1.109-1.187 5.614 5.614 0 0 1 1.438-.836 3.359 3.359 0 0 1-.633-.563 3.551 3.551 0 0 1-.477-.687 3.387 3.387 0 0 1-.3-.781A3.858 3.858 0 0 1 2 7.5a3.391 3.391 0 0 1 .273-1.359 3.525 3.525 0 0 1 1.86-1.86A3.5 3.5 0 0 1 5.5 4a3.391 3.391 0 0 1 1.359.273 3.525 3.525 0 0 1 1.86 1.86A3.5 3.5 0 0 1 9 7.5a3.424 3.424 0 0 1-.1.836 3.311 3.311 0 0 1-.3.781 4.035 4.035 0 0 1-.477.695 3.076 3.076 0 0 1-.639.563ZM5.5 10a2.424 2.424 0 0 0 .969-.2 2.523 2.523 0 0 0 .789-.532 2.6 2.6 0 0 0 .539-.8 2.478 2.478 0 0 0 .008-1.946 2.46 2.46 0 0 0-.539-.789 2.746 2.746 0 0 0-.8-.539A2.348 2.348 0 0 0 5.5 5a2.424 2.424 0 0 0-.969.2A2.537 2.537 0 0 0 3.2 6.531a2.505 2.505 0 0 0 0 1.938 2.631 2.631 0 0 0 .532.8 2.436 2.436 0 0 0 .8.539A2.484 2.484 0 0 0 5.5 10ZM16 0v8h-2l-3 3V8h-1V7h2v1.586L13.586 7H15V1H5v1.8a8.641 8.641 0 0 0-.5.078 2.926 2.926 0 0 0-.5.141V0Z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Help.svg",["require","exports"],(function(e,t){"use strict";return{type:130,data:"<svg viewBox='2 2 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M8 2a6 6 0 1 1 0 12A6 6 0 0 1 8 2Zm0 1a5 5 0 1 0 0 10A5 5 0 0 0 8 3Zm0 7.5A.75.75 0 1 1 8 12a.75.75 0 0 1 0-1.5Zm0-6a2 2 0 0 1 2 2c0 .73-.212 1.14-.754 1.708l-.264.27C8.605 8.87 8.5 9.082 8.5 9.5a.5.5 0 0 1-1 0c0-.73.212-1.14.754-1.708l.264-.27C8.895 7.13 9 6.918 9 6.5a1 1 0 0 0-2 0 .5.5 0 0 1-1 0 2 2 0 0 1 2-2Z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/HelpMin.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 24 24' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><circle cx='17.75' cy='6.611' r='6'/><circle cx='10' cy='18.86' r='.75'/><path d='M10 10.11a2.5 2.5 0 0 1 1.651 4.378l-.154.125-.219.163-.087.072a1.968 1.968 0 0 0-.156.148 2.216 2.216 0 0 0-.535 1.614.5.5 0 0 1-1 0 3.2 3.2 0 0 1 .805-2.298 3.107 3.107 0 0 1 .356-.323l.247-.184.118-.1A1.5 1.5 0 1 0 8.5 12.61a.5.5 0 1 1-1 0 2.5 2.5 0 0 1 2.5-2.5Z'/><path d='M17.75 13.61a7.04 7.04 0 0 1-.838-.054 7.037 7.037 0 1 1-6.074-5.89 7.023 7.023 0 0 1-.086-1.017A8.087 8.087 0 0 0 10 6.61a8.056 8.056 0 1 0 7.93 6.99c-.06.002-.12.01-.18.01Z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Notifications.svg",["require","exports"],(function(e,t){"use strict";return{type:342,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14 12v1h-4a2.4 2.4 0 0 1-.2.8l-.4.6-.6.4-.8.2-.8-.2-.6-.4-.4-.6A2.4 2.4 0 0 1 6 13H2v-1h1V6a5.9 5.9 0 0 1 .2-1.3 6.1 6.1 0 0 1 .5-1.2 3.9 3.9 0 0 1 .8-1 3.9 3.9 0 0 1 1-.8l1.2-.5L8 1l1.3.2 1.2.5a3.9 3.9 0 0 1 1 .8 3.9 3.9 0 0 1 .8 1 6.1 6.1 0 0 1 .5 1.2A5.9 5.9 0 0 1 13 6v6zm-2 0V6a4.5 4.5 0 0 0-.3-1.6 2.7 2.7 0 0 0-.9-1.2 2.7 2.7 0 0 0-1.2-.9 4.4 4.4 0 0 0-3.2 0 2.7 2.7 0 0 0-1.2.9 2.7 2.7 0 0 0-.9 1.2A4.5 4.5 0 0 0 4 6v6zm-4 2h.4l.3-.2.2-.3A.7.7 0 0 0 9 13H7a.6.6 0 0 0 .1.4l.2.3.3.2z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","Fx/DependencyInjection","Fx/Experimentation","FxInternal/AsyncLoader","Weave","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.AvatarMenu","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Search","MsPortalImpl/Widgets/Widgets.AsyncSearch","MsPortalImpl/Widgets/Widgets.TopbarActionsMenu","_generated/MsPortalImpl/Svg/Library/Gear.svg","_generated/MsPortalImpl/Svg/Startup/Console.svg","_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg","_generated/MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg","_generated/MsPortalImpl/Svg/Startup/Feedback.svg","_generated/MsPortalImpl/Svg/Startup/Help.svg","_generated/MsPortalImpl/Svg/Startup/HelpMin.svg","_generated/MsPortalImpl/Svg/Startup/Notifications.svg","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Base/Base.Events","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Services/Services.Subscriptions","FxInternal/Weave","MsPortalImpl/Widgets/Widgets.Portal.State","MsPortalImpl/Widgets/Widgets.ToastViewModel","Viva.Controls/Util/Viva.Resize","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Copilot","FxInternal/RpcEndPoints"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M,C,P,w,I,S,_,F,T,k,D,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayCopilotBubble=t.shouldNotShowBubble=t.HelpAction=t.Widget=t.ViewModel=void 0,(0,F.injectCss)(T);const B=window.fx.environment,A="fxs-topbar-avatarmenu",N="fxs-avatarmenu-imageonly",R="fxs-display-none",L=MsPortalFx.isFeatureEnabled,O=r.TopBar,z=L("azureconsole"),H=L("feedback"),U=L("asyncSearch")||B.globalSearch?.pills?.length;let W=class extends l.ViewModel{constructor(e,t,s){super(),this.toastViewModel=e,this.reportBug=$.noop,this.exitDevMode=$.noop,this.directoryFilterIcon=ko.observable(h),this.newDashboardSaveEnabled=(0,n.makeWritableComputation)(!1),this.copilotEnabled=ko.observable(!1),this.isCopilotOpen=ko.observable(!1),this.commandIconsVisible=ko.observable(!1),this.dashboardChanged=(0,n.makeWritableComputation)(!1),this.dashboardWritable=(0,n.makeWritableComputation)(!1),this.dashboardVisible=(0,n.makeWritableComputation)(!1),this.exitOrganizeMode=$.noop,this.finishDashboardEdit=$.noop,this.settingsButtonClick=$.noop,this.loadingIdList=(0,n.makeArrayComputation)(),this.searchViewModel=U?new d.ViewModel:new c.ViewModel,this.avatarMenuVM=new a.ViewModel,this.consoleButtonClick=MsPortalFx.noop,this.canUpgradeSubscription=(0,n.makeWritableComputation)(!1),this.upgradeableSubscription=(0,n.makeWritableComputation)(),this.displayMode=s.displayMode,this.isInOrganizeMode=s.inOrganizeMode,this.settingsFlyoutState=s.settingsFlyoutState,this.actionDefinitions=function(e,t){const s=[],o=MsPortalFx.getEnvironmentValue("topBar")?.customTopBarButtons;if(o?.length>0){let e=0;o.slice(0,3).forEach((o=>{if(!o.flagName||o.flagName&&MsPortalFx.isFeatureEnabled(o.flagName)){const i="fxs-topbar-custom-button-"+e;s.push({name:K(o.textAriaResxKey),icon:G(o.iconName),classNames:["fxs-topbar-custom-button",i],clickHandler:()=>{t.settingsFlyoutState(0),t.customTopBarButtonClick&&t.customTopBarButtonClick(o.bladeTarget,o.extensionName,i)}}),e++}}))}z&&s.push({name:O.console,icon:m,classNames:"fxs-topbar-console",ariaExpanded:!1,ariaControls:"consoleRegionId",clickHandler:()=>{t.settingsFlyoutState(0),t.consoleButtonClick()}});B.notifications?.hideNotificationButton||s.push({name:O.notifications,icon:y,classNames:"fxs-topbar-notifications",clickHandler:()=>{t.settingsFlyoutState(0),t.notificationButtonClick&&t.notificationButtonClick()},showNotification:ko.observable(!1)});s.push({name:O.settings,icon:u,classNames:["fxs-topbar-settings fxs-menu-settings",{"fxs-topbar-active":t.settingsFlyoutState}],clickHandler:()=>{t.settingsButtonClick&&t.settingsButtonClick()}}),B.chrome.hideHelpButton||s.push(e.get(j));H&&s.push({name:O.feedback,icon:f,classNames:"fxs-topbar-feedback fxs-menu-feedback",clickHandler:()=>{t.settingsFlyoutState(0),t.feedbackButtonClick&&t.feedbackButtonClick()}});return s.forEach((e=>{e.menuIcon=e.menuIcon||e.icon})),s}(t,this)}dispose(){this.searchViewModel.dispose()}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget&&this._widget.element}};t.ViewModel=W,t.ViewModel=W=__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),s.Class(),__metadata("design:paramtypes",[S.ViewModel,s.Container,I.PortalState])],W);class V extends l.Widget{constructor(e,t,s,i){super(e,t,!0),this._reactiveLayoutInitialized=!1;const l=this.ltm;if(t.setWidget(this),this.options.copilotEnabled((0,D.isCopilotEnabled)(s)),ko.computed(l,(async()=>{const e=this.options.copilotEnabled(),o=this.options.commandIconsVisible();e&&o&&J(s,t),e&&MsPortalFx.require("MsPortalImpl/Services/Services.CopilotShellAPIs").then((e=>{s.get(e.CopilotShellAPIs).copilotBladeState.subscribe(l,(e=>{this.options.isCopilotOpen("opened"===e)}))}))})),this.toggleConsole=MsPortalFx.noop,z&&(t.consoleButtonClick=this.toggleConsole=()=>{s.get(C.ToggleCloudShell).invoke(void 0)}),!L("hidedirectorypanebutton")&&!B.chrome.hideDirectoryPaneButton){const e=s.get(P.SubscriptionsUserContext);Promise.all([e.getAllSubscriptionsCount(),e.getGlobalSelectedSubscriptions(),e.useAdvancedFiltersPromise]).then((([e,s,o])=>{if(o)return t.directoryFilterIcon(h);s.subscribeAndRun(l,(s=>{t.directoryFilterIcon(s.length===e.value?h:g)}))}))}s.get(o.Experimentation).shellAssignments.whenAvailable().then((e=>{t.newDashboardSaveEnabled(e.getBooleanValue("DashboardSaveExperience"))})),this._topbarActionsViewModel=new p.ViewModel(t.actionDefinitions),this._topbarActionsViewModel.ariaLabel(r.TopBar.actionsMenuButtonLabel);const u=new a.Widget(this._findByClassName(A),t.avatarMenuVM,s);let m;if(m=U?new d.Widget(this._findByClassName("fxs-topbar-search"),t.searchViewModel,s):new c.Widget(this._findByClassName("fxs-topbar-search"),t.searchViewModel,s),MsPortalFx.isFeatureEnabled("globalsearchonecolumn")){$.querySelectorAll(".fxs-topbar-search").addClass("fxs-search-onecolumn")}l.registerForDispose([u,m]),this.topBarHasExpandedItem=(0,n.composeComputation)([(0,w.toComputation)(t.searchViewModel.showMenu),(0,w.toComputation)(this._topbarActionsViewModel.dropMenuOptions.isMenuOpen),(0,w.toComputation)(u.getDropMenuOpenObservable()),this.options.settingsFlyoutState],((e,t,s,o)=>e||t||s||!!o))}_findByClassName(e){return $(this.element[0].querySelector("."+e))}initReactiveLayout(e){if(this._reactiveLayoutInitialized)return;this._reactiveLayoutInitialized=!0;let t,s,o,i,n,r,a,l,c,d,u,m,h=!0;const g=this._findByClassName("fxs-topbar-search"),f=this._findByClassName("fxs-topbar-buttons-container"),x=this._findByClassName(A),b=this._findByClassName("fxs-internal-full"),y=this._findByClassName("fxs-topbar-exitdevmode"),C=this._findByClassName("fxs-topbar-reportbug"),P=this._findByClassName("fxs-topbar-reportbug-text"),w=this._findByClassName("fxs-internal-short"),I=this._findByClassName("fxs-topbar-sidebar-collapse-button"),S=this._findByClassName("fxs-topbar-copilot"),F=this.options.copilotEnabled()&&e.getBooleanValue("copilotnexttosearch");let T=800,k=280,D=400,E=0;F&&(MsPortalFx.isFeatureEnabled("globalsearchonecolumn")&&(T=520,k=364,D=520),E=16);const B=v.throttleByAnimationFrame((()=>{const e=this._findByClassName("fxs-topbar-upgradebutton"),v=this._findByClassName("fxs-topbar-upgradebutton-text");let M;h&&(o=q(this.element,"fxs-avatarmenu-tenant-image-container"),s=q(f),i=q(this.element,"fxs-topbar-brand"),n=q(b),r=q(w),a=q(y),l=q(C),c=q(this.element,"fxs-topbar-reportbug-icon"),d=q(e),u=q(this.element,"fxs-topbar-upgradebutton-icon"),m=q(this.element,"fxs-topbar-copilot")+E),t?M=t:x.hasClass(N)?M=180+o:(M=x.width(),this._findByClassName("fxs-avatarmenu-tenant").text()&&this._findByClassName("fxs-avatarmenu-username").text()&&(t=M));const _=function(e,t){const{topbarWidth:s,commandIconsWidth:o,copilotIconAndTextWidth:i,searchBarMaxInWideScreen:n,searchBarWidth:{min:r,max:a,collapsed:l,margin:c},avatarMenuWidth:{normal:d,imageOnly:p},others:{debugModeWidth:u,reportBugExpendedWidth:m,reportBugIconWidth:h,previewWidth:g,previewShortWidth:f,sidebarHamburgerWidth:x,upgradeIconWidth:b,upgradeExpandedWidth:y},firstTime:v}=t;let M=0;const C=m>0?m+7:0,P=h>0?33:0,w=y>0?y+7:0,I=b>0?33:0,S=x+t.logoWidth+t.others.previewWidth+u+C+w+7,_=c+o+d+i,F=c+40+p,T=S+n+_,k=T-C-w+P+I-n+r,D=k-_+F,E=D-r-c+40,B=E-g+f,A=B-P,N=A-I,R=s>=k?n:a;if(s>=D){let e=S,t=_;s<T&&(e=e-C+P-y+w),s<k&&(t=F);const o=(s-R)/2,i=o+R;M=o<e?Math.max(0,s-e-t-R,s-T):Math.max(0,s-i-t)}const L=s>=k;v&&e.commandIconsVisible(L);return{searchBar:{expanded:s>=D,width:s>=D?Math.min(R,Math.max(r,s-D+r)):l,rightToCommands:M+c},commandIconsVisible:L,avatarMenuExpanded:s>=k,others:{reportABugVisible:s>=B,debugModeVisible:s>=A,previewExpanded:s>=E,reportBugExpanded:s>=T,upgradeVisible:s>=N,upgradeExpanded:s>=T}}}(this.options,{topbarWidth:this.element.width(),logoWidth:i,searchBarMaxInWideScreen:T,searchBarWidth:{min:k,max:D,collapsed:40,margin:15},commandIconsWidth:s,copilotIconAndTextWidth:m,avatarMenuWidth:{normal:M,imageOnly:o},others:{previewWidth:n,previewShortWidth:r,debugModeWidth:a,reportBugExpendedWidth:l,reportBugIconWidth:c,upgradeExpandedWidth:d,upgradeIconWidth:u,sidebarHamburgerWidth:q(I)},firstTime:h});h=!1,this.element.toggleClass("fxs-topbar-state-searchcollapsed",!_.searchBar.expanded);const B=_.searchBar.expanded?_.searchBar.rightToCommands:"";F?(S.css("margin-right",B),S.css("margin-left",16)):g.css("margin-right",B),g.css("max-width",_.commandIconsVisible?T:400),x.toggleClass(N,!_.avatarMenuExpanded),f.toggleClass(R,!_.commandIconsVisible),C.toggleClass(R,!_.others.reportABugVisible),y.toggleClass(R,!_.others.debugModeVisible),b.toggleClass(R,!_.others.previewExpanded),w.toggleClass(R,_.others.previewExpanded),P.toggleClass(R,!_.others.reportBugExpanded),e.toggleClass(R,!_.others.upgradeVisible),v.toggleClass(R,!_.others.upgradeExpanded),_.commandIconsVisible||this.options.dropMenuWidget||(this.options.dropMenuWidget=new p.Widget(this._findByClassName("fxs-topbar-actionsmenu"),this._topbarActionsViewModel),this.ltm.registerForDispose(this.options.dropMenuWidget));this._findByClassName("fxs-topbaractions-dropmenu").toggleClass(R,_.commandIconsVisible),this.options.dropMenuWidget?.closeMenu()}));_.track(this.ltm,this.element.first(),B),this.ltm.registerForDispose([this.element.setEvents(["fxavatartextchange",B]),$(document).setEvents([M.fullscreen,B])])}dispose(){this._cleanElement(),super.dispose()}}t.Widget=V;let j=class extends FxImpl.TriggerableLifetimeManager{constructor(e,t){super(),this.name=O.help,this.icon=x,this.menuIcon=ko.observable(x),this.classNames="fxs-topbar-helpmenu",this.showNotification=ko.observable(!1),this.active=ko.observable(!1),this.visible=ko.observable(!0),this.clickHandler=()=>{t.settingsFlyoutState(0),e.getAsync(i.get("MsPortalImpl/UI/UI.HelpPane","HelpPane")).then((e=>e.toggle()))},this.showNotification.subscribe(this,(e=>{this.menuIcon(e?b:x)}))}};function q(e,t){const s=(t?e.find(`.${t}`):e)[0];return s?s.offsetWidth:0}function G(e){const t=MsPortalFx.Base.Images[e];return t&&"function"==typeof t?t():MsPortalFx.Base.Images.Question()}function K(e){const t=e?.split("_");if(3===t?.length){const e=t[1],s=t[2],o=r.TopBar[e];if(o){return o[s]??r.TopBar.CustomButton.default}}return r.TopBar.CustomButton.default}async function J(e,t){if(MsPortalFx.isFeatureEnabled("ci")||!MsPortalFx.isFeatureEnabled("copilotbubble"))return;const s=e.get(k.SettingsManager),o=await s.querySettings({store:7,keys:["WelcomeSequence","CopilotBubble","WelcomeSequenceCopilotStep"]}),i=o.CopilotBubble||{},n="complete"===i.action,a="dismiss"===i.action&&"dismissButton"===i.source,l="dismiss"===i.action&&"refresh"===i.source;if(n||a||l||i.viewCount>3)return;const c=e.get(FxImpl.Features),d=c.isEnabled("guidedtour")&&(!o||!o.WelcomeSequence)&&!c.isEnabled("ci"),p=o.WelcomeSequenceCopilotStep;if(!d&&!p){const o=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.TeachingBubble"),n=$.querySelectorAll(".fxs-topbar-copilot")[0];o.createTeachingBubble({teachingBubbleOptions:[{targetElement:n,directionalHint:"up",title:r.TopBar.Copilot.TeachingBubble.title,description:r.TopBar.Copilot.TeachingBubble.message,actionButtonText:r.TopBar.Copilot.TeachingBubble.tryItOut,learnMoreLink:"https://aka.ms/azurecopilot/learnmore",width:360,showDismissButton:!0,showFeedbackButton:!1}],onCompletion:()=>{s.setSetting(7,"CopilotBubble",{viewed:+Date.now(),action:"complete",source:"",viewCount:(i.viewCount||0)+1}),t.settingsFlyoutState(0),E.copilotNudgeEndpoint.invoke(FxImpl.Rpc.client,"Microsoft_Azure_Copilot",[null])},onDismiss:e=>{s.setSetting(7,"CopilotBubble",{viewed:+Date.now(),action:"dismiss",source:e,viewCount:(i.viewCount||0)+1})},isCoachmark:!0,diContainer:e,featureName:"CopilotTopBarTeachingBubble"})}}t.HelpAction=j,t.HelpAction=j=__decorate([__metadata("fx:diagnostics",[e,"HelpAction"]),s.Class(),__metadata("design:paramtypes",[s.Container,I.PortalState])],j),t.shouldNotShowBubble=function(e){const t="complete"===e.action,s="dismiss"===e.action&&"dismissButton"===e.source,o="dismiss"===e.action&&"refresh"===e.source;return t||s||o||e.viewCount>3},t.displayCopilotBubble=J})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css",["module"],(function(e){"use strict";return{css:'.fxs-portal{position:fixed;left:0;right:0;top:0;bottom:0;overflow:hidden;z-index:0;display:flex;flex-direction:column;font-size:13px;line-height:normal}.fxs-portal-main{display:flex;flex-flow:row nowrap;align-items:stretch;position:relative;flex:1 1 auto;min-height:0;height:100%}.fxs-portal-region{display:flex;overflow:hidden;min-height:0;height:100%;min-width:0;width:100%}.fxs-portal-main-region{display:flex;flex-direction:column;width:100%;height:100%;min-height:0;min-width:0;position:relative}.fxs-portal-content{flex:1 1 auto;position:relative;overflow:hidden;z-index:1}.fxs-portal-controlloadfailed>svg{vertical-align:bottom;height:18px}.fxs-portal-tip-content{max-width:400px}.fxs-portal-tip.azc-balloon .azc-balloon-content{padding:0}.fxs-portal-shield{position:fixed;width:100%;height:100%;background-color:rgba(0,0,0,.7);z-index:9;display:table}.fxs-portal-shield-middle{display:table-cell;vertical-align:middle}.fxs-portal-shield-icon{position:absolute;height:40px;width:40px;top:-20px;display:flex;justify-content:center;align-items:center}.fxs-portal-shield-icon>svg{width:20px;height:20px}.fxs-portal-shield-icon-warning{background-color:#ffdfb8}.fxs-portal-shield-icon-error{background-color:#fdd8db}.fxs-portal-shield-modaldialog{width:430px;max-width:100vw;margin:auto;padding:20px;position:relative}.fxs-panorama{position:relative}.fxs-panorama .fxs-startboard-target,.fxs-panorama .fxs-home-target,.fxs-panorama .fxs-journey-target,.fxs-panorama .fxs-sidebar-flyout{display:none;position:absolute;top:0;left:0;height:100%;width:100%;z-index:0}.fxs-panorama .fxs-settings-flyout{position:absolute;top:0;left:0;height:100%;width:100%;z-index:202}.fxs-panorama>div[data-popup="true"].azc-control{z-index:150}.fxs-home-target{overflow-y:auto}.fxs-show-startboard .fxs-startboard-target,.fxs-panorama .fxs-journey-target{display:flex}.fxs-journey-target{pointer-events:none}.fxs-show-journey .fxs-journey-target,.fxs-journey-target .fxs-part-frame{pointer-events:all}.fxs-show-home .fxs-home-target,.fxs-show-allservices .fxs-sidebar-flyout,.fxs-show-settings .fxs-settings-flyout{display:block}.fxs-input{padding:0;margin:0;box-sizing:border-box;border-width:1px;border-style:solid;outline:0;height:24px;text-indent:10px}.fxs-button.fxt-button:focus,.azc-button.fxt-button:focus{outline:0}.fxt-button{min-width:80px;border-radius:2px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.fxs-button{position:relative;box-sizing:border-box;height:24px;font-size:13px;line-height:20px;font-weight:600;cursor:pointer;border-width:1px;border-style:solid;padding:0 20px;margin:0}.fxs-button.fxs-button-disabled{cursor:default}.fxs-inner-solid-border{position:relative}.fxs-inner-solid-border:focus::after{content:"";position:absolute;top:1px;left:1px;right:1px;bottom:1px;display:block;border-width:1px;border-style:solid;pointer-events:none}.fxs-inner-solid-border:focus::after.fxs-button-default{border-color:#605e5c}.fxs-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-full-height{height:100%}.fxs-full-width{width:100%}@keyframes fxs-progress-animatedEllipses{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}@keyframes fxs-progress-animatedEllipsesShadow{0%{transform:scale(1);opacity:0}36.1%{transform:scale(1.06);opacity:.4}50%{transform:scale(1.06);opacity:.4}86.1%{transform:scale(1);opacity:0}}fxs-progress,.fxs-progress{position:absolute;width:100%;height:100%;top:0;z-index:194}.fxs-progress-nozindex{z-index:initial}.fxs-progress-dots{position:absolute;top:calc(50% - 10px/2);width:100%;line-height:0;justify-content:center;display:grid}.fxs-progress-dots-dot,.fxs-progress-dots-dot-shadow{height:10px;width:10px;margin:0 5px;border-radius:5px;grid-row-start:1}.fxs-progress-dots-dot:nth-child(1),.fxs-progress-dots-dot-shadow:nth-child(1),.fxs-progress-dots-dot:nth-child(4),.fxs-progress-dots-dot-shadow:nth-child(4){grid-column-start:1;animation-delay:0s}.fxs-progress-dots-dot:nth-child(2),.fxs-progress-dots-dot-shadow:nth-child(2),.fxs-progress-dots-dot:nth-child(5),.fxs-progress-dots-dot-shadow:nth-child(5){grid-column-start:2;animation-delay:.125s}.fxs-progress-dots-dot:nth-child(3),.fxs-progress-dots-dot-shadow:nth-child(3),.fxs-progress-dots-dot:nth-child(6),.fxs-progress-dots-dot-shadow:nth-child(6){grid-column-start:3;animation-delay:.25s}.fxs-progress-dots-dot{animation:fxs-progress-animatedEllipses 1.8s infinite;background-color:#3471ff;opacity:.3}.fxs-progress-dots-dot-shadow{animation:fxs-progress-animatedEllipsesShadow 1.8s infinite;background-color:transparent;opacity:0;box-shadow:0 3px 3px 0 #0078d4}.fxs-progress-small .fxs-progress-dots,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots,.fxs-startboard-layout .fxs-tile .fxs-progress-dots{top:calc(50% - 6px/2)}.fxs-progress-small .fxs-progress-dots-dot,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots-dot,.fxs-startboard-layout .fxs-tile .fxs-progress-dots-dot,.fxs-progress-small .fxs-progress-dots-dot-shadow,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots-dot-shadow,.fxs-startboard-layout .fxs-tile .fxs-progress-dots-dot-shadow{height:6px;width:6px;margin:0 3px;border-radius:3px}.fxs-progress-small .fxs-progress-dots-dot-shadow,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots-dot-shadow,.fxs-startboard-layout .fxs-tile .fxs-progress-dots-dot-shadow{box-shadow:0 2px 2px 0 #0078d4}.azc-fabric .azc-formControl{border-radius:2px!important}.azc-fabric .azc-textBox-wrapper .azc-input,.azc-fabric .azc-password-wrapper .azc-input,.azc-fabric .azc-numericTextBox-wrapper .azc-input{border-radius:2px}',moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Interactions/Interactions.ContextMenuTouch","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextPane","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Widgets/Widgets.Portal.State","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/Base/Base.Events","MsPortalImpl/ReactViews/ReactFrame.FramePool","MsPortalImpl/Widgets/Widgets.Portal.html","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Weave/DirectRender","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css","Weave","Fx/Experimentation","MsPortalImpl/Extension/ViewModelManager"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M,C,P,w,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,M.injectCss)(C);const S=window,_=S.fx.environment,F=S.fx.getTimestamp,T=MsPortalFx.Base.Diagnostics,k=T.Telemetry,D=T.createLog(e),E="HomeScriptLoad",B="HomeScriptLoadStart",A="HomeScriptLoadEnd",N="AzureHomeLoad",R={start:`${N}Start`,end:`${N}End`};let L=class extends u.ViewModel{constructor(e,t,s,o,i){super("fxsportalroot"),this.sideBar=e,this.topBar=t,this.customEvents=s,this._diContainer=o,this._widgetCreatePromise=Q.defer(),this.rightContextPane=new d.ViewModel(this._diContainer),this.shellContextPane=new d.ViewModel(this._diContainer),this.dockedContextPane=new d.ViewModel(this._diContainer),this.contextMenuViewModel=new y.ViewModel,this.startboardLoading=(0,P.makeWritableComputation)(!1),this.startboardNotFound=(0,P.makeWritableComputation)(!1),this.allServicesMenuInput={filter:(0,P.makeWritableComputation)(),category:""},this.displayMode=i.displayMode,this.inOrganizeMode=i.inOrganizeMode,this.settingsFlyoutState=i.settingsFlyoutState}getDisplayMode(){return this.displayMode.value}setRootPageDisplayType(e){this._rootPageDisplayType=e}getRootPageDisplayType(){let e=this._rootPageDisplayType;return"Home"!==e&&"Dashboard"!==e&&"AllServices"!==e&&(e=(0,l.isLandingPageDashboard)(this._diContainer)?"Dashboard":"Home"),e}showStartboard(){if("Dashboard"===this.displayMode.value)return;this.displayMode("Dashboard");const e=this.getStartBoardWidget();e&&e.setFocus()}getStartBoardArea(){return $(this._widget.element[0].querySelector(".fxs-startboard-target"))}getJourneyArea(){return $(this._widget.element[0].querySelector(".fxs-journey-target"))}getStartBoardWidget(){return c.Widget.getWidget(this.getStartBoardArea(),p.Widget)}getJourneyWidget(){const e=c.Widget.getWidgets(this.getJourneyArea());if(e.length>1)throw new Error("The journey target has been initialized with more than one widget.");return e[0]}async getAzureHomeWidget(e){return this.getWidget().getAzureHomeWidget(e)}getAzureHomeReactWidget(e){return this.getWidget().getAzureHomeReactWidget(e)}setWidget(e){this._widget=e,this.customEvents.setElement(e.element),this._widgetCreatePromise.resolve(!0)}getWidget(){return this._widget}getRootElement(){return this._widget&&this._widget.element}onWidgetCreate(){return this._widgetCreatePromise.promise}};t.ViewModel=L,t.ViewModel=L=__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),s.Class(),__metadata("design:paramtypes",[h.ViewModel,g.ViewModel,f.PortalCustomEvents,s.Container,m.PortalState])],L);class O extends u.Widget{static create(e,t,s){return new O(e.portal,t,s)}constructor(e,t,s){super(e,t,!0),this._diContainer=s,t.setWidget(this),t.setRootPageDisplayType(t.displayMode.value);const o=t.displayMode;e.addClass("fxs-portal fxs-desktop-normal"),t.inOrganizeMode.subscribe(this.ltm,(t=>{e.toggleClass("fxs-desktop-organize",t),e.toggleClass("fxs-desktop-normal",!t)})),(0,b.renderPortal)(e[0],t,s,this.ltm);const c=s.get(l.GeneralSettings),p=this.ltm,u=t.sideBar;c.sideBarLayout.subscribeAndRun(p,(()=>{const t=!(0,l.isSideBarDocked)(s);e.toggleClass("fxs-sidebar-hamburger-mode",t).toggleClass("fxs-sidebar-docked-mode",!t)}));const m=this._findByClassName("fxs-sidebar");m.toggleClass("fxs-display-none",!!_.chrome.hideSidebarNav),new h.Widget(this.ltm,m,u,s);const f=t.topBar,y=this._findByClassName("fxs-topbar"),v=new g.Widget(y,f,s,this._findByClassName("fxs-portal-console")),M=FxImpl.features.getValue("extensionsidebar");if(M){const[,e,t]=M.split("/");s.get(I.ViewModelManager).tryEarlyGetViewModel(e,t,{},{inSideBar:!0,isPrefetch:!0})}s.get(x.ReactFramePool).setFrameRoot(this.element[0].querySelector(".fxs-journey-layout"));const C=new d.Widget(this._findByClassName("fxs-portal-contextpane-right"),t.rightContextPane),w=new d.Widget(this._findByClassName("fxs-portal-contextpane-shell"),t.shellContextPane),S=new d.Widget(this._findByClassName("fxs-portal-contextpane-docked"),t.dockedContextPane);i.register(e),r.register(e),a.register(),(0,P.subscribe)(p,[o],(e=>{"Journey"!==e&&(t.setRootPageDisplayType(e),s.get(n.FullScreenMode).exit()),this.element.toggleClass("fxs-show-journey","Journey"===e),this.element.toggleClass("fxs-show-startboard","Dashboard"===e),this.element.toggleClass("fxs-show-home","Home"===e),this.element.toggleClass("fxs-show-allservices","AllServices"===e),f.dashboardVisible("Dashboard"===e)})),(0,P.subscribe)(p,[this.options.dockedContextPane.opened],(e=>{C.element.toggleClass("fxs-portal-contextpane-docked-opened",e)}));let F=!1;this.ltm.registerForDispose([v,C,w,S,()=>{i.unregister(e),r.unregister(e),a.unregister()},this.element.setEvents(["fxloadingontopbar",(e,t)=>{t.cancel?f.loadingIdList.removeIf((e=>e===t.id)):f.loadingIdList.push(t.id);const s=this.options.getJourneyWidget();s&&s.loadingHint(t.id,!t.cancel)}],["fxtoggleconsole",()=>{v.toggleConsole()}],["fxtogglesidebar",(e,t)=>{const s=t?.collapse??!u.isCollapsed.value;2===u.layoutMode.value&&t?.updateSettings&&c.sideBarCollapsedKey(s),u.setCollapsed(s)}],["fxshowwaffle",()=>{MsPortalFx.require("MsPortalImpl/Widgets/MicrosoftCloudMenuRenderer").then((e=>{F?(e.unmountMicrosoftCloudMenu(),F=!1):(e.renderMicrosoftCloudMenu(),F=!0)}))}])])}async getAzureHomeWidget(e){if(!this._azureHomeWidget){const t=FxImpl.features.isNativePerf&&S.performance,s=F();t&&(t.mark(R.start),t.mark(B)),this._azureHomeWidget=await Promise.all([MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AzureHome"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AzureHome.Component"),this._diContainer.get(w.Experimentation).shellAssignments.whenAvailable()]).then((async([o,i,n])=>{t&&(t.mark(A),t.measure(E,B,A));const r=F(),a=this._findByClassName("fxs-home-target"),l=n.getBooleanValue("reacthomepage"),c=new o.ViewModel(this.options.sideBar.launchBlade,this._diContainer,n,l),d=F();if((0,v.applyToElement)({element:a[0],ltm:this.ltm,weaveNode:i.AzureHomeInner({vm:c}),weaveContext:{diContainer:this._diContainer},opName:"AzureHome"}),l){n.getBooleanValue("azHome")?MsPortalFx.require("MsPortalImpl/Widgets/AzHome/AzHomeToggling.React").then((async e=>{await e.renderHomeWithToggle(this._diContainer)})):MsPortalFx.require("MsPortalImpl/Widgets/AzureHome/AzureHomeRenderer").then((e=>{e.renderAzureHome(this._diContainer)}))}const p=new o.Widget(a,c,this._diContainer);this.ltm.registerForDispose(p);const u=F();return p.setFocus(),p.getFirstLoadPerfIndicators().then((o=>{t&&(t.mark(R.end),t.measure(N,R.start,R.end));const i=o.assetsLoadDuration,n=o.recentsLoadDuration,a=o.favoritesLoadDuration;k.trace({source:"Shell",action:"AzureHomeLoad",data:{assets:i,recents:n,favorites:a,render:u-d,scripts:r-s,fullyReady:Math.max(i,n),endAzureHomeRender:u}}),e&&k.trace({source:"Shell",action:"TotalTimeToInitialRoute",name:"Home",duration:F(),data:{startScriptLoadTime:s,scriptsLoadedTime:r,assetsLoadedTime:o.assetsLoadedTs,recentsLoadedTime:o.recentsLoadedTs,favoritesLoadedTime:o.favoritesLoadedTs}})})),p})).catch((e=>(D.error("failed to load and initialize azure-home",null,MsPortalFx.getLogFriendlyMessage(e)),null)))}return this._azureHomeWidget}async getAzureHomeReactWidget(e){if(!this._azureHomeReactWidgetLoaded){const t=FxImpl.features.isNativePerf&&S.performance,s=F();t&&(t.mark(R.start),t.mark(B)),await Promise.all([this._diContainer.get(w.Experimentation).shellAssignments.whenAvailable(),MsPortalFx.require("MsPortalImpl/Widgets/AzureHome/AzureHomeRenderer"),MsPortalFx.require("MsPortalImpl/Widgets/AzureHome/PerfIndicator")]).then((([o,i,n])=>{t&&(t.mark(A),t.measure(E,B,A));const r=F(),a=F();i.renderAzureHome(this._diContainer);const l=F();n.getFirstLoadPerfIndicators(this._diContainer).then((o=>{t&&(t.mark(R.end),t.measure(N,R.start,R.end));const i=o.assetsLoadDuration,n=o.recentsLoadDuration,c=o.favoritesLoadDuration;k.trace({source:"Shell",action:"AzureHomeLoad",data:{assets:i,recents:n,favorites:c,render:l-a,scripts:r-s,fullyReady:Math.max(i,n),endAzureHomeRender:l}}),e&&k.trace({source:"Shell",action:"TotalTimeToInitialRoute",name:"Home",duration:F(),data:{startScriptLoadTime:s,scriptsLoadedTime:r,assetsLoadedTime:o.assetsLoadedTs,recentsLoadedTime:o.recentsLoadedTs,favoritesLoadedTime:o.favoritesLoadedTs}})})),this._azureHomeReactWidgetLoaded=!0}))}}_findByClassName(e){return $(this.element[0].querySelector("."+e))}}t.Widget=O,__decorate([__metadata("fx:diagnostics",[e,"Widget"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.RootElements,L,s.Container]),__metadata("design:returntype",O)],O,"create",null)})),
define("MsPortalImpl/Widgets/Widgets.Portal.init",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.Portal"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPortalViewModel=void 0,ko.components.register("fxs-progress",{template:s("div",{class:"fxs-progress-dots"},s("div",{class:"fxs-progress-dots-dot"}),s("div",{class:"fxs-progress-dots-dot"}),s("div",{class:"fxs-progress-dots-dot"}),s("div",{class:"fxs-progress-dots-dot-shadow"}),s("div",{class:"fxs-progress-dots-dot-shadow"}),s("div",{class:"fxs-progress-dots-dot-shadow"}))}),t.getPortalViewModel=function(e){return e.get(o.ViewModel)}})),
define("MsPortalImpl/UI/UI.ContextPane",["require","exports","Fx/DependencyInjection","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Portal.init","Weave"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DockedContextPane=t.ShellContextPane=t.RightContextPane=t.ContextPaneImpl=t.ContextPane=void 0;var l=MsPortalFx.Base.Diagnostics.Telemetry;class c{}t.ContextPane=c;class d{constructor(e,t){this._viewModel=t,this._onMinimizeCallbacks=$.Callbacks(),this.opened=this._viewModel.opened,this.loading=this._viewModel.loading;const s={dismissFn:()=>{this.close()},logName:"contextPane"},i=(0,r.getPortalViewModel)(e);MsPortalFx.tryImmediateResolve(i.onWidgetCreate(),(()=>{const e=this._containerLifetime=t.getWidget().ltm;this._contentLifetime=e.createChildLifetime(),(0,a.subscribeAndRun)(e,[t.opened],(e=>{e?o.register(s):o.unregister(s)}))})),t.close=e=>{e.stopPropagation(),this.close()},t.getWidget()&&t.getRootElement().on("minimized",(()=>{this._viewModel.enableResize&&l.trace({source:"Shell",action:"SideCarMinimized",data:{}}),this._onMinimizeCallbacks.fire()})),t.getWidget()&&t.getRootElement().on("maximized",(()=>{t.getWidget().element.width($.querySelectorAll(".fxs-portal-region").width()),t.getWidget().element.addClass("fxs-contextpane-docked-maximized"),t.getRootElement().find(".fxs-blade-restore").removeClass("fxs-display-none"),t.getRootElement().find(".fxs-blade-maximized").addClass("fxs-display-none"),l.trace({source:"Shell",action:"SideCarMaximized",data:{}})})),t.getWidget()&&t.getRootElement().on("restore",(()=>{const e=t.getWidget().getContextPaneWidth();t.getWidget().element.width(e+"px"),t.getWidget().element.removeClass("fxs-contextpane-docked-maximized"),t.getWidget().element.removeClass("fxs-contextpane-docked-resized"),t.getRootElement().find(".fxs-blade-maximized").removeClass("fxs-display-none"),t.getRootElement().find(".fxs-blade-restore").addClass("fxs-display-none"),l.trace({source:"Shell",action:"SideCarRestored",data:{}})}))}hasContent(e){return this._contentProvider===e}getContent(){return this._contentProvider}get contentLifetime(){return this._contentLifetime}tryOpen(e,t,s){if(this._contentProvider===e)return this._viewModel.getWidget().setFocus(),Promise.resolve(!0);const o=!!t||this._tryRemoveContent();if(o){this._contentProvider=e,t?this._contentProviderStack.push(e):this._contentProviderStack=[e],this._previouslyFocusedElement=document.activeElement;const n=this._viewModel;return n.opened(!0),n.loading(!0),e.onAddingContent(this._viewModel,t).finally((()=>i.waitForBindings(this._viewModel.getRootElement()[0]).finally((()=>{const e=n.getWidget();n.enableResize(s??!1),e.element.hasClass("fxs-portal-contextpane-docked")&&e.element.removeAttr("style"),n.loading(!1)})))).then((()=>(this._viewModel.getWidget().setFocus(),o)))}return Promise.resolve(o)}close(e){if(!this._contentProvider)return!0;let t=!0;if(e?this._clearContent():t=this._tryRemoveContent(),t){const e=this._viewModel;0===e.childElementCount.value&&e.opened(!1),e.loading(!1),this._restoreFocus()}return t}onMinimized(e){this._onMinimizeCallbacks.add(e)}_clearContent(){const e=this._contentProvider;e&&e.onRemovingContent(this._viewModel),this._contentProviderStack.pop(),0===this._contentProviderStack.length?this._contentProvider=null:this._contentProvider=MsPortalFx.last(this._contentProviderStack);const t=this._contentLifetime;t&&(t.dispose(),this._contentLifetime=this._containerLifetime.createChildLifetime())}_tryRemoveContent(){const e=this._contentProvider;if(!e)return!0;const t=!e.canRemoveContent||e.canRemoveContent();return t&&this._clearContent(),t}_restoreFocus(){const e=this._previouslyFocusedElement;if(e){let t=$(e).closest(".fxs-blade");if(t.length){t=t.parent().children(".fxs-blade").last();const e=n.Widget.getWidgets(t),s=e.length&&e[0];if(s&&s.setFocus)return void s.setFocus()}(document.activeElement===document.body||$.contains(this._viewModel.getRootElement()[0],document.activeElement))&&e.focus()}}}t.ContextPaneImpl=d;class p extends c{static create(e){const t=(0,r.getPortalViewModel)(e);return new d(e,t.rightContextPane)}}t.RightContextPane=p,__decorate([__metadata("fx:diagnostics",[e,"RightContextPane"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",p)],p,"create",null);class u extends c{static create(e){const t=(0,r.getPortalViewModel)(e);return new d(e,t.shellContextPane)}}t.ShellContextPane=u,__decorate([__metadata("fx:diagnostics",[e,"ShellContextPane"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",u)],u,"create",null);class m extends c{static create(e){const t=(0,r.getPortalViewModel)(e);return new d(e,t.dockedContextPane)}}t.DockedContextPane=m,__decorate([__metadata("fx:diagnostics",[e,"DockedContextPane"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",m)],m,"create",null)})),
define("MsPortalImpl/Base/Telemetry",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDesktopTraceEnabled=void 0,t.isDesktopTraceEnabled=!!MsPortalFx.trace.desktop})),
define("MsPortalImpl/Services/Services.EditScopeManagement",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateEditScopeIsSavingState=t.saveSerializedEditScope=t.loadSerializedEditScope=t.EditScopeManager=t.EditScopeManagerImpl=void 0;var n=FxImpl.Data,r=FxImpl.Rpc;class a{constructor(e,t){this._editScopes={},this._extensionManager=e,this._rpcClient=t,e.onUnload((e=>(this._onExtensionUnloaded(e),!0)))}onEditScopeCreated(e){this._ensureEditScope(e,!0)}onEditScopeDisposed(e){this._getDirtyExtensionSettings(e).forEach((t=>{const s=this._extensionManager.getExtension(c(t.key).extension);s&&s.isLoaded()&&n.onEditScopeDiscardedEndPoint.invoke(this._rpcClient,s.name,e)})),this._deleteEditScope(e)}getStateObservable(e){const t=this._ensureEditScope(e);if(!t.stateObservable){const s=ko.observable();t.stateObservable=ko.pureComputed((()=>{s();return this._getDirtyExtensionSettings(e).length>0?t.savingRefCount()>0?2:1:0})),this._loadEditScope(e).then((()=>{s(!0)}))}return t.stateObservable}logEditsToConsole(e){const t=this._editScopes[e]&&this._editScopes[e].settings;t&&t.extensionSettings().forEach((e=>{const t=c(e.key);console.debug('Edits for editScopeId: {0}, extension: "{1}"'.format(t.editScopeId,t.extension)),n.logEditsToConsole(e.settings)}))}loadEditScopeForExtension(e,t){return this._loadEditScope(e).then((()=>{const s=this._editScopes[e];if(!s)return null;const o=s.settings;if(o){const s=l(e,t),i=MsPortalFx.find(o.extensionSettings(),(e=>e.key===s));return i?i.settings:null}return null}))}saveEditScopeForExtension(e,t,s){const o=this._editScopes[e];let i;if(!this._canEditScopeBeUpdated(o))return;const n=l(e,t),r=MsPortalFx.findIndex(o.settings.extensionSettings(),(e=>e.key===n));r<0?o.settings.extensionSettings.push({key:n,settings:s}):(i=o.settings.extensionSettings()[r],i.settings=s,o.settings.extensionSettings.splice(r,1,i)),o.settings.keys.indexOf(n)<0&&o.settings.keys.push(n)}updateEditScopeIsSavingStateForExtension(e,t,s){const o=this._editScopes[e];if(!o)return;const i=o.savingRefCount()||0;s?o.savingRefCount(i+1):i>0&&o.savingRefCount(i-1)}trackingEditScope(e){return!!this._editScopes[e]}_canEditScopeBeUpdated(e){return!!e&&!!e.loadPromise}_deleteEditScope(e){delete this._editScopes[e]}_loadEditScope(e){const t=this._ensureEditScope(e);return t.justCreated&&(t.settings={keys:[],extensionSettings:ko.observableArray()},t.loadPromise=Promise.resolve(),t.justCreated=!1),t.loadPromise||(t.loadPromise=this._getAndProcessSettings(e)),t.loadPromise}_getAndProcessSettings(e){return this._editScopes[e].settings={keys:[],extensionSettings:ko.observableArray()},Promise.resolve()}_getDirtyExtensionSettings(e){const t=this._editScopes[e]&&this._editScopes[e].settings;return t&&t.extensionSettings().filter((e=>{const t=e.settings;return t&&t.edits.length>0}))||[]}_onExtensionUnloaded(e){for(const t in this._editScopes){const s=this._editScopes[t];if(s.savingRefCount()>0){s.settings&&s.settings.extensionSettings().some((t=>e===c(t.key).extension&&t.settings.edits.length>0))&&(this._clearEditScopeEdits(t),s.savingRefCount(0))}}}_clearEditScopeEdits(e){const t=this._editScopes[e];if(!this._canEditScopeBeUpdated(t))return;const s=t.settings&&t.settings.extensionSettings;s().forEach((e=>{e.settings=null})),s(s())}_ensureEditScope(e,t=!1){let s=this._editScopes[e];return s||(s=this._editScopes[e]={savingRefCount:ko.observable(0),justCreated:t}),s}}function l(e,t){return"{0}-{1}-{2}".format("editScopes",e,t)}function c(e){const t=e.split("-");return{editScopeId:t.slice(1,t.length-1).join("-"),extension:t[t.length-1]}}t.EditScopeManagerImpl=a;class d{static create(e,t){return new a(e,t)}}t.EditScopeManager=d,__decorate([__metadata("fx:diagnostics",[e,"EditScopeManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.ExtensionManager,r.Client]),__metadata("design:returntype",d)],d,"create",null),t.loadSerializedEditScope=o.defineHandler(n.loadSerializedEditScopeEndPoint,(e=>e.diContainer.get(d).loadEditScopeForExtension(e.messageArg,e.messageContext.srcWindowId))),t.saveSerializedEditScope=o.defineHandler(n.saveSerializedEditScopeEndPoint,(e=>{e.diContainer.get(d).saveEditScopeForExtension(e.messageArg.editScopeId,e.messageContext.srcWindowId,e.messageArg.edits)})),t.updateEditScopeIsSavingState=o.defineHandler(n.updateEditScopeIsSavingStateEndPoint,(e=>{e.diContainer.get(d).updateEditScopeIsSavingStateForExtension(e.messageArg.editScopeId,e.messageContext.srcWindowId,e.messageArg.isSaving)}))})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Graph",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionGraph=void 0;let n=class{constructor(){this._entries=new Map,this._idIndex=new Map}getStartBoard(){return this._startBoard}find(e){return this._idIndex.get(e)}findBlades(e,t,s){let n=[];if(e instanceof o.Locator)this._entries.forEach(((t,s)=>{s.getCompositionType()===i.CompositionType.Blade&&s.locator.equals(e)&&n.push(s)}));else if(e){const t=this._entries.get(e);n=t?.opened.slice()||[]}else{if(s||t)throw new Error("Criteria is null or undefined.  Searching for the help blade or a docked blade requires a locator or parent composition");if(this._startBoard){const e=this._entries.get(this._startBoard);let t=e?.opened[0];for(;t;){n.push(t);const e=this._entries.get(t);t=e?.opened[0]}}}return n.filter((e=>!(256&e.flags)&&512&(s?e.flags:~e.flags)&&32&(t?e.flags:~e.flags)))}getParentBlade(e){const t=this._entries.get(e);return t?.openedBy?.parent?.parent}setStartBoard(e){if(!this._entries.has(e)){const t={instance:e,opened:[]};this._addEntry(t),this._startBoard=e}}addBlade(e,t){let s=this._entries.get(e);if(s||(s={instance:e,openedBy:t,opened:[]},this._addEntry(s)),t.getCompositionType()===i.CompositionType.Part||t.getCompositionType()===i.CompositionType.StartboardPart){const s=this._entries.get(t);s&&s.opened.push(e)}let o=t.getCompositionType()===i.CompositionType.StartboardPart||t.getCompositionType()===i.CompositionType.Part?t.parent:t;o&&o.getCompositionType()===i.CompositionType.Lens&&(o=o.parent),o&&(s=this._entries.get(o),s||(s={instance:o,opened:[]},this._addEntry(s)),s.opened.push(e),s.instance.getCompositionType()===i.CompositionType.Blade&&s.instance.onDetailContainersChanged())}addPart(e){let t=this._entries.get(e);t||(t={instance:e,opened:[]},this._addEntry(t)),e.registerForDispose((()=>this.removePart(e)))}removeBlade(e,t=!0){this.findBlades(e,!!(32&e.flags),!!(512&e.flags)).forEach((e=>this.removeBlade(e,!1))),this._deleteEntry(e),this._entries.forEach((s=>{if(MsPortalFx.remove(s.opened,e).length&&t){const e=s.instance.getCompositionType()===i.CompositionType.Blade&&s.instance;e&&!e.isDisposed()&&e.onDetailContainersChanged()}}))}removeAllBlades(e){const t=this._entries.get(e);if(t){t.opened.slice().forEach((e=>{32&~e.flags&&512&~e.flags&&this.removeBlade(e)}))}}removePart(e){this._deleteEntry(e)}_addEntry(e){this._entries.set(e.instance,e),this._idIndex.set(e.instance.id,e.instance)}_deleteEntry(e){this._entries.delete(e),this._idIndex.delete(e.id)}};t.CompositionGraph=n,t.CompositionGraph=n=__decorate([__metadata("fx:diagnostics",[e,"CompositionGraph"]),s.Class()],n)})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Finder",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Graph"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Finder=void 0;let n=class{constructor(e){this._graph=e}find(e){return this._graph.find(e)}findPart(e,t){let s=MsPortalFx.find(t.children,(t=>t.id===e));if(!s)for(const o of t.children)if(s=MsPortalFx.find(o.children,(t=>t.id===e)),s)break;return s}findBlades(e=null,t=!1,s=!1){return this._graph.findBlades(e,t,s)}findSiblingBlades(e,t=!1,s=!1){return this._graph.findBlades(this.findPartsContainer(e),t,s)}findPartsContainer(e){if(!e)return this._graph.getStartBoard();for(;e&&!r(e);)e=e.parent;return e}findParentMenuBlade(e){if(16&e.flags)for(let t=e;t;t=this._graph.getParentBlade(t)){const e=t?.bladeDefinition;if(e?.menuBlade||e?.tabMenuBlade)return t}else{const t=this._graph.getParentBlade(e),s=t?.bladeDefinition;if(s?.menuBlade||s?.tabMenuBlade)return t}return null}};function r(e){return e.getCompositionType()===o.CompositionType.Startboard||e.getCompositionType()===o.CompositionType.Blade}t.Finder=n,t.Finder=n=__decorate([__metadata("fx:diagnostics",[e,"Finder"]),s.Class(),__metadata("design:paramtypes",[i.CompositionGraph])],n)})),
define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DesktopManagerView=void 0;var r=MsPortalFx.Base.Diagnostics;const a=r.createLog(e);function l(e,t){o.isDesktopTraceEnabled&&a.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(e,t.toString(),ko.toJSON(t.getInputsOnlyViewModel())))}let c=class{constructor(e,t,s){this._contextPane=t,this._dockedContextPane=s,this._portal=(0,n.getPortalViewModel)(e)}composeStartBoard(e){e&&e.compose(this._portal.getWidget())}addPartToStartBoard(e){e.compose(this._portal.getStartBoardWidget())}addBlade(e,t){l("Adding blade to desktop.",e);const s=e.parent,o=s.children;return r.Telemetry.trace({action:"JourneyLength",source:"Desktop",data:{count:o.length,blades:o.map((e=>{const t=e.locator;return{bladeName:t.name,extension:t.getExtensionName()}}))},journeyId:s&&s.id}),512&e.flags?this._dockedContextPane.tryOpen(e,0!=(16&e.flags),0!=(1024&e.flags)).then(MsPortalFx.noop):1&e.flags?this._contextPane.tryOpen(e,0!=(16&e.flags)).then(MsPortalFx.noop):(e.compose(this._portal.getJourneyWidget(),t),Promise.resolve())}removeBlade(e){l("Removing blade from desktop.",e);let t=this._contextPane;if(512&e.flags&&(t=this._dockedContextPane),t.hasContent(e))t.close(!0);else{const t=this._portal.getJourneyWidget();t&&t.removeChild(e.id)}}removeAllBlades(e){const t=this._portal.getJourneyWidget();t&&t.removeChildren(e)}};t.DesktopManagerView=c,t.DesktopManagerView=c=__decorate([__metadata("fx:diagnostics",[e,"DesktopManagerView"]),s.Class(),__metadata("design:paramtypes",[s.Container,i.RightContextPane,i.DockedContextPane])],c)})),
define("MsPortalImpl/UI/UI.JourneyManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Telemetry","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JourneyManager=t.getLastResourceIdInJourney=void 0;const m=i.Desktop,h=MsPortalFx.Base.Diagnostics.createLog(e);var g=MsPortalFx.deepEquals;const f={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."};var x=MsPortalFx.getUniqueId,b=MsPortalFx.Base.Diagnostics.Telemetry;t.getLastResourceIdInJourney=o.defineHandler(FxImpl.Extension.getLastResourceIdInJourneyEndPoint,(e=>{const t=e.diContainer.get(y).activeJourney();return t&&t.getCurrentResourceId()}));let y=class{constructor(e,t,s,o,i){let n;this._diContainer=e,this._browser=t,this._finder=s,this._compositionGraph=o,this._view=i,this.activeJourney=ko.observable(null),this._loadingJourneyGuid=null,this._portal=(0,u.getPortalViewModel)(e);let r,a=!1,l=0,c=!1;const d=()=>{const e=this._portal;this._moveMenuBladeWidget(e),e.customEvents.trigger("fxjourneychanged",{openedAsHome:c,wasCtxPaneRoot:a})},p=e=>{l++||(n=this.activeJourney(),r=n&&n.children&&n.children.length,a=n&&n.isStartedWithContextBlade()),c=e},m=e=>{if(! --l){const t=n&&n.children&&n.children.length;e||n===this.activeJourney()&&r===t||d(),n=void 0,a=!1,c=!1}};this._changeJourney=(e,t,s)=>{p(t);try{return e()}finally{m(s)}}}configure(e){this._startBoard=e}setActiveJourney(e){this.activeJourney(e),e&&n.isFullscreen()&&n.exitFullscreen()}async openBlade(e,t){const s=0===e.containerType,o=!!MsPortalFx.find(this._sideBarJourney?.children||[],(t=>t.id===e.id));this._createJourney||await this._loadModules(),this._finder.findBlades(e).forEach(((e,s)=>{if(e.locator.equals(t.locator)&&e.masterPartId===t.masterPartId&&e.masterInvocationProperty===t.masterInvocationProperty&&0===s&&e.locator.equals(t.locator)){const s=e.containerWidget;return s&&s.setFocus(),r.isDesktopTraceEnabled&&h.verbose("[DesktopManager] Found a previously opened detail blade."+"\n  Existing blade: {0}. Model: {1}.".format(e.toString(),ko.toJSON(e.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(ko.toJSON(t))),Promise.resolve(e)}}));try{this._createNewJourneyPromise&&await this._createNewJourneyPromise}catch{}return s&&0===this._finder.findBlades(e).length||o||32&t.flags||512&t.flags||256&t.flags?this.createJourney(!o&&t.masterPartId,t).then((e=>{if(e&&e.children&&e.children.length>0)return e.children[0];throw new MsPortalFx.Errors.Error("Failed to create new journey")})):this._changeJourney((()=>{const i=this._createBlade(this._diContainer,t,e),n=this._finder.findPart(t.masterPartId,e);this._compositionGraph.addBlade(i,n||e);const r=s||o?0:1+this._findFirstItemIndex(this.activeJourney().children,e.id,f.noBladeInJourney.format(e.id));return this.activeJourney().addChild(i,r),this._view.addBlade(i,{assetType:t.originAssetType,index:r,focus:!0}).catch((e=>{h.error(e)})),i}))}async createJourney(e,t,s){let o,i;const n=!!(32&t?.flags),r=!!(256&t?.flags),a=!!(512&t?.flags);if(this._createJourney||await this._loadModules(),i||(o=this._startBoard,i=MsPortalFx.find(o.children,(t=>t.id===e))),!i&&e)throw h.error(f.noTileInDesktop.format(e)),h.verbose(ko.toJSON(this.getDiagnosticsData(),null,2)),new MsPortalFx.Errors.Error(f.noTileInDesktop.format(e));const l=Promise.withResolvers();if(s||(s=x(),this._loadingJourneyGuid=s,this._createNewJourneyPromise=l.promise),l.promise.finally((()=>{this._loadingJourneyGuid===s&&(this._loadingJourneyGuid=null,this._createNewJourneyPromise=null)})),!1===i?.isComposed&&await i.await(7),n||r||a||this.tryDeactivateJourney(s))try{const e=this._createJourney(this._diContainer,i),s=v("Desktop","JourneyOpened",M(i),void 0,e.id);n?this._helpPaneJourney=e:r?this._sideBarJourney=e:a?this._dockedContextPaneJourney=e:this.setActiveJourney(e);const c=t.openedByContext,d=c&&c.openedAsHome;this._changeJourney((()=>{const s=this._createBlade(this._diContainer,t,o);e.addChild(s),e.compose(this._portal.getWidget()),this._compositionGraph.addBlade(s,i||o),this._view.addBlade(s,{assetType:t.originAssetType,focus:!0}).catch((e=>{h.error(e)})),l.resolve(e)}),d),b.completeTrace(s)}catch(e){l.reject(e)}else l.reject(new MsPortalFx.Errors.Error("tryDeactivateJourney returned false"));return l.promise}getDiagnosticsData(){const e=this._startBoard,t=this.activeJourney();return{startboard:e&&e.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}}tryDeactivateJourney(e){const t=this.activeJourney();if(t){if(!this.confirmBladesCanClose(t.children))return!1;const e=t.children.filter((e=>!e.isRestorable()));for(let t=e.length-1;t>=0;t--)this.forceCloseBlade(e[t]);const s=v("Desktop","JourneyDeactivated",M(t.originTile),void 0,t.id);this._closeActiveJourney(!0),b.completeTrace(s)}else this._startBoard&&this._compositionGraph.removeAllBlades(this._startBoard);return this._loadingJourneyGuid=e||null,!0}closeChildBlades(e){const t=this.discardEditsOfBlade(e,{includeSelf:!1,includeDescendants:!0});if(t.successful){const t=this._finder.findBlades(e);for(let e=t.length-1;e>=0;e--)this.forceCloseBlade(t[e],1)}return t}tryCloseBlade(e,t){if(32&e.flags||512&e.flags||MsPortalFx.findIndex(this.activeJourney()?.children,(t=>t.id===e.id))>=0){const s=this.confirmBladesCanClose([e]);return s&&this.forceCloseBlade(e,t),s}return!0}confirmBladesCanClose(e,t,s){const o=t||this.activeJourney();if(!MsPortalFx.find(e,(e=>!this.canCloseBlade(e,{bladeJourney:o,validateHidden:s}))))return!0;e.forEach((e=>{if(!this._compositionGraph.find(e.id))throw new Error(f.noBladeInJourney.format(e.id))}));const i=[];return MsPortalFx.pushUnique(i,MsPortalFx.mapMany(e,(e=>this._getAlertMessageRecursive(e)))),this._browser.confirm(i.join("\n")||m.confirmEditScopeDiscard)}forceCloseBlade(e,t,s){if(!this.activeJourney()&&!this._helpPaneJourney&&!this._dockedContextPaneJourney)throw new Error(f.noActiveJourney);const o=s&&s.openBlade;this._changeJourney((()=>{const s=e.parent,o=this._findFirstItemIndex(s.children,e.id,f.noBladeInJourney.format(e.id)),i=this._finder.findBlades(this._startBoard);1===i.length&&i[0].id===e.id?this.forceDiscardJourney(s.id,t):(0===o?this.forceDiscardJourney(s.id,t):this._closeBladeRecursive(e,o,t),this._compositionGraph.removeBlade(e))}),void 0,o)}canCloseBlade(e,t){const s=t?.bladeJourney||this.activeJourney();if(!s)return!0;const o=e=>{const i=!(!e.bladeDefinition||!e.bladeDefinition.actionBar);if(!ko.unwrap(e.editScopeId)&&e.shouldAlertOnClose({legacyMode:i,validateHidden:t?.validateHidden}))return!0;if(e.isInitialized&&!e.children.some((e=>e.children.some((e=>e.suppressAlert()))))&&s.ambientSettings.getItemsInPath(e.journeyPath).some((e=>{const t=e.value,s=t&&t.editScope;return s&&s.dirty&&!s.saving})))return!0;const n=this._finder.findBlades(e);return 0!==n.length&&n.some((e=>o(e)))};return!o(e)}forceDiscardJourney(e,t){this.activeJourney()?.id===e?this._changeJourney((()=>{this._closeActiveJourney(!1,t)})):e===this._helpPaneJourney?.id?this._helpPaneJourney.children.slice(0).forEach((e=>{this._compositionGraph.removeBlade(e),e.isDisposed()||this._closeBladeRecursive(e,0,t,!1)})):e===this._dockedContextPaneJourney?.id&&this._dockedContextPaneJourney.children.slice(0).forEach((e=>{this._compositionGraph.removeBlade(e),e.isDisposed()||this._closeBladeRecursive(e,0,t,!1)}))}tryDiscardJourney(e){let t=!1;return(this.canDiscardJourney(e)||this._browser.confirm(m.confirmEditScopeDiscard))&&(this.forceDiscardJourney(e),t=!0),t}canDiscardJourney(e){const t=this.activeJourney()?.id===e&&this.activeJourney(),s=t&&t.ambientSettings.getObservable().peek().some((e=>{const t=e.value,s=t&&t.editScope;return s&&s.dirty&&!s.saving&&s.disposeOnJourneyDiscard}));return!t||!s}discardEditsOfBlade(e,t){return this._discardEditsOfContainer(e,t.force,(s=>{const o=s.value,i=s.path,n=e.journeyPath,r=g(i,n),a=!r&&(1===o.type||i.length>=n.length+2);return o&&o.editScope&&(t.includeSelf&&r||t.includeDescendants&&a)}))}dispose(){this.activeJourney()&&(this.activeJourney().dispose(!0),this.activeJourney(null)),this._helpPaneJourney&&(this._helpPaneJourney.dispose(),this._helpPaneJourney=null),this._sideBarJourney&&(this._sideBarJourney.dispose(),this._sideBarJourney=null),this._dockedContextPaneJourney&&(this._dockedContextPaneJourney.dispose(),this._dockedContextPaneJourney=null)}getJourneyIdForTile(e){const t=this.activeJourney();let s;return t&&t.originTile.id===e&&(s=t.id),s}_discardEditsOfContainer(e,t,s){let o=[];const i={confirmationRequired:!1,successful:!1},n=this.activeJourney();if(!n)throw new Error(f.noActiveJourney);const r=n.ambientSettings;return(0===e.containerType||e.isInitialized)&&(o=r.getItemsInPath(e.journeyPath).filter(s)),i.confirmationRequired=!t&&o.filter((e=>{const t=e.value.editScope;return t.dirty&&!t.saving})).length>0,i.confirmationRequired&&!this._browser.confirm(m.confirmEditScopeDiscard)||(i.successful=!0,o.forEach((e=>{r.removeItem(e.path),this._diContainer.get(a.EditScopeManager).onEditScopeDisposed(e.value.editScope.editScopeId)}))),i}_closeActiveJourney(e,t){const s=this.activeJourney();this.setActiveJourney(null),this._compositionGraph.removeAllBlades(this._startBoard),s&&(s.children.slice(0).reverse().forEach((s=>{s.isDisposed()||this._closeBladeRecursive(s,0,t,e)})),s.dispose(e)),this._view.removeAllBlades((e=>{h.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(e))}));const o=this._portal.sideBar;o&&(o.menuBladePartContainer(null),o.menuBladeId(null))}_closeBladeRecursive(e,t,s,o){this._removeBladesFromUIRecursive(e),this._disposeBladesRecursive(e,t,o),o||(e.parent.save(),this._portal.customEvents.trigger("fxbladeclosed",{id:e.id,reason:s,masterPartId:e.masterPartId}))}_removeBladesFromUIRecursive(e){const t=this._finder.findBlades(e);for(let e=t.length-1;e>=0;e--)this._removeBladesFromUIRecursive(t[e]);this._view.removeBlade(e)}_disposeBladesRecursive(e,t,s){const o=e.parent.children.indexOf(e,t);s?e.dispose(!0):e.parent.removeChildAt(o,void 0),this._finder.findBlades(e).forEach((e=>{this._disposeBladesRecursive(e,o,s)}))}_getAlertMessageRecursive(e){return(e=>{const t=MsPortalFx.mapMany(this._finder.findBlades(e),(e=>e.getAlertOnCloseMessages()));return MsPortalFx.union(e.getAlertOnCloseMessages(),t)})(e)}_findFirstItemIndex(e,t,s){const o=MsPortalFx.findIndex(e,(e=>e.id===t));if(-1===o)throw h.verbose(ko.toJSON(this.getDiagnosticsData(),null,2)),new Error(s);return o}getJourneyWidget(){return this._portal.getJourneyWidget()}_masterIsMenuBlade(e){const t=e&&e.masterContainer,s=t&&t.bladeDefinition;return!(!s||!s.menuBlade)}_moveMenuBladeWidget(e){const t=this.activeJourney(),s=t&&t.children,o=e.sideBar,i=o.menuBladeId,n=o.layoutMode.value,r=o.getRootElement().find(".fxs-sidebar-menu-container"),a=o.menuBladePartContainer,l=(e,t)=>{a(t),i(e)};if(s&&s.length){const e=s[s.length-1],t=e.bladeDefinition;if(t&&t.menuBlade)return;const o=3&e.flags,c=this._masterIsMenuBlade(e.masterContainer),d=this._masterIsMenuBlade(e),p=o?e.masterContainer&&e.masterContainer.masterContainer:e.masterContainer;if(d){const e=p.getMenuWidget(),t=$(e.element);if(0===n&&i.value!==p.id){const e=r.find(".fxc-menu");e.length&&(e.detach(),a.value&&e.appendTo(a.value)),t.appendTo(r)}return void l(p.id,e.getPartContainer())}if(c&&0===n){const e=r.find(".fxc-menu");e.length&&e.detach(),a.value&&e.appendTo(a.value)}}l()}async _loadModules(){if(!this._createJourney){const[e,t]=await Promise.all([o.get("MsPortalImpl/UI/Compositions/UI.Composition.Journey","create"),o.get("MsPortalImpl/UI/Compositions/UI.Composition.Blade","create")]);this._createJourney=e,this._createBlade=t}}};function v(e,t,s,o,i){return b.startTrace({source:e,action:t,name:s,assetType:o,journeyId:i})}function M(e){return e&&e.locator&&e.locator.toFriendlyString()}t.JourneyManager=y,t.JourneyManager=y=__decorate([__metadata("fx:diagnostics",[e,"JourneyManager"]),s.Class(),__metadata("design:paramtypes",[s.Container,p.Browser,l.Finder,c.CompositionGraph,d.DesktopManagerView])],y)})),
define("MsPortalImpl/Base/Base.Router",["require","exports","Fx/ResourceManagement","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.HistoryManager","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.Portal.init","Weave","Fx","Fx/Experimentation","MsPortalImpl/Services/Services.AssetTypes"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M,C,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Router=t.getReactBrowseRedirectBlade=t.convertToBrowseRouteUrlOnValidBrowseBlade=t.Internal=void 0;var w=MsPortalFx.Base,I=w.Diagnostics;const S=window,_=I.createLog(e),F=n.Portal.defaultPageTitle.format(n.Dashboard.defaultTitle,S.fx.environment.branding.title);const T=FxImpl.getErrorMap({linkFormat:"",invalidLink:"",unfoundAsset:"",noResourceAsset:""});function k(e,t){const s=new Date;e.getAsync(i.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((e=>{e.addClientNotification({title:n.Shell.deepLinkInvalidTitle,description:t,status:MsPortalFx.Hubs.Notifications.NotificationStatus.Error,timestamp:s,correlationIds:[s.getTime().toString()]})}))}var D;function E(e,t,s,o,i,n){return MsPortalFx.extend({extensionName:e,assetType:t,assetId:s,detailBladeInputs:o,defaultMenuItemId:i},n)}function B(e){return!(e.isEnabled("hidedirectorypanebutton")||S?.chrome?.hideDirectoryPaneButton)}function A(e,t){const s=t.portal,o=t.baseRouter;return{navigateTo:(t,i)=>o.tryCleanupJourney()?(s.settingsFlyoutState(0),i.interactionSource||(i.interactionSource="Router"),I.Telemetry.trace({source:i.interactionSource||"Base.Router",action:"DashboardNavigation"}),MsPortalFx.isNullOrWhiteSpace(i.dashboardId)&&(i.dashboardId=t&&(0,r.getDashboardIdFromUri)(t)),e.get(u.SwitchDashboardPortalFunc).invoke({id:i.dashboardId,title:i.dashboardId},i.interactionSource).then((()=>{o.updateTitle(),s.customEvents.trigger("fxdeeplinkchanged")}))):Promise.reject()}}function N(e,t){const s=e.get(FxImpl.Features),o=t.portal,i=t.baseRouter;return{navigateTo:(t,n)=>{if(n=n||{},I.Telemetry.trace({source:"Base.Router",action:"AzureHomeNavigation"}),i.tryCleanupJourney()){i.ensureRouteInView("Home");const t=s.getValue("bladeashomedeeplink");if(t){const e=new l.Uri("#"+t),s={deepLink:e.hash,openedAsHome:!0};i.navigateWithRoute("blade",e,{openedByContext:s})}else{e.get(C.Experimentation).shellAssignments.whenAvailable().then((t=>{o.getAzureHomeWidget(n.invokedByInitRoute).then((s=>{t.getBooleanValue("reacthomepage")?MsPortalFx.require("MsPortalImpl/Widgets/AzureHome/AzureHome.DataSource").then((t=>{t.reloadRecentsAndFavorites(e)})):s&&(s.reloadRecents(),s.reloadFavorites(),!n.skipFocus&&s.setFocus())}))}))}return i.updateTitle(),o.customEvents.trigger("fxdeeplinkchanged"),Promise.resolve()}return Promise.reject()}}}function R(e,t){const s=t.portal,o=t.baseRouter;return{navigateTo:e=>{if(o.tryCleanupJourney()){const t=e.getHashParts().rest.split("/");let i,n="";if(t?.length){switch(t[0].toLowerCase()){case"category":i=t[3],n=t[1];break;case"filter":i=t[1],n=t[3]}}o.ensureRouteInView("AllServices");const l=i&&decodeURIComponent(i);s.allServicesMenuInput.filter(l),s.allServicesMenuInput.category=n&&decodeURIComponent(n),"allservices"!==(0,r.getCurrentUri)().getHashParts().category&&a.pushState({data:{},url:e.hash}),o.updateTitle()}return Promise.resolve()}}}function L(e,t){const s=e.get(g.JourneyManager),o=t.portal,i=t.lifetime,n=t.baseRouter,l={2:"directory",3:"filters",6:"contact",4:"appearance"};const c=(t,r)=>{const a=t.getHashParts().rest,l=e.get(FxImpl.Features),c=function(e,t){let s=1;if(t.enableOverview||(s=t.enableDirectorySettings?2:4),!e)return s;let o,i=e.toLowerCase();switch(e.startsWith("#settings")&&(i=e.split("/")[1]),i){case"directory":t.enableDirectorySettings&&(o=2);break;case"filters":t.enableGlobalResourceFilters&&(o=3);break;case"contact":t.enableContactInfo&&(o=6);break;case"appearance":o=4}return MsPortalFx.isNullOrUndefined(o)&&(o=s),o}(a,{enableDirectorySettings:B(l),enableGlobalResourceFilters:r,enableContactInfo:l.isEnabled("contactinfo"),enableOverview:!l.isEnabled("hidesettingsoverview")});if(o.settingsFlyoutState(c),0!==o.settingsFlyoutState.value){e.get(m.RightContextPane).close(!0);const t=e.get(h.DialogManager);t.hasOpenDialog&&(I.Telemetry.trace({source:"Base.Router",action:"SettingsFlyoutClosedDialogsOnOpen"}),t.dismissOpenDialog())}const d=i.createChildLifetime();(0,v.subscribe)(d,[o.settingsFlyoutState],(async e=>{if(0===e){const e=s.activeJourney();e&&e.children.length||await n.goToLandingPage({interactionSource:"Router",replaceHistory:!1,invokedByInitRoute:!0,skipFocus:!0}),d.dispose()}}))};return(0,v.subscribe)(i,[o.settingsFlyoutState],(e=>{if(0===e){const e=(0,r.getCurrentUri)().getHashParts();return void(e.category&&"settings"===e.category&&(n.updateNavHistory(),n.updateTitle()))}const t=l[e];a.pushState({data:{},url:(0,r.getCurrentUri)().setHash("#settings"+(t?`/${t}`:"")).href}),o.customEvents.trigger("fxdeeplinkchanged"),n.updateTitle()})),{navigateTo:t=>e.get(p.SubscriptionsUserContext).useAdvancedFiltersPromise.then((e=>c(t,e)))}}!function(e){e.RouterImpl=class{constructor(e,s,o){this._diContainer=e,this._portal=o,this._ltm=new FxImpl.TriggerableLifetimeManager,this._journeyManager=e.get(g.JourneyManager),this._features=e.get(FxImpl.Features);const i={portal:o,lifetime:this._ltm,baseRouter:{goToLandingPage:e=>this.goToLandingPage(e),tryCleanupJourney:()=>this._tryCleanupJourney(),ensureRouteInView:e=>this.ensureRouteInView(e),updateTitle:()=>this._updateTitle(),updateNavHistory:e=>this._updateNavHistory(e),navigateWithRoute:(e,t,s)=>this.navigateWithRoute(e,t,s)}},c=function(e,s){const o=e.get(d.AssetTypeService),i=e.get(g.JourneyManager),c=s.portal,p=s.baseRouter,m={["MyAccessBlade".toLowerCase()]:"MyAccess.ReactView",["RPStatusBlade".toLowerCase()]:"RPStatus.ReactView"};function h(e,t){const s=(e||"").split("/"),o=s.length;if(o<2)return null;if(!s[1])return null;let i,n=0;t?"~"===s[2]&&(n=2,i=decodeURI(s[3])):(n=o%2,1===n&&(i=decodeURI(s[2])));const a=(0,r.parseBladeInputs)(s.slice(2+n),e,{parseJSON:!0,v2DeepLink:t});return{extension:s[0],detailBlade:s[1],detailBladeInputs:a,defaultMenuItemId:i}}const f=(e,s,o)=>{const i=new l.Uri(e),n=h(i.getHashParts().rest,"view"===i.getHashParts().category),r=(0,t.getReactBrowseRedirectBlade)({bladeName:n.detailBlade,resourceType:o,variantAssignments:s}),a=i.getHashParts().rest.split("/").slice(2).join("/");return`#${i.getHashParts().category}/HubsExtension/${r}/${a}`};return{navigateTo:(s,g)=>{const x="view"===s.getHashParts().category,b=s.getHashParts().rest;let y=g&&g.route||h(b,x);y.openedByContext=g&&g.openedByContext,c.settingsFlyoutState(0);let v=Promise.resolve(),M=Promise.resolve();const P=e.get(C.Experimentation).shellAssignments.whenAvailable();if(y.extension&&y.extension.toLowerCase()==="HubsExtension".toLowerCase()){const _=(y.detailBlade||"").toLowerCase(),F=e.get(FxImpl.Features);if("contactinfoblade"===_&&F.isEnabled("contactinfo"))return void c.settingsFlyoutState(6);if("settingsblade"===_)return I.Telemetry.trace({source:"Base.Router",action:"SettingsFlyoutRedirect"}),a.pushState({data:{},url:(0,r.getCurrentUri)().setHash("#menu/settings").href}),c.customEvents.trigger("fxdeeplinkchanged"),p.navigateWithRoute("menu",new l.Uri("#menu/settings"),{});function T(e){return M=P.then((t=>{if(!t)return;const o=f(s.hash,t,e),i=s.hash!==o;if(I.Telemetry.trace({source:"Base.Router",action:"BrowseResourceReactRedirect",actionModifier:i?"Redirected":"NotRedirected",data:{originalUri:s.hash,newUri:o,resourceType:e,reactRedirectApplied:i}}),i){const e=h((s=new l.Uri(o)).getHashParts().rest,"view"===s.getHashParts().category);y=e}}))}const D=(t,i)=>{v=MsPortalFx.tryImmediateResolve(o.assetTypesComplete,(()=>{let n,r="";if(t===w.Constants.ResourceTypes.AllResources?r=d.lowerCaseAllResourcesId:(n=o.getAssetTypeByResourceType(t),n&&(r=n.id.toLowerCase())),r)return(0,d.getBrowseBladeUri)(e,r,s.hash,n,i).then((e=>{if(s.hash!==e){const t=h((s=new l.Uri(e)).getHashParts().rest,"view"===s.getHashParts().category);y=t}}))}))},E=["resources","browseresource","browseresourceblade","browse.reactview","browseresource.reactview"],B=y.detailBladeInputs||{},A=B.resourceType||"",N=B.kind||"",R=E.includes(_);"browseallresourcesblade"===_?D(w.Constants.ResourceTypes.AllResources):"browseresourceblade"===_?D(A,N):"browseresourcegroupblade"===_?D(w.Constants.ResourceTypes.ResourceGroups):Object.keys(m).includes(_)&&(y.detailBlade=m[_]),R&&T(A)}const S=i.activeJourney();return v.then((()=>M)).then((()=>Promise.resolve().then((()=>S&&S.getDeepLink()||Promise.resolve(""))).catch((()=>"")).then((t=>{if(s.hash!==t)return e.get(u.CreateJourneyForBladeFunc).invoke(y).then(MsPortalFx.identity,(t=>{throw k(e,n.Shell.deepLinkErrorLoading.format(b)),t}))})).then((()=>{P.then((e=>{if(e.getBooleanValue("browseroute")){const{isBrowseBlade:e,newRouteUrl:s}=(0,t.convertToBrowseRouteUrlOnValidBrowseBlade)({extension:y.extension,detailBlade:y.detailBlade,detailBladeInputs:y.detailBladeInputs,v2DeepLink:x});e&&s&&a.replaceState({data:{},url:s})}}))}))))}}}(e,i);this._routeConfigMapping={allservices:R(e,i),asset:U(e,i),blade:c,view:c,cloudshell:this._features.isEnabled("azureconsole")?O(e,i):void 0,create:z(e,i),dashboard:A(e,i),menu:H(e,i),home:this._features.isEnabled("azurehome")?N(e,i):void 0,resource:W(e,i),settings:L(e,i),browse:j(e,i)},MsPortalFx.ViewModels.navigateToDashboardEndPoint.register(s,null,(([e,t])=>{this.navigateWithRoute("dashboard",null,{interactionSource:e,dashboardId:t})}))}navigateWithRoute(e,t,s){const o=this._routeConfigMapping[e];return o?o.navigateTo(t,s):Promise.reject("Invalid route type")}_getRouteConfig(e){const t=e.getHashParts().category;return this._routeConfigMapping[t]}ensureRouteInView(e){this._portal.settingsFlyoutState(0),this._portal.displayMode.value!==e&&this._portal.displayMode(e)}route(e,t){return this._route(new l.Uri(e),{openedByContext:t})}_route(e,t={}){const s=MsPortalFx.extend(t.openedByContext||{},{deepLink:e.hash});return MsPortalFx.tryImmediateResolve(Promise.resolve(),(()=>{if(this._features.isEnabled("azureconsole")&&this._routeConfigMapping.cloudshell.onNavAway(),"Dashboard"===this._portal.displayMode.value){const e=this._portal.getStartBoardWidget();if(this._portal.inOrganizeMode()||e.options.dashboardChanged.value){if(!this._diContainer.get(f.Browser).confirm(n.Desktop.confirmEditScopeDiscard))return;this._portal.topBar.finishDashboardEdit(3)}}e.isHashEmpty()&&(e.setHash((0,x.isLandingPageDashboard)(this._diContainer)?"dashboard":"home"),a.replaceState({data:{},url:e.href}),e=(0,r.getCurrentUri)());const o=this._getRouteConfig(e);return o?o.navigateTo(e,{skipFocus:t.skipFocus,openedByContext:s,invokedByInitRoute:t.invokedByInitRoute}):Promise.reject(FxImpl.createError("{0} is not a valid deep link".format(e.hashWithHashQueryString)))})).then((()=>this._portal.customEvents.trigger("fxdeeplinkchanged"))).finally((()=>{this._features.isEnabled("clarity")&&S.clarity&&S.clarity("identify","azureportal",MsPortalFx.sessionId,e.hash)}))}initialRoute(e,t){const s=(0,r.getCurrentUri)();let o;return o=this._getRouteConfig(s)?this._route(s,t).catch(e):e(),this.startListening(),o.catch((e=>(_.warning(e,1,"Unable to load initial route."),this.goToLandingPage(t))))}startListening(){let e=this._isListening;e&&e.dispose(),e=this._isListening=this._ltm.createChildLifetime(),this._portal.customEvents.addHandler(e,"fxjourneychanged",((e,t)=>{(t=t||{openedAsHome:!1}).wasCtxPaneRoot||this._updateNavHistory({addToHistory:!0,openedAsHome:t.openedAsHome})})),this._portal.customEvents.addHandler(e,"fxbladerebound",(()=>{this._updateNavHistory()})),e.registerForDispose([$(window).setEvents(["hashchange",()=>{const e=(0,r.getCurrentUri)(),t=(0,r.getCurrentUri)();this._route(t,{skipFocus:!1}).catch((s=>{this._updateNavHistory(),I.Telemetry.trace({source:"Base.Router",action:"UriHashChange",data:{originalUri:e,replacedUri:t,reason:s}})}))}])])}stopListening(){const e=this._isListening;e&&e.dispose(),this._isListening=null}dispose(){this.stopListening(),this._ltm.dispose(),window.location.hash=""}goToLandingPage(e){const t=(0,x.isLandingPageDashboard)(this._diContainer);I.Telemetry.trace({source:e.interactionSource||"Base.Router",action:"LandingPageNavigation"});const s=(0,r.getCurrentUri)().setHash(t?"dashboard":"home");return(e.replaceHistory?a.replaceState:a.pushState)({data:{},url:s.href}),this.navigateWithRoute(t?"dashboard":"home",null,e)}_tryCleanupJourney(){if(this._journeyManager.tryDeactivateJourney()){if(!this._getActiveJourneyId()){const e=this._portal.getJourneyWidget();e&&e.close()}return!0}return!1}_updateTitle(){const e=this._journeyManager.activeJourney();this._titleLifetime&&this._titleLifetime.dispose(),this._titleLifetime=null;const t=e=>n.Portal.windowTitleFormat.format(e,S.fx.environment.branding.title);if(0!==this._portal.settingsFlyoutState.value)S.document.title=t(n.TopBar.settings);else if(e&&e.children.length>0){this._titleLifetime=this._ltm.createChildLifetime();const s=e.children[e.children.length-1].containerWidget,o=s&&s.options;o&&o.crumb.subscribeAndRun(this._titleLifetime,(e=>{MsPortalFx.isNullOrUndefined(e)||(S.document.title=t(e))}))}else new Promise((e=>{switch(this._portal.getDisplayMode()){case"Home":e(t(n.AzureHome.home));break;case"Dashboard":MsPortalFx.require("MsPortalImpl/UI/UI.DesktopManagerImpl").then((({DesktopManagerImpl:s})=>{const o=this._diContainer.get(s).startBoard,i=o&&o.getDashboard()||{};i.title?e(t(i.title)):e(F)}));break;default:e(t(n.SideBar.allServices))}})).then((e=>S.document.title=e))}_getActiveJourneyId(){const e=this._journeyManager.activeJourney();return!e||e.isStartedWithContextBlade()?"":e.id}_updateNavHistory(e){const t=e&&e.addToHistory?a.pushState:a.replaceState,s=e&&e.skipFocus,o=this._journeyManager.activeJourney();let i=!0;if(!o){let e;switch(this._portal.getRootPageDisplayType()){case"Dashboard":e="dashboard";break;case"Home":e="home";break;default:e="allservices"}const o=(0,r.getCurrentUri)(),i=o.getHashParts().category;return MsPortalFx.localeCompareIgnoreCase(i,"dashboard")&&MsPortalFx.localeCompareIgnoreCase(i,"home")&&MsPortalFx.localeCompareIgnoreCase(i,"allservices")&&t({data:null,url:o.setHash(e).href}),this._route((0,r.getCurrentUri)(),{skipFocus:s})}return MsPortalFx.tryImmediateResolve(o.getDeepLink(),(s=>{if(!this._getActiveJourneyId())return;const n=o.children,a=n[n.length-1],l=a&&a.bladeDefinition;if(l&&(l.menuBlade||l.tabMenuBlade))return void(i=!1);const c=(0,r.getCurrentUri)();e&&e.openedAsHome?c.setHash("#home"):c.setHash(s),c.href.toLowerCase()!==location.href.toLowerCase()&&(t({data:{},url:c.href}),this._portal.customEvents.trigger("fxdeeplinkchanged"))}),(e=>{_.warning(new MsPortalFx.Errors.Error({message:"Failed to update address bar.",data:{id:this._getActiveJourneyId(),key:o.templateKey},innerErrors:e}))})).finally((()=>{i&&this._updateTitle()}))}}}(D||(t.Internal=D={}));function O(e,t){function s(){return e.getAsync(i.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole"))}let o=!1;return{navigateTo:()=>(o=!0,s().then((e=>e.showFullscreen()))),onNavAway:()=>o?s().then((e=>e.minimizeIfOpen())):Promise.resolve()}}function z(e,t){const s=(0,M.memoizePromise)((()=>MsPortalFx.require("MsPortalImpl/Base/Base.Selectable2.Provisioning"))),o=t.baseRouter;return{navigateTo:(t,i)=>{const a=t&&t.getHashParts().rest,c=(a||"").split("/");if(!c.length)return k(e,n.Shell.deepLinkInvalid.format(a)),Promise.reject(FxImpl.createError(`Deep link ${a} should be #{routeTypes.create}/{package-id}.`));I.Telemetry.trace({source:"Gallery",action:"DeepLinkVisited",name:a});const d=c.shift(),p=(0,r.parseBladeInputs)(c,a);if("hub"!==d)return s().then((s=>s.getDynamicCreateBladeReference(e,{galleryItemId:d,inputs:p}).then((e=>(e.defaultMenuItemId=c[2],i.route=e,o.navigateWithRoute("blade",t,i))))));{const e="{0}/{1}/package/{2}/additionalConfig/{3}/selectedMenuItemId/undefined/createLanding/undefined".format(MsPortalFx.Base.Constants.ExtensionNames.Marketplace,MsPortalFx.Base.Constants.BladeNames.Hubs.CreateHubBlade,encodeURIComponent(d),encodeURIComponent(JSON.stringify(p)));return o.navigateWithRoute("blade",new l.Uri("#blade/"+e),i)}}}}function H(e,t){const s=/^[\w-]+$/,o=t.portal,i=t.baseRouter,n=e=>{const t=new l.Uri(e.toString());return t.setHash("#settings"),i.navigateWithRoute("settings",t,{})};return{navigateTo:t=>{const r=t.getHashParts().rest;s.test(r)||T.linkFormat(r);const a=r.toLowerCase();if("directory"===a&&B(e.get(FxImpl.Features)))return n(t);if("subscriptions"===a)return n(t);const l="fxs-menu-"+a;let c=o.getRootElement().find(`.${l}`);c.length>1&&(c=b.filterVisible(o.getRootElement()[0],"."+l)),1!==c.length&&T.invalidLink(r),i.updateNavHistory({skipFocus:!0}),c[0].click()}}}function U(e,t){const o=e.get(c.ManifestCache);return{navigateTo:(t,i)=>{const r=t.getHashParts().rest,a=/([^/]+)\/([^/]+)\/(.+)/.exec(r);if(!a||a.length<4)return k(e,n.Shell.deepLinkInvalid.format(r)),Promise.reject(FxImpl.createError(`'${r}' is invalid. Correct format is #asset/{ExtensionName}/{AssetType}/{AssetId}`));const l=decodeURI(a[1]);let c=decodeURI(a[2]),d=decodeURI(a[3]);const p="string"==typeof d&&s.ArmId.parse("/"+d,!0);return p&&0!==p.kind&&(d="/"+d),MsPortalFx.tryImmediateResolve(o.getManifestAsync(l,"assetTypes"),(t=>{const s=c.toLowerCase(),o=MsPortalFx.find(t.assetTypes,(e=>e.name.toLowerCase()===s));return o||(k(e,n.Shell.deepLinkNotFound.format(c)),T.unfoundAsset(c)),c=o.name,I.Telemetry.trace({source:"Asset",action:"DeepLinkVisited",name:l,data:c}),e.get(u.CreateJourneyForAssetFunc).invoke(E(l,c,d,{},null,i))}),(t=>{throw k(e,n.Shell.deepLinkNotFound.format(l)),t}))}}}function W(e,t){const o=e.get(d.AssetTypeService);return{navigateTo:(t,i)=>{let r=t.getHashParts().rest;r="/"+r.replace(/^\//,""),r=decodeURI(r);const a=r.split("/");let l=null;return a.length%2==0&&(l=a[a.length-1],r=r.slice(0,r.length-l.length-1)),MsPortalFx.tryImmediateResolve(Q(),(()=>MsPortalFx.tryImmediateResolve(o.assetTypesComplete,(()=>{const t=o.getAssetTypeByResourceType(s.ArmId.parse(r,!0).resourceType)||o.getAssetTypeByResourceTypeWithFallback(s.ArmId.parse(r).resourceType),a=t.assetTypeManifest,c=a.name,d=t.extension,p=a.resourceType.resourceTypeName;return c||(k(e,n.Shell.deepLinkNotFound.format(p)),T.noResourceAsset(p)),I.Telemetry.trace({source:"Resource",action:"DeepLinkVisited",name:d,data:p||MsPortalFx.Base.Constants.AssetNames.NonAssetResource}),e.get(u.CreateJourneyForAssetFunc).invoke(E(d,c,r,{},l,i))}))),(t=>{throw k(e,n.Shell.deepLinkErrorLoading.format(r)),t}))}}}t.convertToBrowseRouteUrlOnValidBrowseBlade=e=>{let t="";const s=e.extension,o=e.detailBlade,i=e.detailBladeInputs||{},n=e.v2DeepLink,a=i.resourceType||"",l={browseallresourcesblade:"all","browseall.reactview":"all",browseall:"all",browseresourcegroupblade:"resourcegroups",browseresourcegroups:"resourcegroups",resources:a,browseresourceblade:a,browseresources:a,browseresource:a,"browse.reactview":a,"browsefavoriteresources.reactview":"favorites","browserecentresources.reactview":"recents"},c=s?.toLowerCase()==="HubsExtension".toLowerCase()&&o?.toLowerCase()in l;if(!c)return{isBrowseBlade:!1,newRouteUrl:t};let d=l[o.toLowerCase()]||"";switch(d){case P.lowerCaseAllResourcesType:d="all";break;case P.lowerCaseResourceGroupsType:d="resourcegroups";break;case P.lowerCaseResourcesWithTagType:d="resourceswithtag"}t=d?.length>0?`#browse/${encodeURIComponent(d)}`:"#browse",a&&delete i.resourceType;const{serializedInputs:p}=(0,r.serializeBladeInputs)(i,n);return t+=p,{isBrowseBlade:c,newRouteUrl:t}};const V=(e,t)=>{if(!e)return[];const s=e=>t+(e>0?e:"");let o=0,i=e.getStringValue(s(o))||"";const n=[];for(;i.length;)n.push(...i.split(",").map((e=>e.trim()))),i=e.getStringValue(s(++o))||"";return n};function j(e,t){const o=t.baseRouter;return{navigateTo:(t,i)=>e.get(C.Experimentation).shellAssignments.whenAvailable().then((async e=>{if(!e.getBooleanValue("browseroute")){const e="Browse Route experiment unavailable";return T.invalidLink(e),Promise.reject(FxImpl.createError(e))}{const e=t.getHashParts().rest.split("/");if(e?.length){const n=e.shift().toLowerCase(),c=e.join("/");let d="",p="";switch(n){case"all":case"resourceswithtag":d=P.lowerCaseAllResourcesType;break;case"resourcegroups":d=P.lowerCaseResourceGroupsType;break;case"recents":p="BrowseRecentResources.ReactView";break;case"favorites":p="BrowseFavoriteResources.ReactView";break;default:d=decodeURIComponent(n)}const u=(0,r.parseBladeInputs)(e,c,{parseJSON:!0,v2DeepLink:!0}),m=u.view,h=u.kind,g=u.filter,f=await(0,s.getBrowseBladeReference)({resourceType:d,kind:h});let x="";if(f||p){let e;if(""!==p)e={detailBlade:p,extension:"HubsExtension",detailBladeInputs:null,defaultMenuItemId:null},x=`#view/HubsExtension/${p}`;else{const t="resourceswithtag"===n?P.lowerCaseResourcesWithTagType:"",s={...f.parameters};m&&(s.view=m),g&&(s.filter=g),t&&(s.resourceType=t),e={detailBlade:f.blade,extension:f.extension,detailBladeInputs:s,defaultMenuItemId:null};const{serializedInputs:o}=(0,r.serializeBladeInputs)(s,!0);x=`#view/${f.extension}/${f.blade}`+o}o.navigateWithRoute("view",new l.Uri(x),{openedByContext:i.openedByContext,route:e}).then((()=>{"browse"!==(0,r.getCurrentUri)().getHashParts().category&&(0,r.getCurrentUri)().hash!==t.hash&&a.replaceState({data:{},url:t.hash})}))}else x=`#view/HubsExtension/BrowseResource/resourceType/${n}`,o.navigateWithRoute("view",new l.Uri(x),{openedByContext:i.openedByContext}).then((()=>{a.replaceState({data:{},url:t.hash})}))}o.updateTitle()}}))}}t.getReactBrowseRedirectBlade=e=>{const{bladeName:t,resourceType:s,inMenu:o,variantAssignments:i}=e;if(o||!i||!s)return t;if(s===w.Constants.ResourceTypes.AllResources&&i.getBooleanValue("RedirectBlade-HubsExtension-BrowseAll"))return"BrowseAll.ReactView";if(s===w.Constants.ResourceTypes.ResourceGroups&&i.getBooleanValue("RedirectBlade-HubsExtension-BrowseResourceGroups"))return"BrowseResourceGroups.ReactView";const n=V(i,"ReactBrowseOptInResourceProviders").flatMap((e=>e.toLowerCase())),r=V(i,"ReactBrowseOptOutResourceTypes").flatMap((e=>e.toLowerCase())),a=s.toLowerCase(),l=a.split("/")[0];return n.includes(l)&&!r.includes(a)?"Browse.ReactView":t};class q{static create(e,t){return new D.RouterImpl(e,t,(0,y.getPortalViewModel)(e))}}t.Router=q,__decorate([__metadata("fx:diagnostics",[e,"Router"]),o.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.Container,FxImpl.Rpc.Client]),__metadata("design:returntype",q)],q,"create",null)})),
define("MsPortalImpl/Base/Base.Selectable2.Common",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenBladeTaskArgs=t.OpenBladeConfig=t.OpenBladeResources=void 0;let o=class{};t.OpenBladeResources=o,t.OpenBladeResources=o=__decorate([__metadata("fx:diagnostics",[e,"OpenBladeResources"]),s.Class("pipeline")],o);let i=class{};t.OpenBladeConfig=i,t.OpenBladeConfig=i=__decorate([__metadata("fx:diagnostics",[e,"OpenBladeConfig"]),s.Class("pipeline")],i);let n=class{};t.OpenBladeTaskArgs=n,t.OpenBladeTaskArgs=n=__decorate([__metadata("fx:diagnostics",[e,"OpenBladeTaskArgs"]),s.Class("pipeline")],n)})),
define("MsPortalImpl/Base/Base.Selectable2",["require","exports","Fx/Composition/Selectable","MsPortalImpl/Base/Base.Events","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Selectable2.Common","MsPortalImpl/Base/Base.Pipeline","MsPortalImpl/UI/UI.BladeOpener"],(function(e,t,s,o,i,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOrCreateOpenBladeSelectable=t.getOrCreateCachedFxElement=t.getFxClickSelectable=t.isProvisioningBladeReference=t.findExtensionViewModel=t.setSelectableContext=t.getOrCreate=t.createListSelectable=void 0;var c=MsPortalFx.Base.ProxiedObservables,d=FxImpl.shellInterface;let p=1;const u=a.createDescriptor(r.OpenBladeConfig,r.OpenBladeResources,r.OpenBladeTaskArgs);u.registerAsync("MsPortalImpl/Base/Base.Selectable2.Pipeline","OpenBladeRequestHandler",(()=>!0)),u.registerAsync("MsPortalImpl/Base/Base.Selectable2.SupplyBladeReference","SupplyBladeReferenceHandler",((e,t,s)=>!s.bladeRequest)),u.registerAsync("MsPortalImpl/Base/Base.Selectable2.PPV3","ParameterProviderV3SelectableHandler",((e,t,s)=>function(e){const t=d(e);return t&&20560===t.type}(s.bladeRequest.bladeReference)),2),u.registerAsync("MsPortalImpl/Base/Base.Selectable2.Provisioning","OpenBladeHandler",((e,t,s)=>x(s.bladeRequest.bladeReference)),2);class m extends FxImpl.TriggerableLifetimeManager{isClickable(){return!0}constructor(e,t){super(),this.id=p++,this.isCanceled=!1,this.callbacks=ko.observableArray();const s=ko.observable(),o=FxImpl.shellInterface(t),i=ko.observable(!1),n={selectable:this,selectedValue:s,extensionVm:o,callbacks:this.callbacks},r=u.createPipeline(e,this,{},n);let a,l,c,d=0;this.setLifetimeReference=(e,t)=>{e===(d&e)&&(d|=e,t.registerForDispose({dispose:()=>{d^=e,d||this.dispose()}}))},this.value=ko.computed(this,{read:()=>{const e=i()?s():void 0;return void 0!==e?(c&&c!==l&&(c=l),l=a):l&&(c=l,l=void 0),e},write:e=>{void 0===e&&(i(!1),s(void 0))}}),this.processRequest=e=>{let t;if(a=e,e){if(3!==e.reason&&4!==e.reason||i(!0),4===e.reason)return void m(e.operationId,!!(2&e.flags),e.initialWidth);if(3===e.reason){let s;t=new Promise((e=>s=e)),r.startTask({bladeRequest:e,notifyBladeOpenCompleted:t=>s({operationId:e.operationId,success:t})})}}return t};const m=(e,t,o)=>{const n=this.createChildLifetime(),r=setTimeout((function(){let i=16;i|=t?8:0,s({operationId:e||MsPortalFx.getUniqueId(),flags:i,initialWidth:o})}),500),a=()=>{n.dispose()};s.subscribe(n,a),i.subscribe(n,a),n.registerForDispose((()=>{clearTimeout(r)}))};this.isSelected=ko.computed(this,{read:()=>i(),write:e=>{if(i()!==e)if(i(e),!0===e){const e=MsPortalFx.getUniqueId();m(e),this.isCanceled=!1,r.startTask({operationId:e,notifyBladeOpenCompleted:e=>{e||(this.isCanceled=!0)}})}else s(void 0)}}),this.onClick=()=>{this.isSelected(!0)},this.invokeClickCallback=(e,s,o,i,n,r,a,l)=>{s.invokeClickHandler(e,o,i,t,n,r,a,l)};const h=e=>e?{item:e.selectedItem,metadata:e.controlMetadata}:void 0;this.activationState=ko.computed(this,(()=>{this.value();return{previous:h(c),current:h(l)}})),this.refresh=()=>{const e=MsPortalFx.getUniqueId();m(e),r.startTask({operationId:e,notifyBladeOpenCompleted:MsPortalFx.noop})}}}function h(e,t){const s="Selectable";let o=c.disposableData(t,s);if(!o){o=function(e){const t=new FxImpl.TriggerableLifetimeManager;return e.setLifetimeReference(1,t),{selectable:e,dispose:()=>{t.dispose()}}}(new m(e,t)),c.disposableData(t,s,o)}return o.selectable}t.createListSelectable=function(e,t){return h(e,t)},t.getOrCreate=h;const g="data-fxselectable";function f(e){const t=(e=$(e[0].closest(`[${g}]`))).attr(g);return n.rotFind(t)}function x(e){const t=d(e);return t&&19792===t.type}function b(e,t,o,i){if(!o)return;const n=FxImpl.shellInterface(o.container),r=n.selectables();let a=r[t];const l=!a;if(l){const e=$.extend(!1,r);a=e[t]=new s.Selectable2({supplyBladeReference:MsPortalFx.noop}),n.selectables(e)}const c=h(e,a);return l&&i&&i(c),c}t.setSelectableContext=function(e,t,s){const o=n.rotAdd(e,t);s.attr(g,o),e.registerForDispose((()=>{s.removeAttr(g)}))},t.findExtensionViewModel=f,t.isProvisioningBladeReference=x,t.getFxClickSelectable=function(e,t,s,n,r){const a=n+"idmap",c=f(s);let d=MsPortalFx.Base.ProxiedObservables.data(c,a);d||(d=c?MsPortalFx.Base.ProxiedObservables.data(c,a,{}):{});const p=r;d[p]||(d[p]=ko.observable(),t.registerForDispose((()=>delete d[p])));const u=d[p],m=b(e,n,c,(e=>{const o=s.closest(".fxs-tile").data(i.CompositionInstanceDataName)||t.createChildLifetime(),n=e;ko.reactor(o,(()=>{const t=n.activationState();if(t){const s=t.previous&&t.previous.item,o=t.current&&t.current.item;s&&d[s]&&d[s](void 0),o&&d[o]&&d[o](e.value())}}))}));return{activated:u,invokeClick:(e,t,i)=>{if(m){const n=i?.target||s[0];m.invokeClickCallback(2,c,e,t,(0,o.getOrCreateFxElement)(n,c.internal.elements),p)}else t(null)},openBlade:m?async(t,s)=>{e.get(l.BladeOpener).openBlade(t,{selectable:m,telemetryName:s})}:(e,t)=>{},openContextPane:m?async(t,s)=>{e.get(l.BladeOpener).openBlade(t,{selectable:m,flags:1,telemetryName:s})}:(e,t)=>{}}},t.getOrCreateCachedFxElement=function(e){if(e){const t=$(e),s=f(t),i=s?.internal?.elements||ko.observableArray();return(0,o.getOrCreateFxElement)(t[0],i)}return null},t.getOrCreateOpenBladeSelectable=b})),
define("MsPortalImpl/Base/Base.Selectable2.ClickContext",["require","exports"],(function(e,t){"use strict";function s(){return MsPortalFx.require("../UI/Compositions/UI.Composition.Selectable2Registrar",e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectableWithClickHandler=t.getListSelectableWithClickHandler=void 0,t.getListSelectableWithClickHandler=function(e,t,o,i){const n=ko.observable();return{onClick:r=>{n()?n().onClick(r):s().then((s=>{n()||n(s.getListSelectableWithClickHandler(e,t,o,i)),n().onClick(r)}))},activationState:ko.pureComputed((()=>n()?n().activationState():{previous:void 0,current:void 0}))}},t.getSelectableWithClickHandler=function(e,t,o,i){const n=new FxImpl.TriggerableLifetimeManager,r=ko.observable();let a,l;function c(){s().then((s=>{if(!r()){const a=s.getSelectableWithClickHandler(e,ko.unwrap(t),o,i);a&&(a.registerForDispose(n),r(a))}r()&&(a&&(a=!1,r().onClick()),l&&(l=!1,r().isSelected(!0)))}))}return ko.isObservable(t)&&t.subscribe(n,(()=>{r(void 0)})),{isSelected:ko.computed(n,{read:()=>r()?r().isSelected():l,write:e=>{r()&&r().isSelected(e),e&&!l&&(l=!0,c())}}),isClickable:ko.pureComputed((()=>!!r()&&r().isClickable())),value:ko.pureComputed((()=>r()?r().value():void 0)),onClick:function(){r()?r().onClick():a||(a=!0,c())}}}})),
define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","MsPortalImpl/Services/Services.Storage"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAvatarImage=void 0;var o=MsPortalFx.Base,i=o.Diagnostics,n=o.Net2;const r=i.createLog(e);t.getAvatarImage=function(e,t,o,i,a){if(MsPortalFx.isFeatureEnabled("disableaadgraphendpoint"))return Promise.resolve(o);let l=o;if(t){const c=s.ComponentName.Avatar,d=0;if(l=!a&&i.getValue(c,e,d),!l)return n.ajax({uri:t,type:"GET",dataType:"binary",responseType:"arraybuffer",isBackgroundTask:!0,setAuthorizationHeader:{resourceName:"graph"}}).then((e=>function(e){const t=Promise.withResolvers(),s=new FileReader,o="data:image/jpeg;base64,";return s.onload=e=>{let s=e.target.result,i="";const n=new Uint8Array(s);for(let e=0;e<n.byteLength;e++)i+=String.fromCharCode(n[e]);try{atob(i),s=o+i}catch(e){if(5!==e.code)return void t.reject(e);s=o+btoa(i)}t.resolve(s)},s.onerror=e=>t.reject(FxImpl.createError("Error reading thumbnail photo. Error:"+s.error)),s.readAsArrayBuffer(e),t.promise}(e)),(e=>{const t=e.jqXHR&&e.jqXHR.status;return 404!==t&&403!==t&&r.warning(`Failed to get user's profile image. Status code: ${t}. Error: \n${e}`),o})).then((t=>(i.setValue(c,e,t,d),t)))}return Promise.resolve(l)}})),
define("MsPortalImpl/Base/JQueryExtensions",["require","exports","MsPortalImpl/Base/JQueryHelper"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.focusableSelector=void 0;var o=s.findByClassName;const i=window.document,n="msportalfx-skip-initial-focus",r=$.fn;function a(e){return function(o){return[t.focusableSelector].reduce(((t,i)=>t&&t.length?t:function(e,t,o){const i=MsPortalFx.find(e,(e=>{const t=$(e);return!t.hasClass(n)&&!t.hasClass("fxs-display-none")&&!MsPortalFx.startsWith(t.attr("tabindex"),"-")&&s.isVisible(t)&&(!o||o(t))}),t?-1:0);return i?$(i):$([])}(this.find(i).toArray(),e,o)),null)}}t.focusableSelector="a[href], select, button, input, textarea, [tabindex]:not([tabindex='-1'])",r.setEvents=function(...e){let t=this;const s=function(s){const o=function(){return t[s].apply(t,arguments)};e.forEach((e=>{const t=e[0],s=e[1];if("function"==typeof s)o(t,s);else{const i=e[2];i&&o(t,s,i)}}))};return s("on"),{dispose:function(){t&&(s("off"),t=null)}}},r.findByClassName=function(e){return o(this,e)},r.findFirstTabbable=a(),r.findLastTabbable=a(!0),r.isInScrollView=function(e){let t;const s=e?this.closest("."+e):t=this.scrollParent();if(!s.length||!s[0].offsetParent||!s.is(t||this.scrollParent())&&!this.isInScrollView())return!1;const o=s.offset().top,i=o+s.height(),n=this.offset().top,r=n+this.height();return n>=o&&n<=i&&(r<=i&&r>=o)},r.handleTransitionEndOnce=function(e,t,s){let o,i=!1;this.on("transitionend",o=(t,...n)=>{const r=t&&t.originalEvent;r&&r.propertyName!==e||i||(i=!0,this.off("transitionend",o),s.apply(this,[t].concat(n)))});const n=function(){const t=$.Event("transitionend",{originalEvent:{propertyName:e}});o(t)};return $.fx.off?n():setTimeout(n,t),this},$.enableAnimations=function(e){const t="fxs-transition-off-style-head-marker",s=$(FxImpl.createElement("style")).addClass(t).text("* {transition: none !important;animation-iteration-count: .5 !important;animation-duration: 0s !important;animation-delay: 0s !important;}"),i=$.querySelectorAll("head");$.fx.off=!e,e?o(i,t).remove():0===o(i,t).length&&i.append(s)},$.querySelectorAll=function(e){return $(i.querySelectorAll(e))}})),
define("MsPortalImpl/Base/Languages",["require","exports","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.GeneralSettings"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.currentLocaleContext=t.createLocaleContext=t.getCultureSpecificLanguage=t.getLocalizedName=t.localeDelimiter=t.redirectQueryKey=void 0;const i=window,n=MsPortalFx.forEachKey;t.redirectQueryKey="LocaleQuery",t.localeDelimiter=".";const r=s.ComponentName.Redirect;function a(e){const t=MsPortalFx.convertArrayToMap(e,(e=>e.locale.split("-")[0]));return n(FxImpl.knownCulturesMap,((e,s,o)=>{const i=e.split("-");i.length>1&&!s.neutralCulture&&t[i[0]]&&o.push(s)}),[])}function l(e){const t=e.displayLanguage,s=(o=e.selectableLanguages,i=FxImpl.knownCulturesMap,o.map((e=>i[e])).filter(MsPortalFx.identity));var o,i,n,r;return{selectableDisplayLanguages:s,selectedDisplayLanguage:t,selectedFormatCulture:(n=e.rawLocaleSetting,r=e.formatCulture,n?n.split(".")[1]:r),selectableFormatCultures:a(s)}}function c(e){const t=MsPortalImpl.sanitizeLanguage(e,i.fx.environment.supportedLanguages).split("."),s=t[0];return`${s}.${FxImpl.sanitizeFormatCulture(t[1],s)}`}t.getLocalizedName=function(e){const t=FxImpl.knownCulturesMap[e];return t?t.localizedName:null},t.getCultureSpecificLanguage=function(){const e=MsPortalFx.find(t.currentLocaleContext.selectableDisplayLanguages,(e=>!MsPortalFx.localeCompareIgnoreCase(e.locale,t.currentLocaleContext.selectedDisplayLanguage)));return e&&(e.specificCulture||e.locale)||"en-us"},t.createLocaleContext=l,t.initialize=function(e,n,a,d){const p={requireRedirect:!1,userSettingLocale:void 0,browserLocale:void 0,desiredLocale:void 0,localeFromQuery:void 0},u=n.get(s.StorageService),m=n.get(o.GeneralSettings).rawLocale;return m.subscribeAndRun(e,(e=>{const s=MsPortalImpl.getBrowserLanguage(),o=c(e||s),i=JSON.parse(u.getValue(r,t.redirectQueryKey,0)||"{}");i.l=o,u.setValue(r,"LastUsedLocale",o,0),d||o===c(a)||(p.requireRedirect=!0,p.userSettingLocale=e,p.browserLocale=s,p.desiredLocale=o,p.localeFromQuery=c(a)),u.setValue(r,t.redirectQueryKey,JSON.stringify(i),0)})),t.currentLocaleContext=l({selectableLanguages:i.fx.environment.supportedLanguages.filter((e=>"qps-ploc"!==e)),displayLanguage:FxImpl.Intl.displayLanguage,formatCulture:FxImpl.Intl.formatCulture,rawLocaleSetting:m()}),p}})),
define("MsPortalImpl/Controls/ControlBindings.Async",["require","exports","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Controls/ControlBindings"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.portalControlBindings=void 0;const o=[];function i(e,t,s,i){o.push({name:t,moduleId:e+s,initOptions:i})}function n(e,t,s){i("MsPortalImpl.Controls/",e,t,s)}function r(e,t,s){i("MsPortalImpl/Controls/",e,t,s)}const a={controlsDescendantBindings:!1};n("pcAccordion","Controls/Accordion"),n("pcButton","Controls/SimpleButton"),n("pcChart","Controls/Visualization/Chart"),n("pcCheckBoxField","Fields/CheckBoxField"),n("pcClipboardButton","Controls/ClipboardButton"),n("pcConsole","Controls/Console"),n("pcCopyableLabel","Controls/Forms/CopyableLabel"),n("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2"),n("pcCustomHtmlField","Fields/CustomHtmlField"),n("pcCustomValueSlider","Fields/CustomValueSliderField"),n("pcCustomRangeSlider","Fields/CustomRangeSlider"),n("pcDatePickerField","Fields/DatePickerField"),n("pcDateTimePickerField","Fields/DateTimePickerField"),n("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField"),n("pcDayPickerField","Fields/DayPickerField"),n("pcDiffEditor","Controls/Documents/DiffEditor"),n("pcDockedBalloon","Controls/DockedBalloon"),n("pcDonut","Controls/Visualization/Donut"),n("pcDropDownField","Fields/DropDownField"),n("pcDurationPickerField","Fields/DurationPickerField"),n("pcEditor","Controls/Documents/Editor"),n("pcFilterComboField","Fields/FilterComboField"),n("pcGraph","Controls/Visualization/Graph"),n("pcGrid","Controls/Lists/Grid1/Grid1"),n("pcEditableGrid","Controls/Lists/Grid2/Grid2.EditableGrid.ctl"),n("pcDataGrid","Controls/Lists/Grid2/Grid2.DataGrid.ctl"),n("pcDocsControl","Controls/DocsControl"),n("pcPagedDataGrid","Controls/Lists/Grid2/Grid2.PagedDataGrid.ctl"),n("pcSequentialDataGrid","Controls/Lists/Grid2/Grid2.SequentialDataGrid.ctl"),n("pcPager","Controls/Pager"),n("pcPager2","Controls/Pager2"),n("pcHeatMap","Controls/HeatMap"),n("pcIFrame","Controls/IFrame"),n("pcIFrame2","Controls/IFrameV2"),n("pcLegend","Controls/Visualization/Legend"),n("pcList2","Controls/Lists/List2/ListView"),n("pcObsoleteListView1","Controls/Lists/List1/ListView1"),n("pcLogStream","Controls/LogStream"),n("pcMap","Controls/Visualization/Map"),n("pcMenu","Controls/Lists/Menu"),n("pcMetrics","Controls/Visualization/Metrics"),n("pcMonitorChart","Controls/Visualization/MonitorChartV2/MonitorChartV2"),n("pcMonitorChartV2","Controls/Visualization/MonitorChartV2/MonitorChartV2"),n("pcMetricGrid","Controls/Visualization/MonitorChartV2/MetricGrid"),n("pcMultiLineTextField","Fields/MultiLineTextField"),n("pcNumericTextBoxField","Fields/NumericTextBoxField"),n("pcOAuthButtonField","Fields/OAuthButtonField"),n("pcOAuthButtonV2Field","Fields/OAuthButtonV2Field"),n("pcOptionsGroupField","Fields/OptionsGroupField"),n("pcPairedTimeline","Controls/Visualization/PairedTimeline"),n("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges"),n("pcPartPinner","Controls/PartPinner"),n("pcPasswordField","Fields/PasswordField"),n("pcPricingControl","Controls/PricingControl"),n("pcPreviewTag","Controls/PreviewTag"),n("pcProgressBar","Controls/Visualization/ProgressBar"),n("pcQuotaGauge","Controls/Visualization/QuotaGauge"),n("pcRangeSliderField","Fields/RangeSliderField"),n("pcSearchBox","Controls/SearchBox"),n("pcResourceFilter","Controls/ResourceFilter"),n("pcSection","Fields/Section"),n("pcSelectorField","Fields/SelectorField"),n("pcSimpleButton","Controls/SimpleButton"),n("pcSingleValueGauge","Controls/Visualization/SingleValueGauge"),n("pcSliderField","Fields/SliderField"),n("pcSplitter","Fields/Splitter",a),n("pcSplitter2","Fields/Splitter2"),n("pcSummary","Controls/Summary"),n("pcTextBlock","Controls/TextBlock"),n("pcTextBox","Fields/TextField"),n("pcTextField","Fields/TextField"),n("pcTimePickerField","Fields/TimePickerField"),n("pcToolbar","Controls/Toolbars/Toolbar"),n("pcTreeView","Controls/Lists/Tree1/TreeView"),n("pcTriStateCheckBox","Fields/TriStateCheckBox"),n("pcMarkdown","Controls/Markdown"),n("pcVideo","Controls/Video"),n("pcRecommendations","Controls/Recommendations/Recommendations"),r("pcAsyncFileUpload","Forms/AsyncFileUpload"),r("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation"),r("pcEssentials","Controls.Essentials"),r("pcFileDownloadButton","Controls.FileDownloadButton"),r("pcResourceDropDown","Forms/ResourceDropDown"),r("pcHeroBanner","Controls.HeroBanner"),r("pcHotSpot","Controls.HotSpot",a),r("pcInfoBox","Controls.InfoBox"),r("pcNotice","Controls.Notice"),r("pcPickerV3","Controls.PickerV3"),r("pcPill","Controls.Pill"),r("pcPillCollection","Controls.PillCollection"),r("pcPillList","Controls.PillList"),r("pcTagsByResource","Controls.TagsByResource"),r("pcIntuneAppFileUpload","Forms/IntuneAppFileUpload"),r("pcFileShareDropDown","Storage/FileShareDropDown"),r("pcArmErrorList","ArmErrorList/Controls.ArmErrorList"),r("pcStorageAccountDropDown","Storage/StorageAccountDropDown"),r("pcToggle","Controls.Toggle"),r("pcBlobContainerDropDown","Storage/BlobContainerDropDown"),r("pcGroupDropDownField","Forms/DropDown"),r("pcManagementGroupDropDown","Forms/HierarchicalDropDown"),r("pcOpenCesCvaSurvey","Controls.OpenCesCvaSurvey"),n("pcTabMenu","Controls/Lists/TabMenu"),t.portalControlBindings=o,t.initialize=function(){t.portalControlBindings.forEach((e=>{ko.bindingHandlers[e.name]=s.getAsyncBindingHandler(e.moduleId,e.initOptions)}))}})),
define("MsPortalImpl/InitShellWorker",["require","exports","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.AssetTypes","ShellWorker/ExtensionWorkerPrewarmer","ShellWorker/IFrameExtensionLoader","ShellWorker/AuthorizationState","ShellWorker/Browse","ShellWorker/Locations","ShellWorker/Subscriptions","ShellWorker/GlobalResourceFilters","ShellWorker/UserInfo","ShellWorker/AssetTypes","ShellWorker/FeatureCards","ShellWorker/PreloadData"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pushShellState=t.pushShellStateFromContainer=t.initWorker=t.initWorkerFromContainer=t.init=void 0;var M=MsPortalEarly.ExtensionLoader.getLoadType;const C="browse_columns",P="favorite_views";function w(e,t){const a=new MessageChannel;FxImpl.localRpcPort=a.port1;const l=a.port2;return Promise.all([e.getAsync(r.AuthStateManager),e.getAsync(i.ExtensionManagerOptions),e.getAsync(n.InitializedManifestCache),e.getAsync(o.ManifestCache),e.getAsync(FxImpl.Rpc.Client),e.getAsync(s.ExtensionManager)]).then((([e,s,o,i,n])=>{const r=e.getCurrentUser();I({extensions:s.extensionsAsMap,manifests:FxImpl.mapValues(s.extensionsAsMap,(e=>i.getManifest(e.name,"assetTypes"))),extensionRedirectMap:s.extensionRedirectMap,authState:MsPortalFx.extend2(e,{userObjectId:r.objectId,userTenantId:r.tenantId})},l,t),function(e,t,s){s?.registerForDispose((()=>{e=null})),t.onTokensUpdated((t=>{const{bootstrapState:s,tokenCache:o}=t,i=s?.oAuthToken;e&&u.pushShellAuthTokensEndPoint.invoke(e,"fxw",{portalToken:i&&{header:i.authHeader,expiresAt:i.expiresAt},extensionTokens:o})})),(()=>{const t=Object.create(null);p.loadExtensionInIFrameEndPoint.register(e,"fxw",(s=>{let o;const i=new Promise((e=>{o=t=>{e({telemetry:MsPortalFx.extend2(r.telemetry,{loadType:0}),error:t})}})),n=e.detachPort("fxw",s.portId),r=new MsPortalEarly.ExtensionLoader.IFrameLoadContext({...s,errorHandler:o,port:n});return r.initializeReceived.then((()=>{o()})),r.startLoad(),t[s.iframeId]=()=>{r.cleanup(),delete t[s.iframeId]},i})),p.disposeExtensionIFrameEndPoint.register(e,"fxw",(({iframeId:e})=>{const s=t[e];s?.()}))})(),(()=>{const t=Object.create(null);s?.registerForDispose((()=>{MsPortalFx.forEachKey(t,(e=>{t[e].terminate()}))}));const o=s?MsPortalEarly.ExtensionLoader.createPrewarmer():MsPortalEarly.ExtensionLoader.prewarmer;o.setListener({onCreated:({workerId:s,bootstrapPort:o,terminate:i})=>{let n;if(t[s]={terminate:()=>{n?.(),i()}},e){const t=e.acquireWindow("fxw",0,o);n=()=>{t.dispose()},d.pushNewWorkerEndPoint.invoke(e,"fxw",{workerId:s,portId:t.value})}},onBootComplete:(s,o)=>{e&&t[s]&&d.onWorkerBootCompleteEndPoint.invoke(e,"fxw",{workerId:s,error:o}),o&&delete t[s]}}),d.terminateWorkerEndPoint.register(e,"fxw",(({workerId:e})=>{const s=t[e];delete t[e],s?.terminate()})),d.onGetWorkerCalledEndPoint.register(e,"fxw",(()=>{o.onGetWorkerCalled()}))})()}(n,e,t)}))}function I(e,t,s){const o={onBootstrapError:e=>{MsPortalFx.Base.Diagnostics.Log.writeEntry2(2,"InitShellWorker",e.message||"unknown error from worker",9999,e.error&&[e.error,e])},uploadDiagnostics:e=>{const{telemetryEvent:t,logEntry:s,flush:o}=e;t&&MsPortalFx.Base.Diagnostics.Telemetry.trace(t),s&&MsPortalFx.Base.Diagnostics.Log.writeEntry2(s.level,s.area,s.message,s.code,s.args),1&o&&MsPortalFx.Base.Diagnostics.Telemetry.flush(),2&o&&MsPortalFx.Base.Diagnostics.Upload.flush()}};MsPortalEarly.ShellWorkerLoader.initWorker(function(e){const{extensions:t,manifests:s,extensionRedirectMap:o,authState:i}=e,{host:n,protocol:r,origin:a,pathname:l}=location,{bootstrapState:c,tokenCache:d,userObjectId:p,userTenantId:u}=i,m=(fx?.environment?.writesDisallowedTenants||[]).includes(u),h=c?.oAuthToken,g={portalToken:h&&{header:h.authHeader,expiresAt:h.expiresAt},extensionTokens:d||{},userObjectId:p,isWritesDisallowedTenant:m},f=fx.internalEnv,x=fx.environment;return{internalEnv:f,environment:MsPortalFx.extend2(x,{requireConfig:MsPortalFx.extend2(f.fxRequireConfig,{deps:[]})}),location:{host:n,protocol:r,origin:a,pathname:l},shellFeatures:FxImpl.features.shellFeatures,initOptions:{extensions:t,manifests:FxImpl.mapValues(s,(({pageVersion:e,prewarmerScript:t,weaveBladesMap:s,enableExperimentation:o})=>({pageVersion:e,prewarmerScript:t,weaveBladesMap:s,enableExperimentation:o}))),loadTypes:FxImpl.mapValues(s,(({flags:e},s)=>M(t[s],e))),extensionRedirectMap:o,authorizationState:g,effectiveLocale:FxImpl.Intl.effectiveLocale},userQuery:MsPortalEarly.userQuery}}(e),t,o,s)}function S(e,t){const s=e.getAsync(l.SubscriptionsUserContext),o=e.getAsync(l.ServicesSubscriptions);_(e.get(FxImpl.Rpc.Client),{locations:(0,a.lazyUserDataMemo)(e).then((({locations:e})=>e.value)),preloadedData:MsPortalEarly.preload,startupSubscriptionsInfo:o.then((e=>e.startupSubscriptionsInfoMemo())).then((({subscriptionsMap:e})=>({subscriptions:FxImpl.mapValues(e,(({subscription:e})=>e))}))),subscriptionsCount:s.then((e=>e.getAllSubscriptionsCount())),inSessionSelectedSubscriptions:s.then((e=>e.getInSessionSelectedSubscriptions())),userInfo:e.getAsync(r.AuthStateManager).then((e=>e.getUserInfo())),assetTypes:e.getAsync(c.AssetTypeService).then((e=>(0,c.assetTypesMemo)(e))),globalSelectedSubscriptions:s.then((e=>e.useAdvancedFiltersPromise)).then((e=>e?o.then((e=>e.globalSelectedSubscriptionsObservable)):void 0)),globalResourceFilter:(async()=>{const t=await s;if(await t.useAdvancedFiltersPromise)return MsPortalFx.require("MsPortalImpl/Services/Services.GlobalResourceFilters").then((t=>e.getAsync(t.ResourceFilterManager))).then((e=>e.currentFilterObservable))})(),featureCards:e.getAsync(c.AssetTypeService).then((e=>(0,c.featureCardsMemo)(e)))},t)}function _(e,t,s){s?.registerForDispose((()=>{e=null}));const{preloadedData:o}=t;if(o){const t=MsPortalFx.require("MsPortalImpl/Services/Services.Settings");o.then((async s=>{e&&v.pushPreloadDataEndPoint.invoke(e,"fxw",{variants:s?.variants});const o=s?.settings,{Internal:i,SettingStore:n}=await t,r=i.getSettingStoreName(15),a={15:o?.[r]?.[C],6:o?.[i.getSettingStoreName(6)]?.[C]},l=o?.[r]?.[P];e&&m.pushBrowseMetadataEndPoint.invoke(e,"fxw",{columns:a,favoriteViewIds:l,browseManifestsUri:MsPortalEarly.siteRelUriToAbsolute(MsPortalEarly.getCachedManifestUri("assetTypesBrowse"))})}))}t.locations?.then((t=>{const s=MsPortalFx.extendArrayIntoMap(Object.create(null),t,(e=>e.name),(e=>{const t=e.metadata||{};return{displayName:e.displayName,latitude:t.latitude,longitude:t.longitude}}));e&&h.pushLocationsEndPoint.invoke(e,"fxw",s)})),t.inSessionSelectedSubscriptions?.then((t=>{t.subscribeAndRun(new FxImpl.TriggerableLifetimeManager,(t=>{e&&t&&g.pushSelectedSubscriptionsEndpoint.invoke(e,"fxw",{inSession:t})}))})),t.globalSelectedSubscriptions?.then((t=>{t?.subscribe(new FxImpl.TriggerableLifetimeManager,(t=>{e&&g.pushGlobalFilterSubscriptionsEndpoint.invoke(e,"fxw",t)}))})),t.globalResourceFilter?.then((t=>{t?.subscribeAndRun(new FxImpl.TriggerableLifetimeManager,(t=>{e&&t&&f.pushActiveGlobalResourceFilterEndPoint.invoke(e,"fxw",t)}))})),t.startupSubscriptionsInfo?.then((t=>{e&&g.pushStartupSubscriptionsEndpoint.invoke(e,"fxw",t)})),t.subscriptionsCount?.then((t=>{e&&g.pushSubscriptionsCountEndpoint.invoke(e,"fxw",t)})),t.userInfo?.then((t=>{e&&x.pushUserInfoEndpoint.invoke(e,"fxw",t)})),t.assetTypes?.then((t=>{e&&b.pushAssetTypesEndPoint.invoke(e,"fxw",t)})),t.featureCards?.then((t=>{const s=Object.create(null);t.forEach(((e,t)=>s[t]=e)),e&&y.pushFeatureCardsEndPoint.invoke(e,"fxw",s)}))}t.init=function(e,t){w(e,t).then((()=>{S(e,t)}))},t.initWorkerFromContainer=w,t.initWorker=I,t.pushShellStateFromContainer=S,t.pushShellState=_})),
define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["module"],(function(e){"use strict";return{css:".fxs-keyboardshortcuts{width:355px;height:100%;max-width:100%}.fxs-keyboardshortcuts-scrollcontent{padding-top:10px;overflow:auto;height:100%}.fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts-shortcut{display:flex}.fxs-keyboardshortcuts-key{flex:0 0 auto;width:113px}",moduleId:e.id}})),
define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.DeepLink","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],(function(e,t,s,o,i,n,r,a,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fakeMacOS=t.setup=t.KeyboardShortcutHandler=void 0,(0,d.injectCss)(p);var u=MsPortalFx.Base.Diagnostics,m=u.Telemetry;const h=window,g="#blade/HubsExtension/BrowseAllResourcesBlade/resourceType/Microsoft.Resources%2Fresources",f="#blade/HubsExtension/BrowseResourceGroupBlade/resourceType/Microsoft.Resources%2Fsubscriptions%2FresourceGroups";let x=l.isMac;const b=o.KeyboardShortcuts,y=b.GoTo,v=u.createLog(e),M=m.trace,C=[49,50,51,52,53,54,55,56,57,48],P=[97,98,99,100,101,102,103,104,105,96];function w(e){const t=function(e){return"Journey"===e.getDisplayMode()&&e.getJourneyWidget()}(e);let s=t&&t.getFocusedBlade();return s=s||t&&MsPortalFx.last(t.getBlades()),s}let I=class{static create(e,t,s,o,i){return S(e,t,(()=>s.invoke()),(()=>o.invoke()),(()=>i.invoke()),null,h.fx.environment.chrome.hideShortcuts)}};function S(e,t,s,o,i,n,r){return new _(e,t,s,o,i,n,r)}t.KeyboardShortcutHandler=I,__decorate([__metadata("fx:diagnostics",[e,"KeyboardShortcutHandler"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.ViewModel,a.Router,n.DownloadDiagnosticsJson,n.ShowDebugTools,n.ShowTelemetryInsights]),__metadata("design:returntype",I)],I,"create",null),t.KeyboardShortcutHandler=I=__decorate([__metadata("fx:diagnostics",[e,"KeyboardShortcutHandler"]),s.Class()],I),t.setup=S,t.fakeMacOS=function(){x=!0};class _{constructor(e,t,s,o,i,n,r){this._keyShortcuts={},this._goToShortcuts={},this._eventHandlers=[],this._errorLoggingFunc=n||(e=>{v.error(e)}),this._registerShortcut(b.showDiagnostics,s,65,9),this._registerShortcut(b.showDebugHelper,o,68,9),MsPortalFx.isFeatureEnabled("telemetryinsights")&&this._registerShortcut(b.showTelemetryOverlay,i,84,9),r||(this._addKeyShortcuts(e),this._addGoToShortcuts(t,e),this._registerShortcut(b.moveFavoritesUp,(()=>{e.sideBar.reorderFavorites(38)}),38,5),this._registerShortcut(b.moveFavoritesDown,(()=>{e.sideBar.reorderFavorites(40)}),40,5)),this._attachEventHandlers()}dispose(){this._removeEventHandlers()}_attachEventHandlers(){this._removeEventHandlers();let e=!1;const t=this._eventHandlers;t.push({eventType:"keydown",handler:t=>{if(t.repeat)return;const s=i.getModifierKeys(t),o=t.keyCode;if(71===o&&0===s)return void(e=!0);const n=e?this._goToShortcuts[o]:this._keyShortcuts[o],r=n&&n[s];if(!r)return;const a=$(document.activeElement);a.length>0&&0===s&&(a.is("input")||a.is("textarea")||["azc-editableControl","fxc-editor","fxc-console"].some((e=>a.closest("."+e).length>0)))||(r.handler(),M({source:"KeyboardShortcuts",action:"KeyboardShortcutExecuted",name:r.id}),t.preventDefault())}},{eventType:"keyup",handler:t=>{71===t.keyCode&&(e=!1)}}),t.forEach((e=>{h.document.addEventListener(e.eventType,e.handler)}))}_removeEventHandlers(){this._eventHandlers.forEach((e=>{h.document.removeEventListener(e.eventType,e.handler)}))}_registerShortcut(e,t,s,o=0){const i=this._keyShortcuts[s];let n=o;x&&8&n&&e!==b.showDebugHelper&&(n=8^n|2);const r=this._generateIdForKeyboardShortcut(s,n),a={description:e,handler:t,id:r};i?i[n]&&this._errorLoggingFunc("Duplicate shortcut: "+r):this._keyShortcuts[s]=[],this._keyShortcuts[s][n]=a}_addKeyShortcuts(e){this._registerGotoShortcut(b.toggleFocusSideAndTopBar,(()=>{const e=$(document).find(".fxs-topbar-home")[0],t=$(document).find(".fxs-topbar-sidebar-collapse-button")[0];$(document.activeElement)[0]===e?$(t).is(":visible")?t.focus():$(document).find(".fxs-sidebar-collapse-button")[0].focus():e.focus()}),190),this._registerGotoShortcut(b.moveFocusToCommandBar,(()=>{const t=w(e),s=t&&t.getContentWidget();s&&s.setFocusOnCommandBar()}),188),this._registerShortcut(b.bladeSearch,(()=>{const t=w(e);t&&t.focusSearchBox()}),191,8),this._registerShortcut(b.bladeSearch,(()=>{const t=w(e);t&&t.focusSearchBox()}),55,12)}_registerGotoShortcut(e,t,s){const o=this._goToShortcuts[s],i=this._generateIdForKeyboardShortcut(s,0,!0),n={description:e,handler:t,id:i};o?o[0]&&this._errorLoggingFunc("Duplicate goto shortcut: "+i):this._goToShortcuts[s]=[],this._goToShortcuts[s][0]=n}_addGoToShortcuts(e,t){this._registerGotoShortcut(b.browse,(()=>{h.location.href=(0,c.getAllServicesDeeplink)()}),66),this._registerGotoShortcut(b.new,(()=>{t.sideBar.openCreate()}),78),this._registerGotoShortcut(b.search,(()=>{t.topBar.searchViewModel.setFocus()}),191),[[y.allResources,g,65],[y.resourceGroups,f,82]].forEach((t=>{this._registerGotoShortcut(t[0],(()=>{e.route(t[1],{openedBy:8})}),t[2])})),this._registerGotoShortcut(y.dashboard,(()=>{e.navigateWithRoute("dashboard",null,{interactionSource:"KeyboardShortcuts"})}),68);const s=(e,s)=>{const o=s+1;this._registerGotoShortcut(y.sideBarItem+o,(()=>{t.sideBar.openFavorite(s)}),e)};C.forEach(s),P.forEach(s)}_generateIdForKeyboardShortcut(e,t,s=!1){let o=s?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),8&t&&(o+="CTRL+"),1&t&&(o+=x?"OPT+":"ALT+"),2&t&&(o+=x?"CMD+":"WIN+"),o+=i.mapKeyCodeToString(4==(4&t),e),o}getShortcuts(){return{key:this._keyShortcuts,goTo:this._goToShortcuts}}}})),
define("_generated/Less/MsPortalImpl/Interactions/Interactions.PrintHandler.css",["module"],(function(e){"use strict";return{css:'@media print{html,#web-container{-webkit-print-color-adjust:exact;color-adjust:exact}body{color-adjust:economy;background:none!important}@page{margin:.4in .2in}.fxs-show-startboard{background-color:inherit}pre,blockquote,tr,img,svg,[role="row"],[role="figure"],[role="img"],.fxc-chart{break-inside:avoid}p,h2,h3,h4,h5,h6{orphans:3;widows:3}h2,h3,h4,h5,h6{break-after:avoid}.fxs-blade,.fxs-blade-content-container,.fxs-blade-content-wrapper{display:block!important}.fxs-journey-target,.fxs-journey-layout,.fxs-bladecontent{display:block!important}.fxs-blade-content-container-default,.fxs-blade-content-container-details{width:100%!important}.fxs-portal-main,.fxs-portal-content{flex:0 0 auto;display:block!important}.fxs-panorama{width:100%}#web-container,.fxs-home-target,.fxs-startboard-target,.fxs-sidebar-flyout,.fxs-journey-target{position:static!important}body,#web-container,.fxs-panorama,.fxs-home-target,.fxs-startboard-target,.fxs-sidebar-flyout,.fxs-journey-target,.fxs-journey-layout,.fxs-blade-content-wrapper{overflow:visible!important}.fxs-menublade .fxs-blade-content-container-default{display:none!important}.fxs-tabmenublade .fxs-blade-content-container-default{display:none!important}.fxs-blade{box-shadow:none!important;width:100%!important}.fxs-blade:not(:last-of-type){display:none!important}.fxs-bladecontent-unlocked{background-color:transparent!important}html.fxs-printbladerequest .fxs-blade:not(.fxs-bladetoprint){display:none!important}html.fxs-printbladerequest .fxs-blade.fxs-bladetoprint{display:block!important}.fxs-startboard-layout{padding:25px}}.fxs-printmaxwidth{max-width:750px}',moduleId:e.id}})),
define("MsPortalImpl/Interactions/Interactions.PrintHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Widgets/Widgets.Portal","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.PrintHandler.css","Fx"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrintHandler=void 0,(0,i.injectCss)(n);const a=window,l=MsPortalFx.Base.Diagnostics.Telemetry,c=a.document.documentElement;let d=class{constructor(e){this._portalVm=e}init(e){const t=this._portalVm,s=()=>{const e=t.displayMode.value;let s=this._telemetryName||`Shell/${e}`;const o=this._telemetrySource||"BrowserCommand";let i=this._menuBladeCtx;if("Shell/Journey"===s){const e=MsPortalFx.last(t.getJourneyWidget().getBlades());e&&(s=e.getContentWidget().options.getTelemetryName(),i=e.options.isMenuBlade.peek()?e.options.getTelemetryName():null)}const n={action:"PrintRequest",source:o,name:s,data:{displayMode:e,menuBladeCtx:i}};return this._telemetryName=null,this._telemetrySource=null,this._menuBladeCtx=null,n},o=()=>{$.querySelectorAll(".fxs-bladetoprint").removeClass("fxs-bladetoprint"),c.classList.remove("fxs-printbladerequest"),$.querySelectorAll(".fxs-vivaresize:not(.fxs-journey):not(.fxs-blade):not(.fxs-bladecontent):not(.fxs-blade-content)").removeClass("fxs-printmaxwidth"),t.getJourneyArea().trigger("fxbladerepos")},i=()=>{l.trace(s()),"Dashboard"!==this._portalVm.getDisplayMode()&&p()};a.addEventListener("beforeprint",i),a.addEventListener("afterprint",o),e.registerForDispose((()=>{a.removeEventListener("afterprint",o),a.removeEventListener("beforeprint",i)}))}printBlade(e,t){this._telemetryName=t.name,this._telemetrySource=t.source,this._menuBladeCtx=t.menuBladeCtx,c.classList.add("fxs-printbladerequest"),e.classList.add("fxs-bladetoprint"),p(),r.delay(333).then(a.print)}printDashboard(){this._telemetryName="Shell/Dashboard",this._telemetrySource="Dashboard",a.print()}};function p(){$.querySelectorAll(".fxs-vivaresize:not(.fxs-journey):not(.fxs-blade):not(.fxs-bladecontent):not(.fxs-blade-content)").addClass("fxs-printmaxwidth")}t.PrintHandler=d,t.PrintHandler=d=__decorate([__metadata("fx:diagnostics",[e,"PrintHandler"]),s.Class(),__metadata("design:paramtypes",[o.ViewModel])],d)})),
define("MsPortalImpl/Services/Services.SessionManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Base/Base.BrowserDetection","FxInternal/AsyncLoader","FxHubs/RpcEndPoints"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSessionHistoryHandler=t.SessionManager=void 0;const a={};function l(e,t){e.setSettings({store:22,settings:{SessionHistory:{...t}}})}function c(e){const t=(new Date).getTime();return{sessionStart:t,lastSeen:t,browserAgent:{client:p(),version:navigator.userAgent},tenantName:e,operatingSystem:u()}}function d(e){if(e.sessionEnd)return"Closed";return(new Date).getTime()-e.lastSeen>9e5?"Idle":"Active"}function p(){return i.isEdge?"Edge":i.isChromiumEdge?"Edge Chromium":i.isChrome?"Chrome":i.isOpera?"Opera":i.isSafari?"Safari":i.isChromeIos?"iOS Chrome":i.isAndroidOrMobile?"Android":"Unknown"}function u(){try{const e=navigator.userAgent;let t="Unknown";return e.includes("Win")&&(t="Windows"),e.includes("Mac")&&(t="Mac"),e.includes("X11")&&(t="Unix"),e.includes("Linux")&&(t="Linux"),t}catch(e){console.error("OS was not parsed: "+e)}}async function m(e){let t;return MsPortalFx.forEachKey(e,(s=>{(void 0===t||e[s].sessionStart<e[t].sessionStart)&&(t=s)})),t}let h=class{constructor(e){this._settingsManager=e}async initialize(e){const t={...await this._getSessionHistory(),[MsPortalFx.sessionId]:c(e)};for(;MsPortalFx.keysLength(t)>10;){delete t[await m(t)]}l(this._settingsManager,t),await this._settingsManager.flushSettings()}async removeSession(e){const t=await this._getSessionHistory();delete t[e],l(this._settingsManager,t)}async updateLastSeen(){const e=await this._getSessionHistory(),t=(new Date).getTime();e[MsPortalFx.sessionId]={...e[MsPortalFx.sessionId],lastSeen:t},l(this._settingsManager,e)}async endSession(e){const t=await this._getSessionHistory();if(!t[e].sessionEnd){const s=(new Date).getTime();t[e]={...t[e],lastSeen:s,sessionEnd:s}}l(this._settingsManager,t)}async getSessions(){const e=await this._getSessionHistory();let t=Object.keys(e);t=MsPortalFx.stableSort(t,((t,s)=>e[s].sessionStart-e[t].sessionStart));const s=new Array(t.length);return t.forEach(((o,i)=>{s[i]={...e[t[i]],status:d(e[t[i]]),sessionId:t[i]}})),s}_getSessionHistory(){return async function(e){return(await e.queryStore(22,!0)).SessionHistory||a}(this._settingsManager)}};t.SessionManager=h,t.SessionManager=h=__decorate([__metadata("fx:diagnostics",[e,"SessionManager"]),s.Class(),__metadata("design:paramtypes",[o.SettingsManager])],h),t.getSessionHistoryHandler=(0,n.defineHandler)(r.SessionManager.getSessionHistoryEndPoint,(async e=>await e.diContainer.get(h).getSessions()))})),
define("MsPortalImpl/Services/Services.PortalPollingManager",["require","exports","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.SessionManager","MsPortalImpl/Services/Services.Subscriptions","Fx/Ajax","Fx/DependencyInjection","Fx","Weave","Fx/Experimentation"],(function(e,t,s,o,i,n,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.PollingManager=void 0;var p=MsPortalFx.Base.Diagnostics.Telemetry;const u=FxImpl.features.isEnabled("selftoken");let m=MsPortalFx.isFeatureEnabled("pollservicehealthalerts"),h=MsPortalFx.isFeatureEnabled("outagebanner"),g=!0;let f=class{constructor(e){this._diContainer=e,this._polledData=(0,c.makeWritableComputation)(),this._lifetime=new FxImpl.TriggerableLifetimeManager,e.get(d.Experimentation).shellAssignments.whenAvailable().then((e=>{this._sessionManagerEnabled=e.getBooleanValue("sessionManager")}))}startPolling(){this._pollingHandle||l.delay(12e4).then((()=>{const t=()=>{this._sessionManagerEnabled&&this._diContainer.get(i.SessionManager).updateLastSeen(),async function(t){const i=["whatsNew"],a=t.get(s.PrivateLinkState).isPrivateLinked.value,l=t.get(s.ServiceDependencyState).azureResourceGraphUnavailable.value;h&&i.push("outages"),!m||a||l||i.push("serviceHealthAlerts");const c=p.startTrace({action:"PollPortalOnDemandData",source:"PortalPollingManager"});let d,g;try{const s=await t.get(o.SecurityTokensManager).getToken({extensionName:"fx",resourceName:"",skipCache:!1,isBackground:!1})||{token:{}},c=(await t.get(n.SubscriptionsUserContext).getInSessionSelectedSubscriptions())().map((e=>e.subscriptionId));if(g=await(0,r.postJSON)({isBackgroundTask:!0,uri:"/api/Portal/GetOnDemandData",setAuthorizationHeader:!u||{resourceName:"self"},headers:{"x-ms-feature-flags":JSON.stringify(MsPortalEarly.earlyBaseFeatureFlags)}},{armAuthorizationHeader:s.token.header,subscriptionIds:c,queries:i}),c.length){const s=await MsPortalFx.require(e.normalize("MsPortalImpl/Services/LazyUserData/LazyUserData.Deferred"));a&&m&&!l&&(g.serviceHealthAlerts=await s.getServiceHealthAlerts(c,t))}}catch(e){d=e}return p.endTrace(c,"complete",{counts:{irisNotifications:Object.keys((g?.irisNotifications||{}).Notifications||{}).length,outages:(g?.outages||[]).length,whatsNew:(g?.whatsNew||[]).length,serviceHealthAlerts:(g?.serviceHealthAlerts||[]).length},error:d,queries:i}),g}(this._diContainer).then((e=>{e&&this._polledData(e),this._pollingHandle=setTimeout((()=>{t()}),6e5)}))};(g?Promise.resolve():l.delay(6e5)).then((()=>t()))}))}getPolledDataObservable(){return this._polledData}dispose(){this._pollingHandle&&clearTimeout(this._pollingHandle),this._lifetime.dispose(),g=!0}};t.PollingManager=f,t.PollingManager=f=__decorate([__metadata("fx:diagnostics",[e,"PollingManager"]),a.Class(),__metadata("design:paramtypes",[a.Container])],f)})),
define("MsPortalImpl/Notifications/NotificationsArea",["require","exports","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.PortalPollingManager","Fx","Fx/DependencyInjection","Weave"],(function(e,t,s,o,i,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.DataContext=t.delayTimeout=t.defaultPollingInterval=void 0;var c=MsPortalFx.Base.Diagnostics.Telemetry;const d=MsPortalFx.isFeatureEnabled("fasteventservice"),p=MsPortalFx.getFeatureValue("irismessagelimit"),u=(0,r.memoizePromise)((()=>(0,r.require)(e.normalize("./WhatsNewCheck"))));t.defaultPollingInterval=d?5e3:6e4*(MsPortalFx.isFeatureEnabled("slowpollevents")?30:10),t.delayTimeout=MsPortalFx.isDevelopmentMode&&MsPortalFx.isFeatureEnabled("fasteventservice")?1e4:3e4;let m=function(t,s){const o=s?.Notifications;let i=0;i=Number(p||1)>1&&Array.isArray(o)?o.length:o?1:0,i&&(0,r.require)(e.normalize("./PortalNotifications")).then((e=>{e.init(t,s)})),c.trace({source:"NotificationsArea",action:i?"IrisNotificationPresent":"IrisNotificationNotPresent",data:{count:i,requestedCount:p}})};function h(t,s){s&&s.length?(0,r.require)(e.normalize("./PortalNotifications")).then((e=>{e.initServiceHealthAlerts(t,s)})):c.trace({source:"NotificationsArea",action:"NoServiceHealthAlertsShown"})}let g=class{constructor(e,s){this._diContainer=e,this._lifetime=new FxImpl.TriggerableLifetimeManager;const a=FxImpl.features.isNativePerf,c=MsPortalFx.getFeatureValue("skipeventpoll"),d=MsPortalFx.isFeatureEnabled("portalpolling"),p=MsPortalFx.isFeatureEnabled("pollservicehealthalerts"),g=MsPortalFx.isFeatureEnabled("showservicehealthalerts");if("true"===c||a&&"false"!==c)return void(g&&(0,o.lazyUserDataMemo)(this._diContainer).then((e=>{const t=e.serviceHealthAlerts||[];h(this._diContainer,t)})));const f=ko.observable([]);s.getInSessionSelectedSubscriptions().then((e=>{e.subscribeAndRun(this._lifetime,(e=>f(e)))})),f.subscribeAndRun(this._lifetime,(e=>{if(e&&e.length&&!this._initialized&&(this._initialized=!0,!d&&p)){const s=()=>{this._diContainer.get(i.ServiceDependencyState).azureResourceGraphUnavailable.value||(0,r.delay)(t.defaultPollingInterval).then((()=>{(0,r.require)("MsPortalImpl/Services/LazyUserData/LazyUserData.Deferred").then((t=>{t.getServiceHealthAlerts(e.map((e=>e.subscriptionId)),this._diContainer).then((e=>{h(this._diContainer,e),s()}))}))}))};(0,r.delay)(t.delayTimeout).finally(s)}})),a||(0,r.delay)(t.delayTimeout).then((()=>{u().then((e=>{e.checkForPortalUpdates(this._diContainer)}))})),d&&(0,l.subscribeAndRun)(this._lifetime,[this._diContainer.get(n.PollingManager).getPolledDataObservable()],(e=>{if(e){if(MsPortalFx.getFeatureValue("testbillingdownload"))try{m(this._diContainer,{FormatCulture:"en-us",Notifications:JSON.parse(MsPortalFx.getFeatureValue("testbillingdownload")),RequestDate:Date.now()})}catch(e){}else e.irisNotifications&&m(this._diContainer,e.irisNotifications);e.whatsNew&&u().then((t=>{t.showWhatsNewNotification(this._diContainer,e.whatsNew)})),e.serviceHealthAlerts&&h(this._diContainer,e.serviceHealthAlerts)}})),a||MsPortalEarly.preload.then((e=>{if(e=e||{},MsPortalFx.getFeatureValue("testbillingdownload"))try{m(this._diContainer,{FormatCulture:"en-us",Notifications:JSON.parse(MsPortalFx.getFeatureValue("testbillingdownload")),RequestDate:Date.now()})}catch(e){}else e.irisNotifications&&m(this._diContainer,e.irisNotifications);e.whatsNew&&u().then((t=>{t.showWhatsNewNotification(this._diContainer,e.whatsNew)}))}))}dispose(){!this._lifetime.isDisposed()&&this._lifetime.dispose()}};t.DataContext=g,t.DataContext=g=__decorate([__metadata("fx:diagnostics",[e,"DataContext"]),a.Class(),__metadata("design:paramtypes",[a.Container,s.SubscriptionsUserContext])],g)})),
define("MsPortalImpl/Notifications/PortalNotifications",["require","exports","MsPortalFx/Globalization","MsPortalImpl/Notifications/NotificationsClientStrings","MsPortalImpl/Resources/PortalNotificationsTelemetry","Fx/DependencyInjection","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Notifications/IrisNotificationsTelemetry","Fx/Experimentation"],(function(e,t,s,o,i,n,r,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.initServiceHealthAlerts=t.init=t.PortalNotifications=t.irisDurationMap=t.getToastDuration=void 0;var d=MsPortalFx.Base.Diagnostics.Telemetry,p=MsPortalFx.Hubs.Notifications.NotificationStatus,u=FxImpl.Hubs.Notifications.InternalClientNotification;const m=MsPortalFx.getUniqueId,h=new Map;h.set("serviceissue",o.ServiceHealthAlertTypeNames.serviceIssue),h.set("plannedmaintenance",o.ServiceHealthAlertTypeNames.plannedMaintenance),h.set("healthadvisory",o.ServiceHealthAlertTypeNames.healthAdvisory),h.set("securityadvisory",o.ServiceHealthAlertTypeNames.securityAdvisory);let g=(0,r.hideSmallModals)();function f(e){let s=t.irisDurationMap[(e.duration||"").toString().toLowerCase()];return void 0!==s?s:(s=Number.parseInt(e.duration),s||0)}function x(e,t,s){d.trace({source:i.Source.PortalNotifications,action:e,actionModifier:t,data:s||{}})}t.getToastDuration=f,t.irisDurationMap={0:0,1:1,2:2,3:3,4:4,modal:4,sticky:2,long:1,short:0,suppress:3};let b=class{constructor(e,t){this._irisNotificationsTelemetry=e,this._diContainer=t,this._contactabilityModalDetails=null,this._shouldShowContactability=MsPortalFx.isFeatureEnabled("testcontactabilitymodal"),this._shouldShowIrisAdvisor=!1,this._irisMessageLimit=Number(MsPortalFx.getFeatureValue("irismessagelimit")||1)}_makeIrisAdvisorContent(e,t,s){const o=`${i.Action.IrisNotification}_${i.Action.IrisAdvisor}`;return{timestamp:new Date,title:e.title,modalNotificationData:e.modalNotificationData,description:e.description,descriptionAsHtml:!0,status:e.status||p.Information,toastDuration:s,inlineForm:{buttons:(e.button&&[e.button])??null},irisNotificationDetails:{...t,notificationId:o},notificationId:o}}async _handleBillingDownload(e,t,s){await this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:t,action:i.ActionModifier.BillingDownloadNotificationReceived});const o=MsPortalFx.getFeatureValue("testbillingdownload"),n=MsPortalFx.isFeatureEnabled("showbillingdownload");if(n||o){const r=(await this._diContainer.get(c.Experimentation).shellAssignments.whenAvailable()).getBooleanValue("showbillingdownloadnotification");if(r||o)return await MsPortalFx.require("MsPortalImpl/Notifications/BillingDownloadHelper").then((i=>i.showBillingDownloadNotification(this._diContainer,e,t,s,{expFlag:r,featureFlag:n,testFlag:o}))).catch((e=>{x(i.Action.IrisNotification,i.ActionModifier.NotificationNotShown_LoadBillingDownloadHelperFailed,{expFlag:r,featureFlag:n,testFlag:o})}))}}_handleContactabilityNotification(e){return this._contactabilityModalDetails=e,this._shouldShowContactability=!0,this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:e,action:i.ActionModifier.ContactabilityNotificationReceived})}_handleIrisAdvisor(e,t,s){if(MsPortalFx.isFeatureEnabled("showirisadvisor"))return this._shouldShowIrisAdvisor=!0,this._irisAdvisorContent=this._makeIrisAdvisorContent(e,t,s),this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:t,action:i.ActionModifier.AdvisorNotificationReceived})}async publishIrisNotification(e){const t=e?.ad?.properties,s=e?.prm?._imp,n=e?.tracking?.baseUri;if(!t||!s||!n)return void x(i.Action.IrisNotification,i.ActionModifier.NotificationNotShown_InvalidContent,{ad:!!e.ad,adProperties:!!t,tracking:!!e.tracking,trackingBaseUri:!!n,prm:!!e.prm,prmImp:!!s,traceId:m()});const r=t||{},a=r.notificationId||i.Action.IrisNotification+MsPortalFx.getUniqueId(),c={actionBeaconUri:n,impressionsUri:s,notificationId:a};if("true"===r.isControl||!0===r.isControl)return await this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:c,action:i.ActionModifier.ControlNotificationReceived});if("contactability"===(r.type||"").toLowerCase())return this.contactabilityProperties=r?.properties,await this._handleContactabilityNotification({...c,notificationId:i.Source.UpdateContactabilityDialog});if(r.title&&r.description){let e=f(r);if(!r.type){4!==e||MsPortalFx.isFeatureEnabled("allowirismodalnotifications")||(e=1);const t=[];return r.button&&t.push(r.button),"true"===r.showOptOut&&t.push({label:o.Iris.Notification.OptOutButton.label,secondary:!0,endpoint:{uri:(0,l.replaceActionWithAction)("Dismiss",c.actionBeaconUri),method:"GET",successMessage:o.Iris.Notification.OptOutButton.successMessage,failureMessage:o.Iris.Notification.OptOutButton.failMessage,body:null}}),u.internalPublish({timestamp:new Date,title:r.title,modalNotificationData:r.modalNotificationData,description:r.description,descriptionAsHtml:!0,status:r.status||p.Information,toastDuration:e,inlineForm:{buttons:t.length>0?t:null},irisNotificationDetails:c,notificationId:a}),await this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:c,action:i.ActionModifier.NotificationShown})}if("advisor"===r.type.toLowerCase())return this._handleIrisAdvisor(r,c,e);if("downloadinvoice"===r.type.toLowerCase())try{return await this._handleBillingDownload(r,c,e)}catch(e){}if(r.type)return void x(i.Action.IrisNotification,i.ActionModifier.NotificationNotShown_InValidNotificationType,{actionASID:(0,l.scrapeIrisValue)(n,"asid"),actionPID:(0,l.scrapeIrisValue)(n,"pid"),description:r.description,title:r.title,impressionASID:(0,l.scrapeIrisValue)(s,"asid"),impressionPID:(0,l.scrapeIrisValue)(s,"pid"),messageLimit:this._irisMessageLimit,traceId:m(),type:r?.type})}x(i.Action.IrisNotification,i.ActionModifier.NotificationNotShown_NoTitleOrDescription,{actionASID:(0,l.scrapeIrisValue)(n,"asid"),actionPID:(0,l.scrapeIrisValue)(n,"pid"),description:r.description,title:r.title,impressionASID:(0,l.scrapeIrisValue)(s,"asid"),impressionPID:(0,l.scrapeIrisValue)(s,"pid"),messageLimit:this._irisMessageLimit,traceId:m()})}async publishIrisNotifications(e){const t=e?.Notifications;if(!t||0!==MsPortalFx.localeCompareIgnoreCase(s.formatCulture,e.FormatCulture))return void x(i.Action.IrisNotification,i.ActionModifier.NotificationNotShown_NoNotificationsOrCultureMismatch,{cultureMatch:0===MsPortalFx.localeCompareIgnoreCase(s.formatCulture,e&&e.FormatCulture),formatCulture:s.formatCulture,hasIrisNotifications:!(!e||!e.Notifications),irisFormatCulture:e&&e.FormatCulture,traceId:m()});const o=!MsPortalFx.isArrayOrObservableArray(t);if(1===this._irisMessageLimit&&o)return await this.publishIrisNotification(t);if(o)return void x(i.Action.IrisNotification,i.ActionModifier.NotificationNotShown_NoNotificationsOrCultureMismatch,{type:typeof t,traceId:m()});const n=[];t.forEach((e=>{n.push(this.publishIrisNotification(e))})),await Promise.allSettled(n)}publishServiceHealthNotifications(e){e.forEach((e=>{const t=e.eventType&&h.get((e.eventType||"").toLowerCase());if(t&&e.description)return u.internalPublish({timestamp:new Date,title:t,description:e.description,status:"serviceissue"===e.eventType.toLowerCase()?p.Error:p.Information,notificationId:i.Action.ServiceHealthAlertNotification+m(),correlationIds:[e.trackingId],isServerEvent:!0,uri:`#blade/Microsoft_Azure_Health/AzureHealthBrowseBlade/trackingId/${e.trackingId}`});x(i.Action.ServiceHealthAlertNotification,i.ActionModifier.NotificationNotShown_InvalidContent,{title:e.eventType,description:e.description,traceId:m()})}))}shouldShowContactability(){return this._shouldShowContactability}shouldShowIrisAdvisor(){return this._shouldShowIrisAdvisor}showIrisAdvisor(e){if(this._shouldShowIrisAdvisor=!1,!g)return this._irisAdvisorContent?(u.internalPublish(this._irisAdvisorContent),this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:this._irisAdvisorContent.irisNotificationDetails,action:i.ActionModifier.NotificationShown}),e.get(a.SubscriptionsUserContext).getAllSubscriptionsCount().then((e=>{0===e.value&&x(i.Action.IrisNotification,"AdvisorModelSkipped",{subscriptionsCountType:e.type,traceId:m()})}))):void 0}async showContactabilityModal(t){if(this.shouldShowContactability())return this._shouldShowContactability=!1,MsPortalFx.require(e.normalize("MsPortalImpl/Notifications/ContactabilityHelper")).then((e=>e.invokeContactabilityModal(t,this._contactabilityModalDetails,this.contactabilityProperties)))}};t.PortalNotifications=b,t.PortalNotifications=b=__decorate([__metadata("fx:diagnostics",[e,"PortalNotifications"]),(0,n.Class)(""),__metadata("design:paramtypes",[l.IrisNotificationsTelemetry,n.Container])],b),t.init=async function(e,t){await e.get(b).publishIrisNotifications(t)},t.initServiceHealthAlerts=function(e,t){e.get(b).publishServiceHealthNotifications(t)}})),
define("MsPortalImpl/Interactions/Interactions.Command",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommandImpl=t.FileInputOptions=t.CommandContext=void 0;t.CommandContext=class{constructor(e,t){this.target=e,this.getFormTarget=t}};t.FileInputOptions=class{constructor(e,t){this.accept=e,this.maxFiles=t,this.files=ko.observable(null)}};t.CommandImpl=class{constructor(e,t,s){this._ariaLabel=ko.observable(),this._inheritIcon=ko.observable(),this.fxEnabled=ko.observable(!0),this.hasPopup=ko.observable(!1),this.ariaLabel=this._ariaLabel,this.enabled=ko.observable(!0),this.visible=ko.observable(!0),this.unauthorized=ko.observable(!1),this.pressed=ko.observable(),this.fileInputOptions=ko.observable(null),this.tooltip=ko.observable(),this.isShellCommand=!1;const o=this._ltm=e.createChildLifetime();this.text=ko.isObservable(t)?t:ko.observable(t||""),this.enabled(void 0===s||s),this.icon=ko.computed(o,{read:this._inheritIcon,write:e=>this._inheritIcon(e&&MsPortalFx.extend2(e,{options:$.extend({palette:99},e.options)}))})}get canRebind(){return!0}activate(){}execute(e){}bind(e){const t=e&&e.getFormTarget;e.getFormTarget=()=>t().then((t=>{if(t&&"function"!=typeof t.showForm)throw new Error("invalid context"+JSON.stringify(e,((e,t)=>e+typeof t)));return t})),this._currentContext=e}dispose(){this._ltm.dispose()}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDynamicBindingWithNonLocalSource=t.isOverridesOrContainerModelSourceReference=t.inferredReferenceType=t.extractTraceOptions=t.mapSourceModelToTargetModel=t.PropertyBindings=t.setModelValue=t.getModelValue=t.PropertyBinding=t.PropertyTransformerArgs=t.ObservableChangeArgs=t.ReferenceCardinality=t.ReferenceScope=void 0;var s=FxImpl.TriggerableLifetimeManager;const o=MsPortalFx.Base.Diagnostics.createLog(e),i=MsPortalFx.trace.inputsset,n=Array.prototype.splice,r=FxImpl.quickApplyArrayEdits,a=MsPortalFx.applyCall;function l(e,t,...s){return a(n,this,[e,t].concat(s.map(ko.toJS)))}var c,d;!function(e){e[e.CurrentContainer=0]="CurrentContainer",e[e.MasterContainer=1]="MasterContainer",e[e.DetailsContainer=2]="DetailsContainer"}(c||(t.ReferenceScope=c={})),function(e){e[e.OneToOne=0]="OneToOne",e[e.OneToMany=1]="OneToMany",e[e.ManyToOne=2]="ManyToOne"}(d||(t.ReferenceCardinality=d={}));class p{constructor(e,t){this.kind=e,this.propertyName=t}static forObject(e,t,s){const o=new p(0,e);return o.propertyValue=t,o.propertyOldValue=s,o}static forArray(e,t){const s=new p(1,e);return s.propertyArrayEdits=t||[],s}static forNewArray(e,t){const s=new p(1,e);return s.propertyValue=t,s}}t.ObservableChangeArgs=p;class u{constructor(e,t,s,o,i){this.cancel=!1,this.propertyChanges=[],this.sourceModelId=e,this.sourceModel=t,this.sourceProperty=s,this.targetModel=o,this.targetProperty=i}}t.PropertyTransformerArgs=u;class m{constructor(e,t,s,o,n,r){this.transformers=[],this.compositionBindingDefinition=null,this._callbacks=$.Callbacks(),this._errCallbacks=$.Callbacks(),this._awaitBound=Promise.withResolvers(),this._tgtHasValue=!1,this.sourceProperty=e,this.targetProperty=t,this.targetModel=s,this._tgtModelName=o,this.transformers=n,this._tgtPropExists=r,this._traceOptions=x(o,i)}sourceModelName(){return this._srcModelName}get sourceModel(){return this._srcModel}get isBound(){return!!this._srcModel}get awaitBound(){return this._awaitBound.promise}get targetHasValue(){return this._tgtHasValue}addValueChangedHandler(e){e&&this._callbacks.add(e)}removeValueChangedHandler(e){this._callbacks.remove(e)}addErrorHandler(e){e&&this._errCallbacks.add(e)}bind(e,t,o=!0,i,n){if(!this.isBound){if(this.addValueChangedHandler(i),this.addErrorHandler(n),this._validateBinding(e,t)){this._srcModelName=e,this._srcModel=t;const i=this._getSrcValue(),n=ko.utils.peekObservable(i);let r;if(o&&void 0!==n&&this._changeTgtModel(p.forObject(this.targetProperty,n)),ko.isObservable(i)){let e;r=i,this._bindingLifetime=new s,r.subscribe(this._bindingLifetime,(t=>{let s,o,i;Array.isArray(t)?(o=t,s=t.slice(0)):s=t,(r.splice||r.map)&&(i="arrayChange"),e&&e.dispose(),e=this._bindingLifetime.createChildLifetime(),r.subscribe(e,(t=>{let n;if(e.dispose(),e=void 0,"arrayChange"===i&&(n=t,t=r()),Array.isArray(s)&&Array.isArray(t))if(o===t){n=n||ko.utils.compareArrays(s,t,{sparse:!0});const e=p.forArray(this.targetProperty);e.propertyArrayEdits=ko.utils.adjustArrayEdits(n),this._changeTgtModel(e)}else this._changeTgtModel(p.forNewArray(this.targetProperty,t));else this._changeTgtModel(p.forObject(this.targetProperty,r(),s))}),null,i)}),null,"beforeChange")}else o||this._err("Error when binding. The value is not an observable and importInitialValue is false.");this._awaitBound.resolve()}else this._awaitBound.reject();return this}this._err("Property binding is already bound.")}unbind(){this._bindingLifetime&&this._bindingLifetime.dispose(),this._srcModel=null,this._srcModelName=null,this._callbacks.empty(),this._errCallbacks.empty()}toString(){return"\n\nDetails:\nSource model id: '{0}'.\nSource property: '{1}'.\nTarget model id: '{2}'.\nTarget property: '{3}'.\nSource model: '{4}'.\nTarget model: '{5}'.".format(this._srcModelName||"<UNBOUND>",this.sourceProperty,this._tgtModelName,this.targetProperty||"<DYNAMIC>",this._srcModel?f(this._srcModel):"<UNBOUND>",f(this.targetModel))}_changeTgtModel(e){const t=new u(this._srcModelName,this._srcModel,this.sourceProperty,this.targetModel,this.targetProperty);let s,o;e&&t.propertyChanges.push(e),this._processTransformers(t)&&((t.propertyChanges||[]).forEach((e=>{if(e.propertyName){const t=this._traceOptions;if(0===e.kind)this._tgtHasValue=void 0!==e.propertyValue,b(t,e.propertyName,e.propertyValue),g(this.targetModel,e.propertyName,ko.toJS(e.propertyValue));else{s=h(this.targetModel,e.propertyName).value,o=ko.unwrap(s);const i=e.propertyArrayEdits;if(Array.isArray(o)){if(i)t&&t.verbose&&i.forEach((s=>{"added"===s.status&&b(t,e.propertyName,s.value)})),ko.isObservable(s)&&s.valueWillMutate(),this._tgtHasValue=!0,r(o,i,{inplaceFixup:!1,spliceFunc:l}),ko.isObservable(s)&&s.valueHasMutated();else if(e.propertyValue){this._tgtHasValue=!0;const t=e.propertyValue;s.splice?s.splice.apply(s,[0,o.length].concat(t)):s(t)}}else this._err("[Property Binding] Array change detected on source property, but target property is not an array.")}}})),this._callbacks.fire(t.propertyChanges))}_processTransformers(e){return this.transformers.some((t=>(t(e),e.cancel))),!e.cancel}_getSrcValue(){return h(this._srcModel,this.sourceProperty).value}_validateBinding(e,t){let s;const o=this.compositionBindingDefinition,i=!(o&&o.optional);return this._validateModel(e,t,this.sourceProperty,i,(e=>{s=e}))?this.sourceProperty?this._validateModel(this._tgtModelName,this.targetModel,this.targetProperty,this._tgtPropExists,(e=>{s=e}))||(s="[Property Binding] Invalid target model - {0}".format(s)):s="[Property Binding] Invalid source model - Source property must be defined.":s="[Property Binding] Invalid source model - {0}".format(s),s&&this._err(s),!s}_validateModel(e,t,s,o,i){let n;return e?t?s&&o&&!h(t,s).exists&&(n="Model is missing property '{0}'.".format(s)):n="Model is undefined.":n="Model is missing an identifier.",n&&i&&i(n+"\nModel id: '{0}'.".format(e||"N/A")),!n}_err(e){this.isBound&&(e+=""+this);const t=MsPortalFx.trace;(MsPortalFx.isDevelopmentMode||t&&t.diagnostics)&&o.error(e),this._errCallbacks.fire(e)}}function h(e,t,s){const o=t?t.split("."):[],i={exists:e&&o.length>0,value:void 0};let n=e,r=0;const a=s?ko.utils.peekObservable:ko.unwrap;for(;i.exists&&r<o.length;)n=a(n),n&&n.hasOwnProperty(o[r])?n=n[o[r]]:i.exists=!1,r++;return i.exists&&(i.value=n),i}function g(e,t,s){const o=s=>{if(!s||"object"!=typeof s)throw new Error(function(e,t){const s=f(t);return s?"{0}\nModel: '{1}'".format(e,s):e}("A property in model hierarchy is not an object. Path: '{0}'.".format(t),e));return s},i=t.split(".");let n,r=o(e);for(let e=0;e<i.length-1;e++)n=i[e],MsPortalFx.isNullOrUndefined(r[n])&&(r[n]={}),r=o(ko.unwrap(r[n]));n=MsPortalFx.last(i),r[n]&&ko.isObservable(r[n])?r[n](s):r[n]=s}function f(e){let t;try{t=ko.toJSON(e)}catch(e){return e.message}return t}t.PropertyBinding=m,t.getModelValue=h,t.setModelValue=g;function x(e,t){if(!t)return;const s=e.toLowerCase(),o=e=>!(!MsPortalFx.isPlainObject(e)||MsPortalFx.isEmptyObject(e))&&Object.keys(e).every((e=>s.includes(e.toLowerCase()))),i=o(t.debug),n=o(t.log),r=o(t.verbose);let a;return(n||i||r)&&(a={debugId:e,breakOnInputsSet:i,verbose:r}),a}function b(e,t,s){e&&e.verbose&&!MsPortalFx.canSendThroughPostMessage(s)&&o.verbose("Inputs should be simple data objects without functions/observables: {0} | {1} | {2}".format(e.debugId,t,ko.toJSON(s)))}function y(e){return e&&e.modelType===t.inferredReferenceType}t.PropertyBindings=class{constructor(e,t,s){this._properties=[],this._propertyChangedCallbacks=$.Callbacks(),this._aggregatePropertyChangedHandler=e=>{this._propertyChangedCallbacks.fire(e)},this._targetModel=t,this._targetModelName=e,this._validateTargetPropertiesExist=!1!==s}get properties(){return this._properties.slice(0)}get targetModelName(){return this._targetModelName}get targetModel(){return this._targetModel}get awaitAllBound(){const e=this._properties.map((e=>e.awaitBound));return Promise.all(e)}get allBound(){return this.properties.every((e=>e.isBound))}addPropertyChangedHandler(e){this._propertyChangedCallbacks.add(e)}addProperty(e,...t){const s=new m(e,e,this._targetModel,this._targetModelName,t,this._validateTargetPropertiesExist);return s.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(s),s}mapProperty(e,t,...s){const o=new m(e,t,this._targetModel,this._targetModelName,s,this._validateTargetPropertiesExist);return o.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(o),o}removeProperty(e){const t=this._properties.indexOf(e);t>=0&&(this._properties[t].unbind(),this._properties[t].removeValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.splice(t,1))}getProperty(e){return MsPortalFx.find(this._properties,(t=>t.targetProperty===e))}unbind(){this._properties.forEach((function(e){e.unbind()})),this._propertyChangedCallbacks.empty()}toString(){let e="";const t=this.properties,s=this.properties.length;for(let o=0;o<s;++o)e+="properties[{0}]: {1}".format(o,t[o].toString());return e}},t.mapSourceModelToTargetModel=function(e,t,s,o){const n=x(o,i),r={};return Array.isArray(t)&&t.forEach((t=>{const o=t.source,i=t&&o&&o.scope===c.CurrentContainer&&o.modelType===s&&h(e,o.property);i&&i.exists&&(b(n,t.targetProperty,i.value),g(r,t.targetProperty,ko.toJS(i.value)))})),r},t.extractTraceOptions=x,t.inferredReferenceType=-999,t.isOverridesOrContainerModelSourceReference=y,t.isDynamicBindingWithNonLocalSource=function(e){return e.isDynamicBinding&&!y(e.source)}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","FxHubs/ResourceManagement","MsPortalImpl/Base/Telemetry","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(e,t,s,o,i,n,r,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traceInvocationChange=t.bindOutputsToSelectable2=t.detailsIsPartContainer=t.getAssociatedDetailDefinition=t.mapDynamicSelectionToBladeLocator=t.validateDetailsDefinition=t.needContainerSelectable=t.getSelectablePath=t.isSelectableLocked=t.isSelectableSet=t.isSelectable=t.Resources=t.OpenerConfiguration=t.Configuration=t.DefaultConfiguration=t.PartContainerSelectableValue_ViewModelPath=t.PartContainerSelectable_ViewModelPath=void 0;var d=MsPortalFx.Base.Constants;MsPortalFx.Base.Diagnostics;function p(t,s,i,n,r){const a=`Error invoking detail blade for master '${n}'. ${i} Selection model: '${JSON.stringify(r)}'`;(0,o.logToExtension)(e,s,2,a,{rpcClient:t})}t.PartContainerSelectable_ViewModelPath="container.selectable",t.PartContainerSelectableValue_ViewModelPath=t.PartContainerSelectable_ViewModelPath+".value";const u=c.getModelValue;t.DefaultConfiguration={masterModelId:null,masterModel:null,referenceComposition:null,referenceExtension:null,isBladeOpenedByMaster:null,invocationThrottleDuration:25,configureBladeDescriptor:MsPortalFx.noop,onBladesOpening:MsPortalFx.noop,onBladeOpened:MsPortalFx.noop,addOutputBindings:MsPortalFx.noop,removeOutputBindings:MsPortalFx.noop,getCloseOwnedDetailBladesHandler:MsPortalFx.wrap(null),getCloseOtherDetailBladesHandler:MsPortalFx.wrap(null)};let m=class{};t.Configuration=m,t.Configuration=m=__decorate([__metadata("fx:diagnostics",[e,"Configuration"]),s.Class("pipeline")],m);let h=class extends m{};t.OpenerConfiguration=h,t.OpenerConfiguration=h=__decorate([__metadata("fx:diagnostics",[e,"OpenerConfiguration"]),s.Class("composition")],h);let g=class{};function f(e){const t=e&&e.invocationInputArguments,s=t&&t[0],o=s&&s.valuesFrom,i=o&&o[0];return i&&i.property}function x(e){const s=f(e),o=e.selectablePath;let i=!0;return s?i=s===t.PartContainerSelectableValue_ViewModelPath:o&&(i=o===t.PartContainerSelectable_ViewModelPath),i}function b(e,t){if(!t)return null;const s=t.contracts;return(0,i.supportsContract)(s,8)?a.Locator.forExtension("HubsExtension").withBlade(d.BladeNames.Hubs.ResourceMenuBlade):a.Locator.forExtension(t.bladeExtensionName||e).withBlade(t.bladeName)}t.Resources=g,t.Resources=g=__decorate([__metadata("fx:diagnostics",[e,"Resources"]),s.Class("pipeline")],g),t.isSelectable=function(e,t){const s=2===arguments.length?u(e,t).value:e;if(s){return[s.selectedValue,s.value,s.isSelected,s.isActivated,s.isCommandSelected,s.hasChildEdits].every(ko.isObservable)}return!1},t.isSelectableSet=function(e,t){const s=2===arguments.length?u(e,t).value:e;if(s){return[s.selectableItems,s.selectedItems,s.activatedItems,s.itemsWithChildEdits].every(ko.isObservable)}return!1},t.isSelectableLocked=function(e){return!!e.isLocked()},t.getSelectablePath=function(e){return e.blade?e.selectablePath||"container.selectable":function(e){const t=f(e);if(t){let e=t.split(".");const s=e.length;if(s>1){const t=e[s-1];return["value","activatedItems","selectedItems","selectedItem"].some((e=>e===t))&&(e=e.slice(0,s-1)),e.join(".")}}return null}(e)},t.needContainerSelectable=function(e){if(e){if(!e.filter((e=>e&&!e.selectablePath&&!e.invocationInputArguments)).length){if(!e.filter((e=>e&&"container.selectable"===e.selectablePath)).length){if(!e.filter((e=>{const t=f(e);return"container.selectable.value"===t||!e.blade&&"container.selectable"===t})).length)return!1}}return!0}return!1},t.validateDetailsDefinition=function(e,t,s){let o;const i=e.invocationInputArguments,n=i&&1!==i.length,r=i&&!n&&i[0].valuesFrom,a=e.outputArguments;return n?o="Invocation arguments must exist and have only one element.":r&&r.length>1?o="Multiple 'valuesFrom' not supported for invocation arguments.":!e.blade&&i[0].property?o="Static invocation property is not supported when omitting the details blade name.":r&&void 0!==r[0].constantValue?o="Constants are not allowed on invocation argument.":a&&a.length>0&&(a.some((e=>!e.property))?o="Output arguments must specify a target property.":a.some((e=>1!==e.valuesFrom.length))?o="Output arguments support only one valueFrom property.":a.some((e=>void 0!==e.valuesFrom[0].constantValue))?o="Constants are not allowed on output arguments.":a.some((e=>1!==e.valuesFrom[0].referenceType))&&(o="Output arguments only support source ReferenceType.BladeInput.")),!o&&s&&(o=s(e)),!o||(t.push(o),!1)},t.mapDynamicSelectionToBladeLocator=function(e,t,s,o){const i=t,n=t,l=t;let c;const d={};if(function(e,t,s,o){let i;const n=o,r=o,a=o;o?n.detailBlade||r.assetType||a.resourceId?n.detailBlade&&r.assetType?i="'detailBlade' and 'assetType' cannot be specified at the same time.":n.detailBlade&&a.resourceId?i="'detailBlade' and 'resourceId' cannot be specified at the same time.":r.assetType&&a.resourceId?i="'assetType' and 'resourceId' cannot be specified at the same time.":o.detailBladeInputs||(i="Model must define a 'detailBladeInputs' property."):i="Either 'detailBlade', 'assetType' or 'resourceId' must be specified on the model. ":i="Dynamic selection must be specified. ";i&&p(e.get(FxImpl.Rpc.Client),t,i,s,o);return!i}(e,s.name,o,t)){if(t.extension){let o=t.extension;o=e.get(r.ExtensionManagerOptions).resolveExtensionName(o),s=a.Locator.forExtension(o)}const u=e.get(a.DefinitionFinder);i.detailBlade?c=s.withBlade(i.detailBlade):n.assetType&&u.tryLocate(s.withAssetType(n.assetType),d)?c=b(s.name,d.value):l.resourceId&&e.get(a.LocatorContext).tryLocateAssetDefinitionFromResourceId(l.resourceId,d)?c=b(d.extensionName,d.value):p(e.get(FxImpl.Rpc.Client),s.name,"Unable to locate asset. Error: '{0}'. ".format(d.error),o,t)}return c||(c=s.withBlade("##NOT_SPECIFIED##")),c},t.getAssociatedDetailDefinition=function(e,t,s){const o=t&&t.container,i=s.details;return o&&o.selectable===e?MsPortalFx.find(i,(e=>x(e))):e?MsPortalFx.find(i,(s=>{const o=s.invocationInputArguments,i=s.selectablePath;return o?o.some((s=>s.valuesFrom.some((s=>{const o=[];return s.property.split(".").some((s=>(o.push(s),u(t,o.join(".")).value===e)))})))):!!i&&u(t,i).value===e})):null},t.detailsIsPartContainer=x,t.bindOutputsToSelectable2=function(e,t,s,o,i){let n;t.setLifetimeReference(8,s);const r=()=>{if(o.length||(o=s.bladeDefinition&&s.bladeDefinition.outputs||[]),o.length){const t={};n=new c.PropertyBindings(s.id+"-"+e,t,!1);const r=s.getViewModel(1);let a;n.addPropertyChangedHandler((()=>{a=MsPortalFx.clone(t,!0)})),o.forEach((e=>{n.mapProperty(e,e).bind(s.id,r,!0)})),a&&i&&i(a),n.addPropertyChangedHandler((()=>{const e=MsPortalFx.clone(t,!0);i&&i(e)}))}};(o.length||i)&&(s.isComposed?r():s.await(7).then(r),s.onDispose((()=>{n&&(n.unbind(),n=null)})))},t.traceInvocationChange=function(e,t,s,o,i,r){n.isDesktopTraceEnabled&&e.verbose(`[BladeOpener] ${t}\n Master Identifier: ${o.masterModelId}.\n  Master Property: ${i.source.property}\n  Master Value: ${void 0!==r?ko.toJSON(r):"<undefined>"}.\n  Current Detail Blades from Container: ${s.get(l.Finder).findSiblingBlades(o.referenceComposition).map((e=>`\n    ${e.toString()}. Model: ${ko.toJSON(e.getInputsOnlyViewModel())}`)).join("")||"<None>"}`)}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(e,t,s){"use strict";var o;return function(t){const o=MsPortalFx.Base.Diagnostics.createLog(e);let i;!function(e){const t={invalidNewValue:"[DynamicSelectionTransformer] [{0}] Source value does not implement MsPortalFx.ViewModels.DynamicSelection. Transformer Args: '{1}'"},i={invalidNewValue:"[ManyToOneTransformer] [{0}]: Source value '{1}' must be an array."},n={invalidPropertyChange:"[OneToManyMergeTransformer] [{0}]: No property change detected on source. Transformer Args: '{1}'.",invalidNewValue:"[OneToManyMergeTransformer] [{0}]: Source cannot be an array. Transformer args: '{1}'",invalidCurrentValue:"[OneToManyMergeTransformer] [{0}]: Target value '{1}' must be an array."};e.getDynamicSelectionMapper=function(){return e=>{if(function(e){const s=e.propertyChanges||[],i=1===s.length&&s[0].propertyValue,n=(i||{}).hasOwnProperty("detailBladeInputs");return i&&!n&&o.error(t.invalidNewValue.format(e.sourceModelId,JSON.stringify(e))),n}(e)){const t=e.propertyChanges[0],s=t.propertyValue;t.propertyValue=s.detailBladeInputs}}},e.getModelToPropertyMapper=function(){return e=>{let t,o;const i=e.propertyChanges||[];if(1===i.length&&MsPortalFx.isPlainObject(i[0].propertyValue))for(o in t=e.propertyChanges[0].propertyValue,e.propertyChanges=[],t)t.hasOwnProperty(o)&&e.propertyChanges.push(s.ObservableChangeArgs.forObject(o,t[o]))}},e.getManyToOne=function(){return e=>{const t=ko.unwrap(s.getModelValue(e.sourceModel,e.sourceProperty).value)||[];let n;!function(e,t){let s=!0;return Array.isArray(t)?1!==t.length&&(s=!1):(o.error(i.invalidNewValue.format(e.sourceModelId,JSON.stringify(t))),s=!1),s}(e,t)?e.cancel=!0:(n=e.propertyChanges[0],n.kind=0,n.propertyValue=t[0],n.propertyArrayEdits=null)}},e.getOneToManyMerge=function(){let e=null;return t=>{const i=ko.unwrap(s.getModelValue(t.targetModel,t.targetProperty).value);let r,a,l;const c=function(e,t){return MsPortalFx.findIndex(e,(e=>MsPortalFx.deepEquals(e,t)))};(function(e,t){let s=!0;return!t||!t.propertyChanges||t.propertyChanges.length<1?(o.error(n.invalidPropertyChange.format(t.sourceModelId,JSON.stringify(t))),s=!1):Array.isArray(t.propertyChanges[0].propertyValue)||t.propertyChanges[0].propertyArrayEdits&&t.propertyChanges[0].propertyArrayEdits.length>0?(o.error(n.invalidNewValue.format(t.sourceModelId,JSON.stringify(t))),s=!1):Array.isArray(e)||(o.error(n.invalidCurrentValue.format(t.sourceModelId,e)),s=!1),s})(i,t)&&(a=void 0===e?-1:c(i,e),r=t.propertyChanges[0],l=ko.unwrap(r.propertyValue),r.propertyArrayEdits=[],r.kind=1,a>=0&&e!==l&&r.propertyArrayEdits.push({status:"deleted",index:a,moved:null,value:e}),void 0!==l&&-1===c(i,l)&&r.propertyArrayEdits.push({status:"added",index:0,moved:null,value:l}),e=l),t.cancel=!r||!r.propertyArrayEdits||!r.propertyArrayEdits.length}}}(i=t.PropertyTransformers||(t.PropertyTransformers={}))}(o||(o={})),o})),
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionBinder=t.onInputsSetTimeout=void 0;var a=FxImpl.TelemetryContext,l=MsPortalFx.Base.Diagnostics,c=s.ReferenceScope;t.onInputsSetTimeout=5e3;const d=MsPortalFx.trace,p=d.inputsset,u=d.shellinputsset,m=l.createLog(e),h=s.extractTraceOptions,g=s.ReferenceCardinality;function f(e){let t=Promise.resolve();return{getStateAsyncSequenced:()=>(t=t.then(e,e),t)}}var x;!function(e){function l(e,t,o,i,n){const a=(s,i)=>{const n=o.mapProperty(s.source.property,s.targetProperty);n.transformers=function(e){const t=[];e.source.cardinality===g.OneToMany?t.push(r.PropertyTransformers.getOneToManyMerge()):e.source.cardinality===g.ManyToOne&&t.push(r.PropertyTransformers.getManyToOne());e.opensDynamicBlades&&t.push(r.PropertyTransformers.getDynamicSelectionMapper());e.targetProperty||t.push(r.PropertyTransformers.getModelToPropertyMapper());return t}(s),n.compositionBindingDefinition=s,i?n.bind(i.sourceModelName,i.sourceModel):k(e,t,n)};i&&i.forEach((e=>{const t=n&&n(e),i=e.source.constantValue;if(t&&t.overridesConstantBindings)a(e,t);else if(void 0!==i){const t="[Constant: {0}]".format(ko.toJSON(i)),n={};s.setModelValue(n,e.source.property,i);const r=o.mapProperty(e.source.property,e.targetProperty);r.compositionBindingDefinition=e,r.bind(t,n)}else a(e,t)}))}function d(e,t,s){return MsPortalFx.mapMany(e,(e=>(e.valuesFrom||[]).map((i=>{const n={property:i.property,modelType:i.referenceType,constantValue:i.constantValue,scope:c.CurrentContainer,cardinality:e.valuesFrom.length>1?g.OneToMany:g.OneToOne},r={targetProperty:e.property,source:n,optional:!!e.optional,isIdentityInput:!!e.isIdentityInput},a=i.part,l=t.locator.name;return(0===i.referenceType||i.partCommand)&&(n.partLocator=t.locator.getExtensionLocator().withPartInstance(a||l),!(0,o.isPartComposition)(t)||a&&a!==l||(n.id=t.id)),4===i.referenceType&&(n.modelId=i.bladeCommand||i.partCommand),s&&s(r,i),r}))))}function x(e,t){let s=!1;return(0,o.isPartComposition)(e)&&!e.isDisposed()&&(s=t.id?e.id===t.id:e.eligibleForBinding&&e.locator.getExtensionLocator().withPartInstance(e.locator.name).equals(t.partLocator)),s}function b(e,t){const o=[],i={allInputsSet:ko.observable(!1),calledOnInputsSet:ko.observable(!1),failedOnInputsSet:ko.observable(!1),definitionBindings:[],propertyBindings:new s.PropertyBindings(t.bindableTarget.viewModelName,{},!1)};return M(t.referenceComposition,t.inputs,o,t.customInputBindingValidator)?(i.definitionBindings=d(t.inputs,t.referenceComposition),l(e,t.referenceComposition,i.propertyBindings,i.definitionBindings,t.customBindHandler),i.inputsWatcherConfig=y({bindableTarget:t.bindableTarget,allInputsSet:i.allInputsSet,calledOnInputsSet:i.calledOnInputsSet,failedOnInputsSet:i.failedOnInputsSet,propertyBindings:i.propertyBindings,referenceComposition:t.referenceComposition,referenceCompositionIsContainer:t.referenceCompositionIsContainer,notifyWhenInputsChangeWithSameValues:!1,beforeViewModelPropertyUpdate:t.beforeViewModelPropertyUpdate,inputsSetCalled:t.inputsSetCalled})):m.error("{0} Reference: {1}.".format(JSON.stringify(o),t.bindableTarget.viewModelName)),i}function y(e){return MsPortalFx.extend2(e,{propertyBindingsState:void 0,inputsSetTrace:p,shellInputsSetTrace:u,stateReader:!!e.getStateAsync&&f(e.getStateAsync)})}function v(e){let s;P(e,null,e.calledOnInputsSet()),e.allInputsSet()||(s=function(e){const s={handle:setTimeout((()=>{T(s);const t=[],o=[];e.properties.forEach((e=>{const s=F(e),i="Target Input Name: {0} \nSource Model Name: {1} \nSource Property Name: {2} \nOptional: {3}".format(e.targetProperty,e.isBound?e.sourceModelName():"<UNBOUND>",e.isBound?e.sourceProperty:"<UNBOUND>",s);e.targetHasValue||s?o.push(i):t.push(i)}));const i="onInputsSet is taking more time than expected for target model: {0}\n=== Missing Required Properties === \n{1}\n\n=== All Other Properties === \n{2}";m.warning(i.format(e.targetModelName,t.join("\n\n"),o.join("\n\n")))}),t.onInputsSetTimeout)};return s}(e.propertyBindings),e.referenceComposition.onDispose((()=>{T(s)})));const o=e;o.onInputsSetDiagnosticsHandle=s,e.propertyBindings.addPropertyChangedHandler((()=>{o.onInputsSetCallsSuppressed||P(e,s)}))}function M(e,t,s,i){let n;const r=(0,o.isPartComposition)(e);return t&&t.some((e=>(e.property?e.valuesFrom&&1===e.valuesFrom.length?r||0!==e.valuesFrom[0].referenceType||e.valuesFrom[0].part?5===e.valuesFrom[0].referenceType&&void 0===e.valuesFrom[0].constantValue?n="'constantValue' must be defined if using 'Constant' reference type.":void 0!==e.valuesFrom[0].constantValue&&5!==e.valuesFrom[0].referenceType?n="'constantValue' can only be be defined when using 'Constant' reference type.":i&&(n=i(e)):n="Input binding that reference a Part must specify the source part name.":n="Input binding must define one and only one source valueFrom property.":n="Input binding must define a target property.",n||4!==e.valuesFrom[0].referenceType||(e.valuesFrom[0].bladeCommand||e.valuesFrom[0].partCommand?e.valuesFrom[0].bladeCommand&&e.valuesFrom[0].partCommand?n="Only one, 'bladeCommand' or 'partCommand' is allowed when using 'Command' reference type.":e.valuesFrom[0].part&&(n="'part' is not allowed when using 'Command' reference type."):n="'bladeCommand' or 'partCommand' is required if using 'Command' reference type."),!!n))),!n||(s.push(n),!1)}function C(e,t){const o=(...e)=>"| "+e.map((e=>(e.toString()+"                    ").slice(0,15))).join("");let i=["┌-----------",o("Optional","isBound","hasValue","Input: Value")];const n=t.properties.map((e=>"{0}{1}: {2}".format(o(F(e),e.isBound,e.targetHasValue),e.targetProperty,ko.toJSON(e.targetHasValue?s.getModelValue(t.targetModel,e.targetProperty).value:void 0))));i=i.concat(n),i.push("└-----------"),m.verbose("{0} Target Model: {1}\n{2}".format(e,t.targetModelName,i.join("\n")))}function P(e,t,s,o,i,n){return w(e,t,s,!0,o).then((function(t){let s;return t&&(t.dontCallViewModelOnInputsSet=i,a.usingState((()=>{s=function(e,t){const s=e.bindableTarget.viewModel,{inputs:o,settings:i,traceOptions:n,viewModelName:r,inputsMetadata:a,dontCallViewModelOnInputsSet:l,dashboardFilters:c,partFilters:d}=t,p=s.updatePartInputValues(o,i,n,r,a,l,{dashboard:c||{},part:d});return S(e,t,p),p}(e,t)}),e.referenceComposition.getCreationState())),n?s:void 0}))}function w(e,t,s,o,i){const n=!e.propertyBindings.properties.some(_),r=h(e.bindableTarget.viewModelName,e.inputsSetTrace),a=r&&r.verbose;if(!n)return a&&C("onInputsSet not called, missing required properties.",e.propertyBindings),e.propertyBindingsState=void 0,Promise.resolve(null);const l=ko.toJS(e.propertyBindings.targetModel);if(!o&&!MsPortalFx.canSendThroughPostMessage(l))return e.propertyBindingsState=void 0,Promise.resolve(null);if(T(t),!s&&e.notifyWhenInputsChangeWithSameValues||i||!MsPortalFx.deepEquals(l,e.propertyBindingsState)){let t;return e.allInputsSet(!0),e.propertyBindingsState=l,t=e.beforeViewModelPropertyUpdate?MsPortalFx.tryImmediateResolve(e.beforeViewModelPropertyUpdate(l),(t=>{if(t)return I(e,r);a&&C("onInputsSet not called, RBAC check failed.",e.propertyBindings)})):I(e,r),MsPortalFx.tryImmediateResolve(e.getInputsMetadata&&e.getInputsMetadata()||Promise.resolve({}),(s=>MsPortalFx.tryImmediateResolve(t,(t=>{const o={inputs:l,settings:t,traceOptions:r,viewModelName:e.bindableTarget.viewModelName,inputsMetadata:s,dontCallViewModelOnInputsSet:void 0,dashboardFilters:e.getDashboardFilters&&e.getDashboardFilters(),partFilters:e.getPartFilters&&e.getPartFilters()};return function(e,t){const{inputs:s,settings:o}=t,i=t.traceOptions;if(o&&(!e.referenceComposition||!e.referenceComposition.isDisposed())){const t=e.bindableTarget.viewModelName,n=h(t,e.shellInputsSetTrace);return i&&i.verbose&&C("onInputsSet will be called, all required properties are set.",e.propertyBindings),n&&(m.verbose("Invoking onInputsSet of view model '{0}'.\nInputs: {1}.\nSettings: {2}".format(t,ko.toJSON(s),ko.toJSON(o))),n.breakOnInputsSet),!0}return!1}(e,o)?o:null}))))}return a&&C("onInputsSet not called, new values are the same as current values.",e.propertyBindings),Promise.resolve(null)}function I(e,t){const s=e.referenceComposition;if(!s||!s.isDisposed()){const s=e.bindableTarget;if(!s.viewModel||s.viewModel.updatePartInputValues){const s=e.stateReader;return s?s.getStateAsyncSequenced().then((e=>e||{}),(()=>{t&&t.verbose&&C("onInputsSet not called, failed to retrieve part settings.",e.propertyBindings),e.failedOnInputsSet(!0)})):Promise.resolve({})}}return Promise.resolve(null)}function S(e,t,s){e.calledOnInputsSet(!0),e.inputsSetCalled&&e.inputsSetCalled(t.inputs,s||Promise.resolve({}))}function _(e){return!e.targetHasValue&&!F(e)}function F(e){const t=e.compositionBindingDefinition,s=t&&t.optional,o=t&&t.source,i=o&&o.scope===c.DetailsContainer;return!!(s||i)}function T(e){e&&e.handle&&(clearTimeout(e.handle),e.handle=null)}function k(e,t,s){if(t&&!t.isDisposed()){const o=function(e,t,s){const o=e.get(n.Finder),i=o.findPartsContainer(t);let r;switch(s.scope){case c.MasterContainer:r=i.masterContainer;break;case c.DetailsContainer:{const e=o.findBlades(i).filter((e=>e&&!(2&e.flags)));e.length>1?m.error("Unable to bind composition to detail blade, multiple detail blades found. Reference Composition: '{0}', Detail Blades: '{1}'.".format(t.toString(),e.map((e=>e.toString())).join(","))):r=e[0];break}default:r=i}return r}(e,t,s.compositionBindingDefinition.source);D(o,s,s.compositionBindingDefinition.source)(e,t,o,s,s.compositionBindingDefinition.source)}}function D(e,t,s){return e?s.partLocator?4===s.modelType&&t.compositionBindingDefinition.source.scope!==c.MasterContainer?A:B:N:E}function E(e,t,s,o,i){const r=e.get(n.Finder).findPartsContainer(t);MsPortalFx.tryImmediateResolve(r.awaitContainer(t,(e=>function(e,t,s){const o=t.masterContainer;if(t.isDisposed())return!1;if(1!==t.locator.type)return!1;if(s.scope===c.MasterContainer)return e.masterContainer&&e.masterContainer.id===t.id;if(s.scope===c.DetailsContainer){const t=e.diContainer.get(n.Finder);return o&&o.id===e.id&&1===t.findBlades(e).length}return o&&o.id===e.id}(r,e,o.compositionBindingDefinition.source))),(s=>{D(s,o,o.compositionBindingDefinition.source)(e,t,s,o,o.compositionBindingDefinition.source)}))}function B(e,t,s,o,i){MsPortalFx.tryImmediateResolve(s.awaitComposedPart(t,(e=>x(e,i))),(s=>{R(e,t,s,o)}))}function A(e,t,s,o,i){R(e,t,t,o)}function N(e,t,s,o,i){R(e,t,s.getBindableContainer(),o)}function R(e,t,i,n){const r=n.compositionBindingDefinition.source,a=r.modelType,l=r.modelId,c="[Composition: {0}, ModelType:{1}, ModelId:{2}]".format(i.toString(),a,l||"<null>");if(1===a||8===a){const e=i.getViewModel(a,l);n.bind(c,e)}else{const e=e=>{i.isDisposed()||n.bind(c,e)};try{const t=i.getViewModel(a,l);s.getModelValue(t,n.sourceProperty).exists&&e(t)}catch{}n.isBound||i.getViewModelAsync(a,l).then(e,(()=>{t.isDisposed()||m.error("Failed to retrieve view model type '{0}' with id '{1}' from composition '{2}' to bind source property '{3}'.".format(o.referenceTypeMap[a]||a,l||"<none>",i.toString(),n.sourceProperty))}))}const d=()=>{n.unbind(),i.offDispose(p)},p=()=>{n.unbind(),n.compositionBindingDefinition.autoRebindWhenSourceDisposes&&k(e,t,n),t.offDispose(d)};i.onDispose(p),t.onDispose(d)}e.setupPropertyBindings=l,e.modelHasProperties=function(e,t,o){const i=(t||[]).every((e=>o&&s.getModelValue(o,e).exists));return i||m.error("Model '{0}' is missing properties. Expected properties:'{1}', model:'{2}'".format(e,JSON.stringify(t)||"<null>",JSON.stringify(ko.toJS(o))||"<null>")),i},e.modelHasPropertiesWithValue=function(e,t,o){const i=(t||[]).every((e=>{const t=o&&s.getModelValue(o,e);return t&&t.exists&&void 0!==ko.unwrap(t.value)}));return i||m.error("Model '{0}' is missing required properties or has them set to undefined. Required properties:'{1}', model:'{2}'".format(e,JSON.stringify(t)||"<null>",JSON.stringify(ko.toJS(o))||"<null>")),i},e.createObservableModel=function(e){const t={};for(const s in e)if(e.hasOwnProperty(s)){const o=ko.toJS(e[s]);t[s]=Array.isArray(o)?ko.observableArray(o):ko.observable(o)}return t},e.mapInputBindingDefinitions=d,e.bindingsFromJSON=function(e,t){return(t||[]).forEach((t=>{const s=t.source,o=s&&s.partLocator;o&&(s.partLocator=i.Locator.fromJSON(e,o))})),t},e.mapBindingsToFriendlyObjects=function(e){return(e||[]).map((e=>{const t={targetProperty:e.targetProperty};return e.source&&(t.sourceProperty=e.source.property,t.sourcePartLocator=e.source.partLocator&&e.source.partLocator.toString(),t.sourceType=o.referenceTypeMap[e.source.modelType]||e.source.modelType,t.sourceScope=c[e.source.scope],t.sourceCardinality=g[e.source.cardinality]),t}))},e.isSourcePart=x,e.bindViewModelInputs=function(e,t){const s=b(e,t);return s.inputsWatcherConfig&&v(s.inputsWatcherConfig),s},e.createBindViewModelResult=b,e.setupAllInputsSetWatcher=function(e){v(y(e))},e.createAllInputsSetWatcherConfigExtended=y,e.setupAllInputsSetWatcherFromExtendedConfig=v,e.validateInputBindings=M,e.callOnInputsSetIfNeeded=P,e.turnOnInputsSetSuppressionOn=function(e){e.onInputsSetCallsSuppressed=!0},e.turnOnInputsSetSuppressionOff=function(e,t=1,s=!1){const o=e;return o.onInputsSetCallsSuppressed=!1,P(e,o.onInputsSetDiagnosticsHandle,!!(1&t),!!(2&t),!!(4&t),s)},e.loadOnInputsSetParameters=w,e.notifyOnInputsSetCalled=S}(x||(t.CompositionBinder=x={}))})),
define("MsPortalImpl/UI/Commands/UI.ExtensionCommands",["require","exports","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.JourneyManager","FxInternal/AsyncLoader"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setBladeOpenerModule=t.ExtensionCommandImplOptions=t.CompositionInstanceCommandContext=t.getCommandSourceTelemetryContext=t.createExtensionCommand=void 0;var f=MsPortalFx.Base,x=f.Diagnostics,b=x.Telemetry,y=FxImpl.TelemetryContext,v=f.Resources,M=MsPortalFx.Hubs.Notifications.NotificationStatus,C=MsPortalFx.ViewModels.Dialogs,P=a.CompositionType,w=c.CompositionBinder,I=d.ReferenceScope,S=f.Net2;const _=window,F=x.createLog(e),T=MsPortalFx.isNullOrUndefined,k=MsPortalFx.uncurryThis(Array.prototype.forEach);let D=null;const E={invocationInputArguments:[{valuesFrom:[{referenceType:4,property:"container.selectable"}]}]},B=n.FileDownloadCommand,A=n.UriCallbackCommand,N=412;function R(e,t,s,o){let i;return t.lc2?i=new X(e,s,o):t.viewModel?i=new J(e,s,o):t.execute?i=new H(e,s,o):t.navigateUriCallback?i=new q(e,s,o):t.navigateUri?i=new U(e,s,o):t.listItems?i=new $(e,s,o):t.targetUri&&t.httpMethod?i=new K(e,s,o):(o.commandItem.commandDefinition.details||t.bladeName)&&(i=new Q(e,s,o)),i}function L(e){const t=e;let s=null;if(!(e instanceof O))throw new Error("Command context was not an instance of CompositionInstanceCommandContext. All context objects are expected to be of that type.");const o=t.compositionInstance,i=o&&o.locator;return i&&(s={id:i.toFriendlyString(),instanceId:o.instanceId}),s}t.createExtensionCommand=R,t.getCommandSourceTelemetryContext=L;class O extends r.CommandContext{constructor(e,t,s){super(e,t),this.compositionInstance=s}}t.CompositionInstanceCommandContext=O;t.ExtensionCommandImplOptions=class{};class z{constructor(e,t,s){this._extension=s.extension,this._viewModelName=s.viewModelName,this.viewModel=t,this.commandItem=s.commandItem,this._commandContainer=s.container;const o=this._ltm=e.createChildLifetime();this._propertyBindings=s.propertyBindings,this._diContainer=s.diContainer;const n=s.diContainer.get(i.ViewModelManager);o.registerForDispose((()=>{this.viewModel&&(n.releaseViewModel(this.viewModel),this.viewModel=null),this._propertyBindings&&(this._propertyBindings.unbind(),this._propertyBindings=null)}))}init(){}execute(e,t){const s=this._diContainer.get(h.JourneyManager).activeJourney(),o=L(this._context());y.setContextValue(y.ContextType.Blade,o),b.trace({extension:this._extension.name,source:o&&o.id,action:"CommandExecuted",name:this._viewModelName,data:e,journeyId:s&&s.id})}dispose(){this._ltm.dispose()}_context(){return this.commandItem.getCommandContext()}_getFormTarget(){return this._context().getFormTarget()}_target(){const e=this._context();return e&&e.target}}class H extends z{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this._diContainer.get(u.DesktopManagerMode).value.subscribe(this._ltm,(e=>{this._getFormTarget().then((t=>{1===e&&t&&t.hideForm()}))}))}execute(e,t){super.execute(e,t);const s=this._viewModel;1===s.status()?Promise.all([this._diContainer.getAsync(m.DialogManager),this._getFormTarget()]).then((([e,t])=>{this._loadDialog(t,e,ko.unwrap(s.dialog))})):s.status(1),s.execute(t)}init(){const e=this._viewModel,t=this._ltm,s=(e,t,s)=>{0===s?e.hideForm():1===s&&this._loadDialog(e,t,ko.unwrap(this._viewModel.dialog))},o=(e,t,s)=>{1===this._viewModel.status()&&this._loadDialog(e,t,s)};this._diContainer.getAsync(m.DialogManager).then((i=>{e.status.subscribe(t,(e=>{this._context()&&this._getFormTarget().then((t=>{s(t,i,e)}))})),ko.isObservable(e.dialog)&&e.dialog.subscribe(t,(e=>{this._getFormTarget().then((t=>{o(t,i,e)}))}))}))}_loadDialog(e,t,s){if(e&&!(MsPortalFx.deepEquals(this._currentDialogOptions,s)&&t.hasOpenDialog||(t.hasOpenDialog||(this._previouslyFocusedElement=document.activeElement),this._currentDialogOptions=s,T(s)))){if(!this._target())return;const o=this._commandContainer.locator,i=o&&o.withCommand(this.commandItem.commandName),n=t.hasOpenDialog&&this._previouslyFocusedElement?this._previouslyFocusedElement.contains(this._target())?this._target():this._previouslyFocusedElement:this._target();this.commandItem.pressed(!0),t.showDialog(s,e,n,{locator:i}).then((e=>{this.commandItem.pressed(!1);const t=this._viewModel,s=t&&t.dialogClick;"function"==typeof s&&s.call(t,e)}))}}}class U extends z{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this.canSkipBladeValidation=!0}execute(e){const t=this._viewModel,s=t.navigateTarget?t.navigateTarget():"_blank";super.execute(e),_.open(t.navigateUri(),s)}}class W extends z{constructor(e,t,s){super(e,t,s),this.canSkipBladeValidation=!0}_getLocator(){const e=this._commandContainer.locator;return e&&e.withCommand(this.commandItem.commandName)}_showUriCbProgressDlg(e,t,s){this._showProgressDlg(e,t,this._uriCbProgressTitle,this._uriCbProgressText,s)}_showDownloadProgressDlg(e,t,s){this._showProgressDlg(e,t,this._progressTitle,this._progressText,s)}_showProgressDlg(e,t,s,o,i){const n=new C.ProgressBox(s,o);t.showDialog(n,e,this._target(),{locator:this._getLocator()})}_getResources(e){const t=e.uriCallbackConfirmationDialogOptions||{},s=e.downloadProgressDialogOptions||{};this._uriCbProgressTitle=t.uriCallbackProgressTitle||B.uriCallbackProgressTitle,this._uriCbProgressText=t.uriCallbackProgressText||B.uriCallbackProgressText,this._dnldTitle=t.downloadTitle||B.downloadTitle,this._dnldText=t.downloadText||B.downloadText,this._defaultBtnText=t.defaultButtonText||B.defaultButtonText,this._cancelBtnText=t.cancelButtonText||B.cancelButtonText,this._progressTitle=s.downloadProgressTitle||B.downloadProgressTitle,this._progressText=s.downloadProgressText||B.downloadProgressText}}function V(e,t){const s=t&&t.title,o=t&&t.description;e.getAsync(g.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((e=>{e.addClientNotification({title:s||A.uriCallbackCommandError,description:o||A.error,status:M.Error,timestamp:new Date})}))}function j(e,t,o){const i=s.sanitizeLinkUri(e,o);i?_.open(i,t):(F.error(A.invalidUri.format(e)),V(o.diContainer))}class q extends W{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this._getResources(this._viewModel),this.canSkipBladeValidation=!0}execute(t){super.execute(t);const o=this._viewModel.navigateTarget?this._viewModel.navigateTarget():"_blank",i=this._viewModel,n=i.navigateUriCallback&&i.navigateUriCallback(),r=this.commandItem.fxEnabled,a=i.showUriCallbackConfirmationDialog&&i.showUriCallbackConfirmationDialog(),l=e=>{e.hideForm(),r(!0)};let c,d=!0;const p={localRequire:e,windowContext:this._extension.name,diContainer:this._diContainer};n&&a?(r(!1),Promise.all([this._diContainer.getAsync(m.DialogManager),this._getFormTarget()]).then((([e,s])=>(this._dlgMgr=e,this._showUriCbProgressDlg(s,e,t),Promise.resolve(i.navigateUriCallback()()).then((t=>{d=!1;const i=new m.MessageBox(this._dnldTitle,this._dnldText,2);i.defaultButtonText=this._defaultBtnText,i.cancelButtonText=this._cancelBtnText,e.showDialog(i,s,this._context().target,{locator:this._getLocator(),syncCallback:e=>{4===e&&j(t,o,p),l(s)}}),s.showForm(this._target())}),(e=>{V(this._diContainer,e)})).finally((()=>{d&&(F.error(A.callbackError.format("navigateUriCallback failed.")),c&&c.close(),this._dlgMgr&&this._dlgMgr.dismissOpenDialog(),l(s))}))))).catch((e=>{F.error(e)}))):n?(r(!1),c=_.open("about:blank",o),Promise.resolve(n()).then((e=>{d=!1,s.sanitizeUri(e,null,p)?c.location.href=e:(F.error(A.invalidUri.format(e)),V(this._diContainer),c.close())}),(e=>{V(this._diContainer,e)})).finally((()=>{d&&(F.error(A.callbackError.format("navigateUriCallback failed.")),c.close()),this._getFormTarget().then((e=>{l(e)}))}))):j(i.navigateUri(),o,p)}}class $ extends z{constructor(e,t,s){super(e,t,s);const o=this._ltm,i=this.commandItem,n=t.content(),r=i.widgetViewModel.dialogOptions;ko.reactor(o,(()=>{r.listItems(n.listItems())})),n.selectedItem.subscribe(o,(e=>{r.selectedItem(e)})),r.selectedItem(n.selectedItem()),i.hasPopup(!0),r.selectedItem.subscribe(o,(e=>{n.selectedItem(e)})),this.canSkipBladeValidation=!0}execute(e){super.execute(e)}}function G(e,t,s,o){T(e)||"function"!=typeof e||!o&&T(e())||function(e,t){F.warning("The '"+e+"' property of a command viewModel contains a value. This value will be ignored when passing to '"+t+"' dynamic command viewModel.")}(t,s)}class K extends W{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this._getResources(this._viewModel),o.isSafari&&o.webKitVersion<o.safari_11_webKitVersion&&(this.commandItem.fxEnabled(!1),this.commandItem.tooltip(n.FileDownloadCommand.safariDownload)),this.canSkipBladeValidation=!0}execute(e){super.execute(e);let t=null;const s=this.commandItem.fxEnabled;s()&&f.Promises.cancelOnDispose(this._ltm,MsPortalFx.require("MsPortalImpl/Commands/FileDownloadUtil")).then((o=>{const i=this._viewModel,n=o.getHttpMethod(i),r=e=>{e.hideForm(),s(!0)};if(!n)return o.notifyError(i,N,B.typeError),void this._getFormTarget().then((e=>{r(e)}));s(!1),i.downloadStatus(null);const a=this._diContainer.getAsync(m.DialogManager),l=this._getFormTarget(),c=Promise.all([a,l]).then((([t,s])=>this._getUri(s,t,e)));return Promise.all([a,c,l]).then((([s,r,a])=>{const l=r&&r.startsWith("data:");if(!v.isUriAbsolute(r)&&!l)return void o.notifyError(i,N,B.absoluteUriError);i.showDownloadProgressDialog&&i.showDownloadProgressDialog()&&this._showDownloadProgressDlg(a,s,e);const c=L(this._context());if(t=b.startTrace({extension:this._extension.name,source:c&&c.id,action:"StartFileDownload",name:this._viewModelName,data:e}),!l)return S.ajaxExtended(o.getAjaxOptions(i,r,n)).then((e=>{if(this.viewModel){const n=e.content,r=n&&n.length?n.length:0;return o.onSuccess(i,s,n,e.textStatus,e.jqXHR).then((()=>{b.completeTrace(t,r)}))}}),(e=>(o.onError(i,s,e.textStatus,e.jqXHR.status,e.errorThrown),b.cancelTrace(t),Promise.reject(e.errorThrown))));o.dataUriHandler(i,s,r)})).catch((e=>{e&&F.error(e),b.cancelTrace(t)})).finally((()=>{l.then((e=>{r(e)}))}))})).catch((e=>{e&&F.error(e)}))}_getUri(e,t,s){const o=this._viewModel,i=o.targetUriCallback&&o.targetUriCallback(),n=o.showUriCallbackConfirmationDialog&&o.showUriCallbackConfirmationDialog();return f.Promises.cancelOnDispose(this._ltm,MsPortalFx.require("MsPortalImpl/Commands/FileDownloadUtil")).then((r=>{if(i)return n&&this._showUriCbProgressDlg(e,t,s),Promise.resolve(i()).then((s=>{if(!s)return Promise.reject(B.uriError);if(n){const o=new m.MessageBox(this._dnldTitle,this._dnldText,2);o.defaultButtonText=this._defaultBtnText,o.cancelButtonText=this._cancelBtnText;return t.showDialog(o,e,this._target(),{locator:this._getLocator()}).then((e=>4===e?s:Promise.reject()))}return r.dismissDialog(t,o),s})).catch((e=>{r.dismissDialog(t,o);let s=null;return e&&(s=o.errorMessage()||"{0} {1}".format(B.downloadTargetUriCallbackFailed,e),r.notifyError(o,N,s)),Promise.reject(s)}));{const e=o.targetUri&&o.targetUri();return e||(r.notifyError(o,N,B.uriError),Promise.reject(B.uriError))}}))}}class J extends z{constructor(e,t,s){super(e,t,s),this._container=s.container,this._viewModel=t.content(),this._selectionInList=s.selectionInList;const o=this._ltm;let i;this._viewModel.viewModel.subscribeAndRun(o,(e=>{i&&i.dispose(),i=o.createChildLifetime();let t=this._nestedCommand;if(t&&(t.dispose(),this._nestedCommand=void 0),e){const s=this.viewModel,o={container:this._container,extension:this._extension,viewModelName:this._viewModelName,commandItem:this.commandItem,propertyBindings:null,diContainer:this._diContainer,selectionInList:this._selectionInList};this.commandItem.commandDefinition.details=E,function(e,t){const s=e;k(["text","icon","enabled"],(e=>{G(s[e],e,t)})),G(s.onInputsSet,"onInputSet",t,!0)}(e,this._viewModelName);const n=MsPortalFx.clone(s);n.content=ko.observable(e);const r=e;r.bladeName&&n.container.selectable.selectedValue({detailBlade:r.bladeName,detailBladeInputs:r.bladeInputs}),t=this._nestedCommand=R(i,e,n,o),t.init(),this.canSkipBladeValidation=t.canSkipBladeValidation}}))}execute(e){super.execute(e),this._nestedCommand?this._nestedCommand.execute(e):F.error("The nested command is missed for the {0} dynamic command.".format(this._viewModelName))}dispose(){this._nestedCommand&&this._nestedCommand.dispose()}}class Q extends z{getBladeOpener(){if(this._ltm){const e=this._ltm;return this._bladeOpenerPromise||(D=D||MsPortalFx.require("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener"),this._bladeOpenerPromise=D.then((t=>{const s=this._options,o=new t.BladeOpener(this._diContainer,this._getBladeOpenerConfig(s.container,s.extension));return o.registerInvocationProperty(this.commandItem.commandDefinition.details),e.registerForDispose(o),o}))),this._bladeOpenerPromise}return Promise.reject(new MsPortalFx.Errors.DisposedCanceledError)}constructor(e,t,s){super(e,t,s),this._addedOutputPropertyBindings=[],this._outputBindingDefinitions=[],this._viewModel=t,this._containerViewModel=t.container,this._options=s;const o=this.commandItem.commandDefinition;this._commandInstanceId=s.selectionInList?MsPortalFx.newGuid():void 0;const i=function(e){let t;return e.name?e.details||(t="OpenBladeCommand must provide a details blade definition."):t="OpenBladeCommand must provide a command name.",t&&F.error("{0} Command: '{1}'. CommandDefinition: '{2}'.".format(t,e.name,JSON.stringify(e))),!t}(o),n=o.details,r=this._validateDetailsDefinition(n);i&&r?(this._outputBindingDefinitions=w.mapInputBindingDefinitions(n.outputArguments||[],s.container,(e=>{e.source.scope=I.DetailsContainer})),this.getBladeOpener()):s.commandItem.setEnabled(!1),this.canSkipBladeValidation=!0}execute(e){super.execute(e),this.getBladeOpener().then((e=>{if(!e||this._ltm&&!this._ltm.isDisposed()){const e=this._containerViewModel,t=e&&e.selectable;t?t.isSelected(!0):F.error("OpenBladeCommand '{0}' from extension '{1}' was not initialized with a Selectable.".format(this.commandItem.commandDefinition.name,this._extension.name))}}))}_getBladeOpenerConfig(e,t){const s=this.commandItem.commandDefinition.details,o=!!s&&!!s.parameterCollector,i=this._diContainer;return{diContainer:i,masterModelId:"{0}-[{1}-{2}]".format(e.toString(),"OpenBladeCommand",this.commandItem.commandDefinition.name),masterModel:this._viewModel,referenceComposition:e,referenceExtension:t,isBladeOpenedByMaster:t=>t.masterCommandName===this.commandItem.commandDefinition.name&&t.masterPartId===e.id&&t.masterCommandId===this._commandInstanceId,configureBindings:t=>{k(t,(t=>{const s=t.source;4===(s&&s.modelType)&&(s.modelId=this.commandItem.commandDefinition.name,a.isPartComposition(e)&&(s.partLocator=e.locator,s.id=e.id))}))},configureBladeDescriptor:t=>{t.masterCommandName=this.commandItem.commandDefinition.name,t.masterCommandId=this._commandInstanceId,t.masterCommandExtension=this._extension,t.masterPartId=e.id;const s=t.bindings;if(Array.isArray(s))for(let e=s.length-1;e>=0;e--){const i=s[e],n=i.source;if(4===(n&&n.modelType)){t.model[i.targetProperty]=ko.toJS(d.getModelValue(this._viewModel,n.property).value);const r=this.commandItem.sourceBindableContainer;!o&&r&&r.isPartListItem&&s.splice(e,1)}}},onBladeOpened:e=>{this._setCmdActivated(!0),e.onDispose((()=>{this._disposeOutputBindings(),this._setCmdActivated(!1)})),e.await(7).then((()=>{this._createOutputBindings(e)}))},getCloseOtherDetailBladesHandler:(t,s)=>{if(s.openInContextPane){const t=i.get(h.JourneyManager);if(e.getCompositionType()===P.StartboardPart){const e=t.activeJourney();return!e||e.isStartedWithContextBlade()?null:()=>t.tryDeactivateJourney()}if(!i.get(p.RightContextPane).opened.value)return()=>!0}return null}}}_createOutputBindings(e){k(this._outputBindingDefinitions,(t=>{const s=this._propertyBindings;if(s){const o=s.mapProperty(t.source.property,t.targetProperty).bind(e.toString()+"LaunchCommandOutputBinding",e.getViewModel());o.compositionBindingDefinition=t,this._addedOutputPropertyBindings.push(o)}}))}_disposeOutputBindings(){this._propertyBindings&&k(this._addedOutputPropertyBindings,(e=>{this._propertyBindings.removeProperty(e)})),this._addedOutputPropertyBindings.length=0}_validateDetailsDefinition(e){const t=[],s=l.validateDetailsDefinition(e,t,(e=>{let t;const s=e.invocationInputArguments;return e.isMultiple?t="Command cannot open multiple blades. isMultiple value must be false.":s&&4!==s[0].valuesFrom[0].referenceType&&(t="Command invocation argument reference type can only be of type Command."),t}));return t.length&&F.error("{0} Command: '{1}'. Details: '{2}'.".format(t[0],this.commandItem.commandDefinition.name,JSON.stringify(e))),s}_setCmdActivated(e){const t=this._commandContainer.getViewModel(),s=t&&t.container,o=s&&s.selectable;o&&o.isCommandSelected(e),this.commandItem.pressed(e)}}class X extends Q{constructor(e,t,s){super(e,t,s);const o=this._ltm,i=this.commandItem,n=t.content(),r=i.widgetViewModel.dialogOptions;ko.reactor(o,(()=>{r.listItems(n.listItems())})),n.selectedItem.subscribe(o,(e=>{r.selectedItem(e)})),r.selectedItem(n.selectedItem()),i.hasPopup(!0),r.selectedItem.subscribe(o,(e=>{n.selectedItem(e)}))}execute(e){super.execute(e)}}t.setBladeOpenerModule=function(e){D=Promise.resolve(e)}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Security",["require","exports","Fx/ResourceManagement","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.Permissions"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkPermission=t.checkPermissions=void 0;var r=FxImpl.TriggerableLifetimeManager,a=MsPortalFx.Base,l=a.Diagnostics,c=MsPortalFx.Extension.SetRequirement;const d=l.createLog(e),p=MsPortalFx.xor;function u(e,t,o,i,r,l){if(!e)return Promise.resolve(!1);let c;switch(e.assetId.sourceType){case 0:c=Promise.resolve(t[e.assetId.property]);break;case 1:c=m(e,t,o,i,r);break;case 2:c=m(e,t,e.assetType||o,e.extensionName||i,r)}return c.then((t=>{if(t=ko.unwrap(t),(c=s.ArmId.parse(t,!0))&&h[c.kind])return l=t,r.get(n.PermissionsManager).hasPermission(l,[e.action],a.Constants.Shell);throw a.Diagnostics.createIgnoreUnhandledRejectionError(`Asset ID not a resource ID, permissions not checked. Extension <${i}> : AssetType <${o}> : ID _REDACTED_`);var l,c}))}function m(e,t,s,n,a){const l="[getAssetIdFromPropertyProvider]:";return a.get(i.ManifestCache).getManifestAsync(n,"assetTypes").then((i=>{const c=MsPortalFx.find(i.assetTypes,(e=>e.name===s));if(!c)throw new Error(l+"Unknown extension Asset Type : "+s);const d=a.get(o.ViewModelManager);return d.getViewModel(n,c.propertyProviderServiceViewModelLocator||c.propertyProviderServiceViewModel,11).then((s=>{const o=new r;return o.registerForDispose((()=>{d.releaseViewModel(s)})),Q.fcall((()=>{const o=s.content(),i=o&&o.onInputsSet;if("function"==typeof i){const s=$.extend({providerKey:e.assetId.providerKey},t);return(i.call(o,s)||Promise.resolve()).then((()=>{const t=o.properties(),s=e.assetId.property,i=MsPortalFx.find(t,(e=>e.property===s));if(i)return i.value;throw new Error(l+"Can not find propertyDefinition for assetIdProperty: "+s)}))}throw new Error(l+"ViewModel.content.onInputsSet is not a function.")})).finally((()=>{o.dispose()}))}))}))}t.checkPermissions=function e(t,s,o,i,n,r,a){if(t&&t.length){if(void 0===c[s])return Promise.reject(FxImpl.createError("checkPermission: unexpected requirement: "+s));{const l=s===c.All;return t.reduce(((t,s)=>t.then((c=>{if(p(l,c))return t;{let t;if(0===s.permissionType){t=u(s,o,i,n,r,a)}else{if(1!==s.permissionType)throw new Error("unexpected permission.permissionType: "+s.permissionType);{const l=s;t=e(l.permissions,l.requirement,o,i,n,r,a)}}return t.catch((e=>(d.warning.call(d,e,1,["Failed check permissions:","compositionInfo:"+a,"reason: "+e].join("\n")),Promise.resolve(!0))))}}))),Promise.resolve(l))}}return Promise.resolve(!0)},t.checkPermission=u;const h={4:!0,6:!0,8:!0,3:!0,1:!0}})),
define("MsPortalImpl/Widgets/Widgets.CommandBarBase",["require","exports","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/UI.DialogManager"],(function(e,t,s,o){"use strict";var i;return function(e){var t=MsPortalFx.Base.Diagnostics.Telemetry;class i extends s.CommandImpl{constructor(e,t,s,o){const i=o&&o.commandName;super(e,t.label);const n=this._ltm;this._executeLifetime=o&&o.executeLifetime||n,this._model=t,this._locator=s,this.icon=ko.computed(n,{read:()=>{const e=ko.unwrap(this._model.icon);return e&&MsPortalFx.extend2(e,{options:$.extend({palette:99},e.options)})},write:this._model.icon}),this.commandName=i||MsPortalFx.getUniqueId(),this.enabled=ko.computed(this._executeLifetime,(()=>{const e=t,s=!t.disabled(),o=!e.command||e.command.canExecute();return s&&o})),ko.computed(n,(()=>{this.unauthorized(!!ko.unwrap(t.unauthorizedMessage))})),ko.computed(n,(()=>{let e=ko.unwrap(t.unauthorizedMessage);if(!e){const s=ko.unwrap(t.disabled);e="string"==typeof s?s:null}e=e||ko.unwrap(t.tooltip),this.tooltip(e)})),this.isSeparator=ko.observable(12===t.type)}get model(){return this._model}get type(){return this._model&&this._model.type}execute(e){t.trace({source:this._locator&&this._locator.toFriendlyString(),action:"CommandExecuted",name:this.model.name||"Toolbar name not specified",extension:this._locator&&this._locator.getExtensionName()}),super.execute(e)}}e.ItemViewModel=i;e.DialogButton=class extends i{constructor(e,t,s,o,i){super(e,t,s,i),this.hasOpenDialog=ko.observable(!1),this._diContainer=o;const n=t.dialogOptions;this.hasPopup(!!n&&4===n.type)}get dialogOptions(){return this._model.dialogOptions}execute(e){MsPortalFx.Base.Promises.cancelOnDispose(this._executeLifetime,Promise.all([this._diContainer.getAsync(o.DialogManager),this._currentContext.getFormTarget()]).then((([t,s])=>{if(this.hasOpenDialog())t.dismissOpenDialog(),this.hasOpenDialog(!1);else{const e=this._currentContext,o=e&&e.target,i=this._model;this.hasOpenDialog(!0),MsPortalFx.Base.Promises.cancelOnDispose(this._executeLifetime,t.showDialog(this.dialogOptions,s,o,{locator:this._locator})).then((e=>{this.hasOpenDialog(!1),i.command&&i.command.execute(e)}),(()=>{this.hasOpenDialog(!1)}))}super.execute(e)})))}}}(i||(i={})),i})),
define("MsPortalImpl/UI/Commands/UI.Commands",["require","exports","Fx/DependencyInjection","FxInternal","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBarBase","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createOpenLinkCommand=t.createOpenBladeCommand=t.ExtensionCommandMenuItemImpl=t.ExtensionMultiselectCommandMenuItemImpl=t.ExtensionCommandMenuItemBase=t.getCommandGroupForDefinitionItem=t.getBladeContainerWidget=t.getBladeContentWidget=t.getCommandSourceTelemetryContext=t.CompositionInstanceCommandContext=t.CommandState=void 0;var y=MsPortalFx.Base,v=y.Diagnostics,M=y.Images,C=MsPortalFx.Extension.SetRequirement,P=MsPortalFx.ViewModels,w=P.Dialogs,I=P.Toolbars,S=p.CompositionBinder;const _=v.createLog(e),F=c.Commands,T=MsPortalFx.uncurryThis(Array.prototype.forEach);let k=class{constructor(){this.commandsEnabled=ko.observable(!0)}};t.CommandState=k,t.CommandState=k=__decorate([__metadata("fx:diagnostics",[e,"CommandState"]),s.Class()],k),t.CompositionInstanceCommandContext=g.CompositionInstanceCommandContext,t.getCommandSourceTelemetryContext=function(e){return g.getCommandSourceTelemetryContext(e)},t.getBladeContentWidget=function(e){const t=f.Widget.getWidget(e,null);if(e.hasClass("fxs-bladecontent"))return t},t.getBladeContainerWidget=function(e){const t=f.Widget.getWidget(e,null);if(e.hasClass("fxs-blade"))return t},t.getCommandGroupForDefinitionItem=function(e,t,s){const o=s.commandGroupReference,i=o?o.name:s.commandGroup;return e.getCommandGroup(t,i)};class D extends d.CommandImpl{constructor(e,t,s,o,i){super(e,s),this.diContainer=i;const n=ko.observable(!1);this.commandName=t,this._compositionContainer=o;const r=this._overrideEnabled=ko.observable();this.enabled=ko.computed(e,{read:()=>{let e=r();return void 0===e&&(e=n()),e},write:e=>{n(e)}}),this._init(i)}get container(){return this._compositionContainer}get sourceBindableContainer(){return null}_init(e){ko.reactor(this._ltm,(()=>{e.get(k).commandsEnabled()&&1!==this.diContainer.get(m.DesktopManagerMode).value()?this._overrideEnabled(void 0):this._overrideEnabled(!1)}))}}t.ExtensionCommandMenuItemBase=D;t.ExtensionMultiselectCommandMenuItemImpl=class extends D{constructor(e,t,s,o,i,n,r){const a=o.name;super(e,a,o.text,s,n);const l=this._ltm,c=s+"[Command: "+a||o.text+"]",d=(p=r)&&p.selectableItems().filter((e=>e.isSelected()))||[];var p;this._subcommands=d.map((e=>{const r={viewModel:e.data,viewModelName:c,isPartListItem:!0};return new E(l,t,s,o,i,n,r)})),ko.reactor(l,(()=>{const e=this._subcommands.reduce(((e,t)=>t.enabled()&&e),!0);this.enabled(e)}))}bind(e){T(this._subcommands,(t=>{t.bind(e)}))}activate(){T(this._subcommands,(e=>{e.activate()}))}execute(e){T(this._subcommands,(t=>{t.execute(e)}))}};class E extends D{constructor(e,t,s,o,i,n,r,l){super(e,o.name,o.text,s,n),this._viewModelManager=n.get(a.ViewModelManager),this._extension=t,this._commandDefinition=o,this._commandContainerDefinition=i,this._sourceBindableContainer=r,this._selectionInList=l}extensionName(){return this._extension&&this._extension.name}get commandDefinition(){return _.assert(!this._commandDefinition.reference,"External CommandDefinition not resolved."),this._commandDefinition}getInputBindingsFromDefinition(e){let t;const s=this._getCommandReference(e);return s&&Array.isArray(s.bindings)&&s.bindings.length>0?t=s.bindings:e&&(t=e.bindings),t||[]}get widgetViewModel(){return this._widgetViewModel}get sourceBindableContainer(){return this._sourceBindableContainer}activate(){this._loadViewModel()}execute(e){const t=this.widgetViewModel,s=t&&t.dialogOptions;s&&s.type&&5===t.type?this._getFormTarget().then((t=>{const o=this.container.locator,i=o&&o.withCommand(this.commandName);this.diContainer.getAsync(h.DialogManager).then((e=>e.showDialog(s,t,this._target(),{locator:i}))).then((t=>{this._execute(e)}))})):this._execute(e)}getCommandContext(){return this._currentContext}_getFormTarget(){return this._currentContext&&this._currentContext.getFormTarget()}_target(){return this._currentContext&&this._currentContext.target}_getCommandReference(e){const t=this._commandContainerDefinition&&this._commandContainerDefinition.commandGroupReference;let s=null;return t&&t.commands&&e.name&&(s=MsPortalFx.find(t.commands,(function(t){return t.name===e.name}))),s}_execute(e){const t=this._currentContext.compositionInstance;if(!this._extensionCommand)return void this._loadViewModel();const s=t&&t.widget;s&&!this._extensionCommand.canSkipBladeValidation?(this._overrideEnabledPropertyWith(!1),l.ensureFormFieldValidation(s.element).then((t=>{super.execute(e),this._extensionCommand.execute(e,t)})).finally((()=>{this._clearEnabledPropertyOverride()}))):(super.execute(e),this._extensionCommand.execute(e))}dispose(){const e=this._viewModelLoadedPromise,t=()=>{super.dispose()};e&&(e.then(t),this._viewModelLoadedPromise=null),t()}setEnabled(e){this._extensionEnabledProperty=e,this._overrideEnabledProperty||this.enabled(e)}getViewModel(e,t){const s=this._extensionCommand;return s&&s.viewModel}getViewModelAsync(e){return this._loadViewModel(),this._viewModelLoadedPromise}get canRebind(){const e=this._getContentViewModel();return 1!==(e&&ko.unwrap(e.status))}_getContentViewModel(){const e=this.getViewModel();return e&&e.content()}_overrideEnabledPropertyWith(e){this._overrideEnabledProperty=!0,this.enabled(e)}_clearEnabledPropertyOverride(){this._overrideEnabledProperty&&(this._overrideEnabledProperty=!1,this.enabled(this._extensionEnabledProperty))}_resolveCommandDefinition(){return(0,o.fcall)((()=>{const t=this._commandDefinition;if(t.reference){const s=t.reference.extension||this._extension.name,o=t.reference.commandType;return this.icon(M.Loading.EllipsisSquare()),this.text(F.loading),this.diContainer.get(r.DefinitionCache).getCommand(s,o).then((i=>{MsPortalFx.isNullOrUndefined(i)&&(0,n.logToExtension)(e,this._extension.name,2,"Could not resolve the command reference for extension {0} and command name {1}".format(s,o)),this._extension=this.diContainer.get(b.ExtensionManager).getExtension(s);const r=this.getInputBindingsFromDefinition(t);this._commandDefinition=MsPortalFx.extend2(i,{name:t.name}),r.length>0&&(this._commandDefinition.bindings=r),this.text(this._commandDefinition.text)}))}}))}_logError(t){FxImpl.Rpc.client.log(this._extension.name,{level:2,code:0,area:e.normalize("."),message:new MsPortalFx.Errors.Error({message:`${MsPortalFx.getLogFriendlyMessage(t)} \nCommand name: ${this._commandDefinition.name} \nView model name: ${this._commandDefinition.viewModel}`,innerErrors:t})})}_createExtensionCommandHandler(e){const t=this._ltm;if(t.isDisposed())return;const s=e.content,o=t.createChildLifetime(),i={container:this.container,extension:this._extension,viewModelName:this._commandDefinition.viewModel,commandItem:this,propertyBindings:null,diContainer:this.diContainer,selectionInList:this._selectionInList},n=new A(o,e,i);n.init(),i.propertyBindings=n.propertyBindings;const r=this._extensionCommand=g.createExtensionCommand(o,s(),e,i);r?(o.registerForDispose([r]),r.init()):this._logError(FxImpl.createError("Error loading command view model. Unknown view model type.")),e.container.unauthorizedMessage.subscribeAndRun(o,(t=>{this.unauthorized(!MsPortalFx.isNullOrUndefined(t)),this.tooltip(t||e.content().tooltip&&e.content().tooltip())}))}_loadViewModel(){if(!this._viewModelLoadedPromise){let e=this._ltm;if(!e)return;this._viewModelLoadedPromise=this._resolveCommandDefinition().then((()=>{if(e=this._ltm,!e)return;const t=this._extension,s=this._commandDefinition,o=4===s.commandKind;return s.commandKind&&!o||(this._widgetViewModel=B(this._ltm,s,this.diContainer,this.container,o)),this._viewModelManager.getViewModel(t.name,s.viewModelLocator||s.viewModel,7,{createSelectable:!0})})),this._viewModelLoadedPromise.then((t=>{e=this._ltm,e&&(t.content().lc2&&(this._widgetViewModel=B(e,this._commandDefinition,this.diContainer,this.container,!0)),this._createExtensionCommandHandler(t))})).catch((e=>{const t=MsPortalFx.getLogFriendlyMessage(e);this.icon(M.Blank()),this.text(F.failedToLoad),this._logError(FxImpl.createError("Error loading command view model.\nReason: {0}".format(t)))}))}}}function B(e,t,s,o,i){const n=new I.DialogButton;return n.dialogOptions=new w.ListPopup,n.dialogOptions.type=i?4:0,new x.DialogButton(e,n,o.locator.withCommand(t.name),s,{commandName:t.name})}t.ExtensionCommandMenuItemImpl=E;class A{constructor(e,t,s){this._onInputsSetPending=ko.observable(!1),this._hasPermissions=ko.observable(!0),this._extension=s.extension,this._viewModelName=s.viewModelName,this._composedViewModel=t,this._commandViewModel=t.content(),this._commandItem=s.commandItem,this._diContainer=s.diContainer;const o=this._ltm=e.createChildLifetime();this._initializeInputBindings(s.container,s.commandItem),o.registerForDispose((()=>{this._commandViewModel=null}))}init(){const e=this._commandViewModel,t=this._commandItem;ko.isObservable(e.icon)&&e.icon.subscribeAndRun(this._ltm,t.icon),ko.isObservable(e.text)&&e.text.subscribeAndRun(this._ltm,(e=>void 0!==e&&t.text(e))),ko.isObservable(e.ariaLabel)&&e.ariaLabel.subscribeAndRun(this._ltm,t.ariaLabel),ko.isObservable(e.tooltip)&&e.tooltip.subscribeAndRun(this._ltm,t.tooltip),ko.computed(this._ltm,[e.enabled,this._hasPermissions,this._onInputsSetPending],((e,s,o)=>t.setEnabled(e&&s&&!o)))}get propertyBindings(){return this._propertyBindings}dispose(){this._ltm.dispose()}_initializeInputBindings(e,t){const s=this._ltm;if(!s)return;const o=t.getInputBindingsFromDefinition(t.commandDefinition),i={bindableTarget:{viewModelName:e.toString()+"-["+this._viewModelName+"]",viewModel:this._composedViewModel},inputs:o,referenceComposition:e,referenceCompositionIsContainer:!0,customBindHandler:e=>{const s=t.sourceBindableContainer;if(s&&s.viewModel&&0!==e.source.modelType)return{sourceModelName:s.viewModelName,sourceModel:s.viewModel}},beforeViewModelPropertyUpdate:s=>{const o=t.commandDefinition;if(o&&o.permissions){this._hasPermissions(!1);let t=e&&e.locator&&e.locator.toString()+"-";return t=(t||"")+o.name,u.checkPermissions(o.permissions,C.All,s,o.assetType,this._extension.name,this._diContainer,t).then((e=>(this._updateForHasPermissions(e),e)))}return this._updateForHasPermissions(!0),Promise.resolve(!0)}};i.inputs&&Array.isArray(i.inputs)&&i.inputs.length>0&&(this._onInputsSetPending(!0),i.inputsSetCalled=(s,o)=>{this._onInputsSetPending(!0),this._currentOnInputsSetPromise=o,o.then((()=>{this._currentOnInputsSetPromise===o&&this._onInputsSetPending(!1)}),(o=>{_.error("Command '{0}' on composition '{1}' rejected its onInputsSet promise.\nView Model Name: {2}\nInputs Provided: {3}\nReason: {4}".format(t.commandName,e.toString(),this._viewModelName,ko.toJSON(s),o||"N/A"))}))});const n=S.bindViewModelInputs(this._diContainer,i),r=this._propertyBindings=n.propertyBindings;s.registerForDispose((()=>{r&&(r.unbind(),this._propertyBindings=null)}))}_updateForHasPermissions(e){const t=this._composedViewModel&&this._composedViewModel.container;t&&(e?t.unauthorizedMessage(void 0):t.unauthorized()),this._hasPermissions(e)}}function N(e,s,o,n,r,a,l,c){const d="__{0}ViewModel__".format(c),p=i.composeViewModel(n,!0),u=new E(e,l,o,r,a,s),m={container:o,extension:l,viewModelName:d,commandItem:u,propertyBindings:null,diContainer:s,selectionInList:!1},h=g.createExtensionCommand(e,p.content(),p,m);return u.bind(new t.CompositionInstanceCommandContext(null,null,o)),e.registerForDispose([p.container,u,h]),h}t.createOpenBladeCommand=function(e,t,s,o,i,n){return N(e,t,s,(e=>new P.OpenBladeCommand(e)),{name:n,details:{invocationInputArguments:[{valuesFrom:[{property:"container.selectable",referenceType:4}]}]}},o,i,n)},t.createOpenLinkCommand=function(e,t,s,o,i,n,r){return N(e,t,s,(()=>{const e=new P.UriCommand;return e.navigateUri=r.uri,e.navigateTarget=r.target,e}),{name:n},o,i,n)}})),
define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/Base/Base.KeyboardHelper"],(function(e,t,s,o,i,n,r,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortalCommandManager=t.onContextMenu=t.AsyncPortalFormTarget=void 0;var d=FxImpl.TriggerableLifetimeManager;const p=window;class u{static create(e){return e.getAsync(o.get("MsPortalImpl/UI/UI.PortalFormTarget","PortalFormTarget"))}}function m(e){if(c.isCtrlOrCommandOnly(e))return!0;const t=p.getSelection();if(t.rangeCount&&!t.getRangeAt(0).collapsed)return!0;const s=$(e.target);if(s.filter("input,textarea").length)return!0;if(s.add($(e.target).parents("a")).filter("a[href]:not([href='#']):not([href=''])").length)return!0;e.preventDefault(),e.stopPropagation();const o=$.Event("fxcontextmenurequest",{target:e.target,pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY});s.trigger(o)}t.AsyncPortalFormTarget=u,__decorate([__metadata("fx:diagnostics",[e,"AsyncPortalFormTarget"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",Promise)],u,"create",null),t.onContextMenu=m;let h=class{constructor(e,t,s){this._desktopManagerMode=e,this._previouslyFocusedElement=t,this._diContainer=s,this._ltm=new d,this._ltm.registerForDispose($.querySelectorAll("body").setEvents(["fxcontextmenu",(e,t)=>{this._showContextMenu(e,t)}],["contextmenu",e=>{m(e)}]))}dispose(){this._ltm.dispose()}getFormTarget(){return this._diContainer.getAsync(u)}_showContextMenu(e,t){if(!this._contextMenu){const e=(0,l.getPortalViewModel)(this._diContainer);this._contextMenu=new a.Widget(e.getRootElement().find(".fxs-commands-contextMenu"),e.contextMenuViewModel,!0)}const s=t.contextMenu?t.contextMenu:this._contextMenu,o=s.options.menuItems;let r,c,d,p=e.clientX,u=e.clientY;if(t.commands&&0!==t.commands.length){if(t.srcElement){const e=t.srcElement;let s=e;for($(e).hasClass("fxs-tile")&&(s=$(e).find(".fxs-part")[0]);s&&"function"!=typeof s.focus;)s=$(s).closest("[tabindex]")[0];this._previouslyFocusedElement.value(s)}d=t.formTarget&&t.formTarget.length>0?()=>Promise.resolve(i.getBladeContentWidget(t.formTarget)):()=>this.getFormTarget(),s.hide(),o.splice(0,o().length);do{c=c?c.parentNode:e.target,r=$(c).data(n.CompositionInstanceDataName)}while(!r&&c.parentNode);if(n.isContextMenuContainer(r)&&r.beforeActivateCommandMenuItems(t),t.commands.forEach((t=>{this._shouldShowCommand(t)&&(t.activate(),t.bind(new i.CompositionInstanceCommandContext(e.target,d,r)),o.push(t))})),s.options.hasVisibleCommands()){if(!p&&!u){const t=e.target.getClientRects()[0];p=t&&t.left||p,u=t&&t.bottom||u}s.show(p,u,t&&t.forceLeft)}}}_shouldShowCommand(e){return 1!==this._desktopManagerMode.value()||!this._isExtensionCommand(e)}_isExtensionCommand(e){return!!e._extension}};t.PortalCommandManager=h,t.PortalCommandManager=h=__decorate([__metadata("fx:diagnostics",[e,"PortalCommandManager"]),s.Class(),__metadata("design:paramtypes",[r.DesktopManagerMode,r.PreviouslyFocusedElement,s.Container])],h)})),
define("MsPortalImpl/UI/Commands/UI.ShellCommands",["require","exports","Fx/DependencyInjection","Fx/ResourceManagement","FxInternal","FxInternal/AsyncLoader","FxInternal/Composition/Part","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.TileActionBar","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/UI/Commands/Base.PortalFunctions"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClonePart=t.ExitOrganizeMode=t.EnterOrganizeMode=t.ResetStartBoardCommand=t.ReloadPart=t.GoToAssetBlade=t.CreatePartSizeCommandCollection=t.PartSizeCommand=t.PinToStartboard=t.OpenContextMenu=t.CustomizeTileData=t.UnpinFromStartboard=t.ShellCommand=t.CommandNames=t.commandNamePrefix=void 0;var M=MsPortalFx.Base,C=M.Diagnostics.Telemetry,P=FxImpl.TelemetryContext,w=M.Images,I=MsPortalFx.Parts,S=I.PartSize,_=d.CompositionInstanceCommandContext;t.commandNamePrefix="MsPortalImpl.UI.Commands.";function F(e){return g.Widget.getWidget(e.closest(".fxs-tile"),f.Widget)}t.CommandNames={BladeDisplayState:`${t.commandNamePrefix}BladeDisplayState`,ClonePart:`${t.commandNamePrefix}ClonePart`,CustomizeTileData:`${t.commandNamePrefix}CustomizeTileData`,DeleteListItem:`${t.commandNamePrefix}DeleteListItem`,EnterOrganizeMode:`${t.commandNamePrefix}EnterOrganizeMode`,ExitOrganizeMode:`${t.commandNamePrefix}ExitOrganizeMode`,GoToAssetBlade:`${t.commandNamePrefix}GoToAssetBlade`,OpenContextMenu:`${t.commandNamePrefix}OpenContextMenu`,PartSize:`${t.commandNamePrefix}PartSize`,PinBlade:`${t.commandNamePrefix}PinBlade`,EditBlade:`${t.commandNamePrefix}EditBlade`,PinListItem:`${t.commandNamePrefix}PinListItem`,PinToStartboard:`${t.commandNamePrefix}PinToStartboard`,ReloadPart:`${t.commandNamePrefix}ReloadPart`,ResetLayout:`${t.commandNamePrefix}ResetLayout`,ResetStartBoard:`${t.commandNamePrefix}ResetStartBoard`,UnnamedCommand:`${t.commandNamePrefix}UnnamedCommand`,UnpinFromStartboard:`${t.commandNamePrefix}UnpinFromStartboard`};class T extends l.CommandImpl{constructor(e,t,s,o){super(e,o.text,o.enabled),this._diContainer=t,this.commandName=s,this.icon(o.icon||w.Blank()),this.isShellCommand=!0}bind(e){e.getFormTarget||(e.getFormTarget=()=>this._diContainer.getAsync(p.AsyncPortalFormTarget)),super.bind(e)}execute(e){super.execute(e);const t=this._diContainer.get(h.JourneyManager).activeJourney(),s=d.getCommandSourceTelemetryContext(this._currentContext);P.setContextValue(P.ContextType.Blade,s),C.trace({source:s&&s.id,action:"CommandExecuted",name:this.commandName,data:{fromContextMenu:e,desktopMode:this._getDesktopMode()},journeyId:t&&t.id})}createAction(e){const t=new x.TileActionViewModel;return t.command=this,t.bindCommand=()=>{const t=e.widget;t?this.bind(new _(t.element[0],null,e)):this.enabled(!1)},this._setActionClassName(t),t}_getComposition(){return this._currentContext.compositionInstance}_getDesktopMode(){return this._diContainer.get(b.DesktopManagerMode).value()}_setActionClassName(e){const t=this._getActionClassIdentifier();this._actionClassName="fxs-tile-actionbar-command-"+t,e.className=this._actionClassName}_getActionClassIdentifier(){throw new Error("Not implemented.")}}t.ShellCommand=T;t.UnpinFromStartboard=class extends T{constructor(e,s){super(e,s,t.CommandNames.UnpinFromStartboard,{text:a.ShellCommands.unpinFromStartboard,icon:w.Delete()})}execute(e){const t=F($(this._currentContext.target));t&&t.trigger("fxunpin",{tileId:t.options.id}),super.execute(e)}_getActionClassIdentifier(){return"unpinfromstartboard"}};t.CustomizeTileData=class extends T{constructor(e,s){const o=MsPortalFx.isFeatureEnabled(r.partHeaderEnabledFeatureName);super(e,s,t.CommandNames.CustomizeTileData,{text:o?a.ShellCommands.configureTileSettings:a.ShellCommands.customizeTileData,icon:w.Gear()}),this._partSettingsEnabled=o}execute(e){this._getComposition().openPartSettingsBlade()}bind(e){super.bind(e),this.enabled(1!==this._getDesktopMode()||this._partSettingsEnabled)}_getActionClassIdentifier(){return"customizetiledata"}};t.OpenContextMenu=class extends T{constructor(e,s,o){super(e,s,t.CommandNames.OpenContextMenu,{text:o,icon:w.Ellipsis()})}bind(e){super.bind(e);const t=this._partWidget=F($(e.target)),s=t.options.commands.filter((t=>(t.bind(e),t.visible()&&t.enabled()))),o=this._diContainer.get(c.FullScreenMode);this.enabled(s.length>0&&!o.isActive()),ko.computed(this._ltm,(()=>{const e=t.actionBarWidget&&t.actionBarWidget.contextMenuWidget.options.visible();t.element.find(`.${this._actionClassName}`).toggleClass("fxs-tile-actionbar-action-pressed",e)}))}execute(e){const t=this._partWidget,s=t.element,o=$.Event("fxcontextmenu"),i=s.offset();o.clientX=i.left+s.outerWidth(!1),o.clientY=i.top,s.trigger(o,{commands:t.options.commands,contextMenu:t.actionBarWidget.contextMenuWidget}),super.execute(e)}_getActionClassIdentifier(){return"opencontextmenu"}};t.PinToStartboard=class extends T{constructor(e,s,o){super(e,s,t.CommandNames.PinToStartboard,{text:a.ShellCommands.pinToStartboard,icon:w.Pin(),enabled:!1}),this.partComposition=o}bind(e){if(super.bind(e),!this.partComposition.allInputsSet())return void this.enabled(!1);const t=this.partComposition.widget;let s=!1;if(t){const e=m.isVariableSize(t.options.size()),o=ko.unwrap(t.options.supportedSizes);let i;t.element.parentsUntil(".fxs-blade",".fxs-blade-summary-container").length>0?s=!1:e?(i=MsPortalFx.find(o,(function(e){return m.isFixedSize(e)})),null!==i&&i>=0&&(s=!0)):s=!0}this.enabled(s)}execute(e){this._diContainer.get(v.PinTilePortalFunc).invoke(this.partComposition,"ShellCommands").finally((()=>{super.execute(e)}))}_getActionClassIdentifier(){return"pintostartboard"}};class k extends T{constructor(e,s,o,i,n){super(e,s,t.CommandNames.PartSize+I.PartSize[o],{text:i,icon:n}),this.sizeTarget=o}execute(e){const t=F($(this._currentContext.target));let s;t&&(s=m.AllSizes[this.sizeTarget],t.element.trigger("fxsizechange",[t.options.id,s.size.width,s.size.height]),(0,i.fcall)((()=>{t.setFocus()}))),super.execute(e)}bind(e){const t=F($(e.target)),s=t&&t.options;t&&this.sizeTarget!==s.size()&&!m.isVariableSize(s.size())&&1===this._getDesktopMode()?(this.enabled(-1!==s.supportedSizes().indexOf(this.sizeTarget)),super.bind(e)):this.enabled(!1)}}let D;t.PartSizeCommand=k,t.CreatePartSizeCommandCollection=function(e,t){return D||(D=[{size:S.Mini,text:a.ShellCommands.partSizeMini},{size:S.Small,text:a.ShellCommands.partSizeSmall},{size:S.Normal,text:a.ShellCommands.partSizeNormal},{size:S.Wide,text:a.ShellCommands.partSizeWide},{size:S.Tall,text:a.ShellCommands.partSizeTall},{size:S.Large,text:a.ShellCommands.partSizeLarge},{size:S.HeroWide,text:a.ShellCommands.partSizeHeroWide},{size:S.HeroTall,text:a.ShellCommands.partSizeHeroTall},{size:S.Hero,text:a.ShellCommands.partSizeHero}],D.forEach((e=>{e.icon=w.Mini({customClass:"msportalfx-contextmenu-grid-"+I.PartSize[e.size].toLowerCase()})}))),D.map((s=>new k(e,t,s.size,s.text,s.icon)))};t.GoToAssetBlade=class extends T{constructor(e,s,o){super(e,s,t.CommandNames.GoToAssetBlade,{text:a.ShellCommands.goToAsset,icon:w.Go(),enabled:!1}),this.assetWrapper=o}bind(e){super.bind(e),this.assetWrapper.getAssetId().then((e=>{this._assetId=e,this._diContainer.get(b.DesktopManagerMode).value.subscribeAndRun(this._ltm,(t=>{const s=0!==o.ArmId.parse(e,!0).kind,i=1!==t;this.enabled(s&&i)}))})).catch($.noop)}execute(e){super.execute(e),n.get("MsPortalImpl/UI/UI.DeepLink","getResourceDeepLink").then((e=>{const t=e(this._diContainer,this._assetId);this._diContainer.get(v.RoutePortalFunc).invoke({uri:t,openedByContext:{openedBy:4}},"ShellCommands")}))}};t.ReloadPart=class extends T{constructor(e,s,o){super(e,s,t.CommandNames.ReloadPart,{text:a.ShellCommands.reloadPart,icon:w.Refresh({palette:99})}),this.partComposition=o}bind(e){super.bind(e)}execute(e){super.execute(e);const t=this.partComposition,s=C.startTrace({action:"Refresh",source:"UI.ShellCommands",actionModifier:"mark",context:{content:t.locator&&t.locator.name,instanceId:t.id}});return this._diContainer.get(v.ReloadPartPortalFunc).invoke(t,"ShellCommands").then((e=>{const o={source:"Shell",action:"ErrorInteraction",actionModifier:"Refresh",context:{content:t.locator&&t.locator.name,instanceId:t.id}};return e.await(3).then((()=>{o.data={successful:!0}}),(()=>{o.data={successful:!1}})).finally((()=>{C.trace(o),C.completeTrace(s)})),e}))}};t.ResetStartBoardCommand=class extends T{constructor(e,s){super(e,s,t.CommandNames.ResetStartBoard,{text:a.ShellCommands.resetLayout})}execute(e){this._diContainer.get(v.ResetDashboardPortalFunc).invoke({duringPortalStartup:!1,force:!1},"ShellCommands"),super.execute(e)}bind(e){super.bind(e),this.enabled(1===this._getDesktopMode())}};t.EnterOrganizeMode=class extends T{constructor(e,s,o){super(e,s,t.CommandNames.EnterOrganizeMode,{text:a.ShellCommands.enterOrganizeMode,icon:w.Edit()}),this._expandTileGallery=!!o,s.get(b.DesktopManagerMode).value.subscribeAndRun(this._ltm,(e=>{const t=1!==e;this.enabled(t)}))}execute(e){const t=this._getComposition();t&&t.widget?t.widget.element.trigger("fxenterorganizemode",{trigger:1,openTileGallery:this._expandTileGallery}):this._diContainer.get(b.DesktopManagerMode).value(1),super.execute(e)}};t.ExitOrganizeMode=class extends T{constructor(e,s){super(e,s,t.CommandNames.ExitOrganizeMode,{text:a.ShellCommands.exitOrganizeMode})}execute(e){(0,y.getPortalViewModel)(this._diContainer).topBar.exitOrganizeMode(),super.execute(e)}bind(e){super.bind(e),this.enabled(1===this._getDesktopMode())}};let E=class extends T{constructor(e,s,o){super(e,s,t.CommandNames.ClonePart,{text:a.ShellCommands.copy,icon:w.Copy()}),this._partComposition=o}execute(e){super.execute(e),n.get("MsPortalImpl/UI/Dashboard/Common/DashboardPinHelper","copyPartWithDashboardSelection").then((e=>e(this._diContainer,"Dashboard",this._partComposition)))}};t.ClonePart=E,t.ClonePart=E=__decorate([__metadata("fx:diagnostics",[e,"ClonePart"]),s.Class(),__metadata("design:paramtypes",[Object,s.Container,Function])],E)})),
define("WeaveDOM/SandboxRender/Serialize",["require","exports","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","WeaveDOM/Core/InternalUtil","Weave/Core/Computation"],(function(e,t,s,o,i,n){"use strict";function r(e,t,s){switch(t=(t||"").trim(),e){case"aria-describedby":case"aria-controls":case"aria-labelledby":case"aria-owns":case"for":case"form":case"headers":case"id":case"list":return function(e,t){const s=new Array(e.length);for(let o=0;o<e.length;++o)s[o]=t+e[o];return s}(t.split(" ").filter(n._identity),s).join(" ");default:return t}}function a(e,t,s,o,i,n,r,a,c){let d=!1;for(const p of e)d=l(p,t,s,o,i,n,r,a,c)||d;return d}function l(e,t,n,l,p,u,m,h,g){switch(e.type){case"element":return function(e,t,i,n,l,c,d,p,u){const m=e.tagName;!function(e){if(!(0,s.validateTagNameInSandboxMode)(e))throw new Error(`TagName: ${e} is not allowed`)}(m);let h="",g="";const f=i.htmlFragments;f.push("<",m);for(const t of e.attributes){const e=t.name,i=t.value;(0,s.ensureAllowedAttribute)(m,e);const n=(0,s.sanitizeAttributeValue)(e,i,d);if(n.valid)if("id"===e){if(!i)throw new Error("Empty element node id is not accepted.");if(h)throw new Error(`Only one element id can be accepted, ${h}, ${i}`);h=n.value,g=(0,o.getUniqueElementId)(),f.push(' id="',g,'"')}else f.push(" ",e,'="',(0,o.encodeHtml)(r(e,n.value,l)),'"');else console.warn(`Invalid attribute value will be ignored: ${e}, ${i}`)}p&&p.element.postSerialize({addAttribute:(e,t)=>f.push(" ",e,'="',t,'"'),getElementNodeId:()=>(h||(h=g=(0,o.getUniqueElementId)(),f.push(' id="',g,'"')),h),node:e,options:t,ltm:n.innerLtmRoot,hooksState:u});if((0,s.isSelfCloseTag)(m))f.push("/>");else{let s=-1;g||(s=f.length,f.push("")),f.push(">");a(e.children,t,i,n,l,c,d,p,u)&&(g||(g=(0,o.getUniqueElementId)(),f[s]=` id="${g}"`),i.commentContainers.push(g)),f.push("</",m,">")}h&&i.elementNodes.push({ltm:n,nodeId:h,domId:g});return!1}(e,t,n,l,p,u,m,h,g);case"dynamic":return function(e,t,s,n,r,l,p,u,m){const{commentStartId:h,commentEndId:g}=(0,i.getUniqueCommentIdPair)();s.htmlFragments.push("\x3c!--",h,"--\x3e");const{selfLtm:f,contentLtm:x}=(0,o.createDynamicNodeLtms)(e.dynamicNodeType,n),b=x||f;if(a(e.children,t,s,b,r,l,p,u,m),s.htmlFragments.push("\x3c!--",g,"--\x3e"),"forEach"===e.dynamicNodeType&&!e.children.every(c))throw new Error("Only ForEachItem node is allowed as a children to ForEach node.");return s.dynamicNodes.push({nodeId:e.nodeId,nodeType:e.dynamicNodeType,commentStartId:h,commentEndId:g,initContentLtm:x,selfLtm:f,initItemsId:"forEach"===e.dynamicNodeType?e.children.map(d):void 0}),!0}(e,t,n,l,p,u,m,h,g);case"text":return function(e,t){e.text&&"string"==typeof e.text&&t.push((0,o.encodeHtml)(e.text));return!1}(e,n.htmlFragments);case"html":return function(e,t,s){return t.push(s(e.htmlData)),!1}(e,n.htmlFragments,u);default:(0,o.assertSwitchNever)(e)}}function c(e){return"dynamic"===e.type&&"forEachItem"===e.dynamicNodeType}function d(e){return e.nodeId}Object.defineProperty(t,"__esModule",{value:!0}),t.mapAttributeIdPointers=t.serializeRootNode=void 0,t.serializeRootNode=function(e,t,s,o,n,r,l,c){const d={commentContainers:[],dynamicNodes:[],elementNodes:[],htmlFragments:[]},p=c&&c();a(e.children,t,d,s,o,n,r,l,p);const u=(0,i.documentFragmentFromHtml)(d.htmlFragments.join(""));return{containerDoc:u,commentLookup:(0,i.collectCommentNodes)(d.commentContainers,u),dynamicNodes:d.dynamicNodes,elementNodes:d.elementNodes,hooksState:p}},t.mapAttributeIdPointers=r})),
define("WeaveDOM/SandboxRender/WeaveSandbox",["require","exports","WeaveDOM/Core/InternalUtil","WeaveDOM/SandboxRender/Serialize","Weave/Core/MemoryManager","WeaveDOM/DirectRender/ForEachNodeOperations","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","WeaveDOM/Core/DomOperatorBase","Weave/Core/InternalUtil","Weave/Core/Computation"],(function(e,t,s,o,i,n,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SandboxModeRenderEngine=t.connect_internal=void 0,t.connect_internal=function(e,t){let s=null,o=!1;const i=(0,c.makeMap)(p.concat(t.customInstructionHandlers||[]),(e=>e.name),(e=>e.handler));return t.registerOnReceive(((n,r)=>{if(!o&&n)if("setRoot"===n.type){if(s)throw new Error("Cannot have more than one setRoot instruction.");s=new u({rootElement:e,config:t,rootNode:n.rootNode,setRootInstructionOptions:r,idMapPrefix:`_wv_sandbox_idmap_${f++}_`,cssChanges:n.css})}else{const e=i.get(n.type);if(!e)throw new Error(`Unknown Weave sandbox mode instruction: ${JSON.stringify(n).slice(0,200)}`);e(n,s,r)}})),t.registerOnDispose((()=>{s&&s.dispose(),o=!0})),()=>s&&s.getMemoryDebugInfo()};const p=[{name:"applyCss",handler:(e,t)=>t.applyCssChanges(e.css)},{name:"clear",handler:(e,t)=>t.clear(e.dynamicNodeId)},{name:"remove",handler:(e,t)=>t.remove(e.dynamicNodeId)},{name:"removeAttribute",handler:(e,t)=>t.removeAttribute(e.elementNodeId,e.attributeName)},{name:"toggleClass",handler:(e,t)=>t.toggleClass(e.elementNodeId,e.value.className,e.value.shouldAdd)},{name:"setAttribute",handler:(e,t)=>t.setAttribute(e.elementNodeId,e.attributeName,e.attributeValue)},{name:"setContent",handler:(e,t,s)=>t.setContent(e.dynamicNodeId,e.rootNode,s)},{name:"setItems",handler:(e,t,s)=>t.setItems(e.dynamicNodeId,e.items,e.css,s)},{name:"setStyle",handler:(e,t)=>t.setStyle(e.elementNodeId,e.styleName,e.styleValue)},{name:"toggleDisplay",handler:(e,t)=>t.toggleDisplay(e.dynamicNodeId,e.shouldShow)},{name:"setEventListener",handler:(e,t)=>t.addEventListener(e.elementNodeId,e.eventName,e.options)},{name:"focus",handler:(e,t)=>t.focus(e.locatorClass,e.elemIndex)},{name:"setLocatorClass",handler:(e,t)=>t.toggleClass(e.elementNodeId,t.getDomUniqueLocatorClass(e.locatorClass),!0)},{name:"initTwoWayInputBinding",handler:(e,t)=>{t.initTwoWayInputBinding(e.elementNodeId,e.inputBindingName)}},{name:"initValuePushInputBinding",handler:(e,t)=>{t.initValuePushInputBinding(e.elementNodeId,e.inputBindingName)}},{name:"initValueSubscribeInputBinding",handler:(e,t)=>{t.initValueSubscribeInputBinding(e.elementNodeId,e.inputBindingName)}},{name:"twoWayInputBindingCommit",handler:(e,t)=>{t.twoWayInputBindingCommit(e.elementNodeId,e.inputBindingName,e.value)}},{name:"pushInputValue",handler:(e,t)=>{t.pushInputValue(e.elementNodeId,e.inputBindingName,e.value)}}];class u{constructor(e){this._options=e,this._memoryManager=new i.MemoryManager,this._domAgent=new l.DirectDomAgent,this._cssMap=new Map,this._attributeSanitizer=this._options.config.attributeSanitizer,this._getHtmlString=this._options.config.htmlElementDataSerializer,this._idMapPrefix=this._options.idMapPrefix,this._rootElement=this._options.rootElement,this._createHookState=this._options.config.createHookState,this._sendNotification=this._options.config.notificationCallback,this._serializeHooks=this._options.config.serializeHooks,this._postRender=this._options.config.postRender,this._getElement=e=>this._memoryManager.getAndEnsureElementNode(e).element,this._customEventHandlerMap=(0,c.makeMap)(e.config.customEventHandlers||[],(e=>e.eventName),(e=>e.handler));const t=(0,o.serializeRootNode)(e.rootNode,e.setRootInstructionOptions,this._memoryManager.outerLtmRoot,this._idMapPrefix,this._getHtmlString,this._attributeSanitizer,this._serializeHooks,this._createHookState),n=t.containerDoc;h(t.elementNodes,t.dynamicNodes,this._memoryManager,t.commentLookup,n),(0,s.removeAllChildren)(e.rootElement),this.applyCssChanges(e.cssChanges),e.rootElement.appendChild(n),this._postRender&&this._postRender({hooksState:t.hooksState,getElement:this._getElement})}dispose(){this._memoryManager.dispose(),(0,s.removeAllChildren)(this._rootElement)}applyCssChanges(e){const t=e.newCssDefinition;for(const e of Object.keys(t))this._cssMap.set(e,t[e]);const s=[],o=[];for(const t of e.addedCss)s.push(this._cssMap.get(t));for(const t of e.removedCss)o.push(this._cssMap.get(t));(s.length||o.length)&&this._options.config.cssLoader(s,o)}setAttribute(e,t,s){this._domAgent.setAttribute(this._memoryManager,this._attributeSanitizer,e,t,(0,o.mapAttributeIdPointers)(t,s,this._idMapPrefix))}removeAttribute(e,t){this._domAgent.removeAttribute(this._memoryManager,e,t)}toggleClass(e,t,s){this._domAgent.toggleClass(this._memoryManager,e,t,s)}setStyle(e,t,s){this._domAgent.setStyle(this._memoryManager,e,t,s)}clear(e){const t=this._memoryManager.getAndEnsureDynamicNode(e);this._memoryManager.ensureContentDisposed(t,null),this._domAgent.clear(t)}remove(e){this._domAgent.remove(this._memoryManager.releaseDynamicNode(e,null))}toggleDisplay(e,t){this._domAgent.toggleDisplay(this._memoryManager,e,t)}addEventListener(e,t,o){const i=this._memoryManager.getAndEnsureElementNode(e);let n=i.eventNames;if(n||(n=i.eventNames=[]),n.indexOf(t)<0){n.push(t);const r=this._customEventHandlerMap.get(t);r?r({element:i.element,elementNodeId:e,ltm:i.ltm.innerLtmRoot,options:o}):(0,s.attachEventListener)(i.element,i.ltm.innerLtmRoot,t,(s=>{this._sendNotification({type:"event",elementNodeId:e,eventName:t,eventData:(0,a.getEventData)(s,t)})}))}}setContent(e,t,i){const n=this._memoryManager.getAndEnsureDynamicNode(e);(0,a.ensureDynamicNodeOperation)(n.type,4),(0,s.ensureNoContent)(this._memoryManager,n,!1,null);const r=n.selfLtm,l=1&(0,c.getDynamicNodeOperations)(n.type)?n.contentLtm=r.createChildNode():r,d=(0,o.serializeRootNode)(t,i,l,this._idMapPrefix,this._getHtmlString,this._attributeSanitizer,this._serializeHooks,this._createHookState);this._domAgent.setDisplayState(n.commentStart,d.containerDoc),this._renderAfterComment(d,n.commentStart),this._postRender&&this._postRender({hooksState:d.hooksState,getElement:this._getElement})}setItems(e,t,s,i){this.applyCssChanges(s);const l=this._memoryManager.getAndEnsureDynamicNode(e);(0,a.ensureDynamicNodeOperation)(l.type,8);const c=l.itemNodesId,p=(0,r.arrayToSet)(c);for(const e of t)if("number"==typeof e){if(!p.delete(e))throw new Error(`The ForEachItem node ${e} doesn't exists, state tracking is lost.`)}else if("forEachItem"!==e.dynamicNodeType)throw new Error("Only ForEachItem is allowed as children of ForEach node.");p.forEach((e=>{this._memoryManager.releaseDynamicNode(e,null)}));const u={created:0,deleted:0,skipped:0,moved:0},h=(0,n.processForEachItems)((e=>this._memoryManager.getAndEnsureDynamicNode(e)),((e,t)=>{const s=(0,o.serializeRootNode)({children:e},i,l.selfLtm,this._idMapPrefix,this._getHtmlString,this._attributeSanitizer,this._serializeHooks,this._createHookState);return this._domAgent.setDisplayState(l.commentStart,s.containerDoc),this._renderAfterComment(s,t),this._postRender&&this._postRender({hooksState:s.hooksState,getElement:this._getElement}),e.map(g)}),l,t,m,d._identity,u);return u.deleted=c.length-(h.length-u.created),l.itemNodesId=h,h}focus(e,t){const s=this._rootElement.getElementsByClassName(this.getDomUniqueLocatorClass(e))[t];s&&document.activeElement!==s&&s.focus()}getElementMetadata(e){return this._memoryManager.getAndEnsureElementNode(e)}getMemoryDebugInfo(){return this._memoryManager.getDebugInfo()}getDomUniqueLocatorClass(e){return e.split(" ").filter(d._identity).map((e=>this._idMapPrefix+e)).join(" ")}initTwoWayInputBinding(e,t){const o=this._memoryManager.getAndEnsureElementNode(e),i=this._domAgent.prepareInitInputBinding(o,t),n={type:"twoWay",name:t,pendingCount:0};this._domAgent.inputBindingsMgr.createInputBinding(o,n);for(const r of i.eventsToListen)(0,s.attachEventListener)(o.element,o.ltm.innerLtmRoot,r,(s=>{this._sendNotification({type:"twoWayInputBinding",elementNodeId:e,inputBindingName:t,eventData:i.collectDataFromEvent(s)}),n.pendingCount++}))}initValuePushInputBinding(e,t){const o=this._memoryManager.getAndEnsureElementNode(e),i=this._domAgent.prepareInitInputBinding(o,t),n={type:"valuePush",name:t,lastReceivedValue:void 0};this._domAgent.inputBindingsMgr.createInputBinding(o,n);const r=o.element;for(const e of i.eventsToListen)(0,s.attachEventListener)(r,o.ltm.innerLtmRoot,e,(()=>{i.writeValueToElement(r,n.lastReceivedValue)}))}initValueSubscribeInputBinding(e,t){const o=this._memoryManager.getAndEnsureElementNode(e),i=this._domAgent.prepareInitInputBinding(o,t),n={type:"valueSubscribe",name:t};this._domAgent.inputBindingsMgr.createInputBinding(o,n);const r=o.element;for(const n of i.eventsToListen)(0,s.attachEventListener)(r,o.ltm.innerLtmRoot,n,(s=>{this._sendNotification({type:"valueSubscribeInputBinding",elementNodeId:e,inputBindingName:t,eventData:i.collectDataFromEvent(s)})}))}twoWayInputBindingCommit(e,t,s){const o=this._memoryManager.getAndEnsureElementNode(e),i=this._domAgent.inputBindingsMgr.resolveInputBinding(o,t,["twoWay"]),n=this._domAgent.ensureInputBindingMetadata(t);if(i.pendingCount<=0)throw new Error(`Received more twoWayInputBindingCommit message than it should. ${e}, "${t}", ${i.pendingCount}`);i.pendingCount--,0===i.pendingCount&&n.writeValueToElement(o.element,s)}pushInputValue(e,t,s){const o=this._memoryManager.getAndEnsureElementNode(e),i=this._domAgent.inputBindingsMgr.resolveInputBinding(o,t,["twoWay","valuePush"]),n=this._domAgent.ensureInputBindingMetadata(t);"twoWay"===i.type?0===i.pendingCount&&n.writeValueToElement(o.element,s):(i.lastReceivedValue=s,n.writeValueToElement(o.element,s))}_renderAfterComment(e,t){const o=t.nextSibling,i=e.containerDoc;h(e.elementNodes,e.dynamicNodes,this._memoryManager,e.commentLookup,i),(0,s.insertNodeBeforeNode)(o,i)}}function m(e){return"number"!=typeof e}function h(e,t,o,i,n){for(const t of e){const e=(0,s.getElementByIdInDocumentFragment)(n,t.domId);o.setElementNode({nodeId:t.nodeId,element:e,ltm:t.ltm})}for(const e of t)o.setDynamicNode({nodeId:e.nodeId,type:e.nodeType,commentStart:i.get(e.commentStartId),commentEnd:i.get(e.commentEndId),contentLtm:e.initContentLtm,selfLtm:e.selfLtm,itemNodesId:e.initItemsId})}function g(e){return e.nodeId}t.SandboxModeRenderEngine=u;let f=0})),
define("MsPortalImpl/Weave/SandboxRender",["require","exports","MsPortalImpl/Weave/InternalUtil","WeaveDOM/SandboxRender/WeaveSandbox","MsPortalImpl/Base/Base.KnockoutExtensions.Image","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Weave/SandboxDomAgents/EntryPoint","MsPortalImpl/Base/Base.Timers","WeaveDOM/Core/InternalUtil","Weave/Core/InternalUtil"],(function(e,t,s,o,i,n,r,a,l,c){"use strict";function d(e,t,o){return{eventName:e,handler:({element:i,elementNodeId:n,ltm:r,options:a})=>{const d=a;(0,l.attachEventListener)(i,r,t,(i=>{(0,s.matchKeyCode)(d?.stopPropagation,i.keyCode)&&i.stopPropagation(),(0,s.matchKeyCode)(d?.preventDefault,i.keyCode)&&i.preventDefault(),o.postMessage({type:"event",elementNodeId:n,eventName:e,eventData:(0,c.getEventData)(i,t)})}))}}}Object.defineProperty(t,"__esModule",{value:!0}),t.connectWeaveShellPort=void 0,t.connectWeaveShellPort=function(t,c,p,u){let m=!1;return(0,o.connect_internal)(c,{cssLoader:u,registerOnReceive:e=>{if(m)throw new Error("onReceive can only be registered once.");m=!0,t.onObject((t=>{e(t.body,t.obj)}))},registerOnDispose:e=>t.onDispose(e),notificationCallback:e=>t.postMessage(e),attributeSanitizer:{href:t=>(0,s.sanitizeHref)(t,{diContainer:p,windowContext:c,localRequire:e}),src:s.sanitizeSrc},htmlElementDataSerializer:(0,s.makeHtmlDataHandler)(c,p,!1),customEventHandlers:[{eventName:"fxResize",handler:({element:e,elementNodeId:s,ltm:o})=>{(0,a.requestAnimationFrame)((()=>{o.isDisposed()||(0,n.track)(o.createChildLifetime(),$(e).first(),((e,o)=>{(e>0||o>0)&&t.postMessage({type:"event",elementNodeId:s,eventName:"fxResize",eventData:{height:o,width:e}})}),{notifyInitialSize:!0,partialPixels:!0})}))}},{eventName:"fxCustomClick",handler:({element:e,elementNodeId:s,ltm:o,options:i})=>{const n=i;(0,l.attachEventListener)(e,o,"click",(e=>{!0===n?.stopPropagation&&e.stopPropagation(),!0===n?.preventDefault&&e.preventDefault(),t.postMessage({type:"event",elementNodeId:s,eventName:"fxCustomClick",eventData:null})}))}},d("fxCustomKeyDown","keydown",t),d("fxCustomKeyUp","keyup",t),d("fxCustomKeyPress","keypress",t)],customInstructionHandlers:[{name:"fxSetImage",handler:(e,t)=>(0,i.renderImage)(t.getElementMetadata(e.elementNodeId).element,e.value)},{name:"fxSetFocus",handler:(e,t)=>t.getElementMetadata(e.elementNodeId).element.focus()},{name:"fxRequestConfirm",handler:(e,s)=>{const o=window.confirm(e.value.content)?"ok":"cancel";t.postMessage({type:"fxAnswerConfirm",value:{reply:o,replyId:e.value.replyId}})}}],createHookState:()=>[],serializeHooks:{element:{postSerialize:({addAttribute:e,getElementNodeId:t,node:s,options:o,ltm:i,hooksState:n})=>{const r=s;r.proxiedDataIndexes&&r.proxiedDataIndexes.length>0&&(r.proxiedDataIndexes.some((e=>"pcControl"===o[e].type))&&e("data-bind","pcControl: __control_vm__"),n.push({ltm:i,nodeId:t(),proxiedDataList:r.proxiedDataIndexes.map((e=>o[e]))}))}}},postRender:({hooksState:e,getElement:t})=>{for(const o of e){const e=t(o.nodeId),i=o.ltm;let n=!1,a=!1,l=!1;for(const t of o.proxiedDataList)switch(t.type){case"pcControl":{if(n)throw new Error("Duplicate control vm associated to one element found.");n=!0;const s=t.data,o=new ko.bindingContext({__control_vm__:s.vm}).extend({$tabIndex:s.tabIndex,$disabled:s.disabled,$partName:s.partName,$extensionName:s.extensionName,$vm:s.vm,$dicontainer:p});ko.applyBindings(o,e),i.registerForDispose((()=>ko.cleanNode(e)));break}case"fxclick":{if(a)throw new Error("Duplicate fxclick associated to one element found.");a=!0;const o=t.data;(0,s.applyFxClickToElement)(e,i,o.data,{diContainer:p,disabled:o.disabled,tabIndex:o.tabIndex});break}case"domAgent":if(l)throw new Error("Duplicate attachWidget associated to one element found.");l=!0,(0,r.attachSandboxDomAgent)(e,i,p,t.data);break;default:throw new Error(`Unknown proxied data type: ${t.type}`)}}}})}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css",["module"],(function(e){"use strict";return{css:".fxs-part-error-content{display:flex;flex-flow:column nowrap;height:100%;box-sizing:border-box;max-width:715px;font-size:13px;margin:0 auto}.fxs-part-error-reason,.fxs-part-error-detailslink{text-align:center;flex:0 0 auto;margin-bottom:4px}.fxs-part-error-healthlinkcontainer{margin:-10px 15px 0}.fxs-part-error-showdetailscontainer{display:flex;flex-flow:row nowrap;align-items:center;justify-content:center}.fxs-part-error-detailslink{display:none}.fxs-part .fxs-part-content.fxs-errorpart~.fxs-part-nodatamessage{display:none!important}.fxs-part-error-iconcontainer{display:flex;flex-flow:column nowrap;align-items:center;justify-content:center;flex:0 1 auto}.fxs-part-error-icon{flex:0 0 auto;display:block;height:50px;width:50px;padding:10px}.fxs-part-error-commandlist{flex:0 0 auto}.fxs-part-error-commandlist .azc-toolbar-container{justify-content:center}.fxs-part-error-summary{border-width:1px;border-style:solid;overflow-x:hidden;overflow-y:auto;flex:0 1 auto;margin:10px 0}.fxs-part-error-summaryheadercontainer{margin:15px;display:flex;align-items:center}.fxs-part-error-summaryheader{margin:0}.fxs-part-error-summaryfooter{margin:15px}.fxs-part-error-summarycopybutton{margin-left:15px}.fxs-part-error-summarylist{list-style-type:none;padding:0;margin:15px;display:flex;flex-flow:row wrap;align-content:flex-start}.fxs-part-error-summarylistitem{margin:0 10px 10px 0;width:calc(50% - 10px);min-width:225px}.fxs-part-error-summarylistitem-key,.fxs-part-error-summarylistitem-value{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.fxs-part-error-details{margin:15px}.fxs-tilesize-mini .fxs-part-error .fxs-part-error-icon,.fxs-tilesize-small .fxs-part-error .fxs-part-error-icon{margin-top:-15px}.fxs-tilesize-mini .fxs-part-error .fxs-part-error-detailslink,.fxs-tilesize-small .fxs-part-error .fxs-part-error-detailslink{padding:0;margin-top:-12px}.fxs-part-error-hidereason .fxs-part-error-reason{display:none}.fxs-part-error-hidecommandlist .fxs-part-error-commandlist{display:none}.fxs-part-error-hidecommandlist .fxs-part-error-detailslink{display:inline-block}.fxs-part-error-hidesummary .fxs-part-error-summary{display:none}.fxs-blade-errorcontent .fxs-part-error-icon{height:125px;width:125px}.fxs-blade-errorcontent .fxs-part-error-reason{font-size:18px}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.PartError",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","Fx/ResourceManagement","Fx/Ajax","Fx/Experimentation","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Resources/ImplScriptResources","Fx/Controls/CopyableLabel","Fx/Controls/Toolbar","MsPortalImpl/Widgets/Widgets.WidgetBase","Viva.Controls/Util/Viva.Resize","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=t.fetchEligibleAssignments=void 0;var g=MsPortalFx.Base,f=g.Diagnostics.Telemetry;(0,m.injectCss)(h);const x=window,b="fxs-errorpart",y=l.PartError,v=s("div",{class:"fxs-part-error-content","data-bind":{css:"responsiveClasses"}},s("div",{class:"fxs-part-error-iconcontainer"},s("div",{"data-bind":{image:"data.icon"},class:"fxs-part-error-icon"})),s("div",{"data-bind":{untrustedContent:"data.errorOptions.message"},class:"fxs-part-error-reason"}),s("div",{class:"fxs-part-error-showdetailscontainer"},s("a",{href:"#",role:"button","data-bind":{click:"$data.showdetails",clickBubble:"false",text:"$data.showdetailstext"},class:"fxs-part-error-detailslink"})),s("div",{"data-bind":{pcControl:"toolbar"},class:"fxs-part-error-commandlist"}),s("div",{class:"fxs-part-error-summary fxs-portal-bg-txt-br"},s("div",{class:"fxs-part-error-summaryheadercontainer"},s("h4",{class:"fxs-part-error-summaryheader msportalfx-font-semibold"},y.summary),s("div",{"data-bind":{pcControl:"copyBtn"},class:"fxs-part-error-summarycopybutton"})),s("ul",{"data-bind":{foreach:"data.summaryItems"},class:"fxs-part-error-summarylist"},s("li",{class:"fxs-part-error-summarylistitem"},s("label",{"data-bind":{text:"label"},class:"fxs-part-error-summarylistitem-key fxs-portal-subtext"}),s("div",{"data-bind":{text:"value"},class:"fxs-part-error-summarylistitem-value"}))),s("div",{"data-bind":{visible:"data.errorOptions.code >= 500"},class:"fxs-part-error-healthlinkcontainer"},s("a",{href:"#blade/Microsoft_Azure_Health/AzureHealthBrowseBlade/serviceIssues","data-bind":{text:"$data.azurehealth"}})),s(o.KoIf,{condition:"data.errorOptions.details"},s("div",{class:"fxs-part-error-details"},s("label",{class:"fxs-part-error-summarylistitem-key fxs-portal-subtext"},y.details),s("div",{"data-bind":{untrustedContent:"data.errorOptions.details"},class:"fxs-part-error-summarylistitem-details"})))));async function M(e,t,s){const o=await e.get(a.AuthStateManager).getUserInfo().then((e=>e.objectId));if(!o)return null;{const e=(0,n.getEndpoints)().arm+`${t}${s}&$filter=assignedTo('${o}') and atScope()`;try{return await(0,n.ajax)({uri:e,setAuthorizationHeader:!0})}catch(e){return e.message}}}t.fetchEligibleAssignments=M;class C extends p.ViewModel{constructor(e,t,s){super(),this.commands=ko.observableArray([]),s=s||{};const o=MsPortalFx.extend({},e,!0);this.originalShellProps=t=t||{},o.message=o.message||y.title;const i="number"==typeof o.code?o.code:"number"==typeof t.code?t.code:Number.NaN;o.code=i;const n={title:y.title};switch(i){case 404:case 410:this.icon=g.Images.Polychromatic.ContentErrorNotFound(n);break;case 401:case 403:this.icon=g.Images.Polychromatic.ContentErrorUnauthorized(n);break;default:this.icon=g.Images.Polychromatic.ContentErrorGeneric(n)}const r=[{label:y.sessionId,value:t.sessionId||y.notAvailable},{label:y.resourceId,value:t.resourceId||y.notAvailable},{label:y.extName,value:t.extName||y.notAvailable},{label:y.contentName,value:t.contentName||y.notAvailable},{label:y.errorCode,value:isNaN(i)?"--":i+""}];o.summaryItems&&(o.summaryItems=o.summaryItems.filter(MsPortalFx.notNullOrUndefined).map((e=>({label:e.label||"",value:e.value||""}))),r.push(...o.summaryItems)),this.summaryItems=r,this.errorOptions=o,this.showDetailsCmd=s.showDetailsCmd||!1}cloneForDetailsPane(){const e=new C(this.errorOptions,this.originalShellProps);return e.commands.push(...this.commands.peek()||[]),e}}t.ViewModel=C;class P extends p.Widget{constructor(e,t,s){super(e,t),this._diContainer=s,e.html(v).addClass(b);const o=ko.observable(""),n=i.ArmId.parse(t.originalShellProps.resourceId,!0),a=n.subscription??"",p=n.resourceGroup??"",m=n.resourceType??"",h=`subscriptions${a}/resourceGroups${p}/providers/Microsoft.Authorization/roleEligibilityScheduleInstances`;u.track(this.ltm,this.element.first(),((e,s)=>{const i=[];switch((e<145||s<145)&&i.push("fxs-part-error-hidereason"),(e<235||s<145)&&i.push("fxs-part-error-hidecommandlist"),(e<255||s<235)&&i.push("fxs-part-error-hidesummary"),t.errorOptions.code){case 404:case 410:i.push("fxs-part-notfoundmessage","fxs-part-notfound");break;case 401:case 403:i.push("fxs-part-noaccessmessage")}o(i.join(" "))}));const C=()=>(f.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"DetailView",context:{content:t.originalShellProps.contentName}}),MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((e=>{e.showErrorContextPane(this._diContainer,this.ltm,t)})),!1);let P=[];if(t.showDetailsCmd&&P.push(d.ToolbarItems.createBasicButton(this.ltm,{label:y.errordetailsbtn,icon:g.Images.Gear(),onClick:C})),t.commands().length&&(P=t.commands().map((e=>d.ToolbarItems.createBasicButton(this.ltm,{label:e.text,icon:e.icon,onClick:()=>{e.execute(!1)}})))),MsPortalFx.isFeatureEnabled("parterrorshowprodbutton")&&P.push(d.ToolbarItems.createBasicButton(this.ltm,{label:y.openProductionUri,icon:g.Images.Hyperlink(),onClick:()=>{f.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"LeavePreview",context:{content:t.originalShellProps.contentName}});const e=new g.UriBuilder(x.location.toString());e.path=e.path.replace("//rc.","//").replace("//ms.","//").replace("//preview.","//"),e.query.setParameter("feature.customportal","false"),x.open(e.toString())}})),401!==t.errorOptions.code&&403!==t.errorOptions.code&&(P.push(d.ToolbarItems.createBasicButton(this.ltm,{label:y.getsupportbtn,icon:g.Images.Help(),onClick:()=>{f.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"NewSupportRequest",context:{content:t.originalShellProps.contentName}}),MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((e=>{e.openSubmitSupportCase(this._diContainer,{callerName:`${t.originalShellProps.extName} + ${t.originalShellProps.contentName||"##Content Unknown##"}`,assetId:t.originalShellProps.resourceId,issueType:"technical",issueContext:{shellProps:JSON.stringify(t.originalShellProps),error:JSON.stringify(t.errorOptions)}})}))}})),P.push(d.ToolbarItems.createBasicButton(this.ltm,{label:y.selfDiagnostics,icon:g.Images.Wrench(),onClick:()=>{f.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"SelfDiagnostics",context:{content:t.originalShellProps.contentName}});const e=fx.environment.applicationPath+"/SelfHelp";window.open(e)}}))),401===t.errorOptions.code||403===t.errorOptions.code){(async()=>{let e;try{e=await M(s,h,"?api-version=2020-10-01")}catch(t){e=`Error capturing eligible assignments: ${t}`}f.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"NoAccess",context:{origin:t.originalShellProps.contentName,extensionName:t.originalShellProps.extName,message:t.errorOptions.message,details:t.errorOptions.details,summaryItems:t.errorOptions.summaryItems,resourceGroup:p,subscriptionId:a,resourceType:m,eligibleAssignments:e}})})();(async()=>{if(this._diContainer.get(r.Experimentation).shellAssignments.getBooleanValue("ShowNoAccessBlade")){const e=await MsPortalFx.require("react"),s=(await MsPortalFx.require("react-dom/client")).createRoot,o=(await MsPortalFx.require("MsPortalImpl/Widgets/NoAccess/NoAccessRedesign.React")).NoAccessRedesign;s(document.getElementsByClassName("fxs-blade-content-container")[0]).render(e.createElement(o,{dicontainer:this._diContainer,parameters:{sessionId:MsPortalFx.sessionId,resourceId:t.originalShellProps.resourceId,errorCode:t.errorOptions.code.toString(),requiredPermission:l.NoAccess.Required.permissions,details:t.errorOptions.message.toString()}}))}})()}const w=d.create(this.ltm,{items:P,showLabels:!0}),I=c.create(this.ltm,{ariaLabel:y.copySummary,hideTextbox:!0,value:JSON.stringify({shellProps:t.originalShellProps,error:t.errorOptions},null,2)});this._bindDescendants({responsiveClasses:o,showdetails:C,showdetailstext:y.errordetailsbtn,azurehealth:y.azurehealthlink,toolbar:w,copyBtn:I})}dispose(){this._cleanElement(b),super.dispose()}}t.Widget=P})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureCompatibleOfficeLayoutGrid.css",["module"],(function(e){"use strict";return{css:'.ms-Grid{box-sizing:border-box;zoom:1;padding:0 8px}.ms-Grid::before,.ms-Grid::after{display:table;content:"";line-height:0}.ms-Grid::after{clear:both}.ms-Grid-row{margin:0 -8px;box-sizing:border-box;zoom:1}.ms-Grid-row::before,.ms-Grid-row::after{display:table;content:"";line-height:0}.ms-Grid-row::after{clear:both}.ms-Grid-col{position:relative;min-height:1px;padding-left:8px;padding-right:8px;box-sizing:border-box}.ms-Grid-col{float:left}.ms-Grid-col .ms-Grid{padding:0}.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenSm,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenMdDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenLgDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenXlDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenXxlDown{display:none!important}.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMd,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMdUp,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMdDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenLgDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenXlDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenXxlDown{display:none!important}.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenMdUp,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLg,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLgUp,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLgDown,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenXlDown,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenXxlDown{display:none!important}.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenMdUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenLgUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXl,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXlUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXlDown,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXxlDown{display:none!important}.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenMdUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenLgUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXlUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxl,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxlUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxlDown{display:none!important}.fxs-blade-layout-xxxl .ms-hiddenMdUp,.fxs-blade-layout-xxxl .ms-hiddenLgUp,.fxs-blade-layout-xxxl .ms-hiddenXlUp,.fxs-blade-layout-xxxl .ms-hiddenXxlUp,.fxs-blade-layout-xxxl .ms-hiddenXxxl{display:none!important}.ms-sm12{width:100%}.ms-sm11{width:91.66666667%}.ms-sm10{width:83.33333333%}.ms-sm9{width:75%}.ms-sm8{width:66.66666667%}.ms-sm7{width:58.33333333%}.ms-sm6{width:50%}.ms-sm5{width:41.66666667%}.ms-sm4{width:33.33333333%}.ms-sm3{width:25%}.ms-sm2{width:16.66666667%}.ms-sm1{width:8.33333333%}.fxs-blade-layout-md .ms-md12{width:100%}.fxs-blade-layout-md .ms-md11{width:91.66666667%}.fxs-blade-layout-md .ms-md10{width:83.33333333%}.fxs-blade-layout-md .ms-md9{width:75%}.fxs-blade-layout-md .ms-md8{width:66.66666667%}.fxs-blade-layout-md .ms-md7{width:58.33333333%}.fxs-blade-layout-md .ms-md6{width:50%}.fxs-blade-layout-md .ms-md5{width:41.66666667%}.fxs-blade-layout-md .ms-md4{width:33.33333333%}.fxs-blade-layout-md .ms-md3{width:25%}.fxs-blade-layout-md .ms-md2{width:16.66666667%}.fxs-blade-layout-md .ms-md1{width:8.33333333%}.fxs-blade-layout-lg .ms-lg12{width:100%}.fxs-blade-layout-lg .ms-lg11{width:91.66666667%}.fxs-blade-layout-lg .ms-lg10{width:83.33333333%}.fxs-blade-layout-lg .ms-lg9{width:75%}.fxs-blade-layout-lg .ms-lg8{width:66.66666667%}.fxs-blade-layout-lg .ms-lg7{width:58.33333333%}.fxs-blade-layout-lg .ms-lg6{width:50%}.fxs-blade-layout-lg .ms-lg5{width:41.66666667%}.fxs-blade-layout-lg .ms-lg4{width:33.33333333%}.fxs-blade-layout-lg .ms-lg3{width:25%}.fxs-blade-layout-lg .ms-lg2{width:16.66666667%}.fxs-blade-layout-lg .ms-lg1{width:8.33333333%}.fxs-blade-layout-xl .ms-xl12{width:100%}.fxs-blade-layout-xl .ms-xl11{width:91.66666667%}.fxs-blade-layout-xl .ms-xl10{width:83.33333333%}.fxs-blade-layout-xl .ms-xl9{width:75%}.fxs-blade-layout-xl .ms-xl8{width:66.66666667%}.fxs-blade-layout-xl .ms-xl7{width:58.33333333%}.fxs-blade-layout-xl .ms-xl6{width:50%}.fxs-blade-layout-xl .ms-xl5{width:41.66666667%}.fxs-blade-layout-xl .ms-xl4{width:33.33333333%}.fxs-blade-layout-xl .ms-xl3{width:25%}.fxs-blade-layout-xl .ms-xl2{width:16.66666667%}.fxs-blade-layout-xl .ms-xl1{width:8.33333333%}.fxs-blade-layout-xxl .ms-xxl12{width:100%}.fxs-blade-layout-xxl .ms-xxl11{width:91.66666667%}.fxs-blade-layout-xxl .ms-xxl10{width:83.33333333%}.fxs-blade-layout-xxl .ms-xxl9{width:75%}.fxs-blade-layout-xxl .ms-xxl8{width:66.66666667%}.fxs-blade-layout-xxl .ms-xxl7{width:58.33333333%}.fxs-blade-layout-xxl .ms-xxl6{width:50%}.fxs-blade-layout-xxl .ms-xxl5{width:41.66666667%}.fxs-blade-layout-xxl .ms-xxl4{width:33.33333333%}.fxs-blade-layout-xxl .ms-xxl3{width:25%}.fxs-blade-layout-xxl .ms-xxl2{width:16.66666667%}.fxs-blade-layout-xxl .ms-xxl1{width:8.33333333%}.fxs-blade-layout-xxxl .ms-xxxl12{width:100%}.fxs-blade-layout-xxxl .ms-xxxl11{width:91.66666667%}.fxs-blade-layout-xxxl .ms-xxxl10{width:83.33333333%}.fxs-blade-layout-xxxl .ms-xxxl9{width:75%}.fxs-blade-layout-xxxl .ms-xxxl8{width:66.66666667%}.fxs-blade-layout-xxxl .ms-xxxl7{width:58.33333333%}.fxs-blade-layout-xxxl .ms-xxxl6{width:50%}.fxs-blade-layout-xxxl .ms-xxxl5{width:41.66666667%}.fxs-blade-layout-xxxl .ms-xxxl4{width:33.33333333%}.fxs-blade-layout-xxxl .ms-xxxl3{width:25%}.fxs-blade-layout-xxxl .ms-xxxl2{width:16.66666667%}.fxs-blade-layout-xxxl .ms-xxxl1{width:8.33333333%}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedChartingColor.css",["module"],(function(e){"use strict";return{css:".msportalfx-bgcolor-a1{background-color:#fcd116;color:#000}.msportalfx-bgcolor-b1{background-color:#eb3c00;color:#fff}.msportalfx-bgcolor-c1{background-color:#ba141a;color:#fff}.msportalfx-bgcolor-d1{background-color:#b4009e;color:#fff}.msportalfx-bgcolor-e1{background-color:#442359;color:#fff}.msportalfx-bgcolor-f1{background-color:#002050;color:#fff}.msportalfx-bgcolor-g1{background-color:#0072c6;color:#fff}.msportalfx-bgcolor-h1{background-color:#008272;color:#fff}.msportalfx-bgcolor-i1{background-color:#007233;color:#fff}.msportalfx-bgcolor-j1{background-color:#7fba00;color:#fff}.msportalfx-bgcolor-k1{background-color:#a0a5a8;color:#fff}.msportalfx-bgcolor-a0{background-color:#fff100;color:#000}.msportalfx-bgcolor-b0{background-color:#ff8c00;color:#fff}.msportalfx-bgcolor-c0{background-color:#e81123;color:#fff}.msportalfx-bgcolor-d0{background-color:#ec008c;color:#fff}.msportalfx-bgcolor-e0{background-color:#68217a;color:#fff}.msportalfx-bgcolor-f0{background-color:#00188f;color:#fff}.msportalfx-bgcolor-g0{background-color:#00bcf2;color:#fff}.msportalfx-bgcolor-h0{background-color:#00b294;color:#fff}.msportalfx-bgcolor-i0{background-color:#009e49;color:#fff}.msportalfx-bgcolor-j0{background-color:#bad80a;color:#000}.msportalfx-bgcolor-k0{background-color:#bbc2ca;color:#000}.msportalfx-bgcolor-a2{background-color:#fffc9e;color:#000}.msportalfx-bgcolor-b2{background-color:#ffb900;color:#000}.msportalfx-bgcolor-c2{background-color:#dd5900;color:#fff}.msportalfx-bgcolor-d2{background-color:#f472d0;color:#fff}.msportalfx-bgcolor-e2{background-color:#9b4f96;color:#fff}.msportalfx-bgcolor-f2{background-color:#4668c5;color:#fff}.msportalfx-bgcolor-g2{background-color:#6dc2e9;color:#000}.msportalfx-bgcolor-h2{background-color:#00d8cc;color:#000}.msportalfx-bgcolor-i2{background-color:#55d455;color:#000}.msportalfx-bgcolor-j2{background-color:#e2e584;color:#000}.msportalfx-bgcolor-k2{background-color:#d6d7d8;color:#000}.msportalfx-bgcolor-a0s2{background-color:#807900;color:#fff}.msportalfx-bgcolor-b0s2{background-color:#804600;color:#fff}.msportalfx-bgcolor-c0s2{background-color:#740912;color:#fff}.msportalfx-bgcolor-d0s2{background-color:#760046;color:#fff}.msportalfx-bgcolor-e0s2{background-color:#34113d;color:#fff}.msportalfx-bgcolor-f0s2{background-color:#000c48;color:#fff}.msportalfx-bgcolor-g0s2{background-color:#005e79;color:#fff}.msportalfx-bgcolor-h0s2{background-color:#084c41;color:#fff}.msportalfx-bgcolor-i0s2{background-color:#063d20;color:#fff}.msportalfx-bgcolor-j0s2{background-color:#3d460a;color:#fff}.msportalfx-bgcolor-k0s2{background-color:#32383f;color:#fff}.msportalfx-bgcolor-a0s1{background-color:#bfb500;color:#000}.msportalfx-bgcolor-b0s1{background-color:#bf6900;color:#fff}.msportalfx-bgcolor-c0s1{background-color:#ae0d1a;color:#fff}.msportalfx-bgcolor-d0s1{background-color:#b10069;color:#fff}.msportalfx-bgcolor-e0s1{background-color:#4e195c;color:#fff}.msportalfx-bgcolor-f0s1{background-color:#00126b;color:#fff}.msportalfx-bgcolor-g0s1{background-color:#008db5;color:#fff}.msportalfx-bgcolor-h0s1{background-color:#00856f;color:#fff}.msportalfx-bgcolor-i0s1{background-color:#0f5b2f;color:#fff}.msportalfx-bgcolor-j0s1{background-color:#8ba208;color:#fff}.msportalfx-bgcolor-k0s1{background-color:#464f59;color:#fff}.msportalfx-bgcolor-a0t1{background-color:#fcf37e;color:#000}.msportalfx-bgcolor-b0t1{background-color:#ffba66;color:#000}.msportalfx-bgcolor-c0t1{background-color:#f1707b;color:#fff}.msportalfx-bgcolor-d0t1{background-color:#f466ba;color:#fff}.msportalfx-bgcolor-e0t1{background-color:#a47aaf;color:#fff}.msportalfx-bgcolor-f0t1{background-color:#6674bc;color:#fff}.msportalfx-bgcolor-g0t1{background-color:#66d7f7;color:#000}.msportalfx-bgcolor-h0t1{background-color:#66d1bf;color:#000}.msportalfx-bgcolor-i0t1{background-color:#66c592;color:#000}.msportalfx-bgcolor-j0t1{background-color:#d6e86c;color:#000}.msportalfx-bgcolor-k0t1{background-color:#8f9ca8;color:#fff}.msportalfx-bgcolor-a0t2{background-color:#fffccc;color:#000}.msportalfx-bgcolor-b0t2{background-color:#ffe8cc;color:#000}.msportalfx-bgcolor-c0t2{background-color:#facfd3;color:#000}.msportalfx-bgcolor-d0t2{background-color:#fbcce8;color:#000}.msportalfx-bgcolor-e0t2{background-color:#e1d3e4;color:#000}.msportalfx-bgcolor-f0t2{background-color:#ccd1e9;color:#000}.msportalfx-bgcolor-g0t2{background-color:#ccf2fc;color:#000}.msportalfx-bgcolor-h0t2{background-color:#ccf0ea;color:#000}.msportalfx-bgcolor-i0t2{background-color:#ccecdb;color:#000}.msportalfx-bgcolor-j0t2{background-color:#f0f7b2;color:#000}.msportalfx-bgcolor-k0t2{background-color:#63707e;color:#fff}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedSemanticText.css",["module"],(function(e){"use strict";return{css:'.msportalfx-text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-font-regular{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400}.msportalfx-font-bold{font-weight:700}.msportalfx-font-semibold{font-weight:600}.msportalfx-font-light,.msportalfx-font-semilight{font-weight:200}.msportalfx-font-monospace{font-family:Consolas,"Courier New",monospace;font-size:13px;line-height:normal}.msportalfx-text-header{font-size:14px;line-height:18px}.msportalfx-text-header-small,.msportalfx-text-label{font-size:13px;line-height:normal;text-transform:uppercase}.msportalfx-text-small{font-size:13px;line-height:normal}.msportalfx-text-subheader{font-size:10px;line-height:10px;padding-bottom:1px}html[lang^="ja"] .msportalfx-text-subheader,html[lang^="ko"] .msportalfx-text-subheader,html[lang^="zh"] .msportalfx-text-subheader{font-size:11px;line-height:11px}.msportalfx-text-header-regular{font-size:14px;line-height:18px}.msportalfx-text-regular{font-size:13px;line-height:normal}.msportalfx-text-preview{font-weight:600;font-size:11px;line-height:11px;text-transform:uppercase;color:#fff}.msportalfx-text-createsectionheader{font-weight:200;font-size:20px;line-height:normal}.msportalfx-number-jumbo{font-weight:600;font-size:60px;line-height:60px;letter-spacing:-.02em}.msportalfx-number-large{font-weight:600;font-size:43px;line-height:43px;letter-spacing:-.02em}.msportalfx-number-medium{font-weight:600;font-size:30px;line-height:30px;letter-spacing:-.025em}.msportalfx-number-small{font-weight:600;font-size:17px;line-height:17px;letter-spacing:-.02em}.msportalfx-number-jumbo-adorn{font-weight:700;font-size:20px;line-height:20px;letter-spacing:-.02em}.msportalfx-number-large-adorn{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-medium-adorn{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-small-adorn{font-weight:700;font-size:10px;line-height:10px;letter-spacing:-.05em}.msportalfx-lineheight-reset{line-height:normal}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureSemanticText.css",["module"],(function(e){"use strict";return{css:'.az-text-small{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;font-size:10px;line-height:1.4}.az-text-note{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;font-size:12px;line-height:1.33333}.az-text-body{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;font-size:13px;line-height:1.38462}.az-text-label{font-weight:600;font-size:13px;line-height:1.38462}.az-text-header3{font-weight:600;font-size:14px;line-height:1.42857}.az-text-header2{font-weight:600;font-size:16px;line-height:1.375}.az-text-header1{font-weight:600;font-size:18px;line-height:1.33333}.az-text-greeting{font-weight:600;font-size:20px;line-height:1.4}@media print{.az-text-header1,.az-text-header2,.az-text-header3,.az-text-label{break-after:avoid}}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureUtil.css",["module"],(function(e){"use strict";return{css:".az-display-none{display:none!important}@media print{.az-noprint{display:none!important}}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/CustomForm.css",["module"],(function(e){"use strict";return{css:'.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementSubLabelContainer{display:inline-block;vertical-align:middle;width:68%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:80px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-form-labelcontainer{width:32%;display:inline-block}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular .msportalfx-form-extralabel{display:block;width:68%;margin-left:33%;margin-right:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:nth-child(odd),.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:nth-child(odd){margin-right:1%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement{min-height:43px;width:48.75%!important;display:inline-block;vertical-align:top;margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:last-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:last-child{margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-multiLineTextField{height:auto;margin-right:1px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:100px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-form-labelcontainer{display:block;margin-bottom:0;width:auto;min-height:20px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-formElementSubLabelContainer{display:block;width:100%;margin-left:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-extralabel>.msportalfx-form-extralabel{display:inline-block;width:47.75%;margin:43px 1% -49.75%!important}.msportalfx-form.msportalfx-form-custom .msportalfx-form-extralabel{margin-top:0}.fxs-bladestyle-create .msportalfx-form{margin-top:14px}.fxs-bladestyle-create .msportalfx-form .msportalfx-form{margin-top:0}.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement{padding-bottom:15px;width:100%;min-height:23px}.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement .msportalfx-form-formelement{padding-bottom:0}.msportalfx-form.msportalfx-vertical-compact>div>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact .fxc-section>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>.msportalfx-form-formelement{padding-bottom:7px}.msportalfx-form .msportalfx-form-labelcontainer,.msportalfx-form .azc-form-labelcontainer,.msportalfx-form .azc-checkBoxField-inlineLabelContainer{box-sizing:border-box;min-height:17px}.msportalfx-form .msportalfx-form-labelcontainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .azc-checkBoxField-inlineLabelContainer label{max-width:calc(100% - 25px)}.msportalfx-form .azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px)}.msportalfx-form .azc-checkBoxField-inlineLabelContainer label{font-size:13px;line-height:normal}.msportalfx-form .azc-validatableControl-invalid+.azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px - 6px)}.msportalfx-form .msportalfx-form-labelcontainer label,.msportalfx-form .azc-form-labelcontainer label{font-size:13px;line-height:normal}.msportalfx-form.msportalfx-form-row{padding:0 20px;width:calc(100% - 40px)}.msportalfx-form .azc-multiLineTextField .azc-multiLineTextBox{height:100%}.azc-text-sublabel{float:right;margin-bottom:-1px}.fxc-has-sublabel-html>.azc-formElementSubLabelContainer>.azc-text-sublabel{float:none}.azc-formElementSubLabelContainer::after{content:"";display:table;clear:both}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor{padding-bottom:16px}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-form-labelcontainer{padding-bottom:calc(16px + 3px)}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-checkBoxField-inlineLabelContainer{padding-bottom:0}.azc-required-balloon{display:inline-block}.msportalfx-form-extralabel{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:right;margin-top:-15px;padding-bottom:3px}.msportalfx-customHtml .msportalfx-form-extralabel{margin-top:0}.msportalfx-customHtml>.azc-formElementSubLabelContainer{height:100%}.msportalfx-customHtml>.azc-formElementSubLabelContainer>.azc-formElementContainer{height:100%}.msportalfx-form-formelement .azc-dockedballoon.azc-dockedballoon-info{height:15px;width:15px}.msportalfx-nested-control:not(.fxc-left-label){padding-left:45px;position:relative;box-sizing:border-box}.msportalfx-nested-control:not(.fxc-left-label)::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-9px;left:3px;height:calc(50% + 7px);width:32px}.msportalfx-nested-control.fxc-left-label>.azc-form-labelcontainer{padding-left:45px;position:relative;box-sizing:border-box}.msportalfx-nested-control.fxc-left-label>.azc-form-labelcontainer::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-13px;left:3px;height:22px;width:32px}.msportalfx-form-regular div.msportalfx-nested-control::before,.msportalfx-form-regular .msportalfx-nested-control::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-13px;left:3px;height:22px;width:32px}.msportalfx-nested-control:not(.fxc-left-label)::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-9px;left:3px;height:40px;width:32px}.fxc-left-label-fixed.fxc-smart-labels .msportalfx-nested-control .azc-form-labelcontainer{max-width:205px!important}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/CustomPart.css",["module"],(function(e){"use strict";return{css:'.msportalfx-layoutChildren-horizontal-inlineblock{white-space:nowrap;line-height:0;font-size:0}.msportalfx-layoutChildren-horizontal-inlineblock>.msportalfx-layoutChildren-child{display:inline-block;box-sizing:border-box;white-space:normal;font-size:13px;line-height:normal}.msportalfx-layoutChildren-horizontal-float>.msportalfx-layoutChildren-child{float:left;box-sizing:border-box}.msportalfx-layoutChildren-horizontal-float::after{content:" ";clear:both;display:block;visibility:hidden;height:0;font-size:0;line-height:0}.msportalfx-bgcolor-themeMain{background-color:#00bcf2}.msportalfx-bgcolor-themeWarning{background-color:#db7500}.msportalfx-bgcolor-themeError{background-color:#e81123}.msportalfx-bgcolor-themeSuccess{background-color:#7fba00}.msportalfx-bgcolor-paletteDiffAdd{background-color:#c7f1c7}.msportalfx-bgcolor-paletteDiffDel{background-color:#fcd6f1}.msportalfx-bgcolor-white{background-color:#fff}.msportalfx-padding{padding:20px;box-sizing:border-box}.msportalfx-docking{display:flex;flex-direction:column;width:100%;height:100%}.msportalfx-docking-header{flex:0 0 auto}.msportalfx-docking-body{flex:1 1 auto;height:100%;min-height:0;overflow-x:hidden;overflow-y:auto}.msportalfx-docking-footer{flex:0 0 auto;border-top:1px solid}.msportalfx-vertical-center{display:flex;flex-flow:row nowrap;align-items:center}.msportalfx-removeTableBorders{border-spacing:0;border-collapse:collapse}.msportalfx-boxsizing-borderbox{box-sizing:border-box}.msportalfx-removeDefaultListStyle{list-style-type:none;padding:0;margin:0}.msportalfx-removeDefaultListStyle>li{margin:0;padding:0}.msportalfx-fill{height:100%;width:100%}.msportalfx-clearfix::after{content:" ";clear:both;display:block;visibility:hidden;height:0;font-size:0;line-height:0}.fxs-tilesize-fittocontainer .msportalfx-overflowY,.azc-graph-node-container .msportalfx-overflowY{overflow-x:hidden;overflow-y:auto}.msportalfx-unselectable{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.msportalfx-removepartpadding{height:calc(100% + 15px + 15px);width:calc(100% + 15px + 15px);margin:-15px -15px -15px -15px}.msportalfx-removepartpaddingside{width:calc(100% + 15px + 15px);margin:0 -15px 0 -15px}.fxs-blade-locked .msportalfx-removepartpadding{height:calc(100% + 15px);width:100%;margin:0 0 15px}.fxs-blade-locked .msportalfx-removepartpaddingside{width:100%;margin:0}.fxs-blade-locked .fxs-tilesize-fittocontainer .msportalfx-removepartpadding{height:100%;width:100%;margin:0}.msportalfx-partdivider::after{content:"";display:block;width:calc(100% + 15px + 15px);margin:0 -15px 0 -15px;border-bottom-width:1px;border-bottom-style:solid}.msportalfx-code{font-family:Consolas,"Courier New",monospace;font-size:13px;line-height:normal;background-color:#f1f1f8;color:#32383f;border:1px solid #dcdfe2;border-left:5px solid #dcdfe2;padding:10px 10px 10px 15px;margin:5px 0;overflow-x:auto}.msportalfx-gettingstarted-part{color:#fff}.msportalfx-refresh-icon img,.msportalfx-refresh-icon svg{height:12px;width:12px;vertical-align:baseline}.msportalfx-tile-status-icon img,.msportalfx-tile-status-icon svg{height:16px;width:16px;vertical-align:middle}.msportalfx-gridcolumn-asseticon img,.msportalfx-gridcolumn-asseticon svg{margin-top:4px;height:21px;width:21px}.msportalfx-gridcolumn-assetsvg-icon .fx-grid-formatters-svgicon{width:21px!important;height:21px!important}.msportalfx-gridcolumn-assetsvg-icon img,.msportalfx-gridcolumn-assetsvg-icon svg{height:21px;width:21px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-badge{margin-left:-21px;height:21px;width:21px;vertical-align:middle;display:inline-block}.msportalfx-gridcolumn-assetsvg-badge img,.msportalfx-gridcolumn-assetsvg-badge svg{height:10px;width:10px;margin-top:11px}.msportalfx-gridcolumn-assetsvg-text{margin-left:10px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-textbox{vertical-align:middle;display:inline-block;margin-left:20px}.msportalfx-gridcolumn-assetsvg-strongtext{vertical-align:middle;margin-left:0}.msportalfx-gridcolumn-assetsvg-linkicon{margin-left:10px;display:inline-block;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon{display:inline-block}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon img,.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon svg{opacity:.4;height:10px;width:10px;vertical-align:middle}.msportalfx-iconcontainer{flex:0 0 auto;box-sizing:border-box}.msportalfx-iconcontainer>img,.msportalfx-iconcontainer>svg{height:50px;width:50px}.fxs-tilesize-mini .msportalfx-iconcontainer>img,.fxs-tilesize-small .msportalfx-iconcontainer>img,.fxs-tilesize-mini .msportalfx-iconcontainer>svg,.fxs-tilesize-small .msportalfx-iconcontainer>svg{height:30px;width:30px}.msportalfx-gridcolumn-statusicon{text-align:center}.msportalfx-gridcolumn-statusicon img,.msportalfx-gridcolumn-statusicon svg{text-align:center;height:15px;width:15px}.msportalfx-gridcolumn-statusicon svg{margin-top:4px}.msportalfx-grid-borderless .azc-grid table tbody tr td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-grid table tbody tr.azc-grid-row:first-of-type td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-grid table tbody:last-child tr:last-child td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-br-muted:not(.fxc-gc-resizing-handleLine,.fxc-grid-resizing-line){border-top-width:0;border-bottom-width:0;border-color:transparent!important}.msportalfx-create-tab{max-width:700px}.msportalfx-create-tab .msportalfx-create-description{font-size:13px;line-height:normal}.msportalfx-create-tab .fxc-section{margin-bottom:15px}.msportalfx-create-section-label{font-weight:600;font-size:14px;line-height:normal}.msportalfx-create-footer .fxc-simplebutton{margin-right:12px}.msportalfx-create-footer a{margin-left:12px}.msportalfx-ext-link{padding-right:15px}.msportalfx-ext-link::after{content:" ";background-color:currentColor;-webkit-mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2015%22%3E%3Cpath%20d=%22M14.3%201H10V0h6v6h-1V1.7l-8%208-.7-.7z%22/%3E%3Cpath%20d=%22M11%208v5a.9.9%200%2001-1%201H2a.9.9%200%2001-1-1V6a.9.9%200%20011-1h6l1-1H2a2%202%200%2000-2%202v7a2%202%200%20002%202h8a2%202%200%20002-2V7z%22/%3E%3C/svg%3E");-webkit-mask-position:center;-webkit-mask-repeat:no-repeat;mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2015%22%3E%3Cpath%20d=%22M14.3%201H10V0h6v6h-1V1.7l-8%208-.7-.7z%22/%3E%3Cpath%20d=%22M11%208v5a.9.9%200%2001-1%201H2a.9.9%200%2001-1-1V6a.9.9%200%20011-1h6l1-1H2a2%202%200%2000-2%202v7a2%202%200%20002%202h8a2%202%200%20002-2V7z%22/%3E%3C/svg%3E");mask-position:center;mask-repeat:no-repeat;width:11px;height:11px;display:inline-block;margin-left:4px;margin-right:-15px;background-size:11px 11px}.fxs-mode-dark .msportalfx-ext-link::after{background-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2015%22%3E%3Cpath%20fill=%22%23ffffff%22%20d=%22M14.3%201H10V0h6v6h-1V1.7l-8%208-.7-.7z%22/%3E%3Cpath%20fill=%22%23ffffff%22%20d=%22M11%208v5a.9.9%200%2001-1%201H2a.9.9%200%2001-1-1V6a.9.9%200%20011-1h6l1-1H2a2%202%200%2000-2%202v7a2%202%200%20002%202h8a2%202%200%20002-2V7z%22/%3E%3C/svg%3E")}.msportalfx-inherit-color{color:inherit!important}.msportalfx-statuspart{position:relative;height:100%;width:100%}.msportalfx-statuspart>*{box-sizing:border-box}.msportalfx-statuspart .msportalfx-statuspart-statussection{height:calc(100% - 55px);padding-top:10px}.msportalfx-statuspart .msportalfx-statuspart-statussection>*{vertical-align:middle}.msportalfx-statuspart .msportalfx-statuspart-statussection>img{height:30px;width:30px}.msportalfx-statuspart .msportalfx-statuspart-statussection>span{font-weight:700;font-size:11px;text-transform:uppercase;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-messagesection{position:absolute;bottom:55px;margin-bottom:25px;height:40px;line-height:0;white-space:normal}.msportalfx-statuspart .msportalfx-statuspart-messagesection>span{font-size:13px;line-height:normal}.msportalfx-statuspart .msportalfx-statuspart-propertysection,.msportalfx-statuspart .msportalfx-statuspart-metricsection{position:absolute;bottom:0;width:100%;height:55px}.msportalfx-statuspart .msportalfx-statuspart-propertysection{padding-top:5px;font-size:13px;line-height:normal}.msportalfx-statuspart .msportalfx-statuspart-propertysection>span,.msportalfx-statuspart .msportalfx-statuspart-propertysection>div{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div{float:left;width:calc(100%/3 - 3px);box-sizing:border-box;border-right:1px solid #8f9ca8;padding-left:7px}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:first-child{padding-left:0}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:last-child{border-right:0}.msportalfx-statuspart .msportalfx-statuspart-metricsection .msportalfx-statuspart-metrictitle{white-space:normal;height:30px;font-size:13px;line-height:normal;text-transform:uppercase}.msportalfx-property-text-icon,.msportalfx-property-callback-icon{width:27px}.msportalfx-property-text-icon svg,.msportalfx-property-callback-icon svg{height:25px;width:25px}.msportalfx-property{padding:5px 0;white-space:nowrap;line-height:0;font-size:0}.msportalfx-property>*{display:inline-block;vertical-align:middle;box-sizing:border-box;white-space:normal;font-size:medium;line-height:normal}.msportalfx-property .msportalfx-property-name{font-size:13px;line-height:normal;width:32%;white-space:normal;overflow:hidden;text-overflow:ellipsis}.msportalfx-property .msportalfx-property-label-wrapper{font-size:13px;line-height:normal;width:32%;margin-top:5px}.msportalfx-property .msportalfx-property-label-wrapper .msportalfx-property-name{max-width:100%;width:auto;white-space:normal;overflow:hidden;text-overflow:ellipsis;display:inline-block}.msportalfx-property .msportalfx-property-value{font-size:14px;line-height:normal;width:64%;margin-left:3%;margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-tooltip-overflow,.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon{display:inline-block;vertical-align:middle}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon+.msportalfx-tooltip-overflow{max-width:calc(100% - 27px)}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield{margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield input{padding-left:9px}.msportalfx-property.msportalfx-property-compact>*{vertical-align:top}.msportalfx-property.msportalfx-property-compact .msportalfx-property-name{margin-top:4px;width:95px}.msportalfx-property.msportalfx-property-compact .msportalfx-property-value{font-size:13px;line-height:normal;max-width:calc(100% - 3% - 95px)}.msportalfx-property-callback-icon{float:left}.msportalfx-preview-text{font-weight:600;font-size:10px;line-height:normal;text-transform:uppercase;margin-top:3px}.fxs-service-tag{fill:solid;border-radius:2px;padding:.3px 6px;margin-right:4px}.fxs-service-disabled-tag{fill:solid;border-radius:2px;padding:.3px 6px;margin-right:4px;border:1px #a19f9d;background-color:#f3f2f1;color:#a19f9d}.fxs-service-partner-tag{fill:solid;border-radius:2px;padding:.3px 6px;margin-right:4px;color:#db7500;border:1px solid #ebb988;background-color:#fff8f0}.fxs-service-preview-tag{fill:solid;border-radius:2px;padding:.3px 6px;margin-right:4px;color:#8a2da5;border:1px solid #d6adeb;background-color:#f9f3fc}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Parts/Parts.Part.css",["module"],(function(e){"use strict";return{css:'.fxs-part{width:100%;height:100%;position:relative;box-sizing:border-box;overflow:hidden;background-color:inherit;padding:15px 15px 15px 15px}.fxs-part-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.fxs-part-title{height:49px;position:relative;top:-4px;box-sizing:border-box}.fxs-part-titleText,.fxs-part-assetname{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-titleText{font-weight:600;font-size:14px;line-height:17px;padding-bottom:1px}.fxs-part-assetname{font-size:10px;line-height:10px;padding-bottom:1px;margin-top:3px}.fxs-part-content{font-size:13px;line-height:normal;position:relative;width:100%;height:100%;box-sizing:border-box}.fxs-part-part-title-visible .fxs-part-content{height:calc(100% - 45px);top:-4px}.fxs-part[tabindex="0"]:focus,.fxs-part-clickable:focus{outline-offset:2px;outline-width:1px;outline-style:solid}.fxs-part[tabindex="0"]:hover,.fxs-part-clickable:hover{cursor:pointer}.fxs-part-unbound{z-index:1}.fxs-part{padding:15px 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding{padding:0}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-part-title-visible .fxs-part-title{padding:15px 15px 0 15px}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-part-title-visible .fxs-part-content>.msportalfx-padding:first-child{padding:0 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding .fxs-part-content>.msportalfx-padding{padding:15px 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-for-template-blade .fxs-part-content>.msportalfx-padding{padding:10px 20px 20px 20px}.fxs-part-nodata{filter:grayscale(100%);min-height:85px}.fxs-part-nodatamessage{position:absolute;left:0;top:0;height:100%!important;width:100%;text-align:left;padding:15px;box-sizing:border-box;z-index:1}.fxs-part-nodatamessage-text{position:absolute;top:50%;transform:translateY(-50%);margin-top:20px;padding:15px 10px;width:calc(100% - 30px);box-sizing:border-box;font-size:13px;line-height:normal;text-align:center;border-width:1px;border-style:solid}.fxs-tile.fxs-tilesize-mini .fxs-part{padding-left:3px;padding-right:3px}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-title{display:none!important}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-content{height:100%!important;top:0!important}.fxs-blade .fxs-blade-locked .fxs-part{padding:0 0 15px}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title{height:29px;top:0}.fxs-blade .fxs-blade-locked .fxs-tilesize-fittocontainer .fxs-part{padding:0}.fxs-part-filter-button{border:0;padding:0;width:26px;height:26px;cursor:pointer;z-index:2}.fxs-part-filter-button,.fxs-part-filter-button>svg{position:absolute;top:0;left:0}.fxs-part-frame.fxs-tile-floated-frame{top:11px;height:calc(100% - 11px);left:0}.fxs-part-part-title-visible .fxs-part-frame.fxs-tile-floated-frame{top:49px;height:calc(100% - 49px)}',moduleId:e.id}})),
define("_generated/MsPortalImpl/Svg/Startup/DashboardPartFilter.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path fill='#8a8886' d='M26 0H0v26L26 0z'/><path d='M2 2v1.547l4 3.787V12h3V7.334l4-3.787V2zm1 1.253V3h9v.253L8 7v4H7V7z' class='msportalfx-svg-c01'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path fill='#8a8886' d='M26 0H0v26L26 0z'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2z' class='msportalfx-svg-c33'/><path d='M7 8 3 4.035V2H2v2.421l4 3.965V12h1V8z' class='msportalfx-svg-c01'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2zm1 1.253V3h9v.253L10 7v4H9V7z' class='msportalfx-svg-c01'/></g></svg>"}})),
define("MsPortalImpl/Parts/Parts",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.PartError","MsPortalImpl/Base/Base.Selectable2.ClickContext","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Base/Base.KeyboardHelper","FxInternal/Composition/ViewModel","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Weave/SandboxRender","FxInternal/Composition/Part","Fx/Composition","_generated/MsPortalImpl/Svg/Startup/DashboardPartFilter.svg","_generated/MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg","MsPortalImpl/UI/Commands/Base.PortalFunctions","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Part.css","_generated/Less/MsPortalImpl/CssLibrary/AzureCompatibleOfficeLayoutGrid.css","_generated/Less/MsPortalImpl/CssLibrary/AzureSemanticText.css","_generated/Less/MsPortalImpl/CssLibrary/AzureUtil.css","_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedSemanticText.css","_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedChartingColor.css","_generated/Less/MsPortalImpl/CssLibrary/CustomPart.css","_generated/Less/MsPortalImpl/CssLibrary/CustomForm.css"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M,C,P,w,I,S,_,F,T,k,D,E,B,A,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPartFactory=t.createAmdPartFactory=t.getPartFactory=t.getPartSizeOrDefault=t.getFactory=t.registerFactory=t.PartImpl=t.PartBase=t.InternalClickableLink=void 0,(0,_.injectCss)(F,T,k,D,E,B,A,N);var R=FxImpl.TriggerableLifetimeManager,L=MsPortalFx.Base,O=L.Diagnostics,z=L.Images,H=O.Telemetry,U=MsPortalFx.Parts,W=U.PartSize,V=U.PartKind,j=U.PartState;const q=window,G=a.Dashboard.PartFilters,K=FxImpl.features.isNativePerf;let J=0;const X=O.createLog(e),Z=a.Parts.partSettingNotReceivedErrorDescription,Y={},ee=s(o.Root,null,s(o.KoIf,{condition:"context.isFilterApplied"},s("div",{role:"button",class:"fxs-part-filter-button",tabindex:"0","data-bind":{image:"context.filterIcon",click:"context.openPartSettingsBlade",attr:{"aria-label":"context.filterButtonAriaLabel"}}})),s("div",{class:"fxs-part-title"},s("h3",{class:"fxs-part-titleText msportalfx-tooltip-overflow","data-bind":{text:"container.partTitle"}}),s("div",{class:"fxs-part-assetname fxs-portal-subtext msportalfx-tooltip-overflow","data-bind":{visible:"container.assetName() && !context.inContainerOfSameAsset()",text:"container.assetName"}})),s("div",{class:"fxs-part-content fxs-validationContainer"}),s(o.KoIf,{condition:"context.isUiBlocked"},s("div",{class:"fxs-part-blockui-shield"}),s(o.KoTemplate,{options:"{ name: context.uiBlockedTemplate }"}))),te="emptyTemplate";d.registerKoTemplate(te," ");const se="contentHasNoDataTemplate";d.registerKoTemplate(se,s("div",{class:"fxs-part-nodatamessage"},s("div",{class:"fxs-part-nodatamessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white","data-bind":{text:"container.noDataMessage"}})));class oe extends P.ClickableLink{}t.InternalClickableLink=oe;class ie{constructor(){this._selectable=ko.observable(),this.inContainerOfSameAsset=ko.observable(!0),this.partSettingFailed=ko.observable(!1),this.notFoundMessage=ko.observable(),this.handledErrorMessage=ko.observable(),this.lockedUiContext=ko.observable(!0)}}t.PartBase=ie;const ne={1:"fxs-part-success",2:"fxs-part-warning",3:"fxs-part-error",4:"fxs-part-dirty",5:"fxs-part-info"};class re extends ie{constructor(e,t,s,o){super(),this._diContainer=o,this.isFilterApplied=ko.observable(!1),this.filterIcon=ko.observable(),this.filterButtonAriaLabel=ko.observable(),this.partFilterState=ko.observable(0),this.openPartSettingsBlade=(e,t)=>$.noop,this.assetId=ko.observable(),this.ariaLabel=ko.observable(),this.onSizeChange=e=>{};const i=this._lifetime=new R;let n=t.container;this._onDashboard=1===s.partLocation;if(MsPortalFx.isFeatureEnabled(C.partHeaderEnabledFeatureName)&&this._onDashboard&&n.updatableHeader){n={},MsPortalFx.shallowCopyFromObject(n,t.container);const{updatedHeader:e}=n.updatableHeader,s=n.partTitle,o=n.assetName;n.partTitle=ko.computed(i,(()=>{const t=s(),o=e(),i=o?.title;return t&&i?i:t})),n.assetName=ko.computed(i,(()=>{const t=e(),i=t?.subtitle;return s()&&i?i:o()}))}if(!n)throw new Error("Cannot create a part without a container viewmodel.");const d=FxImpl.tryGetSelectableViewModelContract(n);let p;if(p=d&&d._msPortalFxSelectable2?c.getOrCreate(this._diContainer,d._msPortalFxSelectable2):void 0,p=p||n.selectable,!p){const s=t.content;s&&(ko.isObservable(s().onClick)?s().onClick.subscribeAndRun(this._lifetime,(t=>{"function"!=typeof t||this._selectable()||(p=u.getSelectableWithClickHandler(this._diContainer,s,$(e),t),this._selectable(p))})):"function"==typeof s().onClick&&(p=u.getSelectableWithClickHandler(this._diContainer,s,$(e),s().onClick)))}s.pinnedBladeDeeplink&&(p=p||{isClickable:()=>!0,isSelected:ko.observable(!1),value:ko.observable({}),onClick:MsPortalFx.noop},p.onClick=()=>{o.get(S.RoutePortalFunc).invoke({uri:s.pinnedBladeDeeplink,openedByContext:{openedBy:4}},this._onDashboard?"StartBoardPart":"Blade")}),this._selectable(p),this._viewModel=t,ko.cleanNode(e);const m=this._partContainer=$(e).attr("data-bind","attr: { 'role': context._computedRole, 'data-assetname': container.assetName },css: context._computedClasses,click: function (data, evt) { return context._onClick(data, evt); },event: {'keydown': function (data, evt) { return context._onKeyDown(data, evt); } }").html(ee);this._accessibility(),s.noFxContentPadding&&m.addClass("fxs-part-no-fx-content-padding"),s.isVirtualPartForTemplateBlade&&m.addClass("fxs-part-for-template-blade"),this._partContent=m.find(".fxs-part-content")[0];const h=m.find(".fxs-part-title");this.validateElements=ko.observableArray([]),this._options=s;const g=e=>!!e.noDataMessage();this.isUiBlocked=ko.pureComputed((()=>this._viewModel.internal.allowUiBlocking()&&(n.operations.blockingUi()||g(n)))),this.uiBlockedTemplate=ko.pureComputed((()=>{const e=this._viewModel.container,t=!!this.notFoundMessage(),s=!!e.noDataMessage(),o=!!e.unauthorizedMessage();return t||o?te:s?se:te}));const f=ko.pureComputed((()=>this._viewModel.internal.allowUiBlocking()&&g(n)));this._isPartClickable=ko.computed(i,(()=>!(n.operations.blockingUi()||n.partState&&n.partState()===j.Failed||this.notFoundMessage()||!MsPortalFx.isNullOrUndefined(n.unauthorizedMessage()))&&(!!n.clickableLink||n.isSelectable()&&!!this._selectable()))),n.partTitle.subscribe(i,(()=>{setTimeout((()=>{m.trigger("fxsizechanged")}),50)})),ko.computed(i,(()=>{this.lockedUiContext()?m.removeAttr("aria-label"):m.attr("aria-label",n.ariaLabel()||this.ariaLabel()||n.partTitle())}));const x=ko.computed(i,(()=>{const e=n.partTitle()&&n.partState()!==j.Failed;return l.toggle(h,e),e}));let b;this._computedClasses=ko.computed(i,(()=>{const e=[];x()&&e.push("fxs-part-part-title-visible"),this._isPartClickable()&&e.push("fxs-part-clickable"),n.noDataMessage()&&e.push("fxs-part-nodata");const t=this._selectable();t&&n.isSelectable()&&(t.isSelected()&&e.push("fxs-part-selected"),t.isCommandSelected&&t.isCommandSelected()&&e.push("fxs-part-selected-command")),this._viewModel.content()._msPortalFxUnboundPart&&e.push("fxs-part-unbound");const s=ne[n.contentState()];return s&&e.push(s),e.join(" ")})),this._computedRole=ko.computed(i,(()=>{const e=[];if(m.find(".fxs-part-clickdesc, .fxs-part-tabback").remove(),this.lockedUiContext())return m.removeAttr("aria-describedby"),null;const t=MsPortalFx.getUniqueId();if(m.append(FxImpl.createElement("div",{class:"fxs-part-tabback",id:t,style:"display:none;"},MsPortalFx.encodeHtml(a.Parts.tabbackcmds))),e.push(t),this._isPartClickable()){const t=MsPortalFx.getUniqueId();m.append(FxImpl.createElement("div",{class:"fxs-part-clickdesc",id:t,style:"display:none;"},MsPortalFx.encodeHtml(a.Parts.clickableAriaDesc))),e.push(t)}return m.attr("aria-describedby",e.join(" ")),"group"})),ko.applyBindings({container:n,context:this},m[0]),f.subscribeAndRun(i,(e=>{if(e){if(!b){b=i.createChildLifetime();const e=this._partContainer;b.registerForDispose([e.setEvents(["focus",this._onFocus=e=>{this._toggleDisableTabbableElements(f())}],["focusin",this._onFocusIn=t=>{f()&&e[0].focus()}]),()=>{this._onFocus=this._onFocusIn=null}])}m.find(document.activeElement).length>0&&m[0].focus()}else b&&b.dispose(),this._toggleDisableTabbableElements(e)})),ko.reactor(i,(()=>{this.lockedUiContext()||!this._isPartClickable()&&!this._onDashboard?m.removeAttr("tabindex"):m.attr("tabindex",0)}));FxImpl.shellInterface(n).triggerValidation(((e,t)=>r.ensureFormFieldValidation(m,!0,t).then((t=>(e&&r.focusOnFirstInvalidField(this._partContainer),t))))),1===n.location&&this.partFilterState.subscribeAndRun(i,(e=>{const t=4===e||3===e,s=2===e||1===e;this.isFilterApplied(t||s);const o=t?I:w;this.filterButtonAriaLabel(t?G.Conflicted.ariaLabel:G.Applied.ariaLabel);let i="";switch(e){case 1:i=G.Applied.dashboardTimeRange;break;case 0:case 2:i=G.Applied.dashboardFilters;break;case 3:i=G.Conflicted.timeRange;break;case 4:i=G.Conflicted.multiple}this.filterIcon(z.CustomImageWithOptions(o,{title:i}))}))}setupContent(e){const t=Q.defer(),s=b.isV2(this._viewModel.content()),o=ko.observable(s);if(s){this._viewModel.content()._msPortalFx_contentRevealedPromise.then((()=>o(!1)),(()=>t.resolve()))}const i=[this.partSettingFailed,this._viewModel.content,o,this._viewModel.container.partState,this.handledErrorMessage];return i.push(this.notFoundMessage),i.push(this._viewModel.container.unauthorizedMessage),ko.explicitComputed(this._lifetime,i,(()=>{if(this.partSettingFailed())X.error(Z),ko.ignoreDependencies((()=>{this._bindErrorTemplate({message:a.PartError.titleSettings}),t.resolve()}));else{const s=this._viewModel.container.partState(),i=s!==j.Failed,n=MsPortalFx.isNullOrUndefined(this.handledErrorMessage()),r=MsPortalFx.isNullOrUndefined(this.notFoundMessage()),a=MsPortalFx.isNullOrUndefined(this._viewModel.container.unauthorizedMessage()),l=i&&n&&r&&a;if(o()&&l)return;ko.ignoreDependencies((()=>{this._bindContentTemplate(s,this.template,e),d.waitForBindings(this._partContent).then((()=>{this._setupFormValidationReactor(),t.resolve()})).catch((e=>t.reject(e)))}))}})).extend({deferred:!0}),t.promise}_setupFormValidationReactor(){const e=this._viewModel.container;1!==e.location&&this._onContentReady(0,(()=>{ko.computed(this._lifetime,(()=>{const t=this.validateElements(),s=r.gatherFormFieldsFromElements(t,null,!0),o=s.map((e=>{const t=e.viewmodel,s=e.field.validatableViewModel;if(!(t&&t.disabled&&ko.unwrap(t.disabled)||t.visible&&!ko.unwrap(t.visible)))return s&&(s.alwaysHasValidatorEquivalent||s.validators().length)?s.validationState():2})),i=s.some((e=>ko.unwrap(e.viewmodel&&e.viewmodel.dirty)));ko.ignoreDependencies((()=>{e.form.dirty(i);const t=e.form.validationState;o.includes(1)?t(1):o.includes(0)?t(0):o.includes(3)?t(3):t(2)}))})).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}})}))}_findFocusTarget(e,t){const s=$(e).find(t);let o=s.filter(":focusable").first();if(o.length<1&&(o=s.findFirstTabbable(),o.length<1)){const e=s.find(":focusable"),t=e.not("div");if(o=t.length?t.first():e.first(),o.length<1)return null}return o}setFocus(e){const t=this._partContainer.closest(".fxs-blade"),s=t.length>0?t[0]:this._partContainer[0];return Q(d.waitForBindings(s)).then((()=>{let t=this._findFocusTarget(s,e);return t?(t.focus(),{success:!0}):(t=this._findFocusTarget(document.body,e),t?(t.focus(),{success:!0}):{success:!1,errorMsg:"No focusable element found for '{0}' anywhere on the page.".format(e)})}))}_onContentReady(e,t){(this.partComposition?Q(MsPortalFx.Base.Promises.cancelOnDispose(this._lifetime,Q(this.partComposition.await(e)).catch(MsPortalFx.noop))):Q()).then((()=>t(this._partContainer[0])))}_logClick(e){const t=this._diContainer.get(y.JourneyManager).activeJourney(),s=this.partComposition;H.trace({extension:this._options.locator.getExtensionLocator().name,source:this._onDashboard?"StartBoardPart":"Blade",action:"PartClick",name:this._options.locator.toFriendlyString(),data:s?{...e,partKind:s.partDefinition?.partKind}:e,journeyId:t&&t.id})}_onClick(e,t){return this._activatePart(e,t)}_onKeyDown(e,t){return t.target!==this._partContainer[0]||13!==t.keyCode||this._activatePart(e,t)}_activatePart(t,s){if(1===this._diContainer.get(h.DesktopManagerMode).value.peek()&&!this._viewModel.content()._msPortalFxUnboundPart)return!0;const o=this._viewModel.container,i=$(s.target);let r=!0;const a=q.getSelection(),l=a.rangeCount>0&&a.getRangeAt(0),c=o.clickableLink;if(!this._isPartClickable()||i.closest("a").length>0);else if(a.isCollapsed||!l||l.commonAncestorContainer.ownerSVGElement||"svg"===l.commonAncestorContainer.nodeName)if(c)if(c instanceof oe&&$.isFunction(c.onClick))c.onClick();else{let t=c.target();const o=(0,n.sanitizeLinkUri)(String(c.uri()||""),{diContainer:this._diContainer,windowContext:i,localRequire:e})||"",r=MsPortalFx.startsWith(o,"#");let a=!1;"auto"===t&&(t=r?"_self":"_blank"),"_self"===t&&((0,x.isCtrlOrCommandOnly)(s)||s.shiftKey?t="_blank":r&&(this._diContainer.get(S.RoutePortalFunc).invoke({uri:o,openedByContext:{openedBy:4}},this._onDashboard?"StartBoardPart":"Blade"),a=!0)),a||window.open(o,t),this._logClick({effectiveTarget:t,target:c.target(),scrubbedUri:o.split("?")[0]})}else if(s.shiftKey||(0,x.isCtrlOrCommandOnly)(s)||2===s.which)i.trigger("fxopeninnewtab",{selectable:o.selectable});else{const e=this._selectable();e&&(e.isSelected()?i.trigger("fxensurebladevisible",{}):(e.onClick(),this._logClick())),r=!1}else;return r}_accessibility(){const e=this._partContainer.find(".fxs-part-title");for(let t=0;t<e.length;t++){const s=MsPortalFx.getUniqueId(),o=$(e[t]);o.find(".fxs-part-titleText").attr("aria-describedby",s),o.find(".fxs-part-assetname").attr("id",s)}}_bindContent(e,t,s){const o=this._getExtensionName(),n=this._options.locator.name,r=[i.getScopeName(o)];this.scopeClass;const a=new Set,l=$(this._partContent);s&&s.styleSheets&&de.injectStyles(o,s.styleSheets,this._options.locator,a,r),this.scopeClass=r.join(" "),l.addClass(this.scopeClass),this.onSizeChange=e=>{a.forEach((t=>{const{mediaQuery:s,mediaClass:o}=t;"MINWIDTH"===s.type&&(e>=s.pixels?l.addClass(o):l.removeClass(o))}))};const c=this._diContainer.get(v.ViewModelManager).getWeaveShellPort(this._viewModel),d=J++;if(K&&q.performance.mark(`PartStart${d}`),c&&c.isChannelEnabled)(0,M.connectWeaveShellPort)(c,e,this._diContainer,(e=>{const t=[];for(const s of e)MsPortalFx.startsWith(s.moduleId,"FxInternal/_generated/Less/")?(0,_.injectCss)(s):t.push({content:s.css,file:s.moduleId});de.injectStyles(o,t,this._options.locator,a,r),this.scopeClass=r.join(" "),l.addClass(this.scopeClass),this.onSizeChange(this._viewModel.container.width.peek())}));else{$(e).html(t);const s=new ko.bindingContext(this._getContentForBinding(this._lifetime)).extend({$dicontainer:this._diContainer,$partName:n,$extensionName:o});ko.applyBindings(s,e),this._nodeToCleanup=e}K&&(q.performance.mark(`PartEnd${d}`),q.performance.measure(`PartRender(${c&&c.isChannelEnabled?"Weave":"KO"})`,`PartStart${d}`,`PartEnd${d}`))}dispose(){this._lifetime.dispose();const e=this._nodeToCleanup;e&&ko.cleanNode(e);const t=this._partContainer[0];t&&(ko.cleanNode(t),this._partContainer[0]=this._partContent=null),MsPortalFx.disposeViewModelProperties(this._viewModel)}_getContentForBinding(e){return this._viewModel.content}_getExtensionName(){return this._options.locator.getExtensionLocator().name}_bindContentTemplate(e,t,s){const o=this._viewModel.container;if(this.notFoundMessage())this._bindErrorTemplate(this.notFoundMessage(),404);else if(o.unauthorizedMessage())this._bindErrorTemplate(o.unauthorizedMessage(),401);else if(e===j.Ready)if(MsPortalFx.isNullOrUndefined(this.handledErrorMessage()))try{o.contentState(0),this._resetContentTemplateContainer(),this._bindContent(this._partContent,t,s)}catch(e){this._options.traceErrorTelemetry(e.message||"Failed to bind the knockout template",e),this._bindErrorTemplate({message:a.PartError.titleContent,details:MsPortalFx.getLogFriendlyMessage(e)})}else this._bindErrorTemplate(this.handledErrorMessage());else if(e===j.Failed){const e="string"==typeof o.failureMessage()?{message:o.failureMessage()}:o.failureMessage(),t="string"==typeof e.message?e.message:e.message&&e.message.htmlTemplate;this._options.traceErrorTelemetry(t,e.error),this._bindErrorTemplate(e)}}_bindErrorTemplate(e,t){let s;s="string"==typeof e?{message:e}:e,this._viewModel.container.contentState(3),this._resetContentTemplateContainer();const o=new p.ViewModel(s,{sessionId:MsPortalFx.sessionId,extName:this._getExtensionName(),contentName:this._options.locator.name,resourceId:this.assetId(),code:t},{showDetailsCmd:this._onDashboard}),i=this.partComposition;if(i){const e=new g.CompositionInstanceCommandContext($(this._partContent)[0],null,i),t=new f.ReloadPart(this._lifetime,this._diContainer,i);if(t.bind(e),o.commands.push(t),this._onDashboard){const t=new f.UnpinFromStartboard(this._lifetime,this._diContainer);t.bind(e),o.commands.push(t)}const s=new f.GoToAssetBlade(this._lifetime,this._diContainer,this.partComposition);s.bind(e),s.enabled()&&o.commands.push(s)}new p.Widget($(this._partContent),o,this._diContainer)}_resetContentTemplateContainer(){ko.cleanNode(this._partContent),$(this._partContent).html("")}_toggleDisableTabbableElements(e){let t,s,o,i;const n="tabindex",r="data-initialtabindex";if(e)for(t=this._partContainer.find(":tabbable"),i=0;i<t.length;++i)s=$(t[i]),o=s.attr(n),s.attr(n,"-1"),s.attr(r,o||"unset");else for(t=this._partContainer.find("["+r+"]"),i=0;i<t.length;++i)s=$(t[i]),o=s.attr(r),"unset"!==o?s.attr(n,o):s.removeAttr(n),s.removeAttr(r)}}function ae(e){return Y[e]}function le(e){const t=e&&e.initialSize;return void 0!==U.PartSize[t]?t:W.Normal}t.PartImpl=re,t.registerFactory=function(e,t){if(Y[e])throw new Error(`The part kind '${e}' has already been registered and cannot be registered again.`);Y[e]=t},t.getFactory=ae,t.getPartSizeOrDefault=le;class ce{constructor(e){this._extensionName=e,this._metadata=new Map}injectStyles(e,t,s,o){const n=[],r=[];for(const a of e)if(a.content){const e=a.file,l=i.getScopeName(e);let c=this._metadata.get(e);if(!c){const s=[],o=[];this._metadata.set(e,c={file:e,mediaQueries:s,sanitizedCss:i.sanitizeStyleSheetText(a.content,`.${i.getScopeName(this._extensionName)}.${l}`,o,s)}),o.forEach((s=>{n.push(`\n${t} - ${e} - ${i.generateErrorMessage(s)}`)})),r.push(c)}o.push(l);for(const e of c.mediaQueries)s.add(e)}n.length&&FxImpl.Rpc.client.log(this._extensionName,{level:this._extensionName?2:1,code:1,area:"Parts",message:`Sanitization error found in following extension(${this._extensionName}) styleSheets:`+n});for(const e of r)(0,_.injectCss)({moduleId:this._extensionName+"_"+e.file,css:e.sanitizedCss})}}const de=new class{constructor(){this._cache={}}injectStyles(e,t,s,o,i){(this._cache[e]||(this._cache[e]=new ce(e))).injectStyles(t,s,o,i)}};function pe(e,t,s,o,i){return new e.Part(t,s,o,i)}function ue(e,t,s){return{createPart:(s,o,i,n,r)=>Q(MsPortalFx.tryImmediateResolve(MsPortalFx.require(e),(e=>{const a=t(e,s,o,i,n);return a.partComposition=r,a}))),defaultSize:s.defaultSize,supportedSizes:s.supportedSizes,viewStateProperties:s.viewStateProperties,moduleId:e}}function me(e,t={}){return{createPart:(s,o,i,n,r)=>{const a=new(t.partClass||re)(s,o,i,n);return a.template=e,a.partComposition=r,Q(a)},defaultSize:t.defaultSize,supportedSizes:t.supportedSizes,viewStateProperties:t.viewStateProperties}}t.getPartFactory=function(e,t,s){const o=s.partKind;let i;if(o===V.Custom||o===V._Internal_App){const n=s.htmlTemplateInline,r=s.htmlTemplate&&t.getExtensionLocator().withHtmlTemplate(s.htmlTemplate),a=n||r&&e.locate(r);i=me(a&&a.content,{supportedSizes:s.supportedSizes,partClass:o===V._Internal_App?he:null})}else i=o===V.Frame?ue("MsPortalImpl/Parts/Parts.Frame",pe,{supportedSizes:s.supportedSizes}):o===V._Internal_React?ue("MsPortalImpl/Parts/Parts.ReactFrame",((e,t,o,i,n)=>{const{isBlade:r,bladeOrPartName:a,extensionName:l,isMenuBlade:c}=s;return new e.Part(t,o,i,n,{viewName:a,extensionName:l,isTile:!r,isMenuBlade:c})}),{supportedSizes:s.supportedSizes}):ae(V[o]);const n=i.supportedSizes;return n&&n.length||(i.supportedSizes=[le(s)]),i},t.createAmdPartFactory=ue,t.createPartFactory=me;class he extends re{constructor(e,t,s,o){super(e,t,s,o)}_bindContent(e,t,s){super._bindContent(e,t,s),d.waitForBindings(e).then((()=>{const e=fx.getTimestamp();MsPortalFx.require("MsPortalImpl/Parts/Parts.Frame.Common").then((t=>{t.logFrameAddedTelemetry({isPart:this._onDashboard,journeyManager:this._diContainer.get(y.JourneyManager),locator:this._options.locator,telemetryContextState:this._options.getTelemetryContextState&&this._options.getTelemetryContextState(),timestamp:e})}))}))}}})),
define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["module"],(function(e){"use strict";return{css:".fxs-part-buttonpart{display:flex;width:100%;height:100%;box-sizing:border-box;text-align:center;align-items:center;flex-direction:column}.fxs-part-buttonpart-iconcontainer{flex:0 0 auto;box-sizing:border-box;display:flex;align-items:center}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{flex:0 0 auto;height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-size:13px;line-height:normal}.fxs-part-buttonpart-assetname{margin:0;font-size:10px;line-height:10px;padding-bottom:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart-desc{display:none;position:relative;margin-top:10px}.fxs-part-buttonpart-desc:empty{margin-top:0}.fxs-part-buttonpart-titlecontainer{display:flex;flex-flow:row nowrap;align-items:flex-start;justify-content:center}.fxs-part-buttonpart-title{position:relative;margin:0;font-size:14px;font-weight:600;display:block;display:-webkit-box;line-height:18px;max-height:36px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical}.fxs-part-buttonpart-title.fxs-should-use-single-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart,.fxs-tilesize-wide .fxs-part-buttonpart{text-align:left;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-titlecontainer,.fxs-tilesize-wide .fxs-part-buttonpart-titlecontainer{justify-content:flex-start}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{flex:0 1 auto;display:flex;flex-direction:column;justify-content:center}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer{padding-top:3px}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-normal .fxs-part-buttonpart-titlecontainer{margin:13px 0 5px}.fxs-tilesize-normal .fxs-part-buttonpart-iconcontainer{padding-top:28px}.fxs-tilesize-normal .fxs-part-part-title-visible .fxs-part-buttonpart-iconcontainer{padding-top:0}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block;display:-webkit-box;line-height:18px;max-height:90px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:5;-webkit-box-orient:vertical}.fxs-part-buttonpart-externallink{height:12px;width:12px;margin-left:3px;margin-top:2px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}",moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","MsPortalImpl/Parts/Parts","FxInternal/Composition/ViewModel","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonPart=t.template=void 0,(0,i.injectCss)(n);var r=MsPortalFx.Parts.PartSize;t.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon, attr: { title: _displayTitle }'></div><div class='fxs-part-buttonpart-textcontainer'><div class='fxs-part-buttonpart-titlecontainer'><h3 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' data-bind='text: _displayTitle, css: { \"fxs-should-use-single-line\": _assetNameVisible }, attr: { \"aria-describedby\": _assetName() && _id }'></h3>\x3c!-- ko if: _isExternalLink --\x3e<div class='fxs-part-buttonpart-externallink azc-fill-heavy' data-bind='image: _linkSvg, attr: { \"aria-label\": _linkUri }'></div>\x3c!-- /ko --\x3e</div><div data-bind='text: _assetName, visible: _assetNameVisible, attr: { id: _id }' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow'></div><div data-bind='text: description' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'></div></div></div>";class a extends s.PartImpl{constructor(){super(...arguments),this.template=t.template}_getContentForBinding(e){const t=this._viewModel,s=t.content,i=t.container,n=i.clickableLink,a=e=>"_self"===e.target()||e.uri&&MsPortalFx.startsWith(e.uri(),"#")&&"auto"===e.target(),l=ko.observable(!!n&&!a(n));ko.computed(e,(()=>{this.ariaLabel(s().title())}));const c=n&&n.target;c&&c.subscribe(e,(e=>{l(!a(n))}));const d=n&&n.uri;d&&d.subscribe(e,(e=>{l(!a(n))}));const p=o.isV2(s())?()=>this._options.size():()=>s().size&&s().size();return ko.computed(e,(()=>MsPortalFx.extend2(super._getContentForBinding(e)(),{_displayTitle:ko.computed(e,(()=>{const e=p(),t=s(),o=t.title();return(e===r.Mini||e===r.Small)&&t.shortTitle()||o})),_assetName:i.assetName,_isExternalLink:l,_linkUri:d,_linkSvg:MsPortalFx.Base.Images.Hyperlink(),_assetNameVisible:ko.computed(e,(()=>!this.inContainerOfSameAsset()&&i.assetName())),_id:MsPortalFx.getUniqueId()})))}}t.ButtonPart=a})),
define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["module"],(function(e){"use strict";return{css:'.fxs-part-collectionpart .azc-grid table thead tr th{height:28px;line-height:28px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td.azc-grid-cell:first-of-type{padding-left:15px}.fxs-part-collectionpart .azc-grid table td:last-of-type,.fxs-part-collectionpart .azc-grid table td:last-child{padding-right:15px}.fxs-part-collectionpart .azc-grid table .azc-grid-resizableColumn-handle{height:28px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{font-weight:600;font-size:12px;line-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:absolute;right:0}.fxs-part-collectionpart-more-data:hover{text-decoration:underline}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-weight:600;font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-size:10px;line-height:10px;padding-bottom:1px;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^="ja"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^="ko"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^="zh"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}',moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.Collection",["require","exports","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Parts/Parts","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollectionPart=void 0,(0,n.injectCss)(r);var a=MsPortalFx.Parts.PartSize;const l=i.Parts,c=`<div class="fxs-part-collectionpart" data-bind="css: {'fxs-part-collectionpart-rollup-forceshow': alwaysShowRollupCount()}"><div class="fxs-part-collectionpart-rollup-container"><span class="fxs-part-collectionpart-rollup-count" data-bind="text: rollupCount, visible: !noRollupCount()"></span><span class="fxs-part-collectionpart-rollup-label" data-bind="text: rollupCountLabel"></span><img class="fxs-part-collectionpart-rollup-icon" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {'fxs-part-collectionpart-no-rollup-count': noRollupCount }" alt=""/><div class="fxs-part-collectionpart-rollup-icon" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {'fxs-part-collectionpart-no-rollup-count': noRollupCount }"></div><h4 class="fxs-part-collectionpart-part-title fxs-display-none" data-bind="text: _partTitle"></h4></div>\x3c!-- ko if: emptyGrid() && noRowsHtml() --\x3e<div class="fxs-part-collectionpart-norowshtml fxs-display-none" data-bind="pcControl: noRowsHtml"></div>\x3c!-- /ko --\x3e\x3c!-- ko if: !emptyGrid() || !noRowsHtml() --\x3e\x3c!-- ko if: !!gridMode() --\x3e<div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"></div><a href="#" class="fxs-part-collectionpart-more-data fxs-portal-text-primary" tabindex="0" data-bind="visible: hasMoreData">${MsPortalFx.encodeHtml(l.more)}</a>\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e</div>`;class d extends o.PartImpl{constructor(e,t,s,o){super(e,t,s,o),this.template=c;(this._container=$(e)).on("click keydown","a.fxs-part-collectionpart-more-data",(e=>{13!==e.which&&"click"!==e.type||e.preventDefault(),e.stopPropagation();const t=$.Event(e.type);t.keyCode=e.keyCode,$(e.delegateTarget).trigger(t)}))}_getContentForBinding(e){const t=this._viewModel,o=this._container.find(".fxs-part-collectionpart-part-title"),i=this._container.find(".fxs-part-collectionpart-norowshtml");return ko.computed(e,(()=>{const e=t.content().size();s.toggle(o,e!==a.Mini||!!t.container.partTitle()),s.toggle(i,e!==a.Mini&&e!==a.Small)})),ko.observable(MsPortalFx.extend2(t.content(),{_partTitle:t.container.partTitle}))}}t.CollectionPart=d})),
define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["module"],(function(e){"use strict";return{css:".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode{text-align:center;float:initial}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["module"],(function(e){"use strict";return{css:'.msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker::after{right:10px;left:auto;transform:skew(8deg) rotate(3deg)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.fxs-mode-dark .msportalfx-specpicker{box-shadow:0 1px 4px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1) inset}.fxs-mode-dark .msportalfx-specpicker::before,.fxs-mode-dark .msportalfx-specpicker::after{box-shadow:0 0 20px rgba(255,255,255,.8)}.fxs-mode-light .msportalfx-specpicker{box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset}.fxs-mode-light .msportalfx-specpicker::before,.fxs-mode-light .msportalfx-specpicker::after{box-shadow:0 0 20px rgba(0,0,0,.8)}.msportalfx-specpicker-star{width:14px;height:14px;fill:#ffb900;stroke:#000;stroke-width:1px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{font-weight:600;text-transform:uppercase;padding-left:11px}.msportalfx-specpicker-header .msportalfx-specpicker-header-title{padding-left:6px}.msportalfx-specpicker-header-text{fill:#ffb900;stroke:#000;stroke-width:1px;width:161px;position:absolute}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade1{background-color:#8a2da5}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(138,45,165,.2)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(138,45,165,.1)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade1{background-color:#578000}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(87,128,0,.2)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(87,128,0,.1)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade1{background-color:#c40}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade2{background-color:rgba(204,68,0,.2)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade3{background-color:rgba(204,68,0,.1)}.msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-weight:600;font-size:13px;line-height:1.385;margin-left:6px}.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-weight:600;font-size:17px}.msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:13px;line-height:1.385;padding-top:6px;margin-left:6px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;line-height:22px!important;font-weight:600;font-size:22px;line-height:22px;letter-spacing:-.025em}.msportalfx-specpicker-footer-details{font-size:10px;line-height:14px;text-transform:uppercase}.msportalfx-specpicker-footer-statusMessage,.msportalfx-specpicker-footer-channelMessage{margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;display:block;display:-webkit-box;line-height:16px;max-height:32px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline;color:#fff}.ext-hubs-specPickerGrid-container{height:100%;overflow:hidden;display:flex;flex-direction:column}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-filtersContainer.ext-hubs-specPicker-filtersContainer{margin-top:0;padding-top:5px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions{font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#0058ad;fill:#0058ad}.ext-hubs-specPicker-container .ext-hubs-specPicker-content{height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px;white-space:pre-wrap}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:0;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus{outline-style:dotted;outline-width:1px}',moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","MsPortalImpl/Parts/Parts","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parts=void 0,(0,o.injectCss)(i,n);var r=MsPortalFx.Parts.PartKind,a=MsPortalFx.Parts.PartSize;const l=a.Mini,c=a.Small,d=a.Normal,p=a.Wide,u=a.Large,m=a.Tall,h=a.HeroWide,g=a.HeroTall,f=a.HeroWideFitHeight,x=a.FullWidthFitHeight,b=a.FitToContainer,y={defaultSize:x,supportedSizes:[x],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]},v=14,M=18,C=26,P=30;t.parts=[{kind:r.Asset,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",((e,t,s,o,i)=>new e.AssetPart(t,s,o,i)),{defaultSize:c,supportedSizes:[l,c,d]})},{kind:r.Button,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",((e,t,s,o,i)=>new e.ButtonPart(t,s,o,i)),{supportedSizes:[l,c,d,p]})},{kind:C,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Chart",((e,t,s,o,i)=>new e.Chart(t,s,o,i)),{supportedSizes:[c,d,m,p,u,h,g,f,x,b]})},{kind:r.Collection,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",((e,t,s,o,i)=>new e.CollectionPart(t,s,o,i)),{supportedSizes:[l,c,d,p,m,u,h,g,f,b,x]})},{kind:r.CollectionSummary,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",((e,t,s,o,i)=>new e.Part(t,s,o,i)),{supportedSizes:[l,c,d,p]})},{kind:v,factory:s.createPartFactory("<div data-bind='{0}: $root'></div>".format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems","content.selectableData.activatedItems","content.selectableData.itemsWithChildEdits"]})},{kind:r.InfoList,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.InfoList",((e,t,s,o,i)=>new e.InfoListPart(t,s,o,i)),y)},{kind:r.Properties,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",((e,t,s,o,i)=>new e.PropertiesPart(t,s,o,i)),y)},{kind:r.QuickStart,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",((e,t,s,o,i)=>new e.QuickStartPart(t,s,o,i)),{defaultSize:c,supportedSizes:[l,c,d,p]})},{kind:P,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",((e,t,s,o,i)=>new e.ResourceSummaryPart(t,s,o,i)),y)},{kind:M,factory:s.createPartFactory("<div></div>")}],t.parts.forEach((e=>{s.registerFactory(r[e.kind],e.factory)}))})),
define("MsPortalImpl/UI/UI.DockedContextPane",["require","exports","Fx/Composition/Selectable","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/UI.BladeOpener","FxInternal/AsyncLoader","FxInternal/Rpc"],(function(e,t,s,o,i,n,r){"use strict";async function a(e,t){const n=o.Locator.forExtension(t.extensionName).withBlade(t.bladeName),r=t.params,a=new s.PdlBladeReference(n.name,n.getExtensionName(),{parameters:r});await e.get(i.BladeOpener).openBlade(a,{flags:1032,telemetryName:"DockedContextPane"})}Object.defineProperty(t,"__esModule",{value:!0}),t.openDockedContextPane=t.openDockedContextPaneWithBlade=t.openDockedContextPaneEndpoint=void 0,t.openDockedContextPaneEndpoint=new r.FuncEndPointDefinition("Fx.RpcEndpoints.openDockedContextPane"),t.openDockedContextPaneWithBlade=a,t.openDockedContextPane=n.defineHandler(t.openDockedContextPaneEndpoint,(e=>{a(e.diContainer,{extensionName:e.messageArg.extensionName,bladeName:e.messageArg.bladeName,params:e.messageArg.params})}))})),
define("MsPortalImpl/RpcEndPoints",["require","exports","FxInternal/AsyncLoader","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","FxInternal/DirectoryManagement","FxInternal/RpcEndPoints","FxInternal/Copilot/ShellAPIs","FxHubs/ProvisioningRpc","FxInternal/Redirect","FxInternal/ResourceManagement/Subscriptions","FxInternal/ResourceManagement/GlobalResourceFilters","FxInternal/Dashboard/DashboardEndpoints","ShellWorker/AuthorizationState","MsPortalImpl/UI/UI.DockedContextPane","FxInternal/RpcEndPointsCore","FxInternal/ReactView/DataCacheEndpoints"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerRpc=void 0;var x=FxImpl.Data,b=FxImpl.Extension;t.registerRpc=function(e){(0,s.registerRpc)(e,{"FxHubs/MarketplaceRpc":{marketplaceOverrideHandler:(0,s.makeRegistration)(i.Provisioning.marketplaceOverrideEndpoint)},"MsPortalImpl/Base/Base.Selectable2.Provisioning":{getProvisioningContextHandler:(0,s.makeRegistration)(l.provisioningContextEndpoint)},"MsPortalImpl/Extension/ExtensionRpc.Manifest":{getManifestHandler:(0,s.makeRegistration)(b.getManifestEndPoint),getManifestEnvironmentHandler:(0,s.makeRegistration)(b.CreateUiDef.getExtensionConfigurationEndPoint,["Microsoft_Azure_CreateUIDef","HubsExtension"])},"MsPortalImpl/Extension/ExtensionManagerOptions":{registerTestExtensions:(0,s.makeRegistration)(b.CreateUiDef.registerTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),unregisterTestExtensions:(0,s.makeRegistration)(b.CreateUiDef.unregisterTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),listTestExtensions:(0,s.makeRegistration)(b.CreateUiDef.listTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),getCatalogApiCacheContent:(0,s.makeRegistration)(b.getCatalogApiCacheContentEndPoint),getExtensionRegistration:(0,s.makeRegistration)(b.getExtensionRegistrationEndPoint),postBoot:(0,s.makeRegistration)(FxImpl.Extension.postBootEndPoint)},"MsPortalImpl/UI/Hubs/UI.ResourceMapManager":{mapAssetIdToResourceId:(0,s.makeRegistration)(b.mapAssetIdToResourceIdEndPoint),mapResourceIdToAssetId:(0,s.makeRegistration)(b.mapResourceIdToAssetIdEndPoint),mapResourceIdToDynamicSelectionAndIcon:(0,s.makeRegistration)(b.mapResourceIdToDynamicSelectionAndIconEndPoint),getResourceAssetInformation:(0,s.makeRegistration)(b.getResourceAssetInformationEndPoint),getResourceAssetInformationForHubs:(0,s.makeRegistration)(i.AssetTypes.getResourceAssetInformationEndPoint),getResource:(0,s.makeRegistration)(b.getResourceEndPoint)},"MsPortalImpl/UI/UI.JourneyManager":{getLastResourceIdInJourney:(0,s.makeRegistration)(b.getLastResourceIdInJourneyEndPoint,null)},"MsPortalImpl/UI/UI.ConfirmationDialog":{invokeAmeConfirmationDialogHandler:(0,s.makeRegistration)(b.invokeAmeConfirmationDialogEndPoint,null)},"MsPortalImpl/Services/Services.FavoritesSettings":{getUserDirectorySettingsHandler:(0,s.makeRegistration)(n.getUserDirectorySettingsEndPoint,"Microsoft_AAD_IAM"),saveUserDirectorySettingsHandler:(0,s.makeRegistration)(n.saveUserDirectorySettingsEndPoint,"Microsoft_AAD_IAM")},"MsPortalImpl/Services/Services.SessionManager":{getSessionHistoryHandler:(0,s.makeRegistration)(i.SessionManager.getSessionHistoryEndPoint)},"MsPortalImpl/Services/Services.Subscriptions":{getInSessionSelectedSubscriptionsObservableHandler:(0,s.makeProxyRegistration)(d.getInSessionSelectedSubscriptionsObservableEndPoint),getSubscriptionInfoHandler:(0,s.makeRegistration)(FxImpl.Azure.getSubscriptionInfoEndPoint),getInSessionDisplayedSubscriptionsHandler:(0,s.makeRegistration)(i.Subscriptions.getInSessionDisplayedSubscriptionsEndPoint),searchForSubscriptionsHandler:(0,s.makeRegistration)(FxImpl.Azure.searchForSubscriptionsEndPoint),setInSessionSelectedSubscriptionsHandler:(0,s.makeRegistration)(FxImpl.Azure.setInSessionSelectedSubscriptionsEndPoint,"HubsExtension")},"MsPortalImpl/Services/Services.GlobalResourceFilters":{getGlobalResourceFilterObservableHandler:(0,s.makeProxyRegistration)(p.getGlobalResourceFilterObservableEndPoint)},"MsPortalImpl/Services/Services.Tenants":{getHomeTenantsCountHandler:(0,s.makeRegistration)(i.Directories.getHomeTenantsCountEndPoint)},"MsPortalImpl/Services/Services.ProjectedDirectories":{getSubscriptionsForSelectedDirectoriesHandler:(0,s.makeRegistration)(i.Directories.getSubscriptionsForSelectedDirectoriesEndPoint),getDirectoriesMapHandler:(0,s.makeRegistration)(i.Directories.getDirectoriesMapEndPoint)},"MsPortalImpl/Services/Services.AssetManagement":{notifyAssetDeletedHandler:(0,s.makeRegistration)(i.Events.notifyAssetDeletedDefinition)},"MsPortalImpl/Services/Services.AzureStorage":{sasEndPointHandler:(0,s.makeRegistration)(FxImpl.InternalAzure.getSasUriForQueueEndPoint,"Microsoft_Azure_Scheduler")},"MsPortalImpl/Services/Services.EditScopeManagement":{loadSerializedEditScope:(0,s.makeRegistration)(x.loadSerializedEditScopeEndPoint),saveSerializedEditScope:(0,s.makeRegistration)(x.saveSerializedEditScopeEndPoint),updateEditScopeIsSavingState:(0,s.makeRegistration)(x.updateEditScopeIsSavingStateEndPoint)},"MsPortalImpl/UI/UI.AuthStateManager":{getCurrentUserEndPointHandler:(0,s.makeRegistration)(i.Auth.getCurrentUserEndPoint,"HubsExtension")},"MsPortalImpl/Auth/RpcHandlers":{getAuthorizationTokenEndPoint:(0,s.makeRegistration)(b.getAuthorizationTokenEndPoint),getAuthorizationTokenForChallengeEndPoint:(0,s.makeRegistration)(b.getAuthorizationTokenForChallengeEndPoint),getPopTokenEndPoint:(0,s.makeRegistration)(b.getPopTokenEndPoint),getSshCertTokenEndPoint:(0,s.makeRegistration)(b.getSshCertTokenEndPoint),getNewTokenHandler:(0,s.makeRegistration)(m.getAuthorizationTokenForShellWorkerEndPoint,"fxw")},"MsPortalImpl/Services/Services.GalleryEndpoints":{getLocalGalleryPackages:(0,s.makeRegistration)(b.getLocalGalleryPackagesEndpointsDefinition)},"MsPortalImpl/Services/Services.Permissions":{hasPermissionsToShell:(0,s.makeRegistration)(b.hasPermissionsToShell)},"MsPortalImpl/Services/Services.SharedSettings":{getSharedSettings:(0,s.makeRegistration)(b.getSharedSettingsEndPoint)},"MsPortalImpl/Extension/Extension.Definition.Locator":{getBladeDefinitionLocator:(0,s.makeRegistration)(i.Provisioning.getBladeDefinitionLocatorEndPoint,["HubsExtension","Microsoft_Azure_Resources"])},"MsPortalImpl/Extension/DefinitionCache":{doesBladeDefinitionExist:(0,s.makeRegistration)(i.Provisioning.doesBladeDefinitionExistEndPoint,"HubsExtension")},"MsPortalImpl/UI/UI.DesktopManagerImpl":{getDashboardDeepLinkHandler:(0,s.makeRegistration)(i.DashboardEndpoints.getDashboardDeepLink,["HubsExtension","Microsoft_Azure_Resources"]),getDashboardFiltersHandler:(0,s.makeRegistration)(i.PartFilterEndpoints.getFilters,"HubsExtension"),getFilterValuesHandler:(0,s.makeRegistration)(i.PartFilterEndpoints.getFilterValues,"HubsExtension"),getFilterValueDisplayTextHandler:(0,s.makeRegistration)(i.PartFilterEndpoints.getFilterValueDisplayText,"HubsExtension"),getFilterWarningHandler:(0,s.makeRegistration)(i.PartFilterEndpoints.getFilterWarning,"HubsExtension")},"MsPortalImpl/Services/Services.BrowseQueryManifest":{getBrowseManifestsHandler:(0,s.makeRegistration)(i.ArtBrowse.getBrowseManifestsEndpoint,"fxw")},"MsPortalImpl/Services/Services.BrowseCuration":{getResourceTypesCategorizationEndPoint:(0,s.makeRegistration)(i.Curation.getResourceTypesCategorizationEndPoint,["HubsExtension","Microsoft_Azure_Resources"])},"MsPortalImpl/Services/Services.AssetMenuManifest":{getAssetMenuPrereqsHandler:(0,s.makeRegistration)(i.AssetMenu.getAssetMenuPrereqsEndpoint,"HubsExtension"),getResourceMenuPrereqsHandler:(0,s.makeRegistration)(i.AssetMenu.getResourceMenuPrereqsEndpoint,"HubsExtension"),getDefaultUxManifest:(0,s.makeRegistration)(i.AssetMenu.getDefaultUxManifestEndPoint,["HubsExtension","Microsoft_Azure_Copilot"])},"MsPortalImpl/Notifications/IrisNotificationsTelemetry":{irisTelemetryHandler:(0,s.makeRegistration)(i.Impl.irisTelemetryEndpoint,"HubsExtension")},"MsPortalImpl/Notifications/IrisNotificationsClient":{getIrisContentHandler:(0,s.makeRegistration)(b.IrisNotifications.getIrisContentEndPoint,null),sendIrisSignalHandler:(0,s.makeRegistration)(b.IrisNotifications.sendIrisSignalEndPoint,null)},"MsPortalImpl/Services/Services.DeploymentManager":{pollDeploymentHandler:(0,s.makeRegistration)(i.ResourceManager.pollDeploymentEndPoint,null),getMarketplaceUserSettingsHandler:(0,s.makeRegistration)(i.Marketplace.getMarketplaceUserSettingsEndPoint,["Microsoft_Azure_Marketplace","HubsExtension"]),internalDeploymentHelperHandler:(0,s.makeRegistration)(i.ResourceManager.internalDeploymentHelper,["VMCP","Citrix_XenApp_Essentials","Citrix_XenDesktop_Essentials","CloudSimpleExtension","SendGrid_EmailService","SamplesExtension","InternalSamplesExtension"]),notifyDeploymentHandler:(0,s.makeRegistration)(i.ResourceManager.notifyDeploymentEndPoint,null),writeLastUsedUserSettingsHandler:(0,s.makeRegistration)(o.writeHubsLastUsedUserSettings,"HubsExtension")},"MsPortalImpl/Notifications/NotifyResourcesCreated":{notifyResourcesCreatedHandler:(0,s.makeRegistration)(i.NotifyResourceCreated.notifyResourcesCreatedEndpoint,["Microsoft_Azure_Billing","Microsoft_Health_Admin"])},"MsPortalImpl/Services/Services.GeneralSettings":{writeBrowsePreviewOptInFlagHandler:(0,s.makeRegistration)(o.writeBrowsePreviewOptInFlagEndpoint,"HubsExtension")},"MsPortalImpl/Services/Services.Settings":{deleteUserSettingsHandler:(0,s.makeRegistration)(o.deleteHubsUserSettings,"HubsExtension"),readUserSettingsHandler:(0,s.makeRegistration)(o.readHubsUserSettings,["HubsExtension","fx"]),writeUserSettingsHandler:(0,s.makeRegistration)(o.writeHubsUserSettings,["HubsExtension","fx"]),readBrowserStorageSettingsHandler:(0,s.makeRegistration)(i.BrowserStorageSettings.readBrowserStorageSettingsEndpoint,"HubsExtension"),writeBrowserStorageSettingsHandler:(0,s.makeRegistration)(i.BrowserStorageSettings.writeBrowserStorageSettingsEndpoint,"HubsExtension"),readExtUserSettingsHandler:(0,s.makeRegistration)(FxImpl.Azure.ResourceManager.readUserSettingsEndPoint)},"MsPortalImpl/Services/Services.ArmEvents":{createResourceDeletedEventHandler:(0,s.makeRegistration)(i.Events.createResourceDeletedEventDefinition),matchEventsHandler:(0,s.makeRegistration)(i.Events.matchEventsDefinition),removeArmEventSubscriptionHandler:(0,s.makeRegistration)(i.Events.removeArmEventSubscriptionDefinition),subscribeToArmEventHandler:(0,s.makeProxyRegistration)(i.Events.subscribeToArmEventDefinition,"HubsExtension",!1)},"MsPortalImpl/Services/Services.ArmLocations":{getLocationsAndResourceTypesForCreateHandler:(0,s.makeRegistration)(FxImpl.Azure.getLocationsAndResourceTypesForCreate,null),getLocationsHandler:(0,s.makeRegistration)(FxImpl.Azure.getLocationsEndPoint,["HubsExtension","InternalSamplesExtension"])},"MsPortalImpl/Services/PastDueSubsCheck":{raiseWarningForPastDueSubsHandler:(0,s.makeRegistration)(i.Subscriptions.pastDueSubsWarningEndpoint,"HubsExtension")},"MsPortalImpl/UI/Dashboard/DashboardManager":{createDashboardHandler:(0,s.makeRegistration)(u.PortalDashboard.createDashboard,"Microsoft_Azure_PortalDashboard"),deleteDashboardsHandler:(0,s.makeRegistration)(u.PortalDashboard.deleteDashboards,"Microsoft_Azure_PortalDashboard"),getArmDashboardJsonHandler:(0,s.makeRegistration)(u.PortalDashboard.getArmDashboardJson,"Microsoft_Azure_PortalDashboard"),getPrivateDashboardsHandler:(0,s.makeRegistration)(u.PortalDashboard.getPrivateDashboards,"Microsoft_Azure_PortalDashboard"),getRecentDashboardsHandler:(0,s.makeRegistration)(u.PortalDashboard.getRecentDashboards,"Microsoft_Azure_PortalDashboard")},"MsPortalImpl/UI/Hubs/UI.NotificationManager":{addClientNotificationHandler:(0,s.makeRegistration)(FxImpl.Hubs.Notifications.addClientNotificationEndpoint,null),addClientNotificationsHandler:(0,s.makeRegistration)(FxImpl.Hubs.Notifications.addClientNotificationsEndpoint,null),addFxNotificationHandler:(0,s.makeRegistration)(r.addFxNotificationEndpoint,null),showModalNotificationHandler:(0,s.makeRegistration)(FxImpl.Hubs.Notifications.showModalNotificationEndpoint,"HubsExtension"),updateNotificationHandler:(0,s.makeRegistration)(FxImpl.NotificationManager.updateNotificationEndPoint,null),addNotification2Handler:(0,s.makeRegistration)(FxImpl.NotificationManager.addNotification2EndPoint,null),addNotificationHandler:(0,s.makeRegistration)(FxImpl.NotificationManager.addNotificationsEndPoint,null)},"MsPortalImpl/UI/UI.NavigationManager":{forceSignInHandler:(0,s.makeRegistration)(c.forceSignInEndPoint,null)},"MsPortalImpl/Services/Services.PersistentStorage":{writeSettingHandler:(0,s.makeRegistration)(g.writeSettingEndPoint),readSettingsHandler:(0,s.makeRegistration)(g.readSettingsEndPoint),removeSettingsHandler:(0,s.makeRegistration)(g.removeSettingsEndPoint),clearHandler:(0,s.makeRegistration)(g.clearEndPoint),getAllKeysHandler:(0,s.makeRegistration)(g.getAllKeysEndPoint)},"MsPortalImpl/Services/Services.ReactViewDataCache":{dataCacheAddHandler:(0,s.makeRegistration)(f.dataCacheAddEndPoint),dataCacheGetHandler:(0,s.makeRegistration)(f.dataCacheGetEndPoint),dataCacheClearHandler:(0,s.makeRegistration)(f.dataCacheClearEndPoint),dataCacheClearAllHandler:(0,s.makeRegistration)(f.dataCacheClearAllEndPoint)},"MsPortalImpl/Services/Services.CopilotInteractions":{copilotInteractionsHandler:(0,s.makeRegistration)(r.copilotInteractionsEndpoint),copilotNudgeHandler:(0,s.makeRegistration)(r.copilotNudgeEndpoint),addCopilotViewContextAdditionalDetailsHandler:(0,s.makeRegistration)(r.addCopilotViewContextAdditionalDetailsEndpoint)},"MsPortalImpl/Services/Services.CopilotShellAPIs":{copilotShellApisGetDirectLineTokenHandler:(0,s.makeRegistration)(r.copilotShellApisGetDirectLineTokenEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisGetManifestCacheHandler:(0,s.makeRegistration)(r.copilotShellApisGetManifestCacheEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisGetManifestCacheUriHandler:(0,s.makeRegistration)(r.copilotShellApisGetManifestCacheUriEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisGetExtensionVersionHandler:(0,s.makeRegistration)(r.copilotShellApisGetExtensionVersionEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisGetCurrentBladeInfoHandler:(0,s.makeRegistration)(r.copilotShellApisGetCurrentBladeInfoEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisGetRecentBladeHandler:(0,s.makeRegistration)(r.copilotShellApisGetRecentBladeEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisCollectFXContextsHandler:(0,s.makeRegistration)(a.copilotShellApisCollectFXContextsEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisGetBladeDeepLinkHandler:(0,s.makeRegistration)(r.copilotShellApisGetBladeDeepLinkEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisOpenBladeHandler:(0,s.makeRegistration)(r.copilotShellApisOpenBladeEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisLogErrorToExtensionHandler:(0,s.makeRegistration)(r.copilotShellApisLogErrorToExtensionEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisSetBladeDetailsHandler:(0,s.makeRegistration)(r.copilotShellApisSetBladeDetailsEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisGetShellHandlerDefinitionsHandler:(0,s.makeRegistration)(r.copilotShellApisGetShellHandlerDefinitionsEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisExecuteShellHandlerHandler:(0,s.makeRegistration)(r.copilotShellApisExecuteShellHandlerEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisExecuteBladeHandlerHandler:(0,s.makeRegistration)(r.copilotShellApisExecuteBladeHandlerEndpoint,["fx","Microsoft_Azure_Copilot"]),copilotShellApisGetBladeViewModelsHandler:(0,s.makeProxyRegistration)(a.copilotShellApisGetBladeViewModelsHandlerEndpoint)},"MsPortalImpl/Services/Services.CopilotManager":{copilotRunSampleTestHandler:(0,s.makeRegistration)(r.copilotRunSampleTestEndpoint,["HubsExtension","Microsoft_Azure_Copilot"])},"MsPortalImpl/Services/Services.CopilotReactViewChannelFactory":{getActiveReactViewsForCopilotManagerHandler:(0,s.makeRegistration)(a.getActiveReactViewsForCopilotManagerEndpoint,["fx","Microsoft_Azure_Copilot"]),getReactViewPortForCopilotManagerHandler:(0,s.makeRegistration)(a.getReactViewPortForCopilotManagerEndpoint,["fx","Microsoft_Azure_Copilot"])},"MsPortalImpl/Services/Services.Copilot":{isCopilotEnabledHandler:(0,s.makeRegistration)(g.isCopilotEnabledEndpoint)},"MsPortalImpl/Services/Services.FeedbackPolicies":{fetchFeedbackPolicySettingsHandler:(0,s.makeRegistration)(r.fetchFeedbackPolicySettingsEndpoint)},"MsPortalImpl/UI/UI.DockedContextPane":{openDockedContextPane:(0,s.makeRegistration)(h.openDockedContextPaneEndpoint,["InternalSamplesExtension","Microsoft_Azure_ContainerService","Microsoft_Azure_SolutionCenter","Microsoft_Azure_Support","Microsoft_Intune_Workflows"])},"MsPortalImpl/ReactViews/AssetTypeViewModel":{getReactAssetTypeViewModel:(0,s.makeProxyRegistration)(i.AssetMenu.getReactAssetTypeViewModelEndpoint)},"MsPortalImpl/Extension/DxDefinitionCache":{getDxContentHandler:(0,s.makeRegistration)(b.CreateUiDef.getDxContentEndPoint,[MsPortalFx.Base.Constants.Shell,"Microsoft_Azure_CreateUIDef","Microsoft_Azure_PortalDashboard"])}})}})),
define("MsPortalImpl/Services/Services.AssetMenuManifest",["require","exports","Fx/DependencyInjection","FxHubs/RpcEndPoints","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Extension/ExtensionManagerOptions","Fx/Errors"],(function(e,t,s,o,i,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultUxManifest=t.getAssetMenuPrereqsHandler=t.getResourceMenuPrereqsHandler=t.AssetMenuManifestProvider=void 0;const c=MsPortalFx.Base.Diagnostics.createLog(e);let d=class{constructor(e,t,s,o){this._manifestCache=e,this._assetTypeService=t,this._diContainer=s,this._extensionManagerOptions=o}getResourceMenuManifests(e){return this._assetTypeService.assetTypesComplete.then((()=>{const t=Object.create(null),s=e.map((e=>{const s=this._assetTypeService.getAssetTypeByResourceType(e);return s?this.getMenuManifest(s).then((s=>{t[e]={assetMenuManifest:s}})):(t[e]=null,Promise.resolve(null))}));return Promise.all(s).then((e=>t))}))}getResourceMenuManifest(e){return this._assetTypeService.assetTypesComplete.then((()=>{const t=this._assetTypeService.getAssetTypeByResourceType(e);if(!t){const t=new l.FxError({message:`Asset type not found for resource type: ${e}`});return c.error(t),null}return this.getMenuManifest(t).then((e=>({assetMenuManifest:e})))}))}getAssetMenuManifest(e,t){return this._assetTypeService.assetTypesComplete.then((()=>{const s=this._assetTypeService.getAssetType(e,t);if(!s){const s=new l.FxError({message:`Asset type not found for extension: ${e} with name: ${t}`});return c.error(s),null}return this.getMenuManifest(s).then((e=>({assetTypeManifest:s.assetTypeManifest,assetMenuManifest:e})))}))}getMenuManifest(e){const t=e&&e.assetTypeManifest;if(t){const s=e.variant,o=(t.name||"").toLowerCase(),i=s&&o+"/variant:"+s||o;return this._manifestCache.getManifestAsync(e.extension,"assetTypesMenu").then((e=>{const t=(e.assetTypesMenu||[]).filter((e=>e.name.toLowerCase()===i));if(0===t.length&&s&&t.push(...(e.assetTypesMenu||[]).filter((e=>e.name.toLowerCase()===o))),t.length)return t[0]}))}return Promise.resolve(null)}getDefaultUxManifest(e){let t;try{t=this._extensionManagerOptions.getNormalizedMetadata("Microsoft_Azure_GeneratedExtension",!0)}catch{return Promise.resolve("")}return(0,i.get)("MsPortalImpl/Extension/DxDefinitionCache","getDefaultUXManifest").then((s=>s(this._diContainer,t,e))).then((e=>e))}};t.AssetMenuManifestProvider=d,t.AssetMenuManifestProvider=d=__decorate([__metadata("fx:diagnostics",[e,"AssetMenuManifestProvider"]),s.Class(),__metadata("design:paramtypes",[n.ManifestCache,r.AssetTypeService,s.Container,a.ExtensionManagerOptions])],d),t.getResourceMenuPrereqsHandler=(0,i.defineHandler)(o.AssetMenu.getResourceMenuPrereqsEndpoint,(e=>e.diContainer.get(d).getResourceMenuManifest(e.messageArg))),t.getAssetMenuPrereqsHandler=(0,i.defineHandler)(o.AssetMenu.getAssetMenuPrereqsEndpoint,(e=>e.diContainer.get(d).getAssetMenuManifest(e.messageArg.extensionName,e.messageArg.assetName))),t.getDefaultUxManifest=(0,i.defineHandler)(o.AssetMenu.getDefaultUxManifestEndPoint,(e=>e.diContainer.get(d).getDefaultUxManifest(e.messageArg.manifestName)))})),
define("MsPortalImpl/Services/Services.AssetTypes.Rpc",["require","exports","FxHubs/RpcEndPointsCore","FxInternal/Assets/AssetTypes","FxInternal/ResourceManagement/BrowseBladeCore","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.AssetMenuManifest"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupAssetTypeServiceRpc=void 0;var a=FxImpl.Extension;t.setupAssetTypeServiceRpc=function(e){const t=e.get(FxImpl.Rpc.Client),l=e.get(n.AssetTypeService);e.get(r.AssetMenuManifestProvider),function(e,t,r){o.getAllAssetTypesEndPoint.register(e,null,(o=>{if(o?.includeBrowseManifest||o?.includeVariants){return(o?.includeVariants?(0,n.assetTypesWithVariantsMemo)(t):(0,n.assetTypesMemo)(t)).then((t=>{const i=[];t?.forEach((e=>e.resourceType&&i.push(e.lowerCaseResourceType)));return(o?.includeBrowseManifest?s.Browse.getBrowseManifestsForResourceTypesEndpoint.invoke(e,"fxw",i):Promise.resolve({})).then((e=>t.map((t=>{const s={...t};return s.resourceType&&o.includeBrowseManifest&&e&&(s.browseManifest=e[t.lowerCaseResourceType]),s}))))}))}return(0,n.assetTypesMemo)(t).then((e=>e?.slice()))})),a.getAssetTypeInformationEndPoint.register(e,null,(e=>t.getAssetTypeInformation(e.extensionName,e.assetType))),a.getResourceTypeAssetTypeInformationEndPoint.register(e,null,(e=>t.getResourceTypeAssetTypeInformation(e))),a.mapAssetIdToDynamicSelectionAndIconEndPoint.register(e,null,((e,s)=>t.mapAssetIdToDynamicSelectionAndIcon(e.assetId,"mapAssetIdToDynamicSelectionAndIcon"))),i.getBrowseBladeReferenceEndPoint.register(e,null,((e,s)=>t.getBrowseBladeReference(e)))}(t,l)}})),
define("MsPortalImpl/Services/Services.BrowserTelemetry",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserInfo=void 0;var s=MsPortalFx.Base;const o=window,i=o.screen||{};let n,r,a,l;function c(){const e=i.height,t=i.width,c=o.innerHeight,d=o.innerWidth;if(n!==e||r!==t||a!==c||l!==d){const o={PreviousWindowHeight:a,PreviousWindowWidth:l,PreviousWindowResolution:l+"x"+a};n=e,r=t,a=c,l=d,function(e,t){const o=Date.now();s.Diagnostics.Telemetry.trace({timestamp:o,source:"BrowserTelemetry",action:t,data:e})}(MsPortalFx.extend(o,{ScreenHeight:e,ScreenWidth:t,ScreenResolution:t+"x"+e,WindowHeight:c,WindowWidth:d,WindowResolution:d+"x"+c}),"WindowSizeChanged")}}t.getBrowserInfo=function(){const e=o.navigator||{},t=i.availHeight,s=i.availWidth,c=n=i.height,d=r=i.width,f=a=o.innerHeight,x=l=o.innerWidth;return{AppName:e.appName,AppVersion:e.appVersion,UserAgent:e.userAgent,Language:e.language,SystemLanguage:e.systemLanguage,UserLanguage:e.userLanguage,Location:o.location.href,Platform:e.platform,CpuClass:e.cpuClass,Orientation:p,PrefersMsHighContrast:g,PrefersColorScheme:u,PrefersContrast:m,PrefersReducedMotion:h,ScreenAvailableHeight:t,ScreenAvailableWidth:s,ScreenAvailableResolution:s+"x"+t,ScreenHeight:c,ScreenWidth:d,ScreenResolution:d+"x"+c,WindowHeight:f,WindowWidth:x,WindowResolution:x+"x"+f,ScreenColorDepth:i.colorDepth}};let d=0;$(o).on("resize",((e,t)=>{clearTimeout(d),d=setTimeout(c,5e3)}));const p=o.matchMedia("(orientation: landscape)").matches?"landscape":o.matchMedia("(orientation: portrait)").matches?"portrait":"undetermined",u=o.matchMedia("(prefers-color-scheme: light)").matches?"light":o.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"nopreference",m=o.matchMedia("(prefers-contrast: more)").matches?"more":o.matchMedia("(prefers-contrast: less)").matches?"less":o.matchMedia("(prefers-contrast: custom)").matches?"custom":"nopreference",h=o.matchMedia("(prefers-reduced-motion: reduce)").matches?"reduce":"nopreference",g=o.matchMedia("(forced-colors: active) and (prefers-color-scheme: light)").matches?"light":o.matchMedia("(forced-colors: active) and (prefers-color-scheme: dark)").matches?"dark":o.matchMedia("(forced-colors: active)").matches?"activeWithNoDarkOrLightPreferenceDetected":"off"})),
define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",["require","exports","Fx"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerFileUploadEndpoints=void 0;var o=FxImpl.Rpc,i=FxImpl.FileUpload;const n=(0,s.memoizePromise)((()=>MsPortalFx.require("MsPortalImpl/Services/Services.FileUploadManager").then((e=>e.fileUploadManagerInstance()))));let r=!1;t.registerFileUploadEndpoints=function(){r||(r=!0,i.uploadActionEndPoint.register(o.client,null,(e=>n().then((t=>t.invokeUploadAction(e.uploadKey,e.action,e.context))))),i.getUploadInfosEndPoint.registerObjectFactory(o.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:e=>n().then((t=>t.getUploadInfos(e.uploadKeys,e.category,e.resumable)))}))}})),
define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports","Fx"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.uploadSettingsManager=t.hasFileUploads=void 0;const o=(0,s.memoizePromise)((()=>MsPortalFx.require("MsPortalImpl/Services/Services.FileUploadSettings").then((e=>e.fileUploadResumableTrackerInstance()))));let i=!1;t.init=function(e){i||(i=!0,t.uploadSettingsManager=e,e.querySettings({store:10}).then((t=>{!MsPortalFx.isEmpty(t)&&o().then((t=>t.init(e)))})))}})),
define("MsPortalImpl/Services/Services.GitHub",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchGitHubAccountInfo=void 0;var s=MsPortalFx.Base.Diagnostics.Telemetry;let o;t.fetchGitHubAccountInfo=async function(e){if(o)return o;const t=s.start({source:"Services.GitHub",action:"FetchGitHubAccountInfo"});try{o=await fetch(`https://api.github.com/user/${e}`).then((e=>e.json())),s.completeTrace(t)}catch(e){s.cancelTrace(t,{error:e})}return o}})),
define("MsPortalImpl/Services/Services.HatsSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HatsSettings=t.HatsSettingsManager=void 0;class n extends i.SettingsProcessor{static create(e){return i.create(n,e,new r,18,!0)}}t.HatsSettingsManager=n,__decorate([__metadata("fx:diagnostics",[e,"HatsSettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.SettingsManager]),__metadata("design:returntype",Promise)],n,"create",null);class r{constructor(){this.hatsExtensions=ko.observable("")}static create(e){return e.value}addExtensionCounts(e){if(!e.length)return;const t=JSON.parse(this.hatsExtensions()||"{}");e.forEach((e=>{const s=(t[e.extension]??0)+e.count;t[e.extension]=s})),this.hatsExtensions(JSON.stringify(t))}getHatsExtensionsList(){const e=JSON.parse(this.hatsExtensions()||"{}"),t=function(e){return Object.keys(e).map((t=>e[t]??0)).reduce(((e,t)=>e+t),0)}(e);return Object.keys(e).map((s=>{const o=e[s];return{bladeLoadCount:o,extension:s,extensionWeight:(i=t,n=o,Number((n/i).toFixed(5))),totalBladeLoadCount:t};var i,n}))}}t.HatsSettings=r,__decorate([__metadata("fx:diagnostics",[e,"HatsSettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[n]),__metadata("design:returntype",r)],r,"create",null)})),
define("MsPortalImpl/Services/Services.MfaSettings",["require","exports","MsPortalImpl/Notifications/NotificationsClientStrings"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleMfaNotificationLogic=void 0;var o=MsPortalFx.Base.Diagnostics.Telemetry;const i=s.MfaEnforcement;function n(e,t){o.trace({source:"Services.MfaSettings",action:e,data:t})}t.handleMfaNotificationLogic=async function(t,s,o){const r=s.getBooleanValue("mfanotification"),a=MsPortalFx.isFeatureEnabled("ci"),l=MsPortalFx.isFeatureEnabled("testmfaenforcementnotification"),c=s.getBooleanValue("mfaloginexp");if(n("handleMfaNotificationLogicCalled",{ciEnabled:a,mfaExpEnabled:c,mfaNotificationEnabled:r}),r&&!a&&!c||l)try{const r=o.mfaNotificationLastSeen(),a=Date.now(),c=864e5*(s.getNumberValue("mfanotificationintervalindays")||7),d=t&&(r||a-c-1e4)<a-c;if(n("MsPortalEarly_preload_Success",{isTenantAdmin:t,mfaNotificationIntervalInMs:c,mfaNotificationLastSeen:r}),d||l){const t=fx.environment.notifications?.mfaNotificationPortalName??"Azure portal",a=s.getNumberValue("mfaenforcementdateinms")||0,l=new Date;l.setTime(a),n("Publishing_Notification",{mfaNotificationIntervalInMs:c,mfaNotificationLastSeen:r,mfaNotificationPortalName:t}),MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{const s="<div><span>"+(a?i.descriptionSpecific.format(t,l.toLocaleDateString()):i.descriptionVague.format(t))+"</span><a class='msportalfx-ext-link' target='_blank' href='https://aka.ms/mfaforazure' style='margin-left: 5px; line-height: 10px;'>"+i.linkText+"</a></div>";setTimeout((()=>{const t=e.publishNotification({title:i.title,description:{htmlTemplate:s},status:0,toastDuration:2,actions:[{label:i.buttonText,id:"MfaEnforcementNotification_GoTo_MfaSettingsBlade_"+MsPortalFx.getUniqueId(),action:"#view/Microsoft_Azure_Resources/MfaSettings.ReactView"}]});t?n("Published_Notification",{id:t.id}):n("Publish_Failed"),o.mfaNotificationLastSeen(Date.now())}),5e3)}))}}catch(e){n("MsPortalEarly_preload_Failed",MsPortalFx.getLogFriendlyMessage(e))}}})),
define("MsPortalImpl/Services/Services.ProjectedDirectories",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.AuthStateManager","Fx/ResourceManagement","Fx/Ajax","FxHubs/ArmHelpers/ArmApisStartup","MsPortalImpl/Services/Services.Tenants","FxHubs/RpcEndPoints","FxHubs/HubsSettingsSchema","MsPortalImpl/Services/Services.Settings","FxInternal/AsyncLoader","Fx"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetState=t.getDirectoriesMapHandler=t.getSubscriptionsForSelectedDirectoriesHandler=t.ServicesProjectedDirectories=void 0;var m=MsPortalFx.Base.Diagnostics.Telemetry;const h=c.Keys.directoriesSelected,g="Services.ProjectedDirectories",f=(0,u.memoizePromise)((async e=>{const t=(await e.getTenants()).tenants||[],s=FxImpl.lowerCaseStringMap(),o=[];t.forEach((e=>{const{id:t,displayName:i,tenantCategory:n}=e;s.set(t,e),!i&&n.toLowerCase().includes("projectedby")&&o.push(t)}));const i=o.length;if(i){const e=m.start({source:g,action:"_getDirectoriesMapMemo"}),t=[],a=(0,r.listTenantsApi)();for(let e=0;e<i;e=Math.min(i,e+10)){const s=o.slice(e,e+10),i=(async()=>{const e=await(0,n.batch)({uri:`${a}&$filter=tenantId in ('${s.join("','")}')`,setTelemetryHeader:g+".getDirectoryNames"});if(![200,202,201,204].includes(e.httpStatusCode))throw FxImpl.Azure.buildSimplifiedError(e.content);return e.content})();t.push(i)}try{const i=await Promise.allSettled(t);let n=!1,r=0;return i.forEach((e=>{e&&"fulfilled"===e.status&&e.value?(e.value.value||[]).forEach((({tenantId:e,displayName:t})=>{t&&(r++,s.get(e).displayName=t)})):n=!0})),m.completeTrace(e,{directoriesToResolve:o.length,directoriesResolved:r,hasErrors:n}),s}catch(t){throw m.cancelTrace(e,{directoriesToResolve:o.length}),t}}return s}));let x=class{constructor(e,t,s){this._tenantsService=e,this._settingsManager=t;const o=this._selectedDirectoriesInSession=ko.observable([]),i=s.getCurrentUser().tenantId;!i&&m.trace({source:g,action:"constructor",name:"CurrentUserDirectoryIdIsUndefined"});const n=(i||"").toLowerCase(),r=this._defaultSelectedDirectories=[n];this._initPromise=(async()=>{const e=await t.querySetting(6,h),s=e?.toLowerCase()?.split(";"),i=s?.length?s:r;m.trace({source:g,action:"InitializeProjectedDirectories",data:{first100SelectedDirectoryIds:i.slice(0,100)}}),o(i)})(),this._hasProjectedDirectoriesPromise=(async()=>{const[t]=await Promise.all([e.getTenants(),this._initPromise]),s={};let i=!1;t.tenants.forEach((e=>{const t=e.id.toLowerCase(),o=t!==n,r=e.tenantCategory.toLowerCase().includes("projectedby");i=i||o&&r,o&&!r||(s[t]=!0)}));const r=o(),a=r.filter((e=>s[e]));return a.length!==r.length&&this.setSelectedDirectoriesInSession(a),i})(),f(e)}async hasProjectedDirectories(){return await this._initPromise,this._hasProjectedDirectoriesPromise}async setSelectedDirectoriesInSession(e){await this._initPromise;const t=e?.length?e.map((e=>(!e&&m.trace({source:g,action:"setSelectedDirectoriesInSession",name:"DirectoryIdIsUndefined"}),(e||"").toLowerCase()))):this._defaultSelectedDirectories;return this._selectedDirectoriesInSession(t),this._settingsManager.setSetting(6,h,t.join(";"))}async getSelectedDirectoriesInSession(){return await this._initPromise,this._selectedDirectoriesInSession}async getSubscriptionsForSelectedDirectories(e){await this._initPromise,e=e||[];const t=this._selectedDirectoriesInSession();return e.filter((({tenantId:e,subscriptionId:s})=>e?t.includes(e.toLowerCase()):(m.trace({source:g,action:"getSubscriptionsForSelectedDirectories",name:"SubHasNoTenant",data:s}),!1)))}async getDirectoriesMap(){const[e]=await Promise.all([f(this._tenantsService),this._initPromise]);return e}async getDirectoryByResourceId(e){const t=i.ArmId.parse(e,!0);if(!t.subscription)return Promise.resolve(null);const[s,o]=await Promise.all([MsPortalFx.Azure.getSubscriptionInfo(t.subscription),f(this._tenantsService),this._initPromise]),n=s?.tenantId;return n?o.get(n.toLowerCase())||{id:n,displayName:"",domainName:"",tenantCategory:""}:null}};t.ServicesProjectedDirectories=x,t.ServicesProjectedDirectories=x=__decorate([__metadata("fx:diagnostics",[e,"ServicesProjectedDirectories"]),s.Class(),__metadata("design:paramtypes",[a.TenantsService,d.SettingsManager,o.AuthStateManager])],x),t.getSubscriptionsForSelectedDirectoriesHandler=(0,p.defineHandler)(l.Directories.getSubscriptionsForSelectedDirectoriesEndPoint,(e=>e.diContainer.get(x).getSubscriptionsForSelectedDirectories(e.messageArg))),t.getDirectoriesMapHandler=(0,p.defineHandler)(l.Directories.getDirectoriesMapEndPoint,(async e=>{const t=await e.diContainer.get(x).getDirectoriesMap(),s={};return t.forEach(((e,t)=>{s[t]=e})),s}))})),
define("MsPortalImpl/Services/Services.Settings.Schema",["require","exports"],(function(e,t){"use strict";var s;return function(e){e.avatarKey="avatar_base64encoded",e.desktopSettingsKey="sprint2",e.startBoardSettingsKey="Startboard"}(s||(s={})),s})),
define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","FxInternal/AsyncLoader"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSharedSettings=void 0;const o=window.fx.environment.links;t.getSharedSettings=s.defineHandler(FxImpl.Extension.getSharedSettingsEndPoint,(e=>({links:{accountPortal:o.accountPortal,classicPortal:o.classicPortal,createSupportRequest:o.createSupportRequest,helpAndSupport:o.helpAndSupport,manageSupportRequests:o.manageSupportRequests,submitAnIdea:o.submitAnIdea,privacyAndTerms:o.privacyAndTerms,privacyStatement:o.privacyStatement,promotionalCommunicationsManager:o.promotionalCommunicationsManager,learnRelatedResources:o.learnRelatedResources,resourceGroupOverview:o.resourceGroupOverview,roadmap:o.roadmap,filteringGranularity:o.filteringGranularity}})))})),
define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","Fx/Composition/Selectable","Fx/DependencyInjection","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/UI.JourneyManager"],(function(e,t,s,o,i,n){"use strict";var r;return function(t){var r=FxImpl.ViewModels.ParameterCollectionV3,a=MsPortalFx.Base.Diagnostics;t.promiseCleanupDelay=3e4;const l=a.createLog(e);t.create=function(e){return e.get(c)};let c=class{constructor(e,t,s){this._diContainer=e,this._journeyManager=t,this.provisioningPromisesLookup={},this._registerRpcCallbacks(s)}processProvisioningRequest(e){let t=!0;const o="Provisioning request is ";if(!e)throw new Error(`${o}undefined.`);if(!e.provisioningRefKey)throw new Error(`${o}missing the provisioningReferenceKey.`);if(!e.provisioningPromise)throw new Error(`${o}missing the provisioningPromise.`);e.provisioningPromise.catch((e=>{const t=(e||{}).error||e;this._logWarning("Provisioning promise rejected. "+(t.message||JSON.stringify(t)))}));const n=e.provisioningConfig;n&&n.dontDiscardJourney&&(t=!1);const r=n&&n.launchPostCreate&&n.postProvisioningBladeInputs;return r&&r.then((e=>{const t=new s.PdlBladeReference("DeploymentDetailsBlade","HubsExtension",{parameters:{id:e.deploymentId,packageId:e.galleryItemId,packageIconUri:e.galleryItemIconUri,assetTypeId:e.assetTypeId,primaryResourceId:e.primaryResourceId,provisioningHash:e.provisioningHash,createBlade:e.createBlade}}),o=e.createBlade?.telemetryId||"";this._diContainer.get(i.BladeOpener).openBlade(t,{flags:8,telemetryName:"ShellProvisioner"+(o?`_${o}`:"")})})),t&&!r&&e.provisioningPromise.then((()=>{const e=this._journeyManager.activeJourney();e&&this._journeyManager.forceDiscardJourney(e.id)})),e.provisioningPromise}_registerRpcCallbacks(e){r.initiateProvisioningRequestEndPoint.registerObjectFactory(e,{allowedOrigin:null,allowRemoteChanges:!0,handler:(t,s)=>{const o=s.srcWindowId,i="Can't initiate the provisioning request. ";return t.provisionerId?t.provisioningRefKey?(r.getProvisioningRequestEndPoint.acquireObject(e,o,t).then((e=>{this.processProvisioningRequest(e.value).finally((()=>{e.dispose()}))}),(e=>{throw new Error(e)})),Promise.resolve(t)):Promise.reject(i+"provisioningRefKey unspecified."):Promise.reject(i+"provisionerId unspecified.")}}),r.getProvisioningOperationEndPoint.registerObjectFactory(e,{allowedOrigin:null,allowRemoteChanges:!0,handler:e=>{if(!e)return Promise.reject("Can't return provisioning operation. provisioningRefKey unspecified.");const t=this.provisioningPromisesLookup[e],s=t&&t.promise;return s&&(this.provisioningPromisesLookup[e].wasAcquired=!0),Promise.resolve({provisioningPromise:s,data:t&&t.data})}})}_logWarning(e){l.warning(e)}};c=__decorate([__metadata("fx:diagnostics",[e,"ShellProvisionerImpl"]),o.Class(),__metadata("design:paramtypes",[o.Container,n.JourneyManager,FxImpl.Rpc.Client])],c),t.ShellProvisionerImpl=c}(r||(r={})),r})),
define("MsPortalImpl/Services/Services.TelemetrySharing",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingTelemetryProcessor=void 0;var i=MsPortalFx.Base.Constants,n=FxImpl.Rpc;let r=class{constructor(e,t){this._extensionManager=e,this._extensions={},t.registerRpcEndPoint(i.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:()=>{this._extensions[n.getMessageContext().srcWindowId]=!0}})}registerExtensionUnloadCallback(){this._extensionManager.onUnload((e=>{const t=e;return this._extensions[t]&&delete this._extensions[t],!0}))}trace(e){const t=e.extension,s=e.data&&e.data.srcExtension,o=i.TelemetrySharing.TraceTelemetry;"Ajax"!==e.action&&(this._extensions[t]&&n.client.invokeRpc(o,t,e),t!==s&&this._extensions[s]&&n.client.invokeRpc(o,s,e))}flush(){return Promise.resolve()}};t.SharingTelemetryProcessor=r,t.SharingTelemetryProcessor=r=__decorate([__metadata("fx:diagnostics",[e,"SharingTelemetryProcessor"]),s.Class(),__metadata("design:paramtypes",[o.ExtensionManager,n.Client])],r)})),
define("MsPortalImpl/Services/Services.Util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.redactSensitiveData=t.registerEndpoints=void 0;var s=FxImpl.Constants.RpcMethods,o=MsPortalFx.Base.Constants.ExtensionNames;function i(t,s,o,i,n,r){return i.registerRpcEndPoint(t,{allowedOrigin:r,handler:(t,i)=>MsPortalFx.require(e.normalize(s)).then((e=>(0,e[o])(t,i,i.ltm,n)))})}t.registerEndpoints=function(e,t){const n="./Services.UtilHandlers";i(s.pinParts,n,"pinPartsRpcHandler",e,t),i(s.getClientIp,n,"getClientIpHandler",e,t),i(s.getClientIpv6,n,"getClientIpv6Handler",e),i(s.getHmacSha256,n,"hmacShaRpcHandler",e),i("MsPortalFx.Internal.Constants.RpcMethods.X509Certificate.getX509Certificates",n,"x509CertificateRpcHandler",e),i("MsPortalFx.Internal.Constants.RpcMethods.PublishingProfile.getPublishingProfile",n,"getPublishingProfileRpcHandler",e,null,[`${o.ClassicResources}`,"fx"])},t.redactSensitiveData=function(e){const t=(e=e||"").toLowerCase();return["password","pwd","azure_storage_access_key","sharedkey"].some((e=>t.includes(e)))?"_REDACTED_SENSITIVE_DATA_":MsPortalFx.sanitizeMessage(e)}})),
define("MsPortalImpl/Parts/Parts.Error",["require","exports","MsPortalImpl/Parts/Parts","MsPortalImpl/Widgets/Widgets.PartError","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/UI/Commands/UI.ShellCommands"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=MsPortalFx.Parts,a=r.PartKind;class l extends s.PartImpl{constructor(e,t,s,o){super(e,t,s,o),t.container.contentState(3),t.internal.allowUiBlocking(!1)}_bindContent(e,t){const s=this._viewModel.content.peek(),r=new o.ViewModel(s,{sessionId:MsPortalFx.sessionId,extName:this._getExtensionName(),resourceId:this.assetId(),contentName:this._options.locator.name},{showDetailsCmd:this._onDashboard}),a=this.partComposition,l=new i.CompositionInstanceCommandContext(e,null,a),c=a&&new n.ReloadPart(this._lifetime,this._diContainer,a);if(c&&(c.bind(l),r.commands.push(c)),this._onDashboard){const e=a&&new n.UnpinFromStartboard(this._lifetime,this._diContainer);e&&(e.bind(l),r.commands.push(e))}const d=a&&new n.GoToAssetBlade(this._lifetime,this._diContainer,this.partComposition);d&&(d.bind(l),d.enabled()&&r.commands.push(d)),this._lifetime.registerForDispose(new o.Widget($(e),r,this._diContainer))}}s.registerFactory(a[r.PartKind._Internal_Error],s.createPartFactory("",{partClass:l}))})),
define("_generated/Less/MsPortalImpl/Parts/Parts.Frame.css",["module"],(function(e){"use strict";return{css:".fxs-part.fxs-part-framepart{padding:0;overflow:hidden!important}.fxs-part.fxs-part-framepart.fxs-part-part-title-visible .fxs-part-title{padding:15px 15px 0 15px}.fxs-part-frame{width:100%;height:100%;border:0;overflow:auto;min-height:calc(100vh - 40px)}@media(min-height:500px){.fxs-part-frame{min-height:initial}}",moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.Frame.Common",["require","exports","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Frame.css"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeContentPadding=t.formMarkName=t.logFrameTelemetry=t.logFrameAddedTelemetry=t.createFrame=void 0,(0,s.injectCss)(o);var i=MsPortalFx.Base.Diagnostics.Telemetry;const n=window;function r(e){const{isPart:t,journeyManager:s,locator:o,action:n}=e,r=s.activeJourney();FxImpl.TelemetryContext.usingState((()=>{i.trace({extension:o.getExtensionName(),source:t?"StartBoardPart":"Blade",action:n,name:a(e),journeyId:r&&r.id})}),e.telemetryContextState)}function a({isPart:e,locator:t}){let s=t?t.toFriendlyString().toLowerCase():"";return e||(s=s.replace(/\/lens\/.*$/g,"")),s}t.createFrame=function(e){const{contentElement:t,onFatalError:s,trustedOrigin:o,messageSignature:i,onMessage:r,lifetime:a,uri:l,frameReadyDeferred:c,isReadyMessage:d}=e,p=l.toString(),u=FxImpl.createElement("div",{trustedInnerHTML:"<iframe />"}).firstElementChild;let m;u.classList.add("fxs-part-frame"),u.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-modals allow-forms allow-downloads"),u.setAttribute("allow","microphone *; encrypted-media *;clipboard-read;clipboard-write;"),u.setAttribute("role","presentation"),u.setAttribute("src",p),u.setAttribute("allowfullscreen","true"),t.appendChild(u);const h=a.createChildLifetime(),g=e=>{if(h.isDisposed())return;if(!(e.source===(m||u.contentWindow)))return;const t=e.data;"###BOOT###"===t.signature&&s(new Error("Boot message received from iframe, disposing to prevent XSS.")),e.origin===o&&t&&t.signature===i&&(d(t)&&(clearTimeout(f),f=null,c.resolve(),m||(m=u.contentWindow)),r(t))};n.addEventListener("message",g,!1);let f=setTimeout((()=>{FxImpl.Diagnostics.getStatusCode(p,((e,t,s)=>{const o={postIFrameLoadFailurePingResponse:{uri:p,statusCode:e,statusText:s,responseText:t}};c.reject(o)})),f=null}),3e4);return h.registerForDispose({dispose:()=>{f&&clearTimeout(f)}}),h.registerForDispose((()=>{n.removeEventListener("message",g,!1),u.remove()})),{postMessage:(e,t)=>{m.postMessage(e,o,t)},contentWindow:m}},t.logFrameAddedTelemetry=function(e){r({...e,action:"IFrameAddedToDom"})},t.logFrameTelemetry=r,t.formMarkName=a,t.removeContentPadding=function(e){$(e).closest(".fxs-part").addClass("fxs-part-framepart")}})),
define("MsPortalImpl/Parts/Parts.ReactFrameProvider",["require","exports","MsPortalImpl/ReactViews/ReactFrame.FramePool","MsPortalImpl/UI/Compositions/UI.Composition"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFrameProvider=void 0;const i=window,n="fxs-display-none",r="fxs-bladesize-",a="data-react-id";t.createFrameProvider=function(e,t){return t.isTile?new c:32&e.container.flags?new u:1&e.container.flags?new p:16&e.container.flags?new m:t.isMenuBlade?new h:new d};class l{setContentElement(e){this._contentElement=e,e.classList.add("fxs-part-reactframe")}getOptions(e){return this._lifetime=e,this._getFrameOptions(e)}bindToFrame(e,t){const s=this._contentElement;return s.setAttribute(a,t.id),this._configureFrameElement(t.element),this._sectionElement=s.closest(this._cssClasses.section),this._bindToFrame(e,t)}_configureFrameElement({classList:e}){this._cssClasses.frame&&e.add(this._cssClasses.frame),e.add("fxs-floated-frame"),e.remove("fxs-extension-frame")}_createObserver(e,t,s){const o=this._sectionElement,i=this._mutationObserver=new MutationObserver((()=>{s?.(),t.style.display="none"===getComputedStyle(o).display?"none":""}));e.registerForDispose((()=>{i.disconnect()})),i.observe(o,{attributes:!0,attributeFilter:["style","class"]})}_observeParentElement(){this._mutationObserver.observe(this._sectionElement.parentElement,{childList:!0})}_getFrameActions(e,t){const s=()=>{e.element.classList.add(n),e.element.classList.forEach((t=>t.startsWith(r)&&e.element.classList.remove(t))),e.inUse=!1};return this._lifetime.registerForDispose({dispose:s}),{showIFrame:()=>{e.element.classList.remove(n),t?.()},hideIFrame:s}}}class c extends l{constructor(){super(...arguments),this._cssClasses={frame:"fxs-tile-floated-frame",section:".fxs-part"}}getFrame(e,t,o,i){return e.get(s.ReactFramePool).getFrame(2,t.closest(".fxs-part"),o,i,!1)}_getFrameOptions(){return{reactFrameType:2}}_bindToFrame(e,t){return this._createObserver(e,t.element),this._getFrameActions(t)}}class d extends l{constructor(){super(...arguments),this._cssClasses={frame:"fxs-blade-floated-frame",section:".fxs-blade"}}getFrame(e,t,o,i){return e.get(s.ReactFramePool).getFrame(0,null,o,i,!0)}_getFrameOptions(){const e=this._contentElement.closest(".fxs-blade-content-container")?.querySelector(".fxs-bladesize-menu");return{reactFrameType:0,isMenuBladeContent:this._isMenuBladeContent=!!e}}_bindToFrame(e,t){const s=t.element;this._isMenuBladeContent&&s.classList.add("fxs-blade-floated-menuframe");const o=this._contentElement,n=document.getElementsByClassName("fxs-journey-layout")[0],r=o.closest(".fxs-blade-content-wrapper"),a=()=>{const e=s.parentElement&&s.parentElement.getBoundingClientRect(),t=e?.left||0,i=e?.top||0,a=o.getBoundingClientRect(),l=r.getBoundingClientRect();s.setAttribute("style",`left: ${n.scrollLeft+a.left-t}px; top: ${n.scrollTop+a.top-i}px; height: ${l.height}px; width: ${l.width}px;`)};return o.onresize=a,a(),i.addEventListener("resize",a),i.addEventListener("visibilitychange",(()=>"visible"===i.document.visibilityState&&i.requestAnimationFrame(a))),e.registerForDispose((()=>{i.removeEventListener("resize",a)})),this._createObserver(e,s,a),this._observeParentElement(),this._getFrameActions(t,a)}}class p extends l{constructor(){super(...arguments),this._cssClasses={frame:"fxs-blade-floated-frame",section:".fxs-blade"}}getFrame(e,t,o,i){return e.get(s.ReactFramePool).getFrame(1,document.querySelector(".fxs-portal-contextpane-right"),o,i,!0)}_getFrameOptions(e){return{reactFrameType:1,contextPaneOptions:{setContextPaneWidth:t=>{if(!e.isDisposed()){const e=this._contentElement.closest(".fxs-blade"),s=$.data(e,o.CompositionInstanceDataName);s.bladeDefinition.contextPaneWidth=t,s.containerWidget.setContextPaneWidth(t)}}}}}_bindToFrame(e,t){return function(e){e.element.removeAttribute("style");const t=e.container.querySelector(`[class*='${r}']`);t.setAttribute(a,e.id);const s=()=>t.classList.forEach((t=>t.startsWith(r)&&e.element.classList.add(t)));s(),new MutationObserver(((e,t)=>{s(),t.disconnect()})).observe(t,{attributes:!0,attributeFilter:["class"]})}(t),this._createObserver(e,t.element),this._observeParentElement(),this._getFrameActions(t)}}class u extends p{getFrame(e,t,o,i){return e.get(s.ReactFramePool).getFrame(1,document.querySelector(".fxs-portal-contextpane-docked"),o,i,!1)}_getFrameOptions(e){return{reactFrameType:1,contextPaneOptions:{setContextPaneWidth:t=>{if(!e.isDisposed()){const e=this._contentElement.closest(".fxs-blade"),s=$.data(e,o.CompositionInstanceDataName);s.bladeDefinition.contextPaneWidth=t,s.containerWidget.setContextPaneWidth(t)}}},dockedContextPane:!0}}}class m extends l{constructor(){super(...arguments),this._cssClasses={frame:"fxs-blade-floated-frame",section:".fxs-blade"}}getFrame(e){return e.get(s.ReactFramePool).getSidebarFrame()}_getFrameOptions(e){return{reactFrameType:3,inSideBar:!0}}_bindToFrame(e,t){return this._createObserver(e,t.element),this._getFrameActions(t)}}class h extends l{constructor(){super(...arguments),this._cssClasses={frame:null,section:".never-never-never"}}getFrame(e,t,o,i){return e.get(s.ReactFramePool).getFrame(4,null,o,i,!0)}_getFrameOptions(){return{reactFrameType:4}}_bindToFrame(e,t){return t.element.classList.add(n),{showIFrame:()=>{},hideIFrame:()=>{}}}}})),
define("MsPortalImpl/ReactViews/ReactFrame.Utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.watchFirstHiddenAndOffline=t.getBrowserTabId=t.getModuleIdAndUrl=void 0;const s=/[^/]*$/;t.getModuleIdAndUrl=function(e,t,o=!1){e=e.toLowerCase();const i=o?t=>t.toLowerCase().startsWith(e):t=>!t.includes("/_generated/")&&s.exec(t)?.[0].toLowerCase()===e,n=MsPortalFx.forEachKey(t.dependencyTree||{},((e,t,s)=>{s.id||MsPortalFx.find(Object.keys(t),(t=>{if(i(t))return s.id=t,s.url=e,!0}))}),{id:"",url:""});return n.id||MsPortalFx.forEachKey(t.paths,((e,s,o)=>{if(!o.id&&i(e))return o.id=e,o.url=t.paths[e][0],!0}),n),n},t.getBrowserTabId=function(){let e=MsPortalImpl.sessionStorage.getItem("browserTabId");return e||(e=FxImpl.createGuid(null,!0),MsPortalImpl.sessionStorage.setItem("browserTabId",e)),e},t.watchFirstHiddenAndOffline=function(e){const t=e.createChildLifetime();let s;const o=()=>{s||(s=Date.now(),t.dispose())},i=()=>"hidden"===document.visibilityState&&o();window.addEventListener("visibilitychange",i),t.registerForDispose((()=>window.removeEventListener("visibilitychange",i))),i();const n=()=>!window.navigator.onLine&&o();return window.addEventListener("online",n),t.registerForDispose((()=>window.removeEventListener("online",n))),n(),()=>s}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.BladeTelemetry",["require","exports","Fx/DependencyInjection","Fx","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/UI/Compositions/UI.Composition","FxInternal/AsyncLoader"],(function(e,t,s,o,i,n,r,a,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0}),t.BladeTelemetry=t.MAX_NUMBER_OF_FIELDS_TO_CATEGORIZE=t.MAX_NUMBER_OF_ARRAY_ITEMS_TO_CATEGORIZE=t.MAX_ARRAY_DEPTH_TO_CATEGORIZE=t.MAX_CATEGORIZATION_DEPTH=t.bladeFullReadyTimeout=void 0;var d=MsPortalFx.Base.Diagnostics.Telemetry,p=d.ActionModifier,u=FxImpl.TelemetryContext,m=FxImpl.Base.Diagnostics.Metric;const h=new MsPortalFx.Base.Diagnostics.Log("MsPortalImpl/UI/Compositions/BladeTelemetry");t.bladeFullReadyTimeout=6e4,t.MAX_CATEGORIZATION_DEPTH=5,t.MAX_ARRAY_DEPTH_TO_CATEGORIZE=5,t.MAX_NUMBER_OF_ARRAY_ITEMS_TO_CATEGORIZE=5,t.MAX_NUMBER_OF_FIELDS_TO_CATEGORIZE=50;const g=window,f=g.fx.getTimestamp,{cancelOnDispose:x}=MsPortalFx.Base.Promises,b=[void 0,"StartboardPart","SideBar","DeepLink","Desktop","Home","GlobalSearch","AllServices","Notification","AvatarMenu","KeyBoardShortcut","FeedbackPane","TopBar","DebugPane"],y={0:"Small",1:"Medium",2:"Large",3:"XLarge",51:"Menu"},v={0:"Default",1:"TemplateBlade",2:"FrameBlade",3:"MenuBlade",4:"AppBlade",5:"ReactView"};let M=c=class{constructor(e){this._diContainer=e,this._markers={},this._perfData={},this._additional={}}initializeBladeTelemetry(e,t,s){const o=this._perfData={includesExtensionLoadTime:!t.bladeDefinition},n=t.masterContainer,r=n&&n.locator,l=r&&r.toFriendlyString(),d=n&&n.instanceId,p=l,u=t.openedByInfo,m=u.openedByContext;if(this._blade=t,n&&n.getCompositionType()===a.CompositionType.Blade){const e=n;e.bladeDefinition&&e.bladeDefinition.menuBlade&&(this._menuBlade=e,this._menuBladeTelemetry=e.diContainer.get(c))}u.openedBy&&(o.openedBy=b[u.openedBy],o.isFavorite=2===u.openedBy&&m.openedBy&&1===m.openedBy,o.openedByPartName=u.openedByPartName),d&&(o.openedByBlade=d),p&&(o.openedByBladeName=p),s&&(o.preloadPartSettings=!0);const h=t.extension,g=t.locator,x=this._additional={extension:h&&h.name||g&&g.getExtensionName(),locator:g&&g.toFriendlyString(),assetType:e};x.extension&&(o.extVersion=this._diContainer.get(i.ManifestCache).getVersion(x.extension));const y=e=>{this._markers[e]=f(),this._markers["Menu"+e]=null},v=t.widget,M=v&&v.timer;return M&&(o.delayTime=M()),performance.mark("BladeFullReady: "+x.locator.toLowerCase()),y("BladeFullReady"),y("BladeSettled"),this.readyStartTime=f(),this.readyStartTimeCommon=Date.now(),this._perfData}traceBladeComplete(e,s,o){const n=this._blade;this._initializeTelemetryDetails(n,e);const a=n.extension;this._perfData.extVersion=a&&this._diContainer.get(i.ManifestCache).getVersion(a.name);const l=this._perfData;l.clickToFullReadyTime=Date.now()-n.openInitiatedTimestamp,!l.rejectedPromises&&s<t.bladeFullReadyTimeout&&(clearTimeout(s),r.temporaryExtensionCount.incrementCount(n.extension.name),o&&(this._perfData.deepLinkContext=n.masterContainer.getDeepLinkContext()),this._bladeFullReadyTelemetry(p.Complete,n,l)),this._refreshTelemetryInsightsOverlay(n)}traceBladeLoadErrored(e,t){const s=!this._markers.BladeFullReady,o=0===t.status;let n;n=s?o?"BladeNetworkErrored":"BladeErrored":o?"BladeLoadNetworkErrored":"BladeLoadErrored";const r=this._blade,a=r?.extension;this._perfData.extVersion=a&&this._diContainer.get(i.ManifestCache).getVersion(a.name),this._markers[n]=this._markers.BladeFullReady||f(),s||this._traceWithState("BladeFullReady",p.Cancel,r)(),t={...this._perfData,...t},this._traceWithState(n,e,r,t)()}beginTraceBladeDisposed(){this._blade&&(MsPortalFx.forEachKey(this._markers,((e,t)=>{t&&this._traceWithState(e,p.Cancel,this._blade)()})),this._closedTime=this._markers.BladeClosed=f())}endTraceBladeDisposed(){this._blade&&this._traceWithState("BladeClosed",p.Complete,this._blade,{TotalTimeBladeOpen:this._closedTime-this.readyStartTime})()}getTelemetryData(){return this._perfData}_categorizeArray(e,s=1){if(s>t.MAX_ARRAY_DEPTH_TO_CATEGORIZE)return"array_TooDeepToFurtherProcess";const o=new Set;for(let i=0;i<t.MAX_NUMBER_OF_ARRAY_ITEMS_TO_CATEGORIZE&&i<e.length;i++){let t=MsPortalFx.getTypeOf(e[i]);"string"===t?t=this._categorizeStrings(e[i]):"object"===t?t=this._categorizeObjectWithErrorBoundary(e[i]):"array"===t&&(s++,t=this._categorizeArray(e[i],s++)),o.add(`"${t}"`)}return 0===o.size?"[]":"["+Array.from(o).join(",")+"]"}_categorizeObject(e,s=0){if(s>t.MAX_CATEGORIZATION_DEPTH)return'"object_TooDeepToFurtherProcess"';let o=1;const i=[];for(const[n,r]of Object.entries(e)){let e=!1,a=!1,l=MsPortalFx.getTypeOf(r);if(o>t.MAX_NUMBER_OF_FIELDS_TO_CATEGORIZE){l="object_TooManyFieldsToFurtherProcess",i.push(`"${n}":"${l}"`);break}"string"===l?l=this._categorizeStrings(r):"object"===l?(a=!0,l=this._categorizeObject(r,s+1)):"array"===l&&(e=!0,l=this._categorizeArray(r,s+1)),o++,e||a?i.push(`"${n}":${l}`):i.push(`"${n}":"${l}"`)}return`{${i.join(",")}}`}_categorizeStrings(e){if(/[?&](?:sv|sp|se|st|sig)=[^&]+/.test(e))return"URLSASToken";if(/(?:https|http|ftp|ftps):\/\//i.test(e))return"URL";const t=/\{?[0-9A-F]{8}-?(?:[0-9A-F]{4}-?){3}[0-9A-F]{12}\}?/i;if(new RegExp(/\/subscriptions\//i.source+t.source,"i").test(e))return"ResourceID";if(t.test(e))return"GUID";if(/<\/?[a-z][\s\S]*>/i.test(e)){return/mailto:/i.test(e)?"URLMailTo":"HTML"}if(/[\w.%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/i.test(e))return"Email";return/javascript:/i.test(e)?"URLJavaScript":"string"}_categorizeObjectWithErrorBoundary(e){try{return this._categorizeObject(e)}catch(e){return h.error("Error categorizing object",e),"object"}}_initializeTelemetryDetails(e,t){const s=t.filter((e=>"rejected"===e.status)),o=this._perfData;o.inputParameters={};for(const[t,s]of Object.entries(e.getInputsOnlyViewModel())){const e=ko.unwrap(s);let i=MsPortalFx.getTypeOf(e);"string"===i?i=this._categorizeStrings(e):"object"===i?i=this._categorizeObjectWithErrorBoundary(e):"array"===i&&(i=this._categorizeArray(e)),o.inputParameters[t]=i}const i=e.bladeDefinition;o.lockedBlade=!!i.locked,o.useDetailContent=e.useDetailContent,o.bladeType=v[(0,a.getBladeType)(i)],o.bladeWidth=2===o.initialDisplayState?"Fullscreen":y[i.width]||"Fullscreen",o.reflowReady=!!i.reflowReady,o.inContextPane=!!(1&e.flags),o.isWeave=!!i.isWeave,o.resource=e.openedByInfo.openedByContext&&e.openedByInfo.openedByContext.deepLink,0===s.length?o.earlyOnInputsSetBlade=e.earlyOnInputsSet:o.rejectedPromises=s.length,o.telemetryName=e.telemetryName||""}_refreshTelemetryInsightsOverlay(e){!o.isFeatureEnabled("telemetryinsights")||1&e.flags||this._diContainer.getAsync(l.get("MsPortalImpl/Services/Services.TelemetryInsights","TelemetryInsights")).then((e=>{e.overlayVisible&&(e.clear(),e.toggleOverlay(this._blade,!1,this._blade.containerWidget.element)),e.forceInitialLoad&&e.toggleOverlay(this._blade,!0,this._blade.containerWidget.element)}))}_traceTelemetry(e,t,s,o,i,n){const r=this._additional;u.usingState((()=>{const a=i.locator&&i.locator.toFriendlyString();d.trace({extension:r.extension,source:"Shell",action:e,actionModifier:t,context:n,data:o,name:a,assetType:r.assetType,journeyId:i.journeyId,serviceTreeId:i.extension&&i.extension.serviceTreeId,duration:s}),m.record({name:e,extension:r.extension,value:s,dimensions:{bladeName:a,actionModifier:t}})}),n)}_traceWithState(e,t,s,o){const i=this._markers;if(!i[e])return MsPortalFx.noop;delete i[e];const n="BladeFullReady"===e&&o?.reactViewInitializeEnd?Math.max(o.reactViewInitializeEnd-this.readyStartTimeCommon,0):f()-this.readyStartTime;let r;if(this._menuBlade&&s.useDetailContent){const i="Menu"+e,a=this._menuBladeTelemetry,l=a._markers||{};if(i in l){delete l[i];const e=f()-a.readyStartTime,c=this._menuBlade.getCreationState();r=r=>{this._menuBlade.await(4).finally((()=>{u.usingState((()=>{const a=this._menuBlade.locator,l=s.locator,c=this._menuBlade.menu,p=c&&c.getResourceType()||this._menuBlade.assetType,u=c&&c.getTelemetryInfo()||{};d.trace({name:a.toFriendlyString(),extension:a.getExtensionName(),source:"Shell",action:i,actionModifier:t,data:$.extend({detailName:l.toFriendlyString(),detailExtension:s.extension&&s.extension.name,detailDuration:n,type:p,resourceId:s.assetId()||s.parent&&s.parent.getCurrentResourceId()},o||{},r&&r(this._menuBlade)||{},u),duration:e,journeyId:s.journeyId}),m.record({name:i,extension:a.getExtensionName(),value:e,dimensions:{bladeName:a.toFriendlyString(),actionModifier:t}})}),c)}))}}}const a=s.getCreationState();return(i,l,c)=>(this._traceTelemetry(e,t,c||n,MsPortalFx.extend2(o,i),s,a),r&&r(l),c||n)}_bladeFullReadyTelemetry(e,t,s){const i=e=>e.locator.toFriendlyString().toLowerCase(),r=e=>"BladeFullReady: "+e,a=this._traceWithState("BladeFullReady",e,t,s),l=i(t),c=r(l),d=c+"-end";performance.mark(d),performance.measure(c,c,d);const u=t.widget.element[0];x(t,Q((0,n.waitForBindings)(u)).timeout(1e4).then(MsPortalFx.noop,MsPortalFx.noop)).finally((()=>{const e=f(),s=c+"-render",n=e=>{const t=e?i(e):l;performance.measure(`${e?"Menu":""}BladeFullRender: ${t}`,e?r(t):c,s)};performance.mark(s),n();const d=e-this.readyStartTime;t.fullReadyTime(a({bladeRenderTime:d},(t=>{n(t);const s=new Event("fxmenubladerendered",{bubbles:!0});return u?.dispatchEvent(s),{menuBladeRenderTime:e-this._menuBladeTelemetry.readyStartTime}}))),g.requestAnimationFrame((()=>{const e=document.createEvent("Event");e.initEvent("fxbladefullrender",!0,!0),u&&u.dispatchEvent(e)}));const m=async e=>{await o.delay(0),this._traceWithState("BladeSettled",p.Complete,this._blade,this._perfData)({bladeRenderTime:d,bladeReadyTime:t.fullReadyTime(),...e&&{pendingExtensionOperationsCount:e.pendingOperationsCount,extensionWaitForSettledTime:e.waitDuration,...e.interruptedByChild&&{interruptedByChild:!0}}}),performance.measure(`BladeSettled: ${l}`,c)},h=t.extension?.waitForIdle&&x(t,t.extension.waitForIdle(t.locator.name,t.instanceId));h?h.then(m):m()}))}};t.BladeTelemetry=M,t.BladeTelemetry=M=c=__decorate([__metadata("fx:diagnostics",[e,"1"]),s.Value("composition"),__metadata("design:paramtypes",[s.Container])],M)})),
define("MsPortalImpl/ReactViews/ReactFrameBinder",["require","exports","Fx/DependencyInjection","Fx/Errors","MsPortalImpl/AzFramework/AzHost","MsPortalImpl/ReactViews/ReactFrame.FramePool","MsPortalImpl/ReactViews/ReactFrame.Utils","MsPortalImpl/Base/Themes","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Services/Services.ExtensionStorageManager","MsPortalImpl/ReactViews/ReactQueryStore","MsPortalImpl/Extension/ExtensionManagerOptions","FxInternal/Utils/LinkSanitizer","FxInternal/Lifetime","MsPortalImpl/Base/Base.Router","MsPortalImpl/UI/Compositions/UI.Composition.BladeTelemetry","MsPortalImpl/Base/Base.ImplUtils","FxInternal","FxInternal/AsyncLoader"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractBladeSequenceNumber=t.loadModelForView=t.loadModel=t.ReactFrameBinder=t.ReactFrameBinderFactory=void 0;var y=FxImpl.Extension,v=MsPortalFx.Base.Diagnostics.Telemetry,M=FxImpl.TelemetryContext;let C=class{constructor(e){this._diContainer=e}createBinder(e){return new P({...e,diContainer:this._diContainer})}};t.ReactFrameBinderFactory=C,t.ReactFrameBinderFactory=C=__decorate([__metadata("fx:diagnostics",[e,"ReactFrameBinderFactory"]),s.Class(),__metadata("design:paramtypes",[s.Container])],C);class P{constructor(e){this._frameReadyDeferred=Promise.withResolvers();const{telemetryContextState:t,moduleName:s,extensionName:o,frameVal:i,diContainer:n,bladeSequenceNumber:a}=e;this._bladeSequenceNumber=a,this._moduleName=s,this._extensionName=o,this._getFrameVal=i,this._linkSanitizer=n.get(u.LinkSanitizer);const l=n.get(c.ExtensionStorageManager).getStorageForExtension(o),d=n.get(p.PostBootCache).get(o);this._contentOptions=Promise.all([l,d]).then((([e,t])=>({viewModuleId:(0,r.getModuleIdAndUrl)(s,t.requireConfig).id,environment:t.extensionEnvironment,features:t.features,extensionStorage:e,mergedConfig:t.requireConfig}))),this._telemetryContextState=t,this._diContainer=n;const m=this._hostDeferred=Promise.withResolvers();this.azHost=m.promise}awaitReady(){return this._frameReadyDeferred.promise}bindBlade(e){this._bind(e)}bindAmbient(e){this._bind({...e,frameOptions:{reactFrameType:5}})}_bind({lifetime:t,frameOptions:s,parametersPromise:r,menuRenderer:c,azHostOptions:p,initializedDeferred:u,bindToFrame:y,onLoadReactView:C,entryPointName:P,entryPointArgs:w}){u=u||Promise.withResolvers(),Promise.all([this._contentOptions,this._getFrameVal.frame]).then((()=>this._frameReadyDeferred.resolve()),(e=>this._frameReadyDeferred.reject(e)));const{viewModel:S,container:_,contentRevealedDeferred:F}=p||{},T=new m.TriggerableLifetimeManager,k=this._diContainer.get(a.ThemeManager);let D;const E=u.promise.then((()=>{MsPortalFx.Base.Diagnostics.Telemetry.completeTrace(D)}));u.promise.catch((()=>{MsPortalFx.Base.Diagnostics.Telemetry.cancelTrace(D)}));const B=Promise.withResolvers(),A=Promise.withResolvers(),N=this._getFrameVal.frame.then((async e=>{M.usingState((()=>{v.trace({source:"Parts.ReactFrame",action:"FramePartSuccess",data:{frameId:e.id}})}),this._telemetryContextState),T.registerForDispose((()=>this._getFrameVal.dispose()));const o=()=>{if(t.isDisposed())return this._getFrameVal.completed(),T.dispose(),!0};if(o())return null;const{isMenuBladeContent:i,contextPaneOptions:r,inSideBar:a,dockedContextPane:l}=s,c=y?.(T,e)||{showIFrame:()=>{},hideIFrame:()=>{}},d=await B.promise;if(o())return null;const p=this._diContainer.get(n.ReactFramePool).loadReactView({extensionName:L,frame:e,isMenuBladeContent:i,inContextPane:!!r,inDockedContextPane:l,inSideBar:a,viewName:this._moduleName,diContainer:this._diContainer,parameters:d,bladeSequenceNumber:this._bladeSequenceNumber,entryPointName:P,entryPointArgs:w});if(C?.(p,e),D=(await p.viewLoadingCompleted).traceKey,o())return null;const{viewModuleId:u,environment:m,features:h,extensionStorage:g,mergedConfig:f}=await this._contentOptions;if(o())return null;if(!u)return _.fail(`Could not find view module for: ${this._moduleName}.`),S.hookOnInputsSet(Promise.resolve()),void F.resolve();const x=e.model||I(this._diContainer.get(FxImpl.Rpc.Client),f,L,this._moduleName,d);T.registerForDispose((()=>{x.unloadModel()})),e.port.postMessage({signature:"Az",kind:3,data:{isMenuBladeContent:i,environment:!e.featured&&m,features:!e.featured&&h,serializedStorage:!e.featured&&g.serialize(),name:this._moduleName,type:"init"}},[x.port]),e.featured=!0;const b={postMessage:(t,s)=>{e.port.postMessage({signature:"Az",kind:t,data:s})},setOnMessage:t=>e.setMessageListener(t,this._bladeSequenceNumber+""),reactViewOptions:{hide:c.hideIFrame,show:c.showIFrame,dispose:()=>{T.dispose()},onUnloaded:()=>{e.clearMessageListener()}},frameWindow:e.element.contentWindow,frameId:e.id,getFirstHiddenOrOfflineTime:()=>e.getFirstHiddenOrOfflineTime()};return A.resolve(e.provisioningContextPromise),b})).catch((e=>{u.reject(new o.FxError({message:"ReactView frame failed to load.",innerErrors:e,data:{extensionName:this._extensionName,reactView:this._moduleName}}))}));E.finally((()=>{this._getFrameVal.completed()}));const R=this._diContainer,L=this._extensionName,O=R.get(l.ExtensionTokensManager).createAuthTokenCache(L).getToken;(r??Promise.resolve()).then((o=>{const n=o&&o.parameters||{},{reactFrameType:r,contextPaneOptions:a}=s,p=2!==r&&5!==r&&async function(e,t,s){return e?Promise.resolve(e):Promise.all([t,b.get("MsPortalImpl/UI/Compositions/UI.Composition.Finder","Finder")]).then((([e,t])=>{if(e){const o=s.get(f.CompositionProvenance)?.instanceId,i=o&&s.get(t).find(o),n=e;return n.marketplaceItem.launchingContext={...n.marketplaceItem.launchingContext,source:[...i?[i.locator.name,i.toString()]:[],...o?[o]:[]]},n}return Promise.resolve(void 0)}))}(n._provisioningContext,A.promise,R);delete n._provisioningContext,B.resolve(n),MsPortalFx.Base.Promises.cancelOnDispose(t,N).then((async s=>{const{extensionStorage:o}=await MsPortalFx.Base.Promises.cancelOnDispose(t,this._contentOptions),m=R.get(d.ReactQueryStoreManager).getViewStore(L,this._bladeSequenceNumber,t),b={frameId:s&&s.frameId,lifetime:t,parameters:JSON.stringify(n),telemetryContextState:this._telemetryContextState,initializedDeferred:u,viewModel:S,container:_,extensionName:L,getToken:O,diContainer:R,frameWindow:s&&s.frameWindow,contentRevealedDeferred:F,features:R.get(FxImpl.Features).value,theme:k,provisioningContext:p,queryStore:m,reactFrameType:r,defaultTokenPromise:R.get(l.ExtensionTokensManager).createAuthTokenCache(L).getToken(),extensionStorage:o,getSafeLink:(e,t)=>this._linkSanitizer.getSafeLink(e,t),inContextPane:!!a,setContextPaneWidth:a?.setContextPaneWidth,router:R.get(h.Router),bladeTelemetryData:2!==r&&5!==r&&R.get(g.BladeTelemetry).getTelemetryData(),menuRenderer:c,onBladeApiCalled:5===r?t=>{const s=`TypeScript API ${t?`'${t}' `:""}enabled only for ReactViews was called from non-ReactView module '${this._moduleName}' from extension '${L}'.`;throw(0,f.logToExtension)(e,L,2,s,{contextData:{stack:(0,x.getCurrentCallStack)(),moduleName:this._moduleName,...t&&{apiName:t}}}),new Error(s)}:null},y=(0,i.create)(b);s&&y.initialize(s),this._hostDeferred.resolve(y)}))}))}}function w(e,t,s,o){const i=new MessageChannel,n=e.acquireWindow(t,-1,i.port1),r=n.value;return y.getReactModelEndPoint.invoke(e,t,{modelName:s,portId:r,parameters:o}),{unloadModel:o=>{y.disposeReactModelEndPoint.invoke(e,t,{modelName:s,portId:r,unrequire:o}),n.dispose()},port:i.port2}}function I(e,t,s,o,i){const n=`${o.substring(0,o.length-10)}.ReactModel`;return w(e,s,(0,r.getModuleIdAndUrl)(n,t).id,i)}t.ReactFrameBinder=P,t.loadModel=w,t.loadModelForView=I,t.extractBladeSequenceNumber=function(e){const t="string"==typeof e?e:e&&FxImpl.TelemetryContext.usingState((()=>MsPortalFx.Base.Diagnostics.Telemetry.Context.getBladeContext()?.instanceId),e),s=t?.split("_").slice(-2)[0];return s&&parseInt(s)}})),
define("MsPortalImpl/Parts/Parts.ReactFrame",["require","exports","MsPortalImpl/Parts/Parts","MsPortalImpl/Parts/Parts.Frame.Common","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Parts/Parts.ReactFrameProvider","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/ReactViews/ReactFrameBinder"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Part=void 0;class l extends s.PartImpl{constructor(e,t,s,r,l){super(e,t,s,r),this.loadingNetworkThrottlingTelemetry=ko.observable(!1),this.togglingPerfTools=ko.observable(!1),this._contentRevealed=Promise.withResolvers(),this._initializationComplete=Promise.withResolvers();const{extensionName:c,viewName:d}=l,p=this._options.getTelemetryContextState(),u=(0,a.extractBladeSequenceNumber)(p);this._frameProvider=(0,n.createFrameProvider)(t,l);const m=this._getFrameVal=this._frameProvider.getFrame(r,e,c,u);this._frameBinder=new a.ReactFrameBinderFactory(r).createBinder({telemetryContextState:p,extensionName:c,moduleName:d,frameVal:m,bladeSequenceNumber:u}),m.frame.then((()=>{(0,o.logFrameAddedTelemetry)({isPart:this._onDashboard,journeyManager:this._diContainer.get(i.JourneyManager),locator:this._options.locator,telemetryContextState:this._options.getTelemetryContextState&&this._options.getTelemetryContextState()})}))}awaitReady(){return this._frameBinder.awaitReady()}awaitContentRevealed(){return this._contentRevealed.promise}awaitInitializationComplete(){return this._initializationComplete.promise}async toggleDevTools(){const{initializeReactDevTools:e,toggleReactDevTools:t}=await MsPortalFx.require("MsPortalImpl/Parts/ReactDevTools/ReactDevTools");await e();const{element:s}=await this._getFrameVal.frame;t(s),(await this._frameBinder.azHost).toggleDevTools()}async togglePerfTools(){try{this.togglingPerfTools(!0),await(await this._frameBinder.azHost).togglePerfTools()}finally{this.togglingPerfTools(!1)}}async executeCopilotHandler(e,t,s){return(await this._frameBinder.azHost).executeCopilotHandler(e,t,s)}toggleTelemetryInsights(e){this._frameBinder.azHost.then((t=>t.toggleTelemetryInsights(e)))}showTours(e,t,s){this._frameBinder.azHost.then((o=>o.showTours({tours:e,storeData:t,activatedToursCount:s})))}async getFrameClientOptimizations(){const{frameClientOptimizations:e}=await this._getFrameVal.frame;return e}_bindContent(e){MsPortalFx.disposeDisposable(this._childLifetime);const t=this._childLifetime=this._lifetime.createChildLifetime(),s=Promise.withResolvers(),o=s.promise.then((({timestamp:e})=>{this._viewModel.internal.reactViewInitializeEnd(e)})).finally((()=>{this._initializationComplete.resolve()})),i=this._viewModel.content().hookOnInputsSet(o);this._frameProvider.setContentElement(e);const n=e=>{this._frameBinder.bindBlade({azHostOptions:{container:this._viewModel.container,contentRevealedDeferred:this._contentRevealed,viewModel:this._viewModel.content()},bindToFrame:this._frameProvider.bindToFrame.bind(this._frameProvider),frameOptions:a,initializedDeferred:s,onLoadReactView:(e,t)=>{e.viewLoadingStarted.then((()=>{void 0!==t.networkThrottlingTelemetryPromise&&(this._diContainer.get(r.ShowDebugTools).invoke(!0),this.loadingNetworkThrottlingTelemetry(!0),t.networkThrottlingTelemetryPromise.then((()=>{e.viewLoadingCompleted.then((()=>this.togglePerfTools()))})).finally((()=>{this.loadingNetworkThrottlingTelemetry(!1)})))}))},parametersPromise:i,menuRenderer:e,lifetime:t})},a=this._frameProvider.getOptions(t);4===a.reactFrameType?MsPortalFx.require("MsPortalImpl/ReactViews/MenuView").then((({createRendererAndBind:t})=>{const{renderer:o,initializedPromise:i}=t(this._viewModel.container,this._viewModel.content(),(t=>super._bindContent(e,t,null)));i.then((()=>s.resolve({timestamp:Date.now()}))),n(o)})):n()}}t.Part=l})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Base",["require","exports","Fx","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Settings.Schema"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContainerModel=t.Instance=t.compositionRequire=t.createIdentifier=void 0;var a=FxImpl.TriggerableLifetimeManager,l=MsPortalFx.Base.Diagnostics,c=i.CompositionType;const d=l.createLog(e),p=i.getIdMatchFunc;function u(e,t,o){o=o||(0,s.getUniqueId)();let i=c[e];return i+=t?"-"+t.name:"",i+="-"+o,i}t.createIdentifier=u,t.compositionRequire=function(e,t,s,o){return MsPortalFx.tryImmediateResolve(MsPortalFx.require(t,o),(t=>{if(!e||!e.isDisposed())try{return s(t)}catch(e){return Promise.reject(e)}}))};t.Instance=class extends a{constructor(e,t,s,o,i,r,a){super(),this._childObjects=ko.observableArray(),this._disposeCallbacks=$.Callbacks("memory once"),this._composedDeferred=Promise.withResolvers(),this.isComposed=!1,this.diContainer=t,this._sharedSettings=t.get(n.SettingsManager),this.locator=s,this.id=r||u(this.getCompositionType(),s,a&&a.toString()),this.widgetState=ko.observable(i||{}),this._addChildrenInternal(o);const l=this._composedDeferred.resolve;this._composedDeferred.resolve=e=>{l.apply(this._composedDeferred,[e]),this.isComposed=!0},this._toStringPrefix=`{ Name: ${e||"<NOT SPECIFIED>"}, Type: `}get children(){return this._childObjects()}subscribeChildren(e){return this._childObjects.subscribe(this,e)}get templateKey(){return""+(this.locator||this.id)}getPerfData(){return{}}getCompositionType(){throw new Error("The getCompositionType method is not implemented.")}getCreationState(){return this._creationState}toString(){let e=this._toStringPrefix;const t=this._toStringPostfix||(this._toStringPostfix=`, Id: ${this.id} }`);return e+=this.locator||"<null>",e+=t,e}compose(e,...t){if(this._composeInvoked)throw new MsPortalFx.Errors.Error(`Composition '${this.id}' is already composed.`);this._composeInvoked=!0,this._compose(e,this._composedDeferred,...t)}_compose(e,t,...s){throw new Error("Not implemented.")}resetLayout(){const e=this.children;e&&e.forEach((e=>{e.resetLayout()}))}dispose(e){this.isDisposed()||(super.dispose(),this._disposeCallbacks.fire(),e||this._deleteSetting(),this.children.slice(0).forEach((t=>{t.dispose(e)})))}_deleteSetting(){if(void 0!==this._store)this._sharedSettings.deleteSettings({store:this._store,keys:[this.id]});else if(this.parent){const e=this.parent.children,t=MsPortalFx.find(e,p(this.id));t&&MsPortalFx.remove(e,t),this.parent.save()}}save(e){if(void 0!==this._store){const t=this._sharedSettings;if(t){const s=this.toJSON();t.setSetting(this._store,this.id,JSON.parse(JSON.stringify(s))),1===e&&t.flushSettings()}}else this.parent&&this.parent.save(e)}await(e){switch(e){case 0:return Promise.resolve(!1);case 3:return Promise.resolve(null);case 7:return this._composedDeferred.promise}throw new MsPortalFx.Errors.Error("Await reason not supported")}onDispose(e){this._disposeCallbacks.add(e)}offDispose(e){this._disposeCallbacks.remove(e)}addChild(e,t,s=!0){e&&this.addChildren([e],t,s)}addChildren(e,t,s=!0){this._addChildrenInternal(e,t),s&&this.save()}_addChildrenInternal(e,t=this.children.length){if(e&&e.length>0){const s=this._childObjects();e.forEach((e=>{s.splice(t,0,e),e.parent=this,t++,this.addChildWidget(e.widget)})),this._childObjects(s)}}removeChildren(e){for(let t=this.children.length-1;t>=0;t--)this.removeChildAt(t,e,!1);this.save()}removeChildAt(e,t,s=!0){if(e>=0){const o=this._childObjects.splice(e,1)[0];this.removeChildWidget(o.id,t),t||o.dispose(),s&&this.save()}}replaceChild(e,t){const s=this._childObjects;if(e&&t&&s){const o=s.indexOf(e);o>=0&&(s.splice(o,1,t),t.parent=this,this.save())}}removeChild(e,t,s=!0){if(e&&this._childObjects){const o=this._childObjects.indexOf(e);this.removeChildAt(o,t,s)}}addChildWidget(e){this.widget&&e&&this.widget.addChild(e)}removeChildWidget(e,t){this.widget&&this.widget.removeChild(e,t)}getChildById(e){return this._childObjects?MsPortalFx.find(this._childObjects(),p(e)):null}toJSON(e){const t={},s=this.children,o=e?s.filter(e):s;return this.id!==r.startBoardSettingsKey&&o.forEach((e=>{t[e.id]=e.toJSON()})),{id:this.id,locator:this.locator,widgetState:this.widgetState(),errorMessage:this.unrecoverableErrorMessage,children:o.map((e=>e.id)),childSettings:t}}loadFromJson(e){this.unrecoverableErrorMessage=e.errorMessage}getBindableContainer(){return this._bindableContainer||(this._bindableContainer=function(e,t){let s,o=e;for(;o;)(o.hasOwnProperty(t)||"function"==typeof o[t])&&(s=o),o=o.parent;s||d.error(`Could not locate container with property or function '${t}' for composition '${e}'.`);return s}(this,"getViewModel")),this._bindableContainer}getDiagnosticsData(){return $.extend(this.toJSON(),{id:this.id,locator:this.locator&&this.locator.toString(),errorMessage:this.unrecoverableErrorMessage,children:(this.children||[]).map((e=>e.getDiagnosticsData()))})}definitionExists(e){const t=this.diContainer.get(o.DefinitionFinder),s=this.locator;return t.tryLocate(s,{})?0:t.tryLocate(s.getExtensionLocator(),{})&&e?1:2}discardWidgetStateOfUnusedChildren(){if(this.widget){const e=this.widget.discardStateOfUnusedChildren();e&&e.stateDiscarded&&d.warning("Unused widget state was discarded for composition '{0}'. \n{1} \nCurrent Children: {2}\nCurrent Widget State: {3}".format(this,e.message,JSON.stringify((this.children||[]).map((e=>""+e))),JSON.stringify(this.widgetState())))}}_markAsComposed(){this._composedDeferred.resolve()}},t.createContainerModel=function(e){return FxImpl.isSerializedObject(e)?FxImpl.fromSerializableObject(e):{}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer",["require","exports","FxInternal/Composition/ViewModel","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/ShellPart","Fx/Experimentation","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/Compositions/UI.Composition"],(function(e,t,s,o,i,n,r,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSelection=t.composeCommands=t.composePartCommands=t.composeShellCommands=void 0;var d=MsPortalFx.Base.Diagnostics,p=c.CompositionType;const u=d.createLog(e);t.composeShellCommands=function(e,t,s,o,i){if(function(e,t,s){e.filter((e=>t.getCompositionType()===p.StartboardPart&&s?e instanceof l.ShellCommand&&!(e instanceof l.CustomizeTileData):e instanceof l.ShellCommand)).forEach((t=>{MsPortalFx.remove(e,t),t.dispose()}))}(s,t,o),o){const o=function(e,t,s){const o=[];if(t.getCompositionType()===p.StartboardPart)o.push(new l.GoToAssetBlade(e,s,t)),o.push(new l.EnterOrganizeMode(e,s)),o.push(...l.CreatePartSizeCommandCollection(e,s)),o.push(new l.ReloadPart(e,s,t)),o.push(new l.ClonePart(e,s,t)),o.push(new l.UnpinFromStartboard(e,s),new l.ExitOrganizeMode(e,s));else{const i=t.instanceDefinition,n=i&&i.reference;n&&"HubsExtension"===n.extension&&"MonitorChartPart"===n.partTypeName||o.push(new l.PinToStartboard(e,s,t))}return o}(e,t,i);s.push(...o)}},t.composePartCommands=async function(t,r,a){const l=a.getViewModel(),c=(await a.diContainer.get(n.Experimentation).shellAssignments.whenAvailable()).getBooleanValue("resourcetilecommands");if(s.isV2(l.content())||c&&(0,i.isShellPart)(a.locator))try{const e=await(l.content().supplyCommands?.(r));if(e?.length){FxImpl.shellInterface(l.container).partCommands(e);const s=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.CommandBar"),o=a.diContainer,i=e.map((e=>s.createItem(r,e,a.locator,o,{executeLifetime:a})));t.unshift(...i)}}catch(t){const s=`supplyCommands failed.\r\n ${MsPortalFx.getLogFriendlyMessage(t)}`;(0,o.logToExtension)(e,a.extension.name,2,s)}},t.composeCommands=function(e,t){const s=t.diContainer,o=a.getCommandGroupForDefinitionItem(s.get(r.DefinitionCache),t.extension.name,t.partDefinition),i=[],n={viewModelName:t+"-[ContainerModel]",viewModel:t.containerModel};return o.then((o=>{o&&(o.commands.forEach((e=>{(function(e,t){const s=t.parent&&t.getPartsContainer();if(!s)return!0;if(e.details&&1&s.flags)return u.error(`Part '${t}' cannot have the open blade command '${e.name||e.text}', because it is inside the context blade.`),!1;return!0})(e,t)&&i.push(new a.ExtensionCommandMenuItemImpl(t,t.extension,t,e,t.partDefinition,s,n))})),e.unshift(...i))}))},t.createSelection=function(e,t){let s;return s=e._msPortalFxCreateSelectionAsync?e._msPortalFxCreateSelectionAsync(t):e.createSelection(t),Promise.resolve(s)}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Services/Services.Settings"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartSettingsManager=t.buildIdentitySettingKey=t.partIdentityStatePrefix=void 0;var a=MsPortalFx.Base.Diagnostics,l=o.CompositionType,c=i.PropertyBindings;const d=a.createLog(e),p=Object.keys(MsPortalFx.trace.partsettings||{}),u=p.length>0;function m(e,s,i){let n=`${t.partIdentityStatePrefix}${e.toString()}`;if(i&&(n+="-"+i),s){const e=s.hasOwnProperty(o.PartContainerModelIdProperty)&&[o.PartContainerModelIdProperty];n+="-"+MsPortalFx.toSortedString(ko.toJS(s),e)}return n}function h(e){let t;try{t=JSON.parse(JSON.stringify(e))}catch(s){t=e}return t}t.partIdentityStatePrefix="[PartIdentityState]-",t.buildIdentitySettingKey=m;let g=class{constructor(e){this._sharedSettings=e,this._trace=!1}configure(e){this._options=e,this._settingsStore=e.part.getCompositionType()===l.StartboardPart?11:2}configureInstanceProperties(e){this._options.instanceProperties=e}initialize(){this.dispose(),this._registerPartIdentityStateChangeHandler(),this._registerPartSharedKeyChangeHandler(),this._registerPartInstanceChangedHandler(),u&&(this._trace=p.some((e=>this._options.partViewModelId.toLowerCase().includes(e))))}saveIdentityPartSettings(e,t){const s=this._options,{part:o}=s;let i=this.getKeyForIdentitySettings(e);if(o.getCompositionType()===l.StartboardPart&&(i=m(o.locator,e)),i){if(this._identityState){const e=FxImpl.toSerializableObject(this._identityState.targetModel);this._traceOperationWithSettings("Save identity part settings.",e,i),this._sharedSettings.setSetting(t?11:this._settingsStore,i,e)}this._options.part.notifySettingChanged()}}clearIdentityPartSettings(){const e=this._options;if(e){const{part:t}=e,{containerModel:s}=t;let o=[this.getKeyForIdentitySettings(s)];t.getCompositionType()===l.StartboardPart&&o.push(m(t.locator,s)),o=o.filter((e=>!!e)),o.length>0&&this._sharedSettings.deleteSettings({store:this._settingsStore,keys:o})}}getPartSettingsAsync(){if(this._options.part.getCompositionType()===l.StartboardPart)return this.getStartboardPartIdentitySettings();const e=this.getIdentityPartSettingsAsync(),t=this.getSharedPartSettingsAsync();return Promise.all([e,t]).then((([e,t])=>$.extend(!0,{},e,t)))}registerInstanceStateProperty(e,t,s=!0){const{part:o}=this._options,i=this._getOrCreateInstanceStatePropertyBindings(),n=i.targetModel,r=o.getSettingsModel();this._registerViewModelPropertyChangeHandler(t,r,n,i,(()=>{o.save()}),e),s&&o.save()}savePart(){const e=this._options;e&&e.part.save()}dispose(){const e=this._partInstanceState;e&&(e.unbind(),this._partInstanceState=null);const t=this._identityState;t&&(t.unbind(),this._identityState=null);const s=this._sharedKey;s&&(s.unbind(),this._sharedKey=null)}getKeyForIdentitySettings(e){let t=null;const s=this._options,{part:o,partStateDefinition:i,identityInputs:n}=s,r=o.getInputPropertyBindings(),a=i&&i.inputIdentityProperties;if(o.allInputsSet()&&a&&a.length>0){let s="";n&&n.length>0&&(s=MsPortalFx.toSortedString(ko.toJS(r.targetModel),n)),t=m(o.locator,e,s)}return t}_registerPartIdentityStateChangeHandler(){const e=this._options,{part:t,partStateDefinition:s}=e,o=s&&s.inputIdentityProperties;o&&o.length>0&&(this._identityState=new c(t.toString()+"-[PartIdentitySettings]",{}),this._registerViewModelChangeHandler(o,this._identityState,(e=>{e.some((e=>{const t=h(e.propertyValue),s=h(e.propertyOldValue);return!MsPortalFx.deepEquals(t,s)}))&&this.saveIdentityPartSettings(t.containerModel)})))}_registerPartSharedKeyChangeHandler(){const e=this._options,{part:t,partStateDefinition:s}=e,o=s&&s.sharedProperties;if(o&&o.length>0){const e=o.map((e=>e.property)),s={};this._sharedKey=new c(t.toString()+"-[PartSharedSettings]",s),this._registerViewModelChangeHandler(e,this._sharedKey,(()=>{const e={};o.forEach((t=>{const o=i.getModelValue(s,t.property).value;e[t.key]=FxImpl.toSerializableObject(o)}));const t={store:5,settings:e};this._traceOperationWithSettings("Save shared part settings.",e),this._sharedSettings.setSettings(t)}))}}_registerPartInstanceChangedHandler(){const e=this._options,t=e.instanceProperties;if(t&&t.length>0){const s=this._getOrCreateInstanceStatePropertyBindings();this._registerViewModelChangeHandler(t,s,(t=>{e.part.save(),(e=>e.some((e=>"content.pollingOptions"===e.propertyName)))(t)&&e.part.notifySettingChanged()}))}}_registerViewModelChangeHandler(e,t,s){const o=t.targetModel,i=this._options.part.getSettingsModel();e.forEach((e=>{this._registerViewModelPropertyChangeHandler(e,i,o,t,s)}))}_registerViewModelPropertyChangeHandler(t,s,o,r,a,l){i.getModelValue(o,t).exists||i.setModelValue(o,t,ko.toJS(i.getModelValue(s,t).value));const c=r.addProperty(t).bind(this._options.partViewModelId,s,!1,a,(t=>{(0,n.logToExtension)(e,this._options.part.locator.getExtensionName(),2,"[PartState] Failed to bind changes from viewmodel to part state. Error: "+t)}));l&&l.registerForDispose((()=>{r.removeProperty(c)}))}getIdentityPartSettingsAsync(){const e=this._options,{partStateDefinition:t}=e,{containerModel:s}=e.part,o=t&&t.inputIdentityProperties;if(!(o&&o.length>0))return Promise.resolve(null);const i=this.getKeyForIdentitySettings(s),n={store:this._settingsStore,keys:[i]};return this._getPartSettingsAsync("Get identity part settings.",n,void 0).then((e=>{if(i===this.getKeyForIdentitySettings(s)){const t=this._identityState;return t&&$.extend(!0,t.targetModel,e),e}}))}getStartboardPartIdentitySettings(){const e=this._options,{part:t,partStateDefinition:s}=e,o=s&&s.inputIdentityProperties;if(!(o&&o.length>0))return Promise.resolve(null);let i=2&t.flags?[m(t.previousLocator,t.containerModel)]:[];return i=i.concat([this.getKeyForIdentitySettings(t.containerModel),m(t.locator,t.containerModel)]),this._getPartSettingsAsync("Get identity part settings.",{store:this._settingsStore,keys:i},void 0)}getSharedPartSettingsAsync(){const e=this._options,{partStateDefinition:t}=e,s=t&&t.sharedProperties;if(!(s&&s.length>0))return Promise.resolve(null);const o=[],i={};s.forEach((e=>{o.push(e.key),i[e.key]=e.property}));const n={store:5,keys:o};return this._getPartSettingsAsync("Get shared part settings.",n,i)}_traceOperationWithSettings(e,t,s){if(this._trace){if(s){const e={};e[s]=t,t=e}d.verbose("[PartSettingsManager] {0} Part: {1}.\nSettings: {2}".format(e,this._options.part.toString(),ko.toJSON(t,null,2)))}}_traceOperationWithKeys(e,t){this._trace&&d.verbose("[PartSettingsManager] {0} Part: {1}.\nKeys: {2}".format(e,this._options.part.toString(),ko.toJSON(t,null,2)))}_getPartSettingsAsync(e,t,s){this._traceOperationWithKeys("BEGIN - "+e,t.keys);const o=[this._sharedSettings.querySettings(t)];return Promise.all(o).then((o=>{const n={},r=o[0]||{};return t.keys.forEach((e=>{const t=r[e],o=FxImpl.isSerializedObject(t)?FxImpl.fromSerializableObject(t):t;s?void 0!==r[e]&&s[e]&&i.setModelValue(n,s[e],o):$.extend(!0,n,o)})),this._traceOperationWithSettings("END - "+e,n),n}))}_getOrCreateInstanceStatePropertyBindings(){if(!this._partInstanceState){const e=this._options.part;this._partInstanceState=new c(e.toString()+"-[PartInstanceState]",e.partState)}return this._partInstanceState}};t.PartSettingsManager=g,t.PartSettingsManager=g=__decorate([__metadata("fx:diagnostics",[e,"PartSettingsManager"]),s.Class("composition"),__metadata("design:paramtypes",[r.SettingsManager])],g)})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Part",["require","exports","Fx","Fx/DependencyInjection","FxInternal/Composition/ViewModel","FxInternal/AsyncLoader","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Events","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.PrintHandler","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Parts/Parts","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Base/Base.ElementWidgetMap","MsPortalImpl/Extension/ShellPart","FxInternal/Composition/Part","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Parts/Parts.Error","MsPortalImpl/Parts/Parts.ReactFrame"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M,C,P,w,I,S,_,F,T,k,D,E,B,A,N,R,L,O,z,H,U,W){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createOverridesOrContainerModelSourceReference=t.inferredReferenceType=t.setDynamicPartBinderModule=t.setBladeOpenerModule=t.create=t.getSerializableContainerModel=t.prepareContainerModel=t.Instance=t.createCompositionFromJSON=t.OnInputsSetPromiseType=t.fxpartinputchanged=t.EmptyViewModel=t.fxpartsettingchanged=void 0;var V=MsPortalFx.Errors.Error,j=g.Locator,q=FxImpl.TelemetryContext,G=q.ContextType,K=FxImpl.shellInterface,J=MsPortalFx.Base.Diagnostics,X=J.Telemetry.ActionModifier,Z=J.Telemetry,Y=MsPortalFx.Extension.SetRequirement,ee=MsPortalFx.Parts,te=ee.PartKind,se=ee.PartSize,oe=_.CompositionType,ie=k.CompositionBinder,ne=R.ReferenceScope,re=R.PropertyBindings,ae=F.compositionRequire;const{cancelOnDispose:le}=MsPortalFx.Base.Promises,{CanceledError:ce,DisposedCanceledError:de,Error:pe}=MsPortalFx.Errors,ue=window,me=l.Asset,he=MsPortalFx.isNullOrUndefined,ge=J.createLog(e),fe="fxs-part",xe=(e,t,s)=>{ge.error(e+" "+"Part: '{0}'. Details: '{1}'.".format(t,JSON.stringify(s)))},be=T.PartContainerSelectable_ViewModelPath,ye=[be+".isSelected",be+".isCommandSelected"],ve=Z,Me="Shell",Ce=_.EditScopeIdPropertyName,Pe=ie.setupPropertyBindings,we=j.forExtension,Ie=R.getModelValue,Se=ie.mapInputBindingDefinitions,_e=ie.createAllInputsSetWatcherConfigExtended,Fe=R.mapSourceModelToTargetModel,Te={isActivated:!0,isSelected:!0,itemsWithChildEdits:!0,selectedValue:!0,activatedItems:!0,selectedItems:!0},ke="./UI.Composition.DynamicPartBinder",De="./UI.Composition.BladeOpener",Ee={},Be=30;function Ae(e){return e&&e.toFriendlyString()}let Ne=0;var Re;function Le(e,t,s,o){try{return s()}catch(s){const i="Error deserializing composition.";let n,r;try{n=JSON.stringify(t)}catch(e){n="<Invalid> {0}".format(e.toString())}try{r=j.fromJSON(e,t.locator)}catch(e){r=j.forExtension(i+"-"+e)}const a="{0}\nJSON: {1}\nException Message: {2}\nException StackTrace: {3}".format(i,n,s.message||"<N/A>",s.stack||s.toString());return ge.error(a),o(r,a)}}t.fxpartsettingchanged="fxpartsettingchanged",t.EmptyViewModel=(0,U.composePartViewModel)(MsPortalFx.noop),t.fxpartinputchanged="fxpartinputchanged",t.OnInputsSetPromiseType={0:"unknown",1:"Q",2:"jQuery"},function(e){e[e.OldInputsNotHandled=1]="OldInputsNotHandled",e[e.UnrecoverableError=2]="UnrecoverableError",e[e.CustomPartWithMissingTemplate=3]="CustomPartWithMissingTemplate",e[e.PartDefinitionNotFound=4]="PartDefinitionNotFound",e[e.IncorrectPartType=5]="IncorrectPartType",e[e.ErrorLocatingPartDefinition=6]="ErrorLocatingPartDefinition",e[e.ErrorAcquiringViewModel=7]="ErrorAcquiringViewModel",e[e.ViewModelMissing=8]="ViewModelMissing",e[e.ErrorLoadingControl=9]="ErrorLoadingControl",e[e.ErrorCreatingWidget=10]="ErrorCreatingWidget",e[e.TransitionedToErrorState=11]="TransitionedToErrorState"}(Re||(Re={})),t.createCompositionFromJSON=Le;class Oe extends F.Instance{constructor(e,s,o,i,n,r,l,c){super(r||"Part",e,s,[],o,i,c),this._pinnedBladeDeeplink=l,this.bindings=[],this.editScopeId=ko.observable(),this.invocationThrottleDuration=25,this.allInputsSet=ko.observable(!1),this.calledOnInputsSet=ko.observable(!1),this.failedOnInputsSet=ko.observable(!1),this.assetId=ko.observable(),this.triggeringLockedBladeSpinner=ko.observable(!1),this.contentRevealed=!1,this.fullReadyTime=ko.observable(),this._earlyVmDeferred=Promise.withResolvers(),this._viewStateProperties=[],this._partDefinitionDeferred=Promise.withResolvers(),this._registrationDeferred=Promise.withResolvers(),this._disabled=!1,this._restoredFromJson=!1,this._perfData={instanceExtensionLoad:0,referenceExtensionLoad:0,adapterViewModelLoad:0,partViewModelLoad:0,extenderViewModelLoad:0,checkPermissions:0,prepareViewModel:0,finalizePartCompose:0,allInputBindingsBoundPreprocess:0,allInputBindingsBound:0,srcExtension:"",contentRevealedCalled:!1,onInputsSetPromiseState:"",onInputsSetPromiseType:"",resourceId:void 0},this._showShellCommands=!0,this._allInputPropertyBindingsBound=Promise.withResolvers(),this._frameInitialized=Promise.withResolvers(),this._frameRevealed=Promise.withResolvers(),this._frameBlockingUi=ko.observable(!1),this._contentInitializing=ko.observable(!0),this._getPartViewModelCalledDeferred=Promise.withResolvers(),e.get(B.CompositionGraph).addPart(this),e.set(a.CompositionProvenance,new a.CompositionProvenance(s,this.id)),this._viewModelManager=e.get(d.ViewModelManager),this._finder=e.get(g.DefinitionFinder),this._setupPromises();const p=c||Ne++;let u=0;(this._updateRebindSequenceNumber=()=>{this.instanceId=`Part_${MsPortalFx.sessionId}_${p}_${u++}`})(),this._vm=n||t.EmptyViewModel,this.partState={},this.containerModel=null,this.overridesModel=je({},!1),this._registrationDeferred.promise.catch((e=>{this._allInputPropertyBindingsBound.reject(e)})),this._partSettingsManager=this.diContainer.get(A.PartSettingsManager)}getPartsContainer(){return this._partContainer||(this._partsContainer=this.diContainer.get(E.Finder).findPartsContainer(this)),this._partsContainer}shouldAlertOnClose(e){const t=this._getContainer();if(!t)return!1;const s=ko.utils.peekObservable(t.suppressAlert),o=ko.utils.peekObservable(t.configureAlert);return!s&&(o?o.showAlert:!!this.widget&&r.gatherFormFields(this.widget.element,e?.validateHidden).some((t=>{const s=t.viewmodel;return(s._msPortalFxViewModelValueChangesAreClean||s._msPortalFxOldControl&&!e?.legacyMode)&&s.dirty&&s.dirty()})))}getAlertMessage(){const e=this._getContainer(),t=ko.utils.peekObservable(e.configureAlert);return t&&t.showAlert?t.message:""}suppressAlert(){const e=this._getContainer();return!e||ko.utils.peekObservable(e.suppressAlert)}notifySettingChanged(){const e=this.widget;e&&e.element.trigger(t.fxpartsettingchanged,{part:this,isUserInteraction:this.hasUserInteractedRecently()})}getViewModel(e,s){let o=t.EmptyViewModel;const i=this.adapter;if(0===(e=e||0))o=this._vm;else if(4===e){const i=this._contextMenuViewModels;if(i)o=i.getViewModel(e,s);else{const e=this._getCommands(),i=_.findCommand(e,s,""+this);o=i&&i.getViewModel()||t.EmptyViewModel}}else if(7===e)o=i&&i.viewModel;else if(9===e){const e=i&&i.inputPropertyBindings;o=e&&e.targetModel}else ge.error(`Invalid model type '${e}' for part '${this.locator.toString()}'.`);return o}getViewModelAsync(e,t){return this._registrationDeferred.promise.then((()=>{if(4===e){const s=this._contextMenuViewModels;if(s)return s.getViewModelAsync(e,t);{const e=this._getCommands(),s=_.findCommand(e,t,""+this);return s&&s.getViewModelAsync()}}return this.getViewModel(e)}))}setViewModel(e){this._vm=e||t.EmptyViewModel}setBladeOpener(e){this.registerForDispose(this._bladeOpener=e)}getBladeOpener(){return this._bladeOpener}get isDisabled(){return this._disabled}get canClone(){const e=this.isComposed,t=this.getInputPropertyBindings().allBound,s=this.partDefinition.partKind===Be;return e&&t&&!s}get eligibleForBinding(){return!this.containerModel}get templateKey(){let e=this.locator.toString();const t=this.containerModel;return t&&(e+="-"+MsPortalFx.toSortedString(ko.toJS(t))),e}get journeyPath(){return this.getPartsContainer().journeyPath.concat(this.templateKey)}get dirtyAndNotSaving(){return 1===this.diContainer.get(M.EditScopeManager).getStateObservable(this.editScopeId())()}get instanceDefinition(){return this._partInstanceDefinition}getCompositionType(){return oe.Part}getPartSettingsManager(){return this._partSettingsManager}getPerfData(){return this._perfData}getSettingsModel(){let e,t=this._settingsModel;if(!t&&(e=this.getViewModel())){const s=i.isV2(e.content()),o=this.partDefinition,n=o&&o.partState,r=MsPortalFx.unique((n?(n.inputIdentityProperties||[]).concat((n.sharedProperties||[]).map((e=>e.property))):[]).concat(!s&&this._viewStateProperties||[]));this._settingsModel=t=MsPortalFx.clone(e),t.content=ko.observable({}),r.forEach((o=>{if(o.startsWith("content.")){const i=s?ko.observable():Ie(e,o).value;R.setModelValue(t,o,i)}}))}return t}hasUserInteractedRecently(){return!1}dispose(e){super.dispose(e),this._releaseResources(e),this._readyMarker&&q.usingState((()=>{ze(this)||ve.trace({extension:it(this),source:Me,action:"PartReady",actionModifier:X.Cancel,name:Ae(this.locator),data:this._perfData,journeyId:this._getTelemetryJourneyId()})}),this._creationState)}_setExtension(e){this.extension=e,this._partContainer&&this._partContainer.attr("data-extensionname",this.extension?this.extension.name:null)}resourceLTM(){return this._ltm||(this._ltm=this.widget.ltm.createChildLifetime())}_releaseResources(e){this._ltm&&this._ltm.dispose(),this._clearLoadingReactor();const s=this._inputBindings;s&&(s.unbind(),this._inputBindings=null);const o=this._part;o&&(o.dispose(),this._part=null);const i=this._vm;this.extension&&i&&i!==t.EmptyViewModel&&this._viewModelManager.releaseViewModel(i,!0),this._releaseAdapter();const n=this._extenderVM,r=this._extenderVMExtn;n&&r&&this._viewModelManager.releaseViewModel(n),e||this._disposeEditScope(),this._journey=null,this._vm=t.EmptyViewModel}_clearLoadingReactor(){const e=this._loadingReactorLifetime;e&&e.dispose()}_releaseAdapter(){const e=this.adapter;if(!e)return;e.inputPropertyBindings.unbind();const t=e.viewModel;t&&this._viewModelManager.releaseViewModel(t),this.adapter=null}_getContainer(){return K(this.isDisposed()||!this._vm?{}:this._vm.container)}getInputPropertyBindings(){if(!this._inputBindings){const e={};this._inputBindings=new re(Je(this),e,!1)}return this._inputBindings}getAssetId(){const e=this.assetInstanceDefinition;if(!(e&&e.assetIdInputProperty))return Promise.reject(0);const t=e=>{const t=Xe(this);t&&t.exists?e.resolve(ko.unwrap(t.value)):e.reject()},s=Q.defer(),o=this.adapter,i=o?o.allInputsSet:this.allInputsSet;return i()?t(s):i.subscribe(this,(e=>{e&&!s.promise.isFulfilled()&&t(s)})),s.promise}toJSON(){const e=super.toJSON();e.assetInstanceDefinition=this.assetInstanceDefinition,e.partState=FxImpl.toSerializableObject(this.partState||{}),e.initialSize=this.initialSize,e.bindingsInitialized=this._bindingsInitialized,e.savedContainerState=function(e){let t;if(e.isComposed){const s=e.getViewModel();if(s){const e=s.container;if(e){const s=e.partTitle&&e.partTitle(),o=e.assetName&&e.assetName();(s||o)&&(t={partTitle:s,assetName:o})}}}return t}(this),e.containerModel=qe(this.containerModel,this.modelContainsSensitiveData),e.overridesModel=qe(this.overridesModel,!1),e.originalPartLocator=this.previousLocator,e.flags=this.flags;const t=this.adapter,s=this.bindings;return e.adapterBindings=t&&t.bindings,e.bindings=t?s.filter((e=>e.source.scope===ne.DetailsContainer)):s,e}cloneAs(e,t){let s;const o=this.widget?this.widget.options:null,i=[this.await(7),this.getInputPropertyBindings().awaitAllBound],n=this.adapter;return n&&i.push(n.inputPropertyBindings.awaitAllBound),Promise.all(i).then((()=>{const i=this.getNonDetailsContainerPropertyBindings(),n={};i.forEach((e=>{const t=Ie(e.targetModel,e.targetProperty).value;R.setModelValue(n,e.sourceProperty,ko.toJS(t))}));const r=ko.toJS(this.overridesModel);s=e(n,r),s.widgetState($.extend(!0,{},this.widgetState())),o&&o.size&&(s.initialSize=o.size(),s.initialSize===se.Custom&&(s.initialWidth=o.gridWidth(),s.initialHeight=o.gridHeight()));const a=this._partSettingsManager;return a&&a.saveIdentityPartSettings(s.containerModel,t),s}))}clone(){return this.cloneAs(((e,t)=>$e(this.diContainer,this.locator,null,e,t)))}static fromJSON(e,t){const s=e.get(p.ExtensionManagerOptions);return Le(s,t,(()=>{const o=e.createChildContainer("composition"),i=new Oe(o,j.fromJSON(s,t.locator),t.widgetState,t.id);return i.registerForDispose((()=>o.disposeAsync())),i.loadPropertiesFromJson(s,t),i}),((s,o)=>{const i=e.createChildContainer("composition"),n=new Oe(i,s,null,t.id);return n.registerForDispose((()=>i.disposeAsync())),n.unrecoverableErrorMessage=o,n}))}getAssetInstanceMetadataAsync(){return this._registrationDeferred.promise.then((()=>{if(!this.isDisabled&&!this.isDisposed())return this.getAssetId().then((e=>({id:e,type:this.assetType}))).catch($.noop)}))}get assetType(){const e=this.assetInstanceDefinition;return e&&e.assetType}addWidgetToUI(e){const t=this.widget;e.skipDOMAttach||e.parentElement.addChild(t),t.addChild(this._partContainer)}recompose(e){this._compose(e,Promise.withResolvers(),!0)}_compose(e,t,s=!1,o){let i;const n=it(this),r=Ae(this.locator),a=(e,t,s,o)=>function(e,t,s,o,i,n){const r=fx.getTimestamp()-t,a=()=>(i&&(o=MsPortalFx.extend2(o,i.getTelemetryInfo())),Z.trace({name:s.name,extension:s.extension,source:s.source,action:e,actionModifier:X.Complete,data:o,duration:r,journeyId:s.journeyId}));return n?q.usingState(a,n):a()}(e,t,s,o,this._menu,this._creationState),l={extension:n,source:Me,name:r,journeyId:this._getTelemetryJourneyId()};this.calledOnInputsSet.subscribe(this,(e=>{e&&(this._onInputsSetResolvedMarker=fx.getTimestamp())})),this._allOnInputsSet.then((()=>{const e=this._readyMarker;if(e){ze(this)||a("PartReady",e,l,this._perfData),this._readyMarker=null}const t=this._onInputsSetResolvedMarker;t&&(this.fullReadyTime(fx.getTimestamp()-t),this._onInputsSetResolvedMarker=null)})),this.await(0).then((e=>{this._revealedMarker&&(this._perfData.contentRevealedCalled=e,this._revealedMarker=null)})),this._registrationDeferred.promise.then((()=>{t.resolve()}),(()=>{t.reject(),this._getPartViewModelCalledDeferred.reject()})),this._clearLoadingReactor(),this._ltm&&this._ltm.dispose();let c=this.widget;if(c&&s){this._partContainer=c.element.find("."+fe),i=c.options;const e=i.commands.splice(0,i.commands.length),t=!!MsPortalFx.find(e,(e=>e instanceof w.CustomizeTileData));e.forEach(MsPortalFx.disposeDisposable),t&&i.commands.push(new w.CustomizeTileData(this,this.diContainer)),i.actionBarViewModel.update(),this._ltm=c.ltm.createChildLifetime()}else this._partContainer=$(FxImpl.createElement("div",{class:fe})),o?(i=o.options,c=this.widget=o):(i=this.createTileViewModel(e.options.locked()),c=this.widget=C.createTileWidget($(FxImpl.createElement("div")),i,this.diContainer,!1,(()=>this._getActions()))),this.widgetState(c.saveViewSettings()),this._ltm=c.ltm.createChildLifetime(),this.addWidgetToUI({parentElement:e,doNotSaveSettings:!0,skipDOMAttach:!!o});const d=c.element,p=this._ltm;if(e.options.locked()||i.isInBlockingLoadingState(!0),d.data(_.CompositionInstanceDataName,this),p.registerForDispose(d.setEvents(["fxregistermenu",(e,t)=>{this._menu=t}])),this._loadedMarker=fx.getTimestamp(),this._readyMarker=fx.getTimestamp(),this._revealedMarker=fx.getTimestamp(),this.unrecoverableErrorMessage&&this.unrecoverableErrorMessage.length>0)this._partDefinitionDeferred.reject(this.unrecoverableErrorMessage),this._createErrorPart(Re.UnrecoverableError,this.unrecoverableErrorMessage);else{this._locateDefinitionAndStartCompose(p,i),this._perfData.srcExtension=function(e,t){const s=e.locator,o=e.extension,i=s&&s.getExtensionName(),n=o&&o.name;if(i!==t)return i;if(n!==t)return n;return}(this,n),this._perfData.resourceId=this.assetId();const t=this.createChildLifetime();e.options.locked.subscribeAndRun(t,(e=>{(0,D.composeShellCommands)(t,this,i.commands,this._showShellCommands=!e,this.diContainer)}))}}createTileViewModel(e){const t=new C.ViewModel(this.id,this.widgetState());return t.inLockedContext=e,void 0===t.size()&&t.size(this.initialSize),this.initialSize===se.Custom&&(t.gridWidth(Math.max(1,this.initialWidth)),t.gridHeight(Math.max(1,this.initialHeight))),t}generateBindings(e){return Promise.all([this._finder.locateAsync(this.locator).then((e=>this._processLocatedDefinitionAsync(e))),et()]).then((([t,s])=>{if(!e.isDisposed()&&t)return this._generateAndSaveBindings(t)}))}_locateDefinitionAndStartCompose(e,t){const o=(0,s.startTimer)();let i;const n=et();return this._finder.locateAsync(this.locator).then((e=>(this._perfData.instanceExtensionLoad=o(),i=(0,s.startTimer)(),this._processLocatedDefinitionAsync(e)))).then((e=>n.then((()=>e)))).then((s=>{if(!e.isDisposed())if(this._perfData.referenceExtensionLoad=i(),s){if(this._generateAndSaveBindings(s),this.partDefinition=s,this._partDefinitionDeferred.resolve(s),!function(e,t){const s=e.partDefinition;return s&&s.partKind===te.Custom&&s.htmlTemplate&&!t.tryLocate(e.locator.getExtensionLocator().withHtmlTemplate(s.htmlTemplate),{})}(this,this._finder))return this._composeCommandsAndPart(t,this._partContainer);this._createErrorPart(Re.CustomPartWithMissingTemplate,l.UiCompositionPart.missingTemplateMessage)}else this._createErrorPart(Re.PartDefinitionNotFound,`Unable to find the definition for the part. Locator: ${this.locator}.`)})).then((()=>{e.isDisposed()||this._contentInitializing.fxAwaitAndRun(e,(e=>!e)).then((()=>{this._part&&this._vm.container.width.subscribeAndRun(e,this._part.onSizeChange)}))})).catch((t=>{this._partDefinitionDeferred.reject(t),e.isDisposed()||this._createErrorPart(Re.ErrorLocatingPartDefinition,t)}))}getInstanceBindings(){const e=this._partInstanceDefinition;if(e)return e.inline?e.inline.bindings:e.reference.bindings}_generateAndSaveBindings(e){if(this._isRestoredPartLackingBinding(e))if(this.eligibleForBinding)this._bindingsInitialized=!1,this.bindings=[];else if(!e.canUseOldInputVersions)return ge.warning(`[Definition Change] Bindings for part '${this}' have been changed in the definition in an incompatible way.`),void this._createErrorPart(Re.OldInputsNotHandled,`Bindings for part have been changed in the definition in an incompatible way. Locator: ${this.locator}.`);const t=this.adapter;if(this._restoredFromJson&&!1!==this._bindingsInitialized){const s=t?t.bindings:this.bindings,o=t?t.inputDefinitions:e.inputDefinitions,i=tt().inferInitialBindingsForInputDefinitions(this,o).filter((e=>s.every((t=>t.targetProperty!==e.targetProperty))));return[].push.apply(s,i),s}{t?t.bindings=this._constructAdaptedBindings():this._setBindings(e),this.assetInstanceDefinition={assetType:e.assetType,assetIdInputProperty:e.assetIdInputProperty},t&&((t.assetType||t.adaptedPart.assetType)&&(this.assetInstanceDefinition.assetType=t.assetType||t.adaptedPart.assetType),t.assetIdInputProperty&&(this.assetInstanceDefinition.assetIdInputProperty=t.assetIdInputProperty));const s=this._partInstanceDefinition,o=s&&s.reference;return o&&o.assetType&&(this.assetInstanceDefinition.assetType=o.assetType),this._bindingsInitialized=!0,this.save(),t?t.bindings:this.bindings}}_setBindings(e){const t=function(e,t){const s={};e&&t&&(t.forEach((e=>{e.isIdentityInput&&e.property&&(s[e.property]=!0)})),e.forEach((e=>{e.isIdentityInput=!!s[e.property]})));if(e&&t){const s=e.slice(0);return t.forEach((t=>{const o=t.valuesFrom;o&&o.length&&5===o[0].referenceType&&(e.some((e=>e.property===t.property))||s.push(t))})),s}return e||t||[]}(this.getInstanceBindings(),e.bindings);if(function(e,t){const s=[],o=ie.validateInputBindings(e,t,s);s.length&&ge.error(`${s[0]} Part:'${e}'.`);return o}(this,t)&&(this.bindings=this.bindings.concat(Se(t,this))),this.bindings.length<=0&&6===this.locator.type){const t=tt();this.bindings=this.bindings.concat(t.inferInitialBindingsForInputDefinitions(this,e.inputDefinitions))}}_constructAdaptedBindings(){const e=this.adapter;if(e.bindings.length<=0&&6===this.locator.type){return tt().inferInitialBindingsForInputDefinitions(this,e.inputDefinitions)}return Se(e.adaptedPart.bindings,this)}_isRestoredPartLackingBinding(e){if(this._restoredFromJson){const t=this.adapter,s=t?this._constructAdaptedBindings():Se(e.bindings||[],this),o=t?t.bindings:this.bindings,i=e=>!e.optional&&MsPortalFx.findIndex(o,(t=>t.targetProperty===e.targetProperty))<0;return!!s.some(i)}return!1}_getActions(){const e=this.diContainer,t=[];return this.getCompositionType()===oe.StartboardPart&&t.push(new w.UnpinFromStartboard(this,e).createAction(this)),t.push(new w.OpenContextMenu(this,e,l.ContextMenu.ariaLabel).createAction(this)),t}resetLayout(){const e=this.initialSize,t=N.AllSizes[e>=0?e:N.getDefaultSize().name].size,s=this.widget;s.element.trigger("fxsizechange",[s.options.id,t.width,t.height])}clearIdentitySettings(){const e=this._partSettingsManager;e&&e.clearIdentityPartSettings()}_processLocatedDefinitionAsync(e){const t=this._finder;let s,o=e;switch(this.locator.type){case 5:case 7:this._partInstanceDefinition=e;break;case 6:s=e,s&&s.reference&&(this._partInstanceDefinition={reference:{partTypeName:s.name,bindings:s.bindings,assetType:s.assetType,initialSize:s.initialSize}})}const i=this._partInstanceDefinition;if(i){if(i.reference){const e=i.reference.extension||this.locator.getExtensionName(),s=we(e),o=s.withPartType(i.reference.partTypeName);return t.locateAsync(s).then((e=>(this._setExtension(e),t.locateAsync(o)))).then((t=>t&&t.reference?this._processAdapterAsync(t,e):t))}o=i.inline}return this.initialSize===se.Custom&&(this.initialWidth=o.initialWidth,this.initialHeight=o.initialHeight),this._setExtension(t.locate(this.locator.getExtensionLocator())),Promise.resolve(o)}_processAdapterAsync(e,t){const s=we(e.reference.extension||t),o=s.withPartType(e.reference.partTypeName),i=this._finder;return i.locateAsync(s).then((t=>{const s=`${this} (AdapterPart. Extension: ${this.extension.name}, ViewModel: ${e.viewModel})`;this.adapter={extension:this.extension,viewModel:null,viewModelLocator:e.viewModelLocator,viewModelName:e.viewModel,viewModelId:s,bindings:this._adapterBindings||[],inputDefinitions:e.inputDefinitions,adaptedPart:this._partInstanceDefinition.reference,allInputsSet:ko.observable(!1),calledOnInputsSet:ko.observable(!1),failedOnInputsSet:ko.observable(!1),inputPropertyBindings:new re(s,{},!1),assetType:e.assetType,assetIdInputProperty:e.assetIdInputProperty},this._partInstanceDefinition={name:this._partInstanceDefinition.name,reference:e.reference};const n=this.adapter.adaptedPart.assetType;return n&&(this._partInstanceDefinition.reference.assetType=n),this._setExtension(t),i.locateAsync(o)})).then((s=>{if(s&&s.reference){const o="Error processing the part defintion for part '{0}'. Adapted part definition '{0}:{1}' cannot reference another adapted part definition '{2}:{3}'.".format(this,this.adapter.extension.name,e.reference.partTypeName,s.reference.extension||t,s.reference.partTypeName);throw ge.error(o),FxImpl.createError(o)}return this._setBindings(s),"HubsExtension"===this.extension.name&&"MonitorChartPart"===s.name&&this.bindings.forEach((e=>{e.optional=!0})),s}))}getTitle(){return this.getViewModel()?.container?.partTitle?.()||""}getPartAriaLabel(){return this.getViewModel()?.container?.ariaLabel?.()||""}disableForAssetDeleted(e,t){this._disabled=!0;const s=this._vm;s&&s.container&&this._vm.container.notFoundMessage({message:me.deletedTitle});const o=this.widget;if(o&&o.options){const e=o.options.commands;e.splice(0,e.length,new w.UnpinFromStartboard(this,this.diContainer)).forEach(MsPortalFx.disposeDisposable)}this.save(),ge.warning("Part '{0}' disabled because asset was deleted. {1}".format(this,t))}_composeCommandsAndPart(e,t){return(0,D.composeCommands)(e.commands,this).then((()=>{this._composePart(t,e),this._attachEventHandlers(t)}))}_attachEventHandlers(e){this.resourceLTM().registerForDispose(this.widget.element.setEvents([P.Widget.viewSettingsChanged,(e,t)=>{this.widgetState(t),this.save(),e.stopPropagation()}],["fxsizechanged",(t,s)=>{const o=this.widget.options,i=!!ee.PartSize[s];s=i?s:o.size(),Ke(this._vm,e,o,s,i,this.partDefinition),this.widgetState(this.widget.saveViewSettings())}],["rightclick",(e,t)=>{this._handleRightClick(e,t)}],["fxensurebladevisible",(e,t)=>{t.masterPartId=this.id}],[c.fxpinmultipleparts,(e,t)=>{e.stopPropagation();const s=this.locator.getExtensionLocator();this.diContainer.get(O.PinTilesPortalFunc).invoke({partReferences:t.partReferences,originExtension:s.name,notify:!0},Me)}]))}_getPartContext(){const e=He(this)||{},t=this.getPartsContainer(),s=!MsPortalFx.isEmpty(e),o=t&&t.getCompositionType()===oe.Startboard;return{id:Ae(this.locator),instanceId:this.instanceId,bladeId:Ae(e.locator),bladeInstanceId:e.instanceId,onBlade:s,onStartBoard:o,bladeCustomized:!1}}_getPartViewModelAsync(t,r,l,c,d,p,u){const m=this.parent&&this.getPartsContainer(),h=function(t,s){const i=s&&(s.diContainer||o.container)?.get(E.Finder).findParentMenuBlade(s);return i&&{switchItem:(s,o)=>{le(t,Promise.all([MsPortalFx.require("../../../MsPortalImpl.Controls/Controls/Lists/Menu",e),MsPortalFx.require("../../../MsPortalImpl.Controls/Controls/Lists/TabMenu",e)]).then((([e,t])=>{const n=i.widget.element.find(".fxc-menu"),r=i.widget.element.find(".fxc-tabmenu"),a=n.length&&(z.getAllMatch(n[0],e.Widget)||[])[0]||r.length&&(z.getAllMatch(r[0],t.Widget)||[])[0]||i.getMenuWidget();a&&a.switchItem(s,o)})))},internalGetAndSelectItem:s=>le(t,MsPortalFx.require("../../../MsPortalImpl.Controls/Controls/Lists/Menu",e)).then((e=>{const t=i.widget.element.find(".fxc-menu"),o=t.length?(z.getAllMatch(t[0],e.Widget)||[])[0]:i.getMenuWidget();return o?o.internalGetAndSelectItem(s):Promise.resolve(null)}))}}(this,He(this)),g=T.needContainerSelectable(this.partDefinition.details),y=(0,s.startTimer)();q.provideContext((()=>{this._creationState=q.getState()}),G.Part,this._getPartContext());const v=p&&(e=>{e&&!e.chrome&&e.content()&&p(e)}),M=MsPortalFx.tryImmediateResolve(ze(this)?MsPortalFx.tryImmediateResolve(He(this).tryGetVirtualPartViewModel(),(e=>(e&&v&&v(e),e))):Q(null),(e=>{if(this._getPartViewModelCalledDeferred.resolve(void 0),e)return e;const s=Ve(this),o=m&&m.bladeDefinition,i=(0,W.getViewModelType)(t,ze(this)&&o);let n;n=m&&1&m.flags?1:0,n|=Ue(this)?2:0,n|=h?4:0,n|=m&&256&m.flags?16:0,n|=m&&512&m.flags?32:0;const a=!ot(this.partDefinition)&&function(e,t){if(N.isFixedSize(e.size()))return Ge(e);{let e=0,s=0;return 2===t.partLocation&&(e=ue.innerHeight-113,s=ue.innerWidth-(t.inMenuBlade?265:0)-1),{height:e,width:s}}}(u,{partLocation:s,inMenuBlade:!!h});return q.usingState((()=>this._viewModelManager.getPartViewModel(4&o?.attributes?o.dxView.runtimeExtension:this.extension.name,t,i,{createSelectable:g,partSize:r,contentSize:a,partLocation:s,collapsed:l,onInputsSetParameters:d,onViewModelAcquired:v,locator:this.locator,flags:n,menuId:m&&m.defaultMenuItemId,bladeName:o?.name})),this._creationState)}));return M.then(this._earlyVmDeferred.resolve,this._earlyVmDeferred.reject),M.then((t=>{let o,r;if(t&&t.chrome?(r=MsPortalFx.cloneAndRebindFunctions(t),r.content=ko.observable(i.markAsV2(t.chrome)),o=t.content.fxAwaitAndRun(this).then((e=>(p&&p(t),t))),this._setupLoadingReactor(u,t.container.operations)):o=Promise.resolve(r=t),ze(this)){const e=He(this);e.setViewModelForTemplateOrMenuBlade(r),e.setInputsSetPromise(this._allOnInputsSet)}const l=t&&K(t.container);let c;return l&&(l.requestOpenBlade((async(e,t)=>(await this.diContainer.getAsync(n.get("MsPortalImpl/UI/UI.BladeOpenerImpl","BladeOpener"))).requestOpenBlade(e,void 0,t))),l.closeBlade(function(e){const t=e.diContainer.get(I.JourneyManager),s=t.tryCloseBlade.bind(t),o=e.getPartsContainer();return(t,i)=>{switch(t){case 1:case 2:{const i=e.diContainer.get(E.Finder).findBlades(o).filter((s=>{const o=!!(1&s.flags);return We(e,s)&&1===t?!o:o}));return 0!==i.length&&!i.some((e=>!s(e)))}default:{let e=o;const t=o.masterContainer,n=t&&t.bladeDefinition;return n&&n.menuBlade&&(e=t),e.returnValue=i,s(e,2)}}}}(this)),l.menu(h),l.openDialog(((e,s)=>n.get("MsPortalImpl/UI/Compositions/UI.Composition.Part.Dialog","openDialog").then((o=>o(this,t,e,s,this._contentInitializing,He(this),Ue(this)))))),l.setFocus((e=>this._contentInitializing.fxAwaitAndRun(this,(e=>!1===e)).then((()=>this._part.setFocus(e))))),l.print((()=>{const e=He(this).containerWidget;this.diContainer.get(x.PrintHandler).printBlade(e.element[0],{name:e.getContentWidget().options.getTelemetryName(),source:"ExtensionCall",menuBladeCtx:e.options.isMenuBlade.peek()?e.options.getTelemetryName():null})})),l.executeInCloudShell((async(t,...o)=>{if(!(0,s.isFeatureEnabled)("azureconsole"))return(0,a.logToExtension)(e,it(this),1,"Azure Console feature is not enabled in this environment."),!1;const i=He(this).getTelemetryContextState();try{return(await this.diContainer.getAsync(n.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole"))).executeInCloudShell({options:t,commands:o},i)}catch(e){return ge.error(FxImpl.createError("Failed to execute in CloudShell",{innerErrors:e})),!1}})),l.toggleFullScreen((()=>{this.diContainer.get(b.FullScreenMode).toggle()})),l.openHelpPane((async e=>{(await this.diContainer.getAsync(n.get("MsPortalImpl/UI/UI.HelpPane","HelpPane"))).open(e,this.getCreationState())}))),t&&t.container&&t.container._msPortalFxAnnounce((e=>{c||(c=new f.PortalReader(this._ltm,{idPrefix:this.locator.name})),c.read(e)})),o})).then((e=>{const t=this._finder,o=t.locate(this.locator),i=(0,s.startTimer)(),n=e&&e.content();return d&&ie.notifyOnInputsSetCalled(c,d,e&&e.onInputsSetPromise&&Promise.resolve(e.onInputsSetPromise)),o&&o.reference&&(o.reference.extenderViewModelLocator||o.reference.extenderViewModel)?(this._extenderVMExtn=t.locate(this.locator.getExtensionLocator(),this.extension.name),this._viewModelManager.getViewModel(this._extenderVMExtn.name,o.reference.extenderViewModelLocator||o.reference.extenderViewModel,9).then((t=>{const s=o.reference.extenderViewModelLocator?o.reference.extenderViewModelLocator.name:o.reference.extenderViewModel;return t&&t.content()?n&&ko.isObservable(n.extenderViewModel)?(this._extenderVM=t,n.extenderViewModel(t.content())):ge.error(`Part '${this}' defines extender view model '${s}' but the referenced part is not marked as extensible.`):ge.error(`Extender view model '${s}' for part '${this}' must be an object.`),e})).finally((()=>{this._perfData.extenderViewModelLoad=i()}))):e})).finally((()=>{this._perfData.partViewModelLoad=y()}))}_getAdapterViewModelAsync(){if(!this.adapter)return Promise.resolve(null);Qe(this);const e=_e(this._getAdapterAllInputsSetWatcherConfig()),t=ie.loadOnInputsSetParameters(e),o=this.adapter;return t.then((t=>{this._earlyAdapterOnInputsSet=!!t,this._perfData.earlyOnInputsSetAdapter=this._earlyAdapterOnInputsSet;const i=(0,s.startTimer)();return this._viewModelManager.getViewModel(o.extension.name,o.viewModelLocator||o.viewModelName,10,{onInputsSetParameters:t}).then((s=>(o.viewModel=s,t&&ie.notifyOnInputsSetCalled(e,t,s&&s.onInputsSetPromise),e))).finally((()=>{this._perfData.adapterViewModelLoad=i()}))}))}_bindAssetNameFromAdapter(){const e=this.adapter;if(!e)return;const t=Ie(e.viewModel,"content.assetName");let s;t.exists&&(ko.isObservable(t.value)?(s=t.value,ko.computed(this,(()=>{const e=s(),t=this._vm;!he(e)&&t&&t.container&&R.setModelValue(t,"container.assetName",e)}))):ge.error("Failed to bind the asset name from the adapter view model for Part '{0}', because the asset name needs to be an observable.".format(e.viewModelId)))}_composePart(e,o){if(this.isDisposed())return;const n=this.locator,r=this.partDefinition,a=r.partKind,c=y.getPartFactory(this._finder,n,r);let d,p,u;if(c){1!==r.resizeMode?o.supportedSizes(c.supportedSizes):o.supportedSizes([]),this._inputBindings=null,this.getInputPropertyBindings();const a=this._getAdapterViewModelAsync(),u=this._finder.locate(n),m=u&&u.reference&&u.reference.extenderViewModel,h=this.bindings||[],g=h.some((e=>e.source&&e.source.scope===ne.DetailsContainer)),f=this.adapter&&h.some((e=>e.source&&7===e.source.modelType));if(m||g)p=Promise.resolve(null);else{const e=()=>this.isDisposed()?Promise.resolve(null):(this._registerInputPropertyBindings(),d=_e(this._getAllInputsSetWatcherConfig()),ie.loadOnInputsSetParameters(d));p=f?a.then(e):e()}let x;p=function(e){const t=Ye(De);return MsPortalFx.tryImmediateResolve(t,(()=>e))}(p),this._vmPromise=MsPortalFx.tryImmediateResolve(p,(e=>{if(this.isDisposed())return this._releaseResources(),Promise.reject(new de);this._earlyOnInputsSet=!!e,this._perfData.earlyOnInputsSetPart=this._earlyOnInputsSet;const t=this.partDefinition,s=t.partKind===Be?this._getSummaryPartViewModelState():null;x=o?o.size():this.initialSize;const i=this._getPartViewModelAsync(t.viewModelLocator||t.viewModel,x,s,d,e,d&&(e=>this._setupInvocationProperties(c.viewStateProperties,e)),o).then((e=>(0,D.composePartCommands)(o.commands,this.resourceLTM(),this).then((()=>e))));return Promise.all([i,a])})).then((([n,a])=>{const p=(0,s.startTimer)();if(this.setViewModel(n),ko.reactor(this,(()=>{const e=this._vm.content()&&this._vm.onInputsSetPromiseState();e&&(this._perfData.onInputsSetPromiseState=e.state,this._perfData.onInputsSetPromiseType=t.OnInputsSetPromiseType[e.type])})),this.isDisposed())return this._releaseResources(),Promise.reject(new de);if(n){if(!this.isDisabled){this._bindAssetNameFromAdapter(),this.resourceLTM().registerForDispose(this.widget.element.setEvents(["fxportalcontrolloadfailed",(e,t)=>{this._createErrorPart(Re.ErrorLoadingControl,t)}]));const t=o?o.size():this.initialSize,s=t!==x,l=!1;Ke(this._vm,e,o,t,s,this.partDefinition),i.isV2(n.content())||this._setupLoadingReactor(o,n.container.operations),o.userResizable(this.getCompositionType()===oe.StartboardPart&&2===r.resizeMode),o.actionBarViewModel.partTitle(this.getTitle()||"Untitled"),o.actionBarViewModel.ariaLabel(this.getPartAriaLabel()),s?this.extension.processMessages().finally((()=>{this.isDisposed()||this._setupPartWidget(e,c,d,a,l,p)})):this._setupPartWidget(e,c,d,a,l,p)}}else this._createErrorPart(Re.ViewModelMissing,l.UiCompositionPart.viewModelRequired)})).catch((e=>{if(this.isDisposed()||MsPortalFx.Errors.isInstanceOfErrorType(e,MsPortalFx.Errors.CanceledError))return Promise.reject(new de);this._createErrorPart(Re.ErrorAcquiringViewModel,e)}))}else a!==te.Provisioning&&(u="Incorrect part type '{0}'.".format(a),this._createErrorPart(Re.IncorrectPartType,u))}_setupPartWidget(e,t,o,i,n,r){const a=this.widget,l=this.getViewModel();this._perfData.prepareViewModel=r();const c=(0,s.startTimer)();m.setSelectableContext(this,l,e),MsPortalFx.tryImmediateResolve(this._createPartWidget(t,l,n),(()=>{if(this.isDisposed())return Promise.reject(new de);Ke(l,e,a.options,a.options.size(),!1,this.partDefinition),this.register(t.viewStateProperties,o,i),function(e){const t=e.adapter,s=t?t.allInputsSet:e.allInputsSet;ko.computed(e,(()=>{if(s()){const t=Xe(e);t&&t.exists&&e.assetId(ko.unwrap(t.value))}}))}(this),this._ensureAssetAffinity(),this._perfData.finalizePartCompose=c();if(1===this.partDefinition.resizeMode){const e=this.extension&&this.extension.name;if("AppInsightsExtension"!==e&&"SamplesExtension"!==e)return;K(this._vm.container).resize.subscribe(this,(e=>{if(!e||!e.width||!e.height)return;const t=N.getGridPixelSize(e.width,e.height);this.widget.element.trigger("fxsizechange",[a.options.id,t.width,t.height])}))}}),(e=>{this._createErrorPart(Re.ErrorCreatingWidget,e)}))}register(t,o,i){const n=this.parent&&this.getPartsContainer();this._removeOutputArgumentValuesFromContainerModel(),(this.bindings||[]).forEach((e=>{const t=e.source.modelType;this._hasRebindableInputs||e.source.scope!==ne.CurrentContainer||1!==t&&7!==t&&9!==t||(this._hasRebindableInputs=!0)})),this._listenForPartMutation(),this.adapter&&!i&&Qe(this),o||(this._registerInputPropertyBindings(),this._setupInvocationProperties(t,this._vm)),this._partSettingsManager.configureInstanceProperties(this._viewStateProperties),this._partSettingsManager.initialize(),ot(this.partDefinition)||ae(this,"./UI.Composition.SelectableRegistration",(e=>{e.listenForRegistrationChanges(this,this._vm,this)}),e),ae(this,"./UI.Composition.Selectable2Registrar",(e=>{e.registerSelectables(this,this._vm,this,!ot(this.partDefinition)||this.partDefinition.isMenuBlade)}),e);const r=this.getInputPropertyBindings();this._setupBladeRebindingHandlers(n);const a=(0,s.startTimer)();this.save(),o||(o=_e(this._getAllInputsSetWatcherConfig())),o.bindableTarget.viewModel=this._vm,this._setContainerInputsChanging=(e,t)=>{if(!e)return t?ie.turnOnInputsSetSuppressionOff(o,t):ie.turnOnInputsSetSuppressionOff(o);ie.turnOnInputsSetSuppressionOn(o)},ie.setupAllInputsSetWatcherFromExtendedConfig(o),this.adapter&&(i||(i=_e(this._getAdapterAllInputsSetWatcherConfig())),i.bindableTarget.viewModel=this.adapter.viewModel,ie.setupAllInputsSetWatcherFromExtendedConfig(i)),et().then((e=>{e.listenForConfigurationChanges(this,i,o)}));const l=()=>{this._finishCompose(n,r,a)};ze(this)||(0,H.isShellPart)(this.locator)?l():this.extension.processMessages().finally(l)}_finishCompose(e,t,s){if(!this.isDisabled&&!this.isDisposed()){e&&e.notifyPartComposed(this),this._registrationDeferred.resolve();const o=[t.awaitAllBound];this.adapter&&o.push(this.adapter.inputPropertyBindings.awaitAllBound);const i=s(),n=this._allInputPropertyBindingsBound;Promise.all(o).then((()=>{const e=this._perfData;n.resolve(void 0),e.allInputBindingsBoundPreprocess=i,e.allInputBindingsBound=s(),this._loadedMarker&&(this.adapter&&$.extend(e,{innerPart:{extension:this.extension.name,name:this.partDefinition.name}}),this.compositionTime=fx.getTimestamp()-this._loadedMarker,this._loadedMarker=null)})).catch((()=>{n.reject()})),this.save()}}_registerInputPropertyBindings(){const e=[],t=[],s=[];this._journey=this.diContainer.get(I.JourneyManager).activeJourney(),(this.bindings||[]).forEach((o=>{o.source.scope===ne.DetailsContainer?s.push(o):t.push(o),o.isIdentityInput&&e.push(o.targetProperty)})),this._partSettingsManager.configure(this._getPartSettingsManagerConfig(e,this._viewStateProperties));const o=this.getInputPropertyBindings();Pe(this.diContainer,this,o,s),Pe(this.diContainer,this,o,t,(e=>this.adapter?this.adapter?this.bindAdaptedInput(e):void 0:this.bindAgainstOverridesOrContainerModel(e))),this._setEditScope(),this._setupJourneyEditScopeReactor()}bindAdaptedInput(e){const t=e.source;switch(t&&t.modelType){case 7:return{sourceModel:this.adapter.viewModel,sourceModelName:this+"-[Adapter]"};case 9:return{sourceModel:this.adapter.inputPropertyBindings.targetModel,sourceModelName:this+"-[AdapterInputs]"}}}getNonDetailsContainerPropertyBindings(e=!0){const t=this.adapter;return(e&&t?t.inputPropertyBindings:this.getInputPropertyBindings()).properties.filter((e=>{const t=e.compositionBindingDefinition;return(t&&t.source&&t.source.scope)!==ne.DetailsContainer}))}bindAgainstOverridesOrContainerModel(e){if(e.source.id!==this.id){if(R.isDynamicBindingWithNonLocalSource(e))return null;const t=e.source.property,s=this.overridesModel;if(Ie(s,t).exists)return{overridesConstantBindings:!0,sourceModelName:this+"-[OverridesModel]",sourceModel:s};const o=this.containerModel;if(o&&Ie(o,t).exists)return{sourceModelName:this+"-[ContainerModel]",sourceModel:o};if(R.isOverridesOrContainerModelSourceReference(e.source)){const e={};return R.setModelValue(e,t,void 0),{sourceModelName:this+"-[Inferred]",sourceModel:e}}}}_setupInvocationProperties(e,t){const s=this.partDefinition;if(this._vm=t,!this._vm||this.isDisposed()||this.isDisabled)return;this._setViewStateProperties(s.viewStateProperties,e);const o=Ee[De],i=this.diContainer.createChildContainer("composition");i.set(T.OpenerConfiguration,this._getBladeOpenerConfig()),this.setBladeOpener(i.get(o.BladeOpener)),this.registerForDispose((()=>i.disposeAsync())),function(e,t,s){let o=!!t;t&&(t.assetType&&!t.assetIdInputProperty?(ge.error(`'assetIdProperty' is required if 'assetType' is defined on part definition. Locator:'${e.locator}'.`),o=!1):!s&&t.editScopeType&&e.bindings&&e.bindings.some((e=>e.targetProperty===Ce))&&(o=!1,ge.error(`Declaring an 'editScopeType' and an input binding with '${Ce}' as a target property is not supported. A part cannot be the owner of an edit scope and also receive an edit scope id from an external source. Part: '${e}'. Bindings: ${JSON.stringify(e.bindings)}.`)));return o}(this,this.partDefinition,this._restoredFromJson)&&s.details&&s.details.length&&(s.details.forEach((e=>{(function(e,t){const s=[];let o=!0;t&&t.invocationInputArguments&&t.invocationInputArguments.length&&(o=T.validateDetailsDefinition(t,s));s.length&&xe(s[0],e.toString(),t);return o})(this,e)&&this._registerInvocationProperty(e)})),this.resourceLTM().registerForDispose(this.widget.element.setEvents(["fxopeninnewtab",(e,t)=>{const s=t.selectable,o=T.getAssociatedDetailDefinition(s||t.selectableSet,this.getViewModel(),this.partDefinition);if(o){const e=s?s.selectedValue():(0,D.createSelection)(t.selectableSet,t.item),i=Q(e).then((e=>{const t=this._bladeOpener.createBladeModelForSelectedItem(o,e),s=t&&t.locator;return s?(0,u.getBladeDeepLink)(s.getExtensionName(),s.name,t.model,{baseUri:ue.location.href}):null}));this.diContainer.get(S.WindowManager).openWindow(i)}}])))}getSelectableAsync(e){return this.getViewModelAsync().then((t=>{const s="string"==typeof e?e:T.getSelectablePath(e),o=Ie(t,s);if(o.exists)return ko.unwrap(o.value)}))}_getBladeOpenerConfig(){return{diContainer:this.diContainer,masterModelId:Je(this),masterModel:this.getViewModel(),referenceComposition:this,referenceExtension:this.extension,invocationThrottleDuration:this.invocationThrottleDuration,isBladeOpenedByMaster:e=>We(this,e),onBladeOpened:MsPortalFx.noop,addOutputBindings:(e,t)=>{!function(e,t,s){const o=e.getInputPropertyBindings();(s||[]).forEach((s=>{MsPortalFx.find(o.properties,(e=>{const o=e.compositionBindingDefinition;return e.sourceProperty===s.source.property&&o&&o.source&&o.source.id===t.id}))||(Pe(e.diContainer,e,o,[s]),s.source.id=t.id,e.bindings.push(s),e.save())}))}(this,e,t)},removeOutputBindings:e=>{!function(e,t){const s=e.getInputPropertyBindings(),o=e.bindings||[],i=o.filter((e=>e.source.scope!==ne.DetailsContainer));i.length!==o.length&&(s.properties.filter((e=>{const s=e.compositionBindingDefinition;return s&&s.source&&s.source.id===t.id})).forEach((e=>{s.removeProperty(e)})),e.bindings=i,e.save())}(this,e)},configureBladeDescriptor:e=>{e.masterPartId=this.id,e.bindings&&e.bindings.forEach((t=>{t.source&&t.source.id===this.id&&(e.model[t.targetProperty]=ko.toJS(Ie(this._vm,t.source.property).value))}))}}}loadState(e){this.partDefinition&&e&&this._vm&&this._vm!==t.EmptyViewModel&&this._viewStateProperties.forEach((t=>{const s=Ie(e,t);s.exists&&!t.startsWith("internal.")&&R.setModelValue(this._vm,t,s.value)}))}_setupLoadingReactor(e,t){if(this.partDefinition.partKind!==te.Provisioning){this._frameBlockingUi(st(this.partDefinition)),this._loadingReactorLifetime=this.createChildLifetime(),ko.reactor(this._loadingReactorLifetime,(()=>{const s=t.inProgress();e.hasOngoingOperation(s&&!e.locked()),this.triggeringLockedBladeSpinner(s&&e.locked())}));const s=ko.computed(this._loadingReactorLifetime,(()=>t.blockingUi()||this._frameBlockingUi()||this._contentInitializing()));if(ze(this)){const e=He(this);2!==_.getBladeType(e.bladeDefinition)&&(ko.reactor(this._loadingReactorLifetime,(()=>{e.shieldType&&e.shieldType(t.shieldType())})),e.uiBlockers.push(s))}s.subscribe(this._loadingReactorLifetime,(s=>{const o=1===t.shieldType()||e.locked();if(e.isInBlockingLoadingState(s&&!o),!s){const t=e.hasOngoingOperation.value;this._contentRevealed.resolve(t)}})),s()||(this._contentRevealed.resolve(t.inProgress()),e.isInBlockingLoadingState(!1))}}_removeOutputArgumentValuesFromContainerModel(){const e=this.partDefinition,t=this.containerModel;t&&e&&e.details&&e.details.forEach((e=>{const s=e.outputArguments;s&&s.forEach((e=>{const s=e.valuesFrom;s&&s.forEach((e=>{const s=e.property;Ie(t,s).exists&&R.setModelValue(t,s,void 0)}))}))}))}_getPartSettingsManagerConfig(e,t){return{part:this,instanceProperties:t,partViewModelId:Je(this),partStateDefinition:this.partDefinition&&this.partDefinition.partState,identityInputs:e}}_listenForPartMutation(){const e=this.partDefinition;let t;const s=this._vm.container;if(!s.mutate||ze(this))return;const o=this.createChildLifetime();s.mutate.subscribe(o,(s=>{const i=this.locator.getExtensionLocator();if(s.partName)t=s.extensionName?we(s.extensionName).withPartType(s.partName):i.withPartType(s.partName);else{const s=e.assetTypeDefinition;if(!s)return void ge.error("Mutate function on part {0} was called with an object but the mutating part doesn't have an asset type definition.".format(this.locator.toString()));t=we(i.name).withPartType(s.partName)}const n={newPartContainerModel:s.containerModel,invoker:"mutation"};this.diContainer.get(O.ReplacePartPortalFunc).invoke({part:this,newLocator:t,options:n},Me).catch((e=>{const s=`Unable to replace provisioning part '${this.locator.toString()}' with the part for the created asset defined by the locator '${t.toString()}'\r\n${e}.`;ge.error(s)})).finally((()=>{this._disposeEditScope(),o.dispose()}))}))}_updateForHasPermissions(e){return this._vmPromise.then((()=>{const s=this._vm;if(s===t.EmptyViewModel||this.isDisposed())ge.warning("Part '{0}' has not retrieved view model when checking permissions.".format(this.locator.toString()));else{const t=s.container,o=this.widget;e?!MsPortalFx.isNullOrUndefined(t.unauthorizedMessage.peek())&&t.unauthorizedMessage(null):(o&&o.options.isInBlockingLoadingState(!1),t.unauthorized(),s.updatePartForUnauthorized())}}))}_getAllInputsSetWatcherConfig(){const t=this.widget,o={bindableTarget:{viewModelName:Je(this)},propertyBindings:this.getInputPropertyBindings(),allInputsSet:this.allInputsSet,calledOnInputsSet:this.calledOnInputsSet,failedOnInputsSet:this.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0,inputsSetCalled:(e,s)=>{let o;s.then((e=>{o=e})).finally((()=>{this._onInputsSet.resolve(o),this._contentRevealed.resolve(!1),this._lastRebindOnInputsSetProperties&&($.isEmptyObject(this._lastRebindOnInputsSetProperties)||_.deepSubset(e,this._lastRebindOnInputsSetProperties))&&t&&t.options.isInBlockingLoadingState(!1)}))},beforeViewModelPropertyUpdate:t=>{if(this.partDefinition.permissions){const o=(0,s.startTimer)(),i=this.locator.toString();return L.checkPermissions(this.partDefinition.permissions,Y.All,t,this.partDefinition.assetType,this.extension.name,this.diContainer,i).then((t=>(this._updateForHasPermissions(t).catch((t=>{this.isDisposed()||MsPortalFx.Errors.isInstanceOfErrorType(t,MsPortalFx.Errors.CanceledError)||(0,a.logToExtension)(e,this.widget.element,2,`Part permission check failed. Error: ${MsPortalFx.getLogFriendlyMessage(t)}`)})),t))).finally((()=>{this._perfData.checkPermissions=o()}))}return Promise.resolve(!0)},getInputsMetadata:1===Ve(this)&&(()=>MsPortalFx.tryImmediateResolve(et(),(e=>{const t=e.getConfigurableInputsMetadata(this);return Object.keys(t).forEach((e=>{const s=t[e];(s&&s.bindingSources||[]).forEach((e=>{delete e.sourceReference}))})),t}))),getDashboardFilters:()=>{const e=this.parent&&this.getPartsContainer();return e&&e.getFilters?e.getFilters():{}},getPartFilters:()=>this.filters||{}};return this.partDefinition&&this.partDefinition.partState&&this._partSettingsManager&&(o.getStateAsync=()=>this._partSettingsManager.getPartSettingsAsync().then((e=>(this._part&&this._part.partSettingFailed(!1),e)),(e=>(this._part&&this._part.partSettingFailed(!0),Promise.reject(FxImpl.createError(`Failed to retrieve part settings for part '${this}'.`,{innerErrors:e})))))),o}_getAdapterAllInputsSetWatcherConfig(){const e=this.adapter;return{bindableTarget:{viewModelName:e.viewModelId},propertyBindings:e.inputPropertyBindings,allInputsSet:e.allInputsSet,calledOnInputsSet:e.calledOnInputsSet,failedOnInputsSet:e.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0}}notifyDetailBladeClosed(e){const t=()=>{const t=e.masterCommandName,s=this._vm.container,o=s&&s.selectable;o&&!he(t)&&o.isCommandSelected(!1)};this.isComposed?t():this.await(7).then(t)}beforeActivateCommandMenuItems(e){e.isControlContextMenu||this._contextMenuViewModels&&(this._contextMenuViewModels.dispose(),this._contextMenuViewModels=null)}_handleRightClick(t,s){const o=s&&s.listData&&s.listData.selectableSet;if(!this.isDisabled&&!this.isDisposed()){const i=o;s.supplyCommands||i&&i._msPortalFxSupplyCommands?ae(this,"./UI.Composition.ContextMenuV2",(e=>{const o={partComposition:this,diContainer:this.diContainer};e.OpenContextMenuPipeline.createPipeline(this.diContainer,this,o,this).startTask({dataItem:s.viewModel,extension:this.extension,contextMenuArgs:s,evt:t})}),e):this._determineExtensionAndTriggerContextMenu(t,s)}}_determineExtensionAndTriggerContextMenu(t,s){const o=this.diContainer,i=this.extension,n=e=>{const t=this._finder.locateAsync(we(e.commandGroupOwner));return t.catch((()=>{ge.error("Could not find extension '{0}' for commandGroup {1} from part in extension {2}.".format(e.commandGroupOwner,e.commandGroup,i.name))})),t},r=(e,i)=>{e.fireContextMenuEvent(this,o,this,i,t,s,this._showShellCommands,this._bladeOpener).then((e=>{this._contextMenuViewModels=e}))};ae(this,"./UI.Composition.ContextMenuContainer.DemandLoad",(e=>{s.commandGroupOwner&&s.commandGroupOwner!==i.name?n(s).then((t=>{r(e,t)})):r(e,i)}),e)}isSelected(){const e=ko.unwrap(this._vm.container).selectable,t=ko.unwrap(e);return t&&ko.unwrap(t.isSelected)}await(e){switch(e){case 0:return this._allContentRevealed;case 1:return this._partDefinitionDeferred.promise;case 2:return this._earlyVmDeferred.promise;case 3:return this._allOnInputsSet;case 5:return this._getPartViewModelCalledDeferred.promise;case 6:return this.await(1).then((()=>{const e=He(this);return 5===(e?.bladeDefinition?_.getBladeType(e.bladeDefinition):0)?this.await(0):this.await(7)}));case 7:return this._registrationDeferred.promise}return super.await(e)}_createErrorPart(t,s){if(this.isDisposed())return Promise.reject(new de);const o=MsPortalFx.getLogFriendlyMessage(s);this._traceErrorTelemetry(t,"string"==typeof s?s:s&&s.message,s);const i=ze(this)&&He(this),n=`Error composing ${i?"blade":"part"} '${i||this}'. Details: ${o}`;let r;r=new V("string"==typeof s?{message:n}:{message:n,innerErrors:s}),t===Re.ErrorAcquiringViewModel||t===Re.ViewModelMissing?(0,a.logToExtension)(e,it(this),2,n):ge.error(n,t,r);const c=y.getPartFactory(this._finder,this.locator,{partKind:te._Internal_Error}),d=(0,U.composePartViewModel)((()=>({message:l.PartError.titleContent,summaryItems:[{label:l.PartError.errorReason,value:Re[t]}],details:o}))),p=this._savedContainerState,u=d.container;return p&&(u.partTitle(p.partTitle),u.assetName(p.assetName)),this._registrationDeferred.reject(s),i&&i.widget.options.loaded(!0),this._createPartWidget(c,d,!0)}_createPartWidget(t,s,o){if(this.isDisposed())return Promise.reject(new de);const i=He(this),n=i&&i.bladeDefinition,r={size:this.widget.options.size,locator:this.locator,getDebugId:()=>Je(this),traceErrorTelemetry:(e,t)=>{this._traceErrorTelemetry(Re.TransitionedToErrorState,e,t)},noFxContentPadding:this.partDefinition&&(this.partDefinition.noFxContentPadding||this.partDefinition.isV2),isVirtualPartForTemplateBlade:n&&1===_.getBladeType(i.bladeDefinition),getTelemetryContextState:n&&_.bladeImplementedWithVirtualPart(n)?()=>i.getTelemetryContextState():()=>this._creationState,partLocation:Ve(this),pinnedBladeDeeplink:this.partDefinition&&this.partDefinition.ignorePinnedDeepLink?void 0:this._pinnedBladeDeeplink};if(o&&this.widget.options.isInBlockingLoadingState(!1),n){const e=e=>{i.menuDeepLink.subscribeAndRun(this._ltm,e.menuDeepLink)};let t;if(n.menuBlade){let o;if(n.menuBlade.isV2){const e=s.content().viewModel;o=e&&e._msPortalFxMenu}else if(n.menuBlade.isMenuView)s.content().menuBladeViewModel.fxAwaitAndRun(this._ltm).then((t=>{const s=t._msPortalFxMenu._msPortalFxData;e(s)}));else{o=s.content().menu}t=o&&o._msPortalFxData}else if(n.tabMenuBlade?.isV2){const e=s.content().viewModel,o=e&&e._msPortalFxTabMenu;t=o&&o._msPortalFxData}t&&e(t)}return MsPortalFx.tryImmediateResolve(t.createPart(this._partContainer[0],s,r,this.diContainer,this),(t=>{if(this.isDisposed())return Promise.reject(new de);this._part=t;const o=(e=!1)=>{this._frameRevealed.resolve(e),this._frameBlockingUi(!1),!e&&this._frameInitialized.resolve(void 0)};if(st(this.partDefinition)&&t.awaitReady){const s=t;s.awaitReady().catch((t=>{const s=i.bladeDefinition?_.getBladeType(i.bladeDefinition):0;2===s||5===s?i.logFrameBladeLoadError(t):q.usingState((()=>{ve.trace({extension:it(this),source:Me,action:"IFramePartReadyTimeout",name:Ae(this.locator),data:{details:t},journeyId:this._getTelemetryJourneyId()})}),this._creationState),(0,a.logToExtension)(e,this.widget.element,2,`A 'ready' message is expected but not received by '${this}'. IFrame should post the 'ready' message to indicate that the IFrame HTML page has loaded and an 'onMessage' handler has been installed to receive subsequent messages. Details: ${MsPortalFx.getLogFriendlyMessage(t)}`)})),s.awaitContentRevealed().then((()=>{o(!0)})),s.awaitInitializationComplete().then((()=>{o()}))}else o();ze(this)||(ko.reactor(this,(()=>{const e=s.container.notFoundMessage();this._part.notFoundMessage(e)})),ko.reactor(this,(()=>{const e=s.container._msPortalFxHandledError();this._part.handledErrorMessage(e)}))),t.setupContent({extensionWindowId:this.extension&&this.extension.name,styleSheets:this.partDefinition?.styleSheets}).finally((()=>{this._contentInitializing(!1)})),ko.computed(this,(()=>{const e=this.parent,t=e&&e.widget,s=t&&t.options.locked();this.widget&&this.widget.options.locked(s),this._part&&this._part.lockedUiContext(s)}))}))}loadPropertiesFromJson(e,t,s=!1,o){const i=ie.bindingsFromJSON,n=t.partState;this.assetInstanceDefinition=t.assetInstanceDefinition,this.bindings=o?Se(o,this):i(e,t.bindings)||[],this.initialSize=t.initialSize,this._bindingsInitialized=t.bindingsInitialized,this._restoredFromJson=!0,this.loadFromJson(t),this._savedContainerState=t.savedContainerState,this.containerModel=F.createContainerModel(t.containerModel),this.overridesModel=F.createContainerModel(t.overridesModel)||{},this.partState=FxImpl.isSerializedObject(n)?FxImpl.fromSerializableObject(n):n,s&&Ze(this.partState),t.originalPartLocator&&(this.previousLocator=j.fromJSON(e,t.originalPartLocator)),this.flags=t.flags||0,this._adapterBindings=i(e,t.adapterBindings)}calculateInitialSize(){let e,t,s,o,i={};const n=this._finder,r=this.locator,a=r.type;if(5===a||7===a){if(n.tryLocate(r,i)){const a=i.value;if(a){const l=a.inline,c=a.reference;if(t=l?l.initialSize:c.initialSize,s=l?l.initialWidth:c.initialWidth,o=l?l.initialHeight:c.initialHeight,l)e=l;else{const t=we(c.extension||r.getExtensionName()).withPartType(c.partTypeName);i={},n.tryLocate(t,i)&&(e=i.value)}}}}else 6===a?(i={},n.tryLocate(r,i)&&(e=i.value)):ge.error("Unable to create Part composition. Invalid locator type: '{0}'".format(a));this._bindingsInitialized=!1;const l=y.getPartSizeOrDefault(e);let c=l;if(ee.PartSize[t])c=t;else if(e&&ee.PartSize[e.initialSize])c=e.initialSize;else if(e){const t=y.getPartFactory(this._finder,this.locator,e);c=t&&void 0!==t.defaultSize?t.defaultSize:l}this.initialSize=c,this.initialSize===se.Custom&&(this.initialWidth=s||e&&e.initialWidth,this.initialHeight=o||e&&e.initialHeight)}getDiagnosticsData(){return $.extend(super.getDiagnosticsData(),{bindings:ie.mapBindingsToFriendlyObjects(this.bindings)})}_getSummaryPartViewModelState(){const e={collapsed:!1};return this.widget.trigger("fxsummarycollapsed",e),e.collapsed}_getEditScopeIdFromSettings(){const e=this._journey,t=e&&e.ambientSettings.getItem(this.journeyPath),s=t&&t.value,o=s&&s.editScope;return o&&o.editScopeId}_setupJourneyEditScopeReactor(){const e=this.partDefinition,t=this._journey;e&&e.editScopeType&&t&&t.observeEditScopeChanges(this,{editScopeId:this.editScopeId,ownerType:this.locator.type,ownerLocatable:this})}_setEditScope(){const e=this.partDefinition;if(!e||!e.editScopeType)return;const t=this._getEditScopeIdFromSettings(),o=this.editScopeId;t?o(t):(o((0,s.getUniqueId)()),this.diContainer.get(M.EditScopeManager).onEditScopeCreated(o()));const i=this.getInputPropertyBindings();if(!i.properties.some((e=>e.targetProperty===Ce))){const e={};e[Ce]=o,i.mapProperty(Ce,Ce).bind(this+"-[EditScopeId]",e,!0)}}_getCommands(){if(!this.isComposed||!this.widget)throw new pe(`Part '${this}' needs to be composed before retrieving its commands.`);return this.widget.options.commands}_setupPromises(){this._onInputsSet=Promise.withResolvers(),this._contentRevealed=Promise.withResolvers(),this._allOnInputsSet=Promise.all([this._onInputsSet.promise,this._frameInitialized.promise]),this._allContentRevealed=Promise.all([this._contentRevealed.promise,this._frameRevealed.promise]).then((([e])=>e)),this._allContentRevealed.then((e=>this.contentRevealed=e))}_setupBladeRebindingHandlers(e){if(e&&e.onRebind){const t=e=>{this._setContainerInputsChanging(!0),this._updateRebindSequenceNumber(),q.provideContext((()=>{this._creationState=q.getState()}),G.Part,this._getPartContext());const t=this.editScopeId()&&this.diContainer.get(M.EditScopeManager).getStateObservable(this.editScopeId()),s=this.widget;if(this._onInputsSet.reject(new ce(`Part binding canceled due to rebinding for part '${this}'`)),this._contentRevealed.reject(new ce(`Part reveal canceled due to rebinding for part '${this}'`)),this._setupPromises(),this._hasRebindableInputs){const t=(this.parent.parent||this.parent).widget;!s||t&&t.options.locked()||s.options.isInBlockingLoadingState(!0),this._lastRebindOnInputsSetProperties=Fe(e,this.bindings,1,""+this),this._setupAdaptedInputsReboundReactor()}if(t&&0===t()&&this.diContainer.get(M.EditScopeManager).onEditScopeDisposed(this.editScopeId()),this.editScopeId(void 0),this._ensureAdapterAtomicityForBindings(),this.bindings.forEach((e=>{if(e.source.scope===ne.DetailsContainer){Ie(this._vm,e.targetProperty).exists&&R.setModelValue(this._vm,e.targetProperty,void 0)}})),this._vm.container.unauthorizedMessage.peek()&&this._vm.container.unauthorizedMessage(null),ze(this)){He(this).setInputsSetPromise(this._onInputsSet.promise)}else this._vm.container.notFoundMessage.peek()&&this._vm.container.notFoundMessage(null)},s=e=>{this.isComposed&&this._setEditScope()},o=()=>{this._setContainerInputsChanging(!1)};e.onRebind(t,s,o),this.registerForDispose((()=>{e.offRebind(t,s,o)}))}}_ensureAssetAffinity(){const e=this.parent&&this.getPartsContainer(),t=this.assetType,s=e&&e.assetType,o=this._part.inContainerOfSameAsset;if(!(e&&s&&t&&s===t&&ko.isObservable(e.assetId)))return o(!1);ko.computed(this,(()=>{const t=e.assetId(),s=this.assetId(),i=t&&s&&v.compareAssetId(t,s);o(i),this._part.assetId(s)}))}_ensureAdapterAtomicityForBindings(){const e=this.adapter;if(!e)return;const t=[];this.bindings.forEach((e=>{const s=e.source;7===s.modelType&&t.push(s.property)})),t.forEach((t=>{R.setModelValue(e.viewModel,t,void 0)}))}_setupAdaptedInputsReboundReactor(){const e=this.adapter;e&&!e.allOutputsReboundComputed&&(e.allOutputsReboundComputed=ko.computed(this,(()=>{if(this.bindings.filter((e=>{const t=e.source.modelType;return 7===t||9===t})).every((e=>{const t=this.bindAdaptedInput(e).sourceModel,s=Ie(t,e.source.property).value;return void 0!==ko.unwrap(s)}))){const t=""+this,s=Fe(e.viewModel,this.bindings,7,t),o=Fe(e.inputPropertyBindings.targetModel,this.bindings,9,t);this._lastRebindOnInputsSetProperties=$.extend(s,o)}})))}_disposeEditScope(){const e=this.editScopeId();if(e){this.diContainer.get(M.EditScopeManager).onEditScopeDisposed(e);const t=this._journey;t&&t.ambientSettings.removeItem(this.journeyPath)}}_setViewStateProperties(e,t){const s=e||[];let o=t||[];o=o.filter((e=>{const t=e.split(".");return!(t.length>1)||(t.pop(),"object"==typeof Ie(this._vm,t.join(".")).value)})),this._viewStateProperties=MsPortalFx.union(s,o);const i=this._vm,n=i&&i.container;n&&n.selectable&&(this._viewStateProperties=MsPortalFx.union(this._viewStateProperties,ye))}_registerInvocationProperty(e){const t=this._bladeOpener;let s;T.detailsIsPartContainer(e)&&(s=ko.pureComputed((()=>!this._vm.container.isSelectable()))),t.registerInvocationProperty(e,s)}_traceErrorTelemetry(e,t,s){const o={details:t,resourceId:this.assetId(),stack:s?.stack?.slice(0,6e3),status:s&&s.status,...s&&s.data||{}};ze(this)?MsPortalFx.tryImmediateResolve(this.diContainer.getAsync(n.get("MsPortalImpl/UI/Compositions/UI.Composition.BladeTelemetry","BladeTelemetry")),(t=>{t.traceBladeLoadErrored(Re[e],o)})):q.usingState((()=>{ve.trace({extension:it(this),source:Me,action:"PartErrored",actionModifier:Re[e],name:Ae(this.locator),data:o,journeyId:this._getTelemetryJourneyId()})}),this._creationState)}_getTelemetryJourneyId(){const e=this._journey;return e&&e.id}recordUserInteraction(){}_tracePartTelemetry(e,t){const s=it(this),o=Ae(this.locator);ve.trace({source:Me,action:e,extension:s,name:o,journeyId:this._getTelemetryJourneyId(),data:t})}}function ze(e){return e.partDefinition&&e.partDefinition.shareVmWithParentBlade}function He(e){const t=e.getPartsContainer();return t&&t.getCompositionType()===_.CompositionType.Blade&&t}function Ue(e){const t=He(e);return!!(t&&t.bladeDefinition&&t.bladeDefinition.locked)}function We(e,t){return t.masterPartId===e.id&&he(t.masterCommandName)}function Ve(e){const t=e.parent&&e.getPartsContainer(),s=t?t.getCompositionType():oe.Unknown;return t?s===oe.Startboard?1:2:0}function je(e,t=!0){let o;return e&&(t&&!e.hasOwnProperty(_.PartContainerModelIdProperty)&&((e=ko.toJS(e))[_.PartContainerModelIdProperty]=(0,s.getUniqueId)()),o=ie.createObservableModel(e)),o}function qe(e,t){let o;return e&&t?(o={},(0,s.forEachKey)(e,(e=>{o[e]=null}))):o=e,FxImpl.toSerializableObject(o)}function $e(e,t,s,o,i,n){const r=e.createChildContainer("composition"),a=new Oe(r,t,null,s,null,null,null,n);return a.registerForDispose((()=>r.disposeAsync())),a.calculateInitialSize(),a.containerModel=je(o),a.overridesModel=je(i||{},!1),a}function Ge(e){const t=N.getGridPixelSize(e.gridWidth(),e.gridHeight());let s=t.height,o=t.width;return e.locked()||(s-=30,o-=30),{height:s,width:o}}function Ke(e,t,s,o,i,n){if(!ot(n)){if(i){const t="content.size",s=Ie(e,t);s.exists&&ko.isObservable(s.value)&&R.setModelValue(e,t,o)}h.requestAnimationFrame((()=>{const i=function(e,t){return N.isFixedSize(t.size())?Ge(t):{height:e.height(),width:e.width()}}(t,s),n=e.container;n.width(i.width),n.height(i.height);const r=n.size();!he(r)&&r.partSize===o&&MsPortalFx.deepEquals(r.dimensions,i)||n.size({partSize:o,dimensions:i})}))}}function Je(e){const t=e.partDefinition,s=e.adapter,o=t&&t.viewModel?t.viewModel:"N/A";return`${e} (${s?`AdapterPart. Extension: ${s.extension.name}, ViewModel: ${s.viewModelName}, Wrapped ViewModel: ${o}`:`ViewModel: ${o}`})`}function Qe(e){const t=e.adapter,s=t.inputPropertyBindings.targetModel;Pe(e.diContainer,e,t.inputPropertyBindings,t.bindings,(t=>(s[t.targetProperty]=ko.observable(),e.bindAgainstOverridesOrContainerModel(t))))}function Xe(e){const t=e.adapter,s=t?t.inputPropertyBindings:e.getInputPropertyBindings(),o=MsPortalFx.find(s.properties,(t=>t.targetProperty===e.assetInstanceDefinition.assetIdInputProperty));return o?Ie(o.sourceModel,o.sourceProperty):null}function Ze(e){"object"==typeof e&&(0,s.forEachKey)(e,((t,s)=>{Te[t]?delete e[t]:"object"==typeof s&&Ze(s)}))}function Ye(t){return ae(void 0,t,(e=>Ee[t]=e),e)}function et(){return Ye(ke)}function tt(){return Ee[ke]}function st(e){return e&&(e.partKind===te.Frame||e.partKind===te._Internal_React)}function ot(e){return e&&e.partKind===te._Internal_React}function it(e){const t=e.getPartsContainer();if(t){if(t.getCompositionType()===oe.Blade)return t.locator.getExtensionName()}const s=e.locator;return s&&s.getExtensionName()}t.Instance=Oe,t.prepareContainerModel=je,t.getSerializableContainerModel=qe,t.create=$e,t.setBladeOpenerModule=function(e){Ee[De]=e},t.setDynamicPartBinderModule=function(e){Ee[ke]=e},t.inferredReferenceType=-999,t.createOverridesOrContainerModelSourceReference=function(e){return{property:e,modelType:t.inferredReferenceType,scope:ne.CurrentContainer,cardinality:R.ReferenceCardinality.OneToOne}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listenForConfigurationChanges=t.getConfigurableInputsMetadata=t.inferInitialBindingsForInputDefinitions=void 0;var r=MsPortalFx.Base.Constants.BladeParameterNames,a=MsPortalFx.Base.Diagnostics,l=MsPortalFx.ViewModels.Internal,c=MsPortalFx.remove,d=MsPortalFx.deepEquals;const p=a.createLog(e),u=9;function m(e){if(e.adapter){const t=g(e),s={};return f(e,!1).forEach((e=>{let o;const i=e.compositionBindingDefinition,n=i&&i.source;if(n&&n.modelType===u){const e=n.property;o=t[e]}o||(o={bindingSources:[],activeBindingSourceName:null}),s[e.targetProperty]=o})),s}return g(e)}function h(e,t){const s=e,o=e,n=o.targetProperty||s.name,r=!!e.optional;if(!t){const e=o.source&&o.source.property||s.name;t=(0,i.createOverridesOrContainerModelSourceReference)(e)}return{targetProperty:n,optional:r,source:t,isDynamicBinding:!0}}function g(e){const t=e.diContainer.get(o.Finder),s=e.parent&&t.findPartsContainer(e),i=e.adapter?e.adapter.inputDefinitions:e.partDefinition.inputDefinitions,r=e.overridesModel,a={};return f(e).forEach((e=>{const t=e.targetProperty,o=(e=>{let t;if(i&&s&&s.getCompatibleSourceReferences){const o=MsPortalFx.find(i,(t=>t.name===e));o&&(t=s.getCompatibleSourceReferences(o))}return(t||[]).map((e=>({sourceReference:e,name:e.property,acceptsValueUpdates:!1})))})(t),l=e.compositionBindingDefinition,c=l&&l.source,d=!(e=>{if(!e||(0,n.isDynamicBindingWithNonLocalSource)(e))return!1;{const t=e.source&&e.source.property;return r&&t&&(0,n.getModelValue)(r,t).exists}})(l)&&c&&MsPortalFx.find(o,(e=>{const t=e.sourceReference;return t.modelType===c.modelType&&t.property===c.property}));a[t]={bindingSources:o,activeBindingSourceName:d&&d.name}})),a}function f(e,t=!0){return e.getNonDetailsContainerPropertyBindings(t).filter((e=>{const t=e.targetProperty;return!l.isBladeCallerInput(t)&&t!==r.EditScopeId}))}t.inferInitialBindingsForInputDefinitions=function(e,t){const s=e.diContainer.get(o.Finder),i=e.parent&&s.findPartsContainer(e);t=t||[];const r=e.overridesModel,a=[];return t.forEach((e=>{const t=e.name;let s;s=(0,n.getModelValue)(r,t).exists?null:(e=>{if(i&&i.getCompatibleSourceReferences){const t=i.getCompatibleSourceReferences(e);return t&&t[0]}})(e),a.push(h(e,s))})),a},t.getConfigurableInputsMetadata=m,t.listenForConfigurationChanges=function(e,t,o){e.getViewModel().internal.updateConfigFn((function(r,a){let l;t&&s.CompositionBinder.turnOnInputsSetSuppressionOn(t),s.CompositionBinder.turnOnInputsSetSuppressionOn(o);try{const{inputs:t,settings:o,inputsMetadata:a}=r,g=e.getSettingsModel(),f=e.partDefinition&&e.partDefinition.partState,x=f?(f.inputIdentityProperties||[]).concat((f.sharedProperties||[]).map((e=>e.property))):[],b=Object.keys(o);let y;x.forEach((e=>{const t=ko.unwrap((0,n.getModelValue)(g,e).value),s=e.startsWith("content.")?e.slice(8):e,i=ko.toJS((0,n.getModelValue)(o,s).value);d(i,t)||((0,n.setModelValue)(g,e,i),l=!0),MsPortalFx.remove(b,s)}));const v=m(e);Object.keys(v).forEach((o=>{const i=v[o],r=a[o],l=t[o];(function(e,t,o,i,r){const a=i&&MsPortalFx.find(o.bindingSources,(e=>e.name===i));if(i&&!a)return void p.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".format(i,t));const l=e.getInputPropertyBindings(),m=MsPortalFx.find(l.properties,(e=>e.targetProperty===t));let g,f,x;if(a){const e=o.activeBindingSourceName;a.name!==e&&(g=!0)}else{const e=ko.unwrap((0,n.getModelValue)(m.targetModel,m.targetProperty).value);d(ko.toJS(r),e)||(f=!0)}if(!g&&!f)return!1;if(e.adapter){const s=MsPortalFx.find(e.bindings,(e=>e.targetProperty===t)),o=s&&s.source,i=o&&o.modelType===u&&o.property;if(!i)return p.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(e.toString(),t)),!1;x=i}else x=t;const b=e.adapter?e.adapter.inputPropertyBindings:e.getInputPropertyBindings(),y=MsPortalFx.find(b.properties,(e=>e.targetProperty===x)),v=y.compositionBindingDefinition,M=e.overridesModel;let C;if(g){const t=e.adapter?e.adapter.inputDefinitions:e.partDefinition.inputDefinitions;C=h(MsPortalFx.find(t,(e=>e.name===x)),a.sourceReference)}f&&((0,n.setModelValue)(M,y.sourceProperty,ko.toJS(r)),C=h(v));if(C){b.removeProperty(y);const t=e.adapter?e.adapter.bindings:e.bindings;c(t,v),s.CompositionBinder.setupPropertyBindings(e.diContainer,e,b,[C],(t=>e.bindAgainstOverridesOrContainerModel(t))),t.push(C),e.adapter&&(l.removeProperty(m),s.CompositionBinder.setupPropertyBindings(e.diContainer,e,l,m&&[m.compositionBindingDefinition],(t=>e.bindAdaptedInput(t))))}return!0})(e,o,i,r.activeBindingSourceName,l)&&(y=!0)})),y&&(e.widgetState.valueHasMutated(),function(e,t){const s=e.widget;s&&s.element.trigger(i.fxpartinputchanged,{part:e,isUserInteraction:t})}(e,e.hasUserInteractedRecently()),e.save())}finally{const e=(l?2:1)|(a?0:4);return Promise.all([t&&s.CompositionBinder.turnOnInputsSetSuppressionOff(t,e,!0)||Promise.resolve(),s.CompositionBinder.turnOnInputsSetSuppressionOff(o,e,!0)])}}))}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(e,t,s){"use strict";var o;return function(e){const t="internal.registeredSelectables",o="internal.registeredSelectableOptions";e.listenForRegistrationChanges=function(e,i,n){const r=i.internal,a=ko.observableArray([]);a.map(e,((e,i)=>{ko.ignoreDependencies((()=>{!function(e,i,n,r){const a=r.getBladeOpener(),l={invocationInputArguments:[{valuesFrom:[{referenceType:0,property:t+"."+i}]}]},c=ko.unwrap(n.registeredSelectableOptions);if(c){const e=c[i];e&&(e.parameterCollector&&s.addCallerBindings(`${o}.${i}.parameterCollector.bladeCaller`,l,0),l.openInContextPane=e.openInContextPane,l.persistentContextPane=e.persistentContextPane)}a.registerInvocationProperty(l,null,e)}(e,i,r,n)}))})),ko.computed(e,r.registeredSelectables,((e={})=>{a.splice.apply(a,[0,a.peek().length].concat(Object.keys(e)))})).extend({deferred:!0})}}(o||(o={})),o})),
define("_generated/MsPortalImpl/Svg/Internal/CopilotMonoline.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 20 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M5.927 2h6.212c1.054 0 1.981.694 2.278 1.705l.469 1.594c.161.546.64.933 1.199.982h.289c.888 0 1.573.252 2.027.768.443.503.589 1.17.599 1.839.019 1.321-.498 2.962-.909 4.268-.358 1.137-.819 2.318-1.436 3.222-.615.901-1.455 1.623-2.582 1.623H7.861a2.375 2.375 0 0 1-2.278-1.705l-.469-1.594a1.376 1.376 0 0 0-1.199-.982h-.29c-.888 0-1.573-.252-2.027-.768-.443-.503-.589-1.17-.599-1.839-.019-1.321.498-2.962.909-4.268.358-1.137.819-2.317 1.436-3.222C3.959 2.722 4.799 2 5.926 2ZM2.862 7.146c-.427 1.357-.879 2.828-.863 3.953.008.554.13.944.349 1.192.207.235.576.429 1.277.429h2.627c.609 0 1.146-.4 1.32-.985.47-1.577 1.266-4.239 1.894-6.276l.033-.107c.149-.484.293-.952.449-1.368.132-.354.281-.691.461-.985H5.927c-.644 0-1.221.402-1.756 1.187-.533.781-.958 1.848-1.308 2.959Zm2.872 6.574c.147.209.263.444.338.699l.469 1.594c.172.585.709.987 1.319.987h.026a.914.914 0 0 0 .754-.378c.167-.227.32-.543.474-.957.145-.386.281-.827.433-1.321l.03-.098.2-.651a2.382 2.382 0 0 1-.742.119H6.41a2.785 2.785 0 0 1-.159.005h-.518Zm2.459-1.005h.843c.553 0 1.047-.33 1.262-.83.437-1.446.871-2.896 1.171-3.905.075-.253.19-.487.337-.694h-.843c-.553 0-1.046.33-1.262.829a959.24 959.24 0 0 0-1.171 3.906c-.075.253-.19.487-.337.694Zm2.029-6.311c.235-.077.485-.119.742-.119h2.626a2.75 2.75 0 0 1 .158-.005h.518a2.36 2.36 0 0 1-.338-.699l-.469-1.594A1.375 1.375 0 0 0 12.14 3h-.015a.915.915 0 0 0-.765.378c-.167.227-.32.543-.474.957-.145.387-.281.827-.433 1.321l-.03.098-.2.65Zm6.916 6.451c.427-1.357.879-2.828.863-3.953-.008-.555-.13-.944-.349-1.192-.207-.235-.576-.429-1.277-.429h-2.627c-.609 0-1.146.4-1.32.985a777.776 777.776 0 0 1-1.894 6.276l-.033.107c-.149.484-.293.952-.449 1.368a5.731 5.731 0 0 1-.461.985h4.483c.644 0 1.221-.402 1.756-1.187.533-.781.958-1.848 1.308-2.959Z'/></g></svg>"}})),
define("MsPortalImpl/UI/Hubs/UI.ActionableNotifications",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Notifications/IrisNotificationsTelemetry","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Services/Services.Copilot","Fx/Experimentation","MsPortalImpl/Base/Languages","FxInternal/AsyncLoader","FxInternal/Weave/Components/Section","FxInternal/Weave/Components/Button","Fx/Composition/Selectable","_generated/MsPortalImpl/Svg/Internal/CopilotMonoline.svg","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.makeActionable=void 0;var b=MsPortalFx.Base,y=b.Images,v=MsPortalFx.Hubs.Notifications,M=FxImpl.Hubs.Notifications,C=v.NotificationStatus,P=M.InternalClientNotification,w=b.Diagnostics.Telemetry.trace,I=b.Diagnostics;const S=x.ActionableNotification.CopilotButton,_=I.createLog(e),F=2e3;function T(e){return"function"==typeof e?.launchCopilot}const k={};async function D(e,t){try{let s=!1;t.prompt?.length>F&&(s=!0);const o=await MsPortalFx.require("Fx/Copilot/Handler");return{promptTrimmed:s,nudgeResult:await e.get(o.Copilot).nudge(s?{...t,prompt:t.prompt.slice(0,F)}:t)}}catch(e){_.warning("Failed to send prompt through copilot nudge",e)}}function E(e,t){const s=function(e){if(Object.keys(k).length)return k;const t=e.get(d.Experimentation),s=(0,c.isCopilotEnabled)(e)&&"en"===p.currentLocaleContext?.selectedDisplayLanguage;return k.checkCopilotActionableErrorNotifications=s&&t.shellAssignments.getBooleanValue("notificationcopilotbuttonactionable"),k.showCopilotButtonForAllErrorNotifications=s,k}(t);if(s.checkCopilotActionableErrorNotifications||s.showCopilotButtonForAllErrorNotifications){try{const o=e.description||"";if(s.checkCopilotActionableErrorNotifications){let s;if(o.includes("Please remove the lock and try again.")?s="ScopeLocked":o.includes("does not have authorization to perform action")&&(s="AuthorizationFailed"),s){const n=/Failed to ([^.]+)\./.exec(o);if(n&&n.length>1){const o=n[1],r=B(e,{id:"copilot-error-actionable",label:S.label,secondary:!0,launchCopilot:async()=>{const n=await D(t,{prompt:`Customer was trying to execute operation (${o}) but ran into '${s}' error. Execute relevant functions to handle this error.`,displayPrompt:`Finding solutions for '${e.title}'`});return w({source:i.Source.UIActionableNotifications,action:i.ActionInternal.CopilotButtonClicked,actionModifier:"ActionableError",data:{operation:o,armErrorCode:s,nudgeResult:n.nudgeResult,promptTrimmed:n.promptTrimmed}}),n.nudgeResult}});return w({source:i.Source.UIActionableNotifications,action:i.ActionInternal.CopilotButtonAdded,actionModifier:"ActionableError",data:{operation:o,armErrorCode:s,buttonAddedTo:r}}),!0}}}if(2===e.status&&s.showCopilotButtonForAllErrorNotifications){const s=B(e,{id:"copilot-error-general",label:S.label,secondary:!0,launchCopilot:async()=>{const s=await D(t,{prompt:`Customer ran into error with ${e.title}. Details: ${o}.`,displayPrompt:`Finding solutions for '${e.title}'`});return w({source:i.Source.UIActionableNotifications,action:i.ActionInternal.CopilotButtonClicked,actionModifier:"AllError",data:{nudgeResult:s.nudgeResult,promptTrimmed:s.promptTrimmed}}),s.nudgeResult}});return w({source:i.Source.UIActionableNotifications,action:i.ActionInternal.CopilotButtonAdded,actionModifier:"AllError",data:{buttonAddedTo:s}}),!0}}catch(e){_.warning("Failed to add copilot button to notification",e)}return!1}}function B(e,t){let s="";return e.inlineForm?.buttons?.length?(e.inlineForm.buttons.push(t),s="inlineFormButtons"):(e.actions||(e.actions=[]),e.actions.push(t),s="notificationActions"),s}function A(e,t){const s=e.openInContextPane?1:8,o=new g.PdlBladeReference(e.blade,e.extension,{parameters:e.parameters||Object.create(null)});t.get(r.BladeOpener).openBlade(o,{flags:s,telemetryName:i.Source.UIActionableNotifications})}function N(e,t,s,r,c,d){const p={disabled:(0,o.makeWritableComputation)(!1),style:(0,o.makeWritableComputation)(0),text:e.label,icon:r,onClick:()=>{if(T(e))return e?.launchCopilot();if(d.bladeRef){const t=e.action;e.openBlade?A(e.openBlade,s):A({blade:t?.parameters?.blade,extension:t?.parameters?.extension,openInContextPane:t?.parameters?.openInContextPane,parameters:t?.parameters?.parameters},s)}else d.deepLink?s.get(a.RoutePortalFunc).invoke({uri:e.deepLink?.uri??e.action,openedByContext:{openedBy:6}}):d.extLink?s.get(l.WindowManager).openWindow(e.externalLink?.uri??e.action):d.pinToDashboard?function(e,t){const s={partReferences:[{partName:e.name||e.partName,parameters:e.parameters||Object.create(null),options:{extensionName:e.extension}}],originExtension:e.extension,notify:!0};(0,u.get)("MsPortalImpl/UI/Dashboard/Common/DashboardPinHelper","pinTilesWithDashboardSelection").then((e=>e(t,i.Source.NotificationHub,null,s)))}(e.pinToDashboard??e.action,s):e.endpoint&&function(e,t,s){s.forEach((e=>e.disabled(!0))),b.Net2.ajax({uri:e.uri,type:e.method,dataType:"json",contentType:"application/json",setAuthorizationHeader:!!e.useArmToken,data:e.body||""}).then((()=>{t.description=e.successMessage,t.status=C.Success})).catch((s=>{t.description=e.failureMessage,t.status=C.Error})).finally((()=>{t.toastDuration=0,t.inlineForm=void 0,P.internalPublish(t)}))}(e.endpoint,c,t);if(4!==c.toastDuration){const t=c.irisNotificationDetails;t?function(e,t,s){(0,n.irisTelemetryHandler)({diContainer:e,messageArg:{irisNotificationDetails:t,action:s},messageContext:null})}(s,t,e.id):w({source:i.Source.ToastTray,action:e.id,data:{notificationId:c.notificationId||c.id}})}}};(e.secondary||e.isSecondary)&&p.style(1),t.push(p)}t.makeActionable=function(e,t){let o=e.inlineForm?.buttons||e.actions||[];if(o.length<3&&(E(e,t),o=e.inlineForm?.buttons||e.actions||[]),!o.length)return e.formSection=void 0,e;let n=o;MsPortalFx.isArrayOrObservableArray(o)&&o.length>3&&(n=o.slice(0,3),w({source:i.Source.ToastTray,action:"TooManyButtons",data:{buttonCount:o.length,notificationId:e.notificationId||e.id}}));const r=[];return n.forEach((s=>{if(!s.label)return;let o,i={bladeRef:!1,deepLink:!1,extLink:!1,pinToDashboard:!1};if(T(s))N(s,r,t,{image:{...f,options:{customClass:"ext-copilot-error-notification-icon"}},position:0},e,i);else{if(function(e){const t=e.action;if(!t)return!1;if("string"==typeof t)return!0;const s=t,o=s.partName&&s.extension&&s.parameters,i=t?.parameters,n=i?.blade&&i?.extension;if(!o&&!n)return!1;return!0}(s)){const n=s.action;return"string"==typeof n?(n.startsWith("#")?i.deepLink=!0:i.extLink=!0,o=i.deepLink?null:{image:y.LaunchCurrent(),position:1}):n.parameters.blade?i.bladeRef=!0:(i.pinToDashboard=!0,o={image:y.Pin(),position:0}),void N(s,r,t,o,e,i)}(function(e){if(!(e.openBlade||e.deepLink||e.externalLink||e.pinToDashboard||e.endpoint))return!1;if(e.openBlade&&(!e.openBlade.blade||!e.openBlade.extension))return!1;if(e.deepLink&&!e.deepLink)return!1;if(e.externalLink&&!e.externalLink)return!1;if(e.pinToDashboard&&(!e.pinToDashboard.extension||!e.pinToDashboard.name))return!1;if(e.endpoint&&(!e.endpoint.uri||!e.endpoint.method||!e.endpoint.successMessage||!e.endpoint.failureMessage))return!1;return!0})(s)&&(s.externalLink?o={image:y.LaunchCurrent(),position:1}:s.pinToDashboard&&(o={image:y.Pin(),position:0}),i={bladeRef:!!s.openBlade,deepLink:!!s.deepLink,extLink:!!s.externalLink,pinToDashboard:!!s.pinToDashboard},N(s,r,t,o,e,i))}})),e.formSection=function(e){return{buttons:e,section:t=>s(m.Section,{className:t,children:[s(m.Section,{children:e.map((e=>s(h.Button,{...e})))})]})}}(r),e}})),
define("MsPortalImpl/UI/Hubs/UI.NotificationManager",["require","exports","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/Hubs/UI.ActionableNotifications","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.NavigationManager","FxInternal/AsyncLoader","FxInternal/Authentication/TokensCommon","FxInternal/Notifications","FxInternal/RpcEndPoints","FxHubs/Helpers/NotificationHelper","Fx/Ajax","Fx/Composition/Selectable","Fx/DependencyInjection","Fx/ResourceManagement","Weave"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M,C,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.getNotificationManager=t.getNotificationData=t.createNotificationManager=t.addNotificationHandler=t.addNotification2Handler=t.updateNotificationHandler=t.showModalNotificationHandler=t.addFxNotificationHandler=t.addClientNotificationsHandler=t.addClientNotificationHandler=t.NotificationHandler=t.NotificationManager=void 0;var w=MsPortalFx.Base,I=w.Constants,S=I.AssetNames,_=w.Diagnostics,F=(_.LogEntryLevel,_.Telemetry),T=M.Container,k=MsPortalFx.Hubs.Notifications,D=k.ClientNotification,E=k.NotificationStatus,B=FxImpl.Hubs.Notifications,A=B.ClientNotificationUriAction,N=FxImpl.NotificationManager;const R=window,L=_.createLog(e),O=r.Source.NotificationHub,z=A.OpenInNewTab,H=I.Shell.toLowerCase(),U="HubsExtension".toLowerCase(),W=MsPortalFx.getLogFriendlyMessage,V=Object.entries,j=Object.keys,q=new WeakMap;let $;const G=e=>(t,s)=>{const o=s.srcWindowId;if(o){MsPortalFx.merge(t).forEach((t=>{const s=o+"#";t.notificationId.startsWith(s)||(t.notificationId=s+t.notificationId),e._addOrUpdateNotification(t,o)}))}};let K=class{constructor(e){this._diContainer=e,this.notifications=ko.observableArray(),this._notificationDefinitions={},this._extensionNotifications={},this._serverEventToNotificationMap={},this._extensionsHeldByCorrelationId={},this._inProgressLookupTable=new Z,this.addNotifications=(e,t)=>{const s=t;s&&this.itemsPromise.finally((()=>{let t=e.notifications.map((e=>this._mapFxNotificationV1ToClientNotification(e)));t=t.filter((e=>!!e)),t.forEach((e=>this._addOrUpdateNotification(e,s)))}))},this.addNotification2=(e,t)=>{const s=t;s&&this.itemsPromise.finally((()=>{const t=this._mapNotificationV2ToClientNotification(s,e.id,e.name,e.status,e.subStatus,e.assetId,e.properties);this._addOrUpdateNotification(t,s)}))},this.updateNotification=e=>{this.itemsPromise.finally((()=>{const t=MsPortalFx.find(this.notifications(),(t=>(t.correlationIds||[]).some((t=>t.toLowerCase()===e.id))));if(t){const s=e.propertyName.toLowerCase(),o=e.propertyValue;let i=t.correlationIds;"correlationid"===s?(i||(t.correlationIds=i=[]),i.push(o),this._addOrUpdateNotification(t)):s==="percentComplete".toLowerCase()&&(t.percentComplete=o,this._addOrUpdateNotification(t))}}))},this.showModalNotification=(e,t)=>{const s=t.notification;return this.addClientNotification(s),e.getAsync(u.DialogManager).then((e=>(this.addClientNotification(s),e.showModalDialog({title:s.title,description:s.description,buttons:2,defaultButtonText:t.primaryButtonText,cancelButtonText:t.secondaryButtonText,showErrorIcon:!0})))).then((o=>{let i;return 4===o?i=t.primaryButtonClickAction:1===o&&(i=t.secondaryButtonClickAction),1===i?this.handleNotificationClick(s):2===i&&e.get(m.WindowManager).redirect({uri:"/",reason:"ModalNotificationClickAction_RefreshPortal"}),o}))},this.addServerEvents=e=>{e.forEach((e=>{e&&this.itemsPromise.finally((()=>{this._addServerEvent(e)}))}))},this._rpcClient=e.get(FxImpl.Rpc.Client),this._pollingNotificationLookupTable=new Y(e),this.itemsPromise=e.get(i.ManifestCache).getManifests("assetTypes",((e,t)=>this._collectNotificationDefinitions(e,t)))}registerCustomNotificationsProvider(e){if(this._diContainer.get(FxImpl.Features).isEnabled("enablecustomnotificationsprovider")){const t=new FxImpl.TriggerableLifetimeManager;this.notifications.subscribeAndRun(t,(t=>{e.notifications(t)}))}}addClientNotification(e){le(e),this._addOrUpdateNotification(e)}showNotificationDetails(e){ae(this._diContainer,ee(e))}handleNotificationClick(e,t){!function(e,t,o){const i=t.isRecommendation?r.ActionInternal.RecommendationClicked:r.ActionInternal.NotificationClicked;re(t,i);const a=t.asset||{},l=a.assetType;if(l){const t=l.toLowerCase(),i=a.extensionName.toLowerCase(),r=e.get(n.ExtensionManager);if(o||!r.getExtension("Microsoft_Azure_Monitoring")||i==="Microsoft_Azure_Billing".toLowerCase()&&t===S.SubscriptionDetail.toLowerCase()||i==="HubsExtension".toLowerCase()&&t===S.Deployments.toLowerCase()){const t={deepLink:(0,s.getAssetDeepLink)(e,a),openedBy:6};return void e.get(c.RoutePortalFunc).invoke({uri:t.deepLink,openedByContext:t},O)}}const d=t.uri;if(d){const s=t.uriAction||w.Resources.isUriAbsolute(d)&&z||A.NavigatePortal;if(s===z)e.get(m.WindowManager).openWindow(d);else if(s===A.OpenInCurrentTab)R.location.href=d;else{const t={deepLink:d,openedBy:6};e.get(c.RoutePortalFunc).invoke({uri:d,openedByContext:t},O)}return}const u=t.linkTo;if(u){if("string"==typeof u){const t={deepLink:u,openedBy:6};return void(u.startsWith("#")?e.get(c.RoutePortalFunc).invoke({uri:u,openedByContext:t},O):e.get(m.WindowManager).openWindow(u))}if(u.parameters?.blade&&u.parameters?.extension){const t=u.parameters?.openInContextPane?1:8,s=new v.PdlBladeReference(u.parameters.blade,u.parameters.extension,{parameters:u.parameters?.parameters});return void e.get(p.BladeOpener).openBlade(s,{flags:t,telemetryName:"NotificationManager.linkTo",context:{openedBy:6}})}if(u.parameters){const t=u.parameters?.openInContextPane?1:8;return void e.get(p.BladeOpener).openBlade(u,{flags:t,telemetryName:"NotificationManager.linkTo",context:{openedBy:6}})}}let h=t.linkedBlade;h||o||(h=ee(t));h&&ae(e,h)}(this._diContainer,e,t)}definitionCount(){return j(this._notificationDefinitions).length}newDefinitionCount(){return j(this._extensionNotifications).length}serverEventsCount(){return j(this._serverEventToNotificationMap).length}removeNotification(e){const t=MsPortalFx.find(this.notifications(),(t=>(t.correlationIds||[]).some((t=>t===e))));t&&this.notifications.remove(t)}_addOrUpdateNotification(e,t){if(e&&ie(e.title)&&function(e){if("string"==typeof e)return!!ie(e);return!!ie(e?.htmlTemplate)}(e.description)){const s=()=>{if(e.clickable=!!(e.asset||e.linkedBlade||e.uri||e.linkTo),function(e){if(e.id)return;e.notificationId||(e.notificationId=D.generateClientNotificationId())}(e),(e.inlineForm?.buttons||e.actions||[]).forEach(((e,t)=>{e.id=e.id||t.toString()})),e.timeSinceNotified||(e.timeSinceNotified=(0,P.makeWritableComputation)(a.NotificationManager.aFewSecondsAgo)),e=function(e,t){if("object"==typeof e.description&&e.description.htmlTemplate)return e;if(null!==e.descriptionAsHtml&&void 0!==e.descriptionAsHtml)return e;const s=e.description;if(s.match(b.htmlTagRegex))return e;const o=(0,b.convertStringToHtml)(s);if(o!==s)return ce(r.ActionInternal.ConvertedLinksInNotificationDescription,null,{correlationIds:e.correlationIds,extensionName:t,id:e.notificationId??e.id}),{...e,descriptionAsHtml:!0,description:{htmlTemplate:o}};return e}(e,t),e.descriptionAsHtml||(e.descriptionAsHtml=!1),e.id||(e.correlationIds||[]).length||(e.correlationIds=[D.generateClientNotificationId()]),!e.correlationIds&&e.id&&(e.correlationIds=[e.id]),e.pollingDetails){if(3!==e.status)return;this._pollingNotificationLookupTable.add(e,t)}3===e.status?this._inProgressLookupTable.add(e.correlationIds):this._inProgressLookupTable.report(e.correlationIds,e.status);let s=this.notifications();const o=MsPortalFx.find(s,(t=>(t.correlationIds||[]).filter((t=>-1!==e.correlationIds.indexOf(t))).length>0));if(o){if(!(o.timestamp.getTime()<e.timestamp.getTime()||3===o.status))return;MsPortalFx.remove(s,o)}s.unshift(e),3!==e.status&&(s=MsPortalFx.stableSort(s,((e,t)=>3===e.status?3===t.status?0:-1:3===t.status?1:t.timestamp.getTime()-e.timestamp.getTime()))),s.length>100&&s.pop(),this.notifications(s),e.isRecommendation&&re(e,r.ActionInternal.RecommendationAdded),t&&(Q(e).extensionName=t,this._holdOntoExtension(t,e))};d.makeActionable(e,this._diContainer),s()}}_addServerEvent(e){if(e.source&&e.operationName){const t=this._serverEventToNotificationMap[se(e.source,e.operationName)];if(t){const s=this._mapNotificationV2ToClientNotification(t.extensionWindowId,e.correlationId,t.notificationName,e.status,e.subStatus,e.assetId,e.properties,e.timestamp,!0);s&&this.addClientNotification(s)}}}_collectNotificationDefinitions(e,t){const s=t.notifications;s&&s.forEach((t=>{const s=se(t.eventSource,t.eventType);this._notificationDefinitions[s]||(this._notificationDefinitions[s]=new X(e,t))}));const o=t.notifications2;o&&o.forEach((t=>{const s=t.name,o=se(e,s);this._extensionNotifications[o]=t;const i=t.serverEvent;if(i&&i.operation&&i.source){const t=se(i.source,i.operation);this._serverEventToNotificationMap[t]={extensionWindowId:e,notificationName:s}}}))}_holdOntoExtension(e,t){const s=t.correlationIds;if(s)if(3===t.status){if(!s.some((e=>!!this._extensionsHeldByCorrelationId[e]))){const t=this._diContainer.get(n.ExtensionManager).getExtension(e);if(t){const o=this._rpcClient.acquireWindow(t.name,6e5);ce(r.ActionInternal.ExtensionExtended,null,{acquireResult:o?.getValue(),extensionAcquireDurationInMs:6e5,extensionName:e}),s.forEach((t=>{this._extensionsHeldByCorrelationId[t]=o,o.onDispose((()=>{this._extensionsHeldByCorrelationId[t]&&(delete this._extensionsHeldByCorrelationId[t],ce(r.ActionInternal.ExtensionDisposed,null,{acquireResult:o?.getValue(),extensionAcquireDurationInMs:6e5,extensionName:e}))}))}))}}}else s.forEach((e=>{const t=this._extensionsHeldByCorrelationId[e];t&&t.dispose()}))}_mapNotificationV2ToClientNotification(e,t,s,o,i,n,a,l,c=!1){const d=this._extensionNotifications[se(e,s)];if(d){let p;const u=d.messages.filter((e=>e.status.toLowerCase()===o.toLowerCase()));if(i?p=MsPortalFx.find(u,(e=>e.subStatus&&e.subStatus.toLowerCase()===i.toLowerCase())):1===u.length&&(p=u[0]),p){let u=p.message;a&&(u=u.format(a));const m={title:p.title,description:u,timestamp:l||new Date,isRecommendation:!1,status:te(p.type),correlationIds:[t],additionalProperties:[],isServerEvent:c};if((p.assetType||d.assetType)&&n){const t=p.assetType||d.assetType;m.asset={extensionName:e,assetType:t,assetId:n}}return ce(r.ActionInternal.ServerEventMappedToNotification,null,{extensionName:e,operationName:(s?.split(".")??[])[1]??s,status:o,subStatus:i,isServerEvent:c}),m}}return null}_mapFxNotificationV1ToClientNotification(e){const t=this._formatNotificationV1FromExtensionManifest(e);if(t){const e={title:t.label,description:t.description,timestamp:t.timestamp,isRecommendation:!1,percentComplete:t.percentOperationComplete,status:t.state,correlationIds:[],additionalProperties:{}},s=t.clientDetails;return t.assetId&&s&&(e.asset={extensionName:s.assetOwner,assetType:s.assetType,assetId:t.assetId}),t.correlationId&&e.correlationIds.push(t.correlationId),t.operationId&&e.correlationIds.push(t.operationId),t.subscriptionId&&(e.additionalProperties.subscriptionId=t.subscriptionId),e}return null}_formatNotificationV1FromExtensionManifest(e){const t=e.eventType,s=e.source;if(s&&t){const o=this._notificationDefinitions[se(s,t)];let i;o?(i=o.notificationDefinition,e.label=i.label,e.description=i.message.format(e.descriptionArgs),i.assetType?e.clientDetails={assetOwner:o.extensionWindowId,assetType:i.assetType}:e.clientDetails=null):(e.label=e.label||t,e.description=e.description||t,e.assetId||(e.clientDetails=null))}return ie(e.label)&&ie(e.description)?e:null}};t.NotificationManager=K,t.NotificationManager=K=__decorate([__metadata("fx:diagnostics",[e,"NotificationManager"]),M.Class(),__metadata("design:paramtypes",[T])],K);let J=class{notificationCallback(e){const t=e.diContainer.get(K);return ne({extensionName:e.messageContext.srcWindowId,action:"NotificationApiCalled",handlerName:"notificationCallback",status:e.messageArg?.status}),G(t)(e.messageArg,e.messageContext)}notificationsCallback(e){const t=e.diContainer.get(K);return ne({extensionName:e.messageContext.srcWindowId,action:"NotificationApiCalled",handlerName:"notificationsCallback",status:e.messageArg?.[0]?.status}),G(t)(e.messageArg,e.messageContext)}fxNotificationCallback(e){const t=e.diContainer.get(K);return ne({extensionName:e.messageContext.srcWindowId,action:"NotificationApiCalled",handlerName:"fxNotificationCallback",status:e.messageArg?.[0]?.status,pollingDetails:e.messageArg?.[0]?.pollingDetails,origin:e.messageArg[1],id:e.messageArg?.[0]?.id}),(e=>(t,s)=>{const o=s.srcWindowId;if(o){const s=t;let i=o;const n=o+"#",r=s.id.indexOf("#");r<0?s.id=n+s.id:i=s.id.slice(0,r),e._addOrUpdateNotification(s,i)}})(t)(e.messageArg[0],e.messageContext)}showModalNotification(e){const t=e.diContainer.get(K);return ne({extensionName:e.messageContext.srcWindowId,action:"DeprecatedNotificationApiCalled",handlerName:"showModalNotification"}),t.showModalNotification(e.diContainer,e.messageArg)}updateNotification(e){const t=e.diContainer.get(K);return ne({extensionName:e.messageContext.srcWindowId,action:"DeprecatedNotificationApiCalled",handlerName:"updateNotification"}),t.updateNotification(e.messageArg)}addNotification2(e){const t=e.diContainer.get(K);return ne({extensionName:e.messageContext.srcWindowId,action:"DeprecatedNotificationApiCalled",handlerName:"addNotification2"}),t.addNotification2(e.messageArg,e.messageContext.srcWindowId)}addNotifications(e){const t=e.diContainer.get(K);return ne({extensionName:e.messageContext.srcWindowId,action:"DeprecatedNotificationApiCalled",handlerName:"addNotifications"}),t.addNotifications(e.messageArg,e.messageContext.srcWindowId)}};function Q(e){let t;return e&&(t=q.get(e),t||q.set(e,t={extensionName:void 0,userVote:(0,P.makeWritableComputation)()})),t}t.NotificationHandler=J,t.NotificationHandler=J=__decorate([__metadata("fx:diagnostics",[e,"NotificationHandler"]),M.Class()],J),t.addClientNotificationHandler=(0,h.defineHandler)(B.addClientNotificationEndpoint,(e=>{e.diContainer.get(J).notificationCallback(e)})),t.addClientNotificationsHandler=(0,h.defineHandler)(B.addClientNotificationsEndpoint,(e=>{e.diContainer.get(J).notificationsCallback(e)})),t.addFxNotificationHandler=(0,h.defineHandler)(x.addFxNotificationEndpoint,(e=>{e.diContainer.get(J).fxNotificationCallback(e)})),t.showModalNotificationHandler=(0,h.defineHandler)(B.showModalNotificationEndpoint,(e=>e.diContainer.get(J).showModalNotification(e))),t.updateNotificationHandler=(0,h.defineHandler)(N.updateNotificationEndPoint,(e=>e.diContainer.get(J).updateNotification(e))),t.addNotification2Handler=(0,h.defineHandler)(N.addNotification2EndPoint,(e=>e.diContainer.get(J).addNotification2(e))),t.addNotificationHandler=(0,h.defineHandler)(N.addNotificationsEndPoint,(e=>e.diContainer.get(J).addNotifications(e))),t.createNotificationManager=function(e){return $=e.get(K)},t.getNotificationData=Q,t.getNotificationManager=function(){return $};class X{constructor(e,t){this.extensionWindowId=e,this.notificationDefinition=t}}class Z{constructor(){this.notificationTable=Object.create(null)}_encode(e){return e.join("~")}add(e){const t=this._encode(e);this.notificationTable[t]||(this.notificationTable[t]=Date.now(),ce(r.ActionInternal.InProgressNotification,r.ActionModifier.InProgressStarted,{createdAt:this.notificationTable[t],ids:t}))}report(e,t){const s=this._encode(e),o=this.notificationTable[s];o&&(ce(r.ActionInternal.InProgressNotification,r.ActionModifier.InProgressFinished,{createdAt:o,duration:Date.now()-o,ids:s,status:t}),this.notificationTable[s]=0)}}class Y{constructor(e){this._diContainer=e,this._notificationTable=Object.create(null),this._trustedDomainsByExtension={},this._securityTokensManager=this._diContainer.get(l.SecurityTokensManager),this._extConfigPromise=this._diContainer.get(i.ManifestCache).getManifests("extensionConfiguration",((e,t)=>this._collectTrustedDomainDefinitions(e,t)));try{const e=JSON.parse(MsPortalImpl.sessionStorage.getItem("NotificationsToPollList")||null)||Object.create(null);if("object"==typeof e){const t=j(e).filter((t=>function(e,t){if(!t)return pe(e,t,"Empty record"),!1;if(!t.originalNotification?.id)return pe(e,t,"original notification / original notification id"),!1;if(!t.uri)return pe(e,t,"uri"),!1;if(!t.extensionName)return pe(e,t,"extension name"),!1;if(!(t.originalNotification.title||"").trim()||!function(e){if(!e)return!1;if("object"==typeof e)return!!(e?.htmlTemplate||"").trim();return!!(e||"").trim()}(t.originalNotification.description))return pe(e,t,"original notification title / description"),!1;(isNaN(t.createdTime)||t.createdTime<0)&&(pe(e,t,"created time"),t.createdTime=0);(isNaN(t.lastTimePolled)||t.lastTimePolled<0)&&(pe(e,t,"last time polled"),t.lastTimePolled=0);(isNaN(t.userTimePassedInMs)||t.userTimePassedInMs<0)&&(pe(e,t,"user time passed in ms"),t.userTimePassedInMs=0);(isNaN(t.lastUserTimeChecked)||t.lastUserTimeChecked<0)&&(pe(e,t,"last user time checked"),t.lastUserTimeChecked=oe());return t.isPolling=!1,!0}(t,e[t])));let s=Object.create(null);j(this._notificationTable).length&&(s=this._notificationTable),this._notificationTable=e,V(s).forEach((e=>{this._notificationTable[e[0]]=e[1]})),this._rehydrateInProgressNotifications(t)}else MsPortalImpl.sessionStorage.removeItem("NotificationsToPollList"),L.warning(`${O}-${r.ActionInternal.PollingNotification}-${r.ActionModifier.FailedToFetchNotificationsFromStorage}`,null)}catch(e){L.warning(`${O}-${r.ActionInternal.PollingNotification}-${r.ActionModifier.FailedToFetchNotificationsFromStorage}`,null,W(e))}setTimeout((()=>{setInterval((()=>{this._cleanOutOldNotifications();const e=this._findNotificationsForPolling();e.length&&this._extConfigPromise.finally((()=>{this._pollNotifications(e)}))}),5e3)}),6e4)}_cleanOutOldNotifications(){const t=oe();j(this._notificationTable).filter((e=>{const s=this._notificationTable[e];if(!s)return!1;const o=s.originalNotification?.pollingDetails?.pollingTimeout?.timeoutInMs??864e5,i=t-s.lastUserTimeChecked;return s.lastUserTimeChecked=t,s.userTimePassedInMs+=i,s.userTimePassedInMs>=864e5||s.userTimePassedInMs>=o})).forEach((t=>{const s=this._notificationTable[t],i={createdTime:new Date(s?.createdTime),extensionName:s?.extensionName,failedAt:new Date,notificationId:t,telemetryName:`${O}-${r.ActionInternal.PollingNotification}-${r.ActionModifier.PollingTimedOut}`,uri:s?.uri};try{const t=JSON.stringify(i);(0,o.logToExtension)(e,s?.extensionName,2,t)}catch{ce(r.ActionInternal.PollingNotification,r.ActionModifier.PollingTimedOut,i)}this._handleFailedPollingAttempt(s,!0),this._notificationTable[t]=null,delete this._notificationTable[t]})),ue(this._notificationTable)}_collectTrustedDomainDefinitions(e,t){const s=/([^:]*)/.exec(R.location.host)[1],o=t?.extensionConfiguration;o?Array.isArray(o[s]?.trustedDomains)?this._trustedDomainsByExtension[e]=o[s].trustedDomains:Array.isArray(o["*"]?.trustedDomains)&&o["*"].trustedDomains.length?this._trustedDomainsByExtension[e]=o["*"].trustedDomains:this._trustedDomainsByExtension[e]=[]:this._trustedDomainsByExtension[e]=[]}_findNotificationsForPolling(){const e=[];return j(this._notificationTable).filter((e=>!!this._notificationTable[e]&&!this._notificationTable[e].isPolling)).forEach((t=>{const s=this._notificationTable[t];s&&function(e,t,s){const o=e>t?e-t:0;s=isNaN(s)?0:Number(s);let i=6e4;e<=12e4?i=5e3:e<=36e4?i=15e3:e<=66e4&&(i=3e4);return s>i?o>=s:o>=i}(s.userTimePassedInMs,s.lastTimePolled,s.originalNotification?.pollingDetails?.customDelayInMs)&&(s.isPolling=!0,e.push(s))})),e}_handleFailedPollingAttempt(t,s){const o=MsPortalFx.clone(t?.originalNotification||Object.create(null),!0,!0),i=o?.pollingDetails||Object.create(null);let n=s?i.pollingTimeout?.failureNotification??i.defaultFailureNotification:i.defaultFailureNotification;if(n){n={...n,status:2};const t=(0,f.createResponseNotification)(o,n);MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{e.publishNotification(t)}))}}_pollNotifications(t){const s={},o=t.map((async e=>{const t=e?.originalNotification?.pollingDetails,o=e?.uri??t?.uri,i=(0,f.isArmUriMatch)(o),n=t?.authDetails;if(!o||i&&n)return de(e,o?"ARM/ARG uri detected, but authDetails were fetched.":"No pollingDetails/uri"),s[e?.originalNotification?.id]=!0,Promise.resolve(null);if(i)return(0,y.batch)({setTelemetryHeader:"PollingNotificationAPI_Polling_Batch",type:"GET",uri:o});let r,a=!1;if(n){const t=n.extensionName;if(!t)return de(e,"Non-ARM/ARG uri detected, but authDetails has no extensionName."),s[e?.originalNotification?.id]=!0,Promise.resolve(null);let i=n.resourceName,l=n.audience;if(!i){const s=await MsPortalEarly.extensionAuthMetadataInPortalConfig??Object.create(null),n=t===H?U:t,r=s[n.toLowerCase()]?.resourceAccessMap??Object.create(null);i=(Object.entries(r).map((e=>{const t=(0,g.isCommonEndPointMatch)(e[1].resource);return t&&t.length?[e[0],(0,g.translateCommonEndpoint)(t[0])]:[e[0],e[1].resource]})).find((e=>{if(o.includes(e[1]))return l=e[1],!0}))??["",""])[0].toLowerCase(),MsPortalFx.extend(e.originalNotification.pollingDetails.authDetails,{extensionName:t,resourceName:i,audience:l})}if(i&&(r=(await this._securityTokensManager.getToken({extensionName:t,isBackground:!1,resourceName:i,skipCache:!1,audience:l}))?.token?.header,!r))return de(e,`Could not fetch a token with extensionName: ${t} and resourceName: ${i}.`,null,i),s[e?.originalNotification?.id]=!0,Promise.resolve(null);if(!(0,f.isShellOrHubs)(t)&&this._trustedDomainsByExtension[t]?.length){a=FxImpl.getDomainValidator([...this._trustedDomainsByExtension[t]],!0).validateDomain(o)}}return(0,y.ajaxExtended)({setTelemetryHeader:"PollingNotificationAPI_Polling_Ajax",type:"GET",uri:o,headers:{"Content-Type":"application/json",...r&&{Authorization:r}},skipDomainValidation:a}).then((e=>({httpStatusCode:e?.jqXHR?.status,content:e?.content,headers:{"Retry-After":e?.jqXHR?.getResponseHeader("Retry-After"),"x-ms-failure-cause":e?.jqXHR?.getResponseHeader("x-ms-failure-cause")}})),(e=>({httpStatusCode:e?.jqXHR?.status,content:e?.jqXHR?.responseJSON??e?.errorThrown,headers:{"Retry-After":e?.jqXHR?.getResponseHeader("Retry-After"),"x-ms-failure-cause":e?.jqXHR?.getResponseHeader("x-ms-failure-cause")}}))).catch((t=>(de(e,`Polling against non-ARM/ARG uri '${o} failed unexpectedly with: '${W(t)}`),s[e?.originalNotification?.id]=!0,null)))}));Promise.allSettled(o).then((e=>{const t=[];return e.forEach((e=>{"rejected"===e.status&&e?.reason?.content?t.push(e.reason):"fulfilled"===e.status&&e?.value?t.push(e.value):t.push(null)})),t})).then((o=>{const i=[];o.forEach(((o,n)=>{const a=t[n]?.originalNotification?.id;if(!o)return i.push(a),void(s[a]||de(t[n],"No response received from polling attempt"));const l=o.httpStatusCode,c=o.content;let d;d="string"==typeof c?l.toString():c?.properties?.provisioningState||c?.status||l.toString();const p=this._notificationTable[a],u=o.headers["Retry-After"],m=1e3*parseInt(u??0);if(m>(p.originalNotification.pollingDetails.customDelayInMs??0)&&(p.originalNotification.pollingDetails.customDelayInMs=m),!p){const e=t[n]||Object.create(null);return void ce(r.ActionInternal.PollingNotification,r.ActionModifier.PollingNotificationNotFound,{code:l,createdTime:new Date(e.createdTime),extensionName:e.extensionName,notificationId:a,uri:e.uri})}p.lastTimePolled=p.userTimePassedInMs;const h=p.originalNotification,g=h.pollingDetails,x=h.pollingDetails;if((g?.keepPollingCodes||[]).includes(l)||(x?.keepPollingStatuses||[]).includes(d))return void(p.isPolling=!1);const b=x?.keepPollingStatuses?(0,f.fetchNotificationPollingResponseDetailsByContentStatus)(x?.responseNotificationByStatus,d):(0,f.fetchNotificationPollingResponseDetailsByStatusCode)(g?.responseNotificationByStatusCode,l);if(b){let t=b.notification;const s=b.requiredResponseValue;let o,n=!0;if(s){if((0,f.checkForContinuedPollingContent)(s,c))return void(p.isPolling=!1);n=(0,f.checkForRequiredContent)(s,c);const e=s.failureNotification;if(!n&&!e)return void(p.isPolling=!1);let o;e&&(o={...e,status:2}),t=!n&&o?o:t}if(o=n?(0,f.createResponseNotification)(h,t,c,p):(0,f.createResponseNotification)(h,t),o)return i.push(a),void MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{e.publishNotification(o)}));const r={...g.defaultFailureNotification,status:2};return o=(0,f.createResponseNotification)(h,r),i.push(a),void MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{e.publishNotification(o)}))}i.push(a),this._handleFailedPollingAttempt(this._notificationTable[a],!1),de(p,`Polling against uri '${p?.uri} failed with unanticipated HttpStatusCode: '${l}', and an x-ms-failure-cause of: ${(o.headers||Object.create(null))["x-ms-failure-cause"]}`,l)})),i.forEach((e=>{this._notificationTable[e]=null,delete this._notificationTable[e]})),ue(this._notificationTable)})).catch((e=>{ce(r.ActionInternal.PollingNotification,r.ActionModifier.PollingError,{error:W(e),extensionNames:t.map((e=>e.extensionName)),notificationIds:t.map((e=>e.originalNotification?.id)),uris:t.map((e=>e.uri))})}))}_rehydrateInProgressNotifications(t){const s=[];t.forEach((t=>{const o=this._notificationTable[t];o?(o.lastUserTimeChecked=oe(),o.isPolling=!1,o.userTimePassedInMs=o.userTimePassedInMs??0,MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{o?.originalNotification?.id&&o.originalNotification.id===t&&e.publishPendingNotification({id:o.originalNotification.id,title:o.originalNotification?.title,description:o.originalNotification?.description,..."linkTo"in o.originalNotification&&{linkTo:o.originalNotification.linkTo},..."actions"in o.originalNotification&&{actions:o.originalNotification.actions},..."percentComplete"in o.originalNotification&&{percentComplete:o.originalNotification.percentComplete},...o.originalNotification.isInternal&&"toastDuration"in o.originalNotification&&{toastDuration:o.originalNotification.toastDuration}})}))):s.push(t)})),s.length&&ce(r.ActionInternal.PollingNotification,r.ActionModifier.FailedToTransferStoredNotification,{ids:s,failedAt:new Date})}add(e,t){const s=e.id;if(this._notificationTable[s])return;const o=e?.pollingDetails?.uri,i=oe();this._notificationTable[s]={createdTime:e?.timestamp.getTime()||i,extensionName:t,isPolling:!1,lastTimePolled:0,lastUserTimeChecked:i,originalNotification:e,uri:o,userTimePassedInMs:0},ce(r.ActionInternal.PollingNotification,r.ActionModifier.PollingRegistered,{createdTime:e?.timestamp,extensionName:t,notificationId:s,registeredTime:this._notificationTable[s].lastUserTimeChecked,uri:o}),ue(this._notificationTable)}}function ee(e){return le(e),FxImpl.ViewModels.getBladeSelection("Microsoft_Azure_ActivityLog","ActivityLogBlade",{queryInputs:{correlatedEvents:{correlationId:e.correlationIds[0],duration:e.timestamp.getMinutes(),subscriptionId:(e.additionalProperties||{}).subscriptionId||null}}})}function te(e){switch(e){case 0:return E.Error;case 1:return E.Warning;case 2:return E.Success;case 3:return E.InProgress;case 4:return E.Information}}function se(e,t){if(e&&t)return`${e}.${t}`}function oe(){return(new Date).getTime()}function ie(e){return e&&e.trim()}function ne(e){ce(e.action,null,{extensionName:e.extensionName,handlerCalled:e.handlerName,origin:e.origin,isPending:e.status&&(3===e.status||e.status===k.NotificationStatus.InProgress),isPolling:!!e.pollingDetails,isExecuteAsyncOp:!!e.pollingDetails?.responseNotificationByStatus,id:e.id})}function re(e,t){let s=e.additionalProperties||{};const o=e.correlationIds,i=e.asset||{};s={...s,status:E[e.status],correlationId:o&&o.join(","),asset:i,notificationId:e.notificationId??e.id},ce(t,null,s)}function ae(e,t){const o=(0,s.getBladeDeepLink)(t.extension,t.detailBlade,t.detailBladeInputs),i={deepLink:o,openedBy:6};e.get(c.RoutePortalFunc).invoke({uri:o,openedByContext:i},O)}function le(e){if(e.additionalProperties||(e.additionalProperties={}),!e.additionalProperties.subscriptionId){const t=e.asset,s=t&&t.assetId,o=C.ArmId.parse(s,!0).subscription;e.additionalProperties.subscriptionId=o}}function ce(e,t,s){F.trace({source:O,action:e,actionModifier:t,data:s??Object.create(null)})}function de(t,s,i,n){const a={createdTime:new Date(t.createdTime),extensionName:t.extensionName,notificationId:t.originalNotification.id,telemetryName:`${O}-${r.ActionInternal.PollingNotification}-${r.ActionModifier.PollingFailed}`,uri:t.uri,...i&&{code:i},...s&&{error:s},...n&&{resourceName:n}};try{const s=JSON.stringify(a);(0,o.logToExtension)(e,t?.extensionName,2,s)}catch{ce(r.ActionInternal.PollingNotification,r.ActionModifier.PollingFailed,a)}}function pe(e,t,s){ce(r.ActionInternal.PollingNotification,r.ActionModifier.IncorrectlyStoredPollingNotificationData,{corruptedValue:s,createdTime:new Date(t?.createdTime),extensionName:t?.extensionName,failedAt:new Date,lastTimePolled:t?.lastTimePolled,lastUserTimeChecked:new Date(t?.lastUserTimeChecked),notificationId:t?.originalNotification?.id,recordId:e,uri:t?.uri,userTimePassedInMs:t?.userTimePassedInMs})}function ue(e){try{const t=JSON.stringify(e);MsPortalImpl.sessionStorage.setItem("NotificationsToPollList",t)}catch(e){ce(r.ActionInternal.PollingNotification,r.ActionModifier.FailedToWriteNotificationsToStorage,{error:W(e)})}}})),
define("MsPortalImpl/Services/Services.AssetManagement",["require","exports","Fx/ResourceManagement","FxHubs/RpcEndPoints","Fx/DependencyInjection","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.ArmEvents","FxInternal/AsyncLoader"],(function(e,t,s,o,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notifyAssetDeletedHandler=t.AssetManager=void 0;const l=MsPortalFx.Base.Diagnostics.createLog(e);let c=class{constructor(e){this.assetTypeService=e,this._assetDeletedCallbacks=$.Callbacks(),this.handleAssetDeletedLocal=(e,t,o,i)=>{i.reason=i.reason||`Received asset deletion notification from the extension '${t}'`;const a=i.assetId,c=i.assetType;if("*Impl_Resource*"===c){s.ArmId.parse(a,!0).resourceType&&this.assetTypeService.mapResourceIdToAssetId(a).then((t=>{this.handleAssetDeleted(t.extensionName,t.assetType,t.assetId,i.reason),e.get(r.ArmEvents).createResourceDeletedEvent([t])})).catch((e=>{0!==(e&&e.message||"").indexOf(n.failedToFindAssetTypePrefix)&&l.warning(e)}))}else this.handleAssetDeleted(o,c,a,i.reason),e.get(r.ArmEvents).createResourceDeletedEvent([{extensionName:o,assetType:c,assetId:a}])}}onAssetDeleted(e){this._assetDeletedCallbacks.add(e)}markAssetDeleted(e,t,s,o){this.handleAssetDeleted(e,t,s,o)}handleAssetDeleted(e,t,s,o){this._assetDeletedCallbacks.fire(e,t,s,o)}};c=__decorate([__metadata("fx:diagnostics",[e,"AssetManagerImpl"]),i.Class(),__metadata("design:paramtypes",[n.AssetTypeService])],c);class d{static create(e){return e}}t.AssetManager=d,__decorate([__metadata("fx:diagnostics",[e,"AssetManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[c]),__metadata("design:returntype",d)],d,"create",null),t.notifyAssetDeletedHandler=(0,a.defineHandler)(o.Events.notifyAssetDeletedDefinition,(e=>{const t=e.messageContext.srcWindowId,s=e.diContainer.get(d);MsPortalFx.makeArray(e.messageArg).forEach((o=>{s.handleAssetDeletedLocal(e.diContainer,t,t,o)}))}))})),
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionAwaiter=void 0;class s{constructor(e,t){this.deferred=Q.defer(),this.targetId=e,this.isSource=t}}t.CompositionAwaiter=class{constructor(e){this._awaitableCompositions=[],this.resolvedCompositions=[],this._trackResolvedCompositions=e}await(e,t){const o=new s(e&&e.toString(),t),i=MsPortalFx.findIndex(this.resolvedCompositions,(e=>t(e)));return i>=0?o.deferred.resolve(this.resolvedCompositions[i]):(this._awaitableCompositions.push(o),e&&e.onDispose((()=>{if(o.deferred.promise.isPending()){o.deferred.reject(new MsPortalFx.Errors.DisposedCanceledError);const e=this._awaitableCompositions.indexOf(o);e>=0&&this._awaitableCompositions.splice(e,1)}}))),o.deferred.promise}resolve(e){let t,s;for(this._trackResolvedCompositions&&(this.resolvedCompositions.push(e),e.onDispose((()=>{const t=this.resolvedCompositions.indexOf(e);t>=0&&this.resolvedCompositions.splice(t,1)}))),t=this._awaitableCompositions.length-1;t>=0;t--)s=this._awaitableCompositions[t],s.isSource(e)&&(s.deferred.resolve(e),this._awaitableCompositions.splice(t,1))}get waitingCompositions(){return this._awaitableCompositions.map((e=>e.targetId))}}})),
define("MsPortalImpl/UI/Dashboard/FiltersSerialization",["require","exports","Fx/Composition/DashboardFilters","FxInternal/Composition/DashboardFilters"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSubstringFilterModel=t.isEqualityFilterModel=t.deserializeFilters=t.serializeFilters=t.getFilterProcessor=void 0;const i={0:"equals",1:"notEquals",2:"contains",3:"notContains",4:"startsWith",5:"notStartsWith",6:"endsWith",7:"notEndsWith"};function n(e){return h["number"==typeof e?e:(0,o.getFilterKindFromId)(e)]}t.getFilterProcessor=n,t.serializeFilters=function(e){const t=e&&Object.keys(e);if(t&&0!==t.length)return t.reduce(((t,s)=>{const o=n(s);return t[s]={model:o.toJSON(o.fromExtensionModel(e[s]))},t}),{})},t.deserializeFilters=function(e){const t=e&&Object.keys(e);if(t&&0!==t.length)return t.reduce(((t,s)=>{const o=n(s),i=o.fromJSON(e[s].model);return t[s]=o.toExtensionModel(MsPortalFx.extend2(i,{selectAllState:void 0})),t}),{})};const r=(()=>{const e=[];return e[0]="auto",e[1]="1m",e[2]="5m",e[3]="15m",e[4]="30m",e[5]="1h",e[6]="6h",e[7]="12h",e[8]="1d",e[9]="7d",e[10]="1mo",e})(),a=(()=>{const e=[];return e[0]="m",e[1]="h",e[2]="d",e[3]="w",e})();function l(e){const t=i[e.operator];if(p(e))return{operator:t,substring:e.substring};const s=e.values;let o=e.selectAllState;switch(MsPortalFx.isNumeric(o)||(o=0),o){case 1:return{operator:t,selectAllState:"intermediate",excludedValues:s};case 0:return{operator:t,values:s};case 2:return{operator:t,selectAllState:"all",values:s}}}function c(e){const t=+MsPortalFx.find(Object.keys(i),(t=>i[+t]===e.operator));if(0!==t&&1!==t)return{operator:t,substring:e.substring,selectAllState:0};const s=e.values||e.excludedValues;let o;switch(e.selectAllState){case"all":o=2;break;case"intermediate":o=1;break;default:o=0}return{operator:t,values:s,selectAllState:o}}function d(e){const{operator:t}=e;return"number"==typeof t&&(0===t||1===t)}function p(e){return!d(e)}function u(e){if(e&&p(e)){const{operator:t,substring:s}=e;return{operator:t,substring:s}}return null}function m(e){if(e&&s.EqualityFilter.isSubstringFilterModel(e)){const{operator:t,substring:s}=e;return{operator:t,substring:s,selectAllState:0}}return null}t.isEqualityFilterModel=d,t.isSubstringFilterModel=p;const h={0:{fromExtensionModel:e=>e,toExtensionModel:e=>e,toJSON:function(e){const t={format:e.format?"local":"utc",granularity:r[e.granularity]};return e.relative?t.relative=`${e.relative.duration}${a[e.relative.timeUnit]}`:t.absolute=e.absolute,t},fromJSON:function(e){const t={format:"local"===e.format?1:0,granularity:function(e){const t=MsPortalFx.findIndex(r,(t=>t===e));return-1!==t?t:0}(e.granularity)},s=e.relative;if(s)t.relative=function(e){if((e=e&&e.trim())&&e.length>1){const t=e.slice(-1),s=MsPortalFx.findIndex(a,(e=>e===t));if(-1!==s){const t=parseInt(e.slice(0,e.length-1));if(MsPortalFx.isNumeric(t))return{duration:t,timeUnit:s}}}}(s);else{const s=e.absolute;s&&(t.absolute={fromDate:new Date(s.fromDate),toDate:new Date(s.toDate)})}return t}},1:{fromExtensionModel:e=>m(e)||{...e,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,values:e.values},toJSON:l,fromJSON:c},2:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.subscriptionIds,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,subscriptionIds:e.values},toJSON:l,fromJSON:c},3:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.locations,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,locations:e.values},toJSON:l,fromJSON:c},5:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.resourceGroupIds,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,resourceGroupIds:e.values},toJSON:l,fromJSON:c},4:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.resourceTypes,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,resourceTypes:e.values},toJSON:l,fromJSON:c}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart",["require","exports","Fx/Composition/DashboardFilters","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Services/Services.EditScopeManagement","Fx/Composition/Selectable","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Widgets/Widgets.Portal.init","FxInternal/Composition/Part"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=t.Instance=t.fxpartfilterschanged=void 0;var b=MsPortalFx.Base.Diagnostics,y=MsPortalFx.Parts.PartKind,v=l.CompositionBinder;const M=window.fx.getTimestamp;t.fxpartfilterschanged="fxpartfilterschanged";const C=b.createLog(e);class P extends d.Instance{constructor(e,t,s,o){super(e,t,s,o&&o.id,null,"StartboardPart",o&&o.pinnedBladeDeeplink),this.partFilterState=ko.observable(0),this._lastUserInteraction=-2e3,this.containerModel={},this._store=4,this._deepLink=o&&o.pinnedBladeDeeplink,o&&o.duringPortalStartup&&(this._dontLoadFilterUpdatingModule=!0),o&&o.savedContainerState&&(this._savedContainerState=o.savedContainerState),o&&o.partHeader&&(this._partHeader=o.partHeader),this.await(7).then((()=>{this._updatePartFilterState(!this._dontLoadFilterUpdatingModule),this._dontLoadFilterUpdatingModule=!1})),this.await(2).then((e=>{w(e)&&e.content.subscribeAndRun(this,(t=>{const s=w(e).updateFilters;s&&s((e=>this.updateFilters(e)))}))})),this._updatableHeaderPromise=this.await(3).then((()=>{if(MsPortalFx.isFeatureEnabled(x.partHeaderEnabledFeatureName)){const{container:e}=this.getViewModel();if(e){const t=e.updatableHeader,s=!!t.options();if(s||e.partTitle())return this._updatableHeader=t,this.getPerfData().updatableHeaderEnabledBy=s?"API":"title",this.getPerfData().updatableHeaderUsed=!!this._partHeader,!s&&t.options({disableSubtitleUpdate:!e.assetName()}),this._partHeader&&this._updateHeader(this._partHeader),t}}}))}clone(){return this.cloneAs(((e,t)=>{const s={overridesModel:t,filters:this.filters,pinnedBladeDeeplink:this._deepLink,savedContainerState:this._savedContainerState},o=I(this.diContainer,this.locator,e,s);return o.defaultMenuItemId=this.defaultMenuItemId,o}))}static fromJSON(e,t,s,n){const r=e.get(o.ExtensionManagerOptions);return d.createCompositionFromJSON(r,t,(()=>{const o=e.createChildContainer("composition"),a=new P(o,i.Locator.fromJSON(r,t.locator),t.widgetState,{id:t.id,duringPortalStartup:n,pinnedBladeDeeplink:t.deepLink});return a.registerForDispose((()=>o.disposeAsync())),a.loadPropertiesFromJson(r,t,!0,s),a._storedEditScopeId=t.editScopeId,a.defaultMenuItemId=t.defaultMenuItemId,a.containerModel=a.containerModel||{},a.filters=u.deserializeFilters(t.filters),a._partHeader=t.partHeader,a}),((s,o)=>{const i=e.createChildContainer("composition"),n=new P(i,s,null,{id:t.id});return n.registerForDispose((()=>i.disposeAsync())),n.unrecoverableErrorMessage=o,n}))}getCompositionType(){return n.CompositionType.StartboardPart}register(e,t,s){super.register(e,t,s);const o=this._part,i=this.editScopeId();i&&this.partDefinition.partKind===y.Provisioning&&this.diContainer.get(m.EditScopeManager).getStateObservable(i).subscribe(this,(e=>{(1===e||2===e)&&this.addWidgetToUI({parentElement:this.getPartsContainer().widget})})),o.openPartSettingsBlade=(e,t)=>{t&&t.stopPropagation(),this.openPartSettingsBlade()},this.partFilterState.subscribe(this,(e=>{o.partFilterState(e)}))}toJSON(){const e=super.toJSON();return e.editScopeId=this.editScopeId(),e.defaultMenuItemId=this.defaultMenuItemId,e.deepLink=this._deepLink,e.filters=u.serializeFilters(this.filters),this._partHeader&&(this._partHeader.title||this._partHeader.subtitle)&&(e.partHeader=this._partHeader),e}validateBindings(e){if(this.bindings&&this.bindings.length>0){const t=this.bindings.filter((e=>e.source.id!==this.id)).map((e=>e.source.property));return v.modelHasProperties(""+this,t,e)}return!0}addWidgetToUI(e){const t=this.widget;Promise.all([this.getDashboardFiltering(),this._updatableHeaderPromise]).then((([e])=>{this._supportsFiltering=e.supportsFiltering,(this._supportsFiltering||this._updatableHeader)&&t.options.commands.push(new p.CustomizeTileData(this,this.diContainer)),c.composeShellCommands(this,this,t.options.commands,!0,this.diContainer)})),super.addWidgetToUI(e),e.doNotSaveSettings||this.save();const s=t.element,o=this._ltm;s&&o&&this.await(1).then((e=>{if(!(this._isFramePart=e&&e.partKind===y.Frame)){const e=function(e,t,s){return e.addEventListener(t,s,!0),{dispose:function(){e&&(e.removeEventListener(t,s,!0),e=null)}}},t=()=>{const e=(0,f.getPortalViewModel)(this.diContainer),t=(e,t)=>{t.masterPartId===this.id&&this.recordUserInteraction()};return e.customEvents.addHandler(o,"fxbladeclosed",t),{dispose:()=>{e.customEvents.removeHandler("fxbladeclosed",t)}}};o.registerForDispose(t()),o.registerForDispose([...["click","mousedown","keydown"].map((t=>e(s[0],t,(()=>this.recordUserInteraction()))))])}}))}hasUserInteractedRecently(){if(this._isFramePart||this._lastUserInteraction+2e3>M())return!0;const e=this.diContainer.get(g.JourneyManager).activeJourney(),t=e&&e.children&&e.children[0];return(t&&t.masterPartId)===this.id}save(e){}_forceSave(e){super.save(e)}_getEditScopeIdFromSettings(){return this._storedEditScopeId}_setupJourneyEditScopeReactor(){}getDashboardFiltering(){return this.await(1).then((e=>({supportsFiltering:e.supportsFiltering,staticFilters:e.filters||[],partApi:this.await(2).then((e=>w(e)))})))}overridesFilter(e){return Object.keys(this.filters||{}).includes(e)}notifyFiltersChanged(e){return this.await(7).then((()=>{this._setContainerInputsChanging(!0);const t=2|(e?4:0),s=this._setContainerInputsChanging(!1,t),o=this._updatePartFilterState(!this._dontLoadFilterUpdatingModule);return Promise.all([s,o])}))}_disposeEditScope(){const e=this.editScopeId();e&&this.diContainer.get(m.EditScopeManager).onEditScopeDisposed(e)}_getBladeOpenerConfig(){const e=super._getBladeOpenerConfig(),t=()=>{const e=this.diContainer.get(r.Finder).findBlades(this.getPartsContainer());return e&&e.length>0&&e[0]},s=this.diContainer.get(g.JourneyManager),o=e.configureBladeDescriptor;return e.configureBladeDescriptor=e=>{o(e),MsPortalFx.startsWith(e.masterInvocationProperty,"container.")&&(e.defaultMenuItemId=this.defaultMenuItemId)},e.onBladesOpening=()=>{this.isDisposed()&&C.error(`Cannot open new blades for part '${this}', it has already been disposed and removed from the starboard. If this part was created from a Hub action, make sure it doesn't change the target blade after it has been opened.`)},e.getCloseOwnedDetailBladesHandler=e=>{let o;const i=e&&e.source&&e.source.property,n=t();return n&&n.masterPartId===this.id&&n.masterInvocationProperty===i&&!n.masterCommandName&&(o=()=>{const e=s.activeJourney();return e?s.tryDiscardJourney(e.id):s.tryDeactivateJourney()}),o},e.getCloseOtherDetailBladesHandler=e=>{let o;const i=e&&e.source&&e.source.property,n=t();return!n||n.masterPartId===this.id&&n.masterInvocationProperty===i||(o=()=>{const e=s.activeJourney();if(e)return e.isStartedWithContextBlade()?s.tryDiscardJourney(e.id):s.tryDeactivateJourney()}),o},e}_updatePartFilterState(e){const t=this.parent&&this.getPartsContainer();return t&&t.getDashboardFiltersForPart(this.id,e).then((e=>{const t=this.filters||{};e=e||{};let o=0;const i=Object.keys(t),n=Object.keys(e);if(i.length>0||n.length>0)if(0===i.length)o=1===n.length&&n.includes(s.TimeRangeFilter.filterId)?1:2;else{const i=[];for(const s in t)e[s]&&!this._deepEquals(t[s],e[s])&&i.push(s);o=0===i.length?n.length>1||!n.includes(s.TimeRangeFilter.filterId)?2:1:i.includes(s.TimeRangeFilter.filterId)&&1===i.length?3:4}this.partFilterState(o)}))}updateFilters(e){const t=this.parent&&this.getPartsContainer();if(!t)return Promise.reject(new Error("Only Parts located on Dashboards can call 'updateFilters'"));let s,o;Array.isArray(e)?s=e.reduce(((e,t)=>(e[t.filterId]=t.filterModel,e)),{}):e.dashboard||e.part?(s=e.dashboard,o=e.part):s=e;let i=!1;return o&&(i=this._updatePartFilters(o)),s?t.updateFilters(this,s):(i&&this.notifyFiltersChanged(!0),Promise.resolve())}_updatePartFilters(e){const s=MsPortalFx.clone(this.filters||{},!0,!0),o=Object.keys(e);for(let t=0;t<o.length;t++){const i=o[t],n=e[i];n?s[i]=n:delete s[i]}return!MsPortalFx.deepEquals(this.filters,s)&&(this.filters=s,this.widget.element.trigger(t.fxpartfilterschanged,{part:this,isUserInteraction:this.hasUserInteractedRecently()}),!0)}_getTelemetryJourneyId(){}recordUserInteraction(){this._lastUserInteraction=M()}openPartSettingsBlade(){const e=!!this._updatableHeader,t=e?this._getPartHeader():void 0;this.getViewModel().container.openContextPane(new h.PdlBladeReference("PartSettingsBlade","HubsExtension",{onClosed:(s,o)=>{if(o){if(this._supportsFiltering){const e={};Object.keys(o.filters).forEach((t=>{e[t]=o.filters[t]&&u.getFilterProcessor(t).toExtensionModel(o.filters[t])})),this._updatePartFilters(e),this.notifyFiltersChanged(!1)}if(e&&o.partHeader){const e=o.partHeader;e.title===t.title&&e.subtitle===t.subtitle||(this._tracePartTelemetry("PartUpdatableHeaderChanged"),this._updateHeader(e,!0),this.widget.element.trigger("fxpartsettingchanged",{part:this,isUserInteraction:!0}))}}},parameters:{partId:this.id,partHeader:t}}))}_getPartHeader(){const{title:e,subtitle:t}=this._partHeader||{},s={title:e},o=this._updatableHeader?.options;return(!o||!o()?.disableSubtitleUpdate)&&(s.subtitle=t||""),s}_updateHeader({title:e,subtitle:t},s){const o=this._getPartHeader();o.title=e;const i=this._updatableHeader.options;!i()?.disableSubtitleUpdate&&(o.subtitle=t),this._partHeader=o,this._updatableHeader.updatedHeader(o),s&&this.widget.element.trigger(d.fxpartsettingchanged,{part:this,isUserInteraction:!0})}getConfigureOnAddToDashboardSelectorAsync(){return this.getViewModelAsync().then((e=>{const t=a.getModelValue(e,"content.configureOnAddToDashboardSelector");if(t.exists)return ko.unwrap(t.value)}))}_deepEquals(e,t){if(e=ko.unwrap(e),t=ko.unwrap(t),e===t)return!0;if(!e||!t)return!1;const s=MsPortalFx.getTypeOf(e);if(s!==MsPortalFx.getTypeOf(t))return!1;switch(s){case"array":{const s=e;return e.length===t.length&&s.every((e=>{let s=!1,o=0;for(;o<t.length;){if(this._deepEquals(t[o],e)){s=!0;break}o++}return s}))}case"date":return e.getTime()===t.getTime();case"object":{const s=Object.keys(e);return s.length===MsPortalFx.keysLength(t)&&s.every((s=>this._deepEquals(e[s],t[s])))}default:return!1}}}function w(e){return e.chrome&&e.chrome._msPortalFxV2ShellApi()}function I(e,t,s,o){o=o||{};const i=e.createChildContainer("composition"),n=new P(i,t,null,o);return n.registerForDispose((()=>i.disposeAsync())),n.calculateInitialSize(),n.modelContainsSensitiveData=o.modelContainsSensitiveData,n.containerModel=d.prepareContainerModel(s||{}),n.filters=o.filters,n.overridesModel=d.prepareContainerModel(o.overridesModel||{}),n.validateBindings(s)||(C.error("Unable to create instance of startboard part '{0}', check log for errors.".format(t.toString())),n.locator.name="##INVALID##"),o.doNotSaveSettings||n.save(),n}t.Instance=P,t.create=I})),
define("MsPortalImpl/UI/UI.DashboardFiltersManager",["require","exports","Fx/Composition/DashboardFilters","Fx/ResourceManagement","FxInternal/Composition/DashboardFilters","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Languages","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Services/Services.Subscriptions"],(function(e,t,s,o,i,n,r,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResourceGroupId=t.normalizeResourceGroupId=t.ResourceTypeFilterRuntime=t.ResourceGroupFilterRuntime=t.LocationFilterRuntime=t.SubscriptionFilterRuntime=t.EqualityFilterRuntime=t.EqualityFilterRuntimeBase=t.DashboardFiltersManager=t.getStaticFilterId=t.getCultureSpecificLanguage=t.isCompleteFilterModel=t.intrinsicFilterDescriptors=void 0;var d=MsPortalFx.Base,p=d.Diagnostics,u=d.Diagnostics.Telemetry;const m=p.createLog(e);function h(e){return e.get(c.SubscriptionsUserContext).inSessionSelectedSubscriptions}function g(e,t){if(!t)return!1;let s=!1;switch(e){case 0:{const e=t;s=e.absolute&&!!e.absolute.fromDate&&!!e.absolute.toDate||e.relative&&MsPortalFx.isNumeric(e.relative.duration)&&MsPortalFx.isNumeric(e.relative.timeUnit),e.absolute&&(s=e.absolute.toDate&&e.absolute.fromDate<e.absolute.toDate);break}case 1:case 2:case 3:case 5:case 4:{const e=t;s=MsPortalFx.isNumeric(e.operator);break}}return s}function f(e){const t=e&&e.selectedDisplayLanguage||"",s=e&&e.selectableDisplayLanguages||[],o=MsPortalFx.find(s,(e=>!MsPortalFx.localeCompareIgnoreCase(e.locale,t)));return o&&o.specificCulture||"en-us"}function x(e){const{filterKind:s}=e;return t.intrinsicFilterDescriptors[s]?t.intrinsicFilterDescriptors[s].filterId:e.filterId}t.intrinsicFilterDescriptors=[{kind:0,filterId:s.TimeRangeFilter.filterId,displayText:n.Filtering.Intrinsics.timeRange},{kind:2,filterId:s.SubscriptionFilter.filterId,displayText:n.Filtering.Intrinsics.subscription},{kind:3,filterId:s.LocationFilter.filterId,displayText:n.Filtering.Intrinsics.location},{kind:5,filterId:s.ResourceGroupFilter.filterId,displayText:n.Filtering.Intrinsics.resourceGroup},{kind:4,filterId:s.ResourceTypeFilter.filterId,displayText:n.Filtering.Intrinsics.resourceType}].reduce(((e,t)=>(e[t.kind]=t,e)),[]),t.isCompleteFilterModel=g,t.getCultureSpecificLanguage=f,t.getStaticFilterId=x;t.DashboardFiltersManager=class{constructor(e,t){this._diContainer=e,this._filtersLocale=ko.observable(),this._appliedFilters=ko.observableArray(),this._currentSessionLocale=f(r.currentLocaleContext),this._equalityFilterRuntimes=[],this._parent=t,this._filtersLifetime=t.createChildLifetime();const s=this._diContainer,o=this._subscriptions={getSelectedSubscriptions:()=>s.get(c.SubscriptionsUserContext).getInSessionSelectedSubscriptions().then((e=>e())),selectedSubsUpdateTriggered:h(s)};this._equalityFilterRuntimes[1]=new y,this._equalityFilterRuntimes[2]=new v(o),this._equalityFilterRuntimes[3]=new M,this._equalityFilterRuntimes[5]=new C(o),this._equalityFilterRuntimes[4]=new P;const i=ko.observableArray([]),n=i.mapInto(t,((e,t)=>{const s=ko.observable();return d.Promises.cancelOnDispose(this._filtersLifetime,t.getDashboardFiltering&&t.getDashboardFiltering()).then((e=>{e.partApi.then((t=>{s({supportsFiltering:e.supportsFiltering,supportsAddFilter:e.staticFilters.some((e=>0!==e.filterKind))||t&&!!t.getDynamicFilterDefinitions})}))})),s}));t.subscribeChildren((e=>{i(e.map((e=>e)))})),this.filtersWidgetViewModel={showDashboardFilteringUi:MsPortalFx.isFeatureEnabled("dashboardautorefresh")?ko.observable(!0):ko.pureComputed((()=>!!this._appliedFilters().length||n().some((e=>e()&&e().supportsFiltering)))),showAddFilterUi:ko.pureComputed((()=>n().some((e=>e()&&e().supportsAddFilter)))),appliedFilters:this._appliedFilters,createDashboardFilterViewmodel:()=>this._createDashboardFilterViewModel({}),getFilterUpdatingApi:()=>this._getFilterUpdatingApi().then((e=>e.filtersWidgetViewModel))},i.subscribeArrayBulkChanges(this._parent,((e,t)=>{t&&t.length&&t.forEach((e=>{this._appliedFilters.peek().forEach((t=>MsPortalFx.remove(t.filteredPartIds,e.id)))}))}));const a=ko.pureComputed(i).extend({throttle:100}),l=ko.pureComputed(this._appliedFilters).extend({throttle:100});ko.reactor(this._parent,[a,l],((e,t)=>(this._isFilterUpdatingModuleLoadingOrLoaded()?this._getFilterUpdatingApi().then((e=>e.getAllFilterDescriptors(!0).then((e=>e.map((e=>e.filterId)))))):(()=>{const t=[];return Promise.allSettled(e.map((e=>this._getPartStaticFilters(e).then((e=>{MsPortalFx.pushUnique(t,e)}))))).then((()=>t))})()).then((e=>{this._ensureTimeRangeFilter(e),t.forEach((t=>{const s=e.includes(t.id())||t.filteredPartIds&&t.filteredPartIds.length>0;t.isApplicable(s)}))}))))}updateFilters(e,t){return this._getFilterUpdatingApi().then((s=>s.updateFilters(e,t)))}getFilters(){return this._appliedFilters.peek().filter((e=>{const t=e.model();return 2!==t.selectAllState||t.values&&0===t.values.length})).reduce(((e,t)=>{const s=t.id(),o=t.model(),i=t.kind();return"string"==typeof s&&g(i,o)&&(e[s]=this.toExtensionModel(i,o)),e}),{})}loadDashboard(e){this.resetFilters(),this._filtersLocale(e&&e.filterLocale||this._currentSessionLocale);const t=e&&e.filters||{},s=Object.keys(t),o=s.map((e=>{const s=((e,t)=>({kind:(0,i.getFilterKindFromId)(e),model:(0,a.getFilterProcessor)(e).fromJSON(t.model),displayCache:t.displayCache,filteredPartIds:t.filteredPartIds}))(e,t[e]),o=s.kind;if(!g(o,s.model))return;const n=this._createDashboardFilterViewModel({id:e,model:s.model,kind:o,filterIdDisplayText:s.displayCache.name,filterValueDisplayText:s.displayCache.value,filteredPartIds:s.filteredPartIds});return this._activateFilter(n),n})).filter((e=>!!e));this._appliedFilters.push(...o),u.trace({source:"DashboardFilters",action:"DashboardFiltersLoaded",data:{filterIds:s.toString()}})}setFilters(e){this._filtersLifetime||(this._filtersLifetime=this._parent.createChildLifetime());const t=Object.keys(e).map((t=>{const s=e[t];return this._createDashboardFilterViewModel({id:t,model:this.fromExtensionModel(s.filterKind,s.filterModel),kind:s.filterKind})}));this._appliedFilters(t)}toJSON(){return this._appliedFilters().length?this._getFilterUpdatingApi().then((e=>e.toJSON())):Promise.resolve({})}getDashboardFiltersForPart(e,t){if(t||this._isFilterUpdatingModuleLoadingOrLoaded())return this._getFilterUpdatingApi().then((t=>t.getDashboardFiltersForPart(e)));{const t=MsPortalFx.find(this._parent.children,(t=>t.id===e));if(!t){const t=new Error("Error retrieving dashboard filters for part '{0}'. Part could not be found.".format(e));return m.error(t),Promise.resolve({})}return this._getPartStaticFilters(t).then((t=>this._appliedFilters.peek().filter((s=>s.filteredPartIds.includes(e)||t.includes(s.id()))).reduce(((e,t)=>(e[t.id()]=this.toExtensionModel(t.kind(),t.model()),e)),{})))}}getFilterValues(e,t,s){return this._getFilterUpdatingApi().then((o=>o.getFilterValues(e,t,s)))}getFilterIdTextAndOperators(e,t){return this._getFilterUpdatingApi().then((s=>s.getFilterIdTextAndOperators(e,t)))}getFilterValueDisplayText(e,t,s){return this._getFilterUpdatingApi().then((o=>o.getFilterValueDisplayText(e,t,s)))}getFiltersSupportedByPart(e){return this._getFilterUpdatingApi().then((t=>t.getFiltersSupportedByPart(e)))}getFilterWarning(e,t){return this._equalityFilterRuntimes[(0,i.getFilterKindFromId)(e)].getFilterWarning(t)}_createDashboardFilterViewModel(e){const t=this._filtersLifetime.createChildLifetime();return{id:ko.observable(e.id),kind:ko.observable(e.kind),kindLifetime:t,model:ko.observable(e.model),isApplicable:ko.observable(!0),filterIdDisplayText:e.filterIdDisplayText,filterValueDisplayText:e.filterValueDisplayText,warningMessage:ko.observable(""),filteredPartIds:e.filteredPartIds||[]}}_ensureTimeRangeFilter(e){const t=this._appliedFilters.peek(),o=MsPortalFx.find(t,(e=>e&&0===e.kind())),i=e.includes(s.TimeRangeFilter.filterId);!o&&i&&d.Promises.cancelOnDispose(this._filtersLifetime,this._getFilterUpdatingApi()).then((e=>e.addTimeRangeFilter()))}resetFilters(){this._filtersLifetime&&this._filtersLifetime.dispose(),this._filtersLifetime=this._parent.createChildLifetime(),this._appliedFilters([])}dispose(){this._filtersLifetime&&this._filtersLifetime.dispose()}toExtensionModel(e,t){return(0,a.getFilterProcessor)(e).toExtensionModel(MsPortalFx.extend2(t,{selectAllState:void 0}))}fromExtensionModel(e,t){return(0,a.getFilterProcessor)(e).fromExtensionModel(t)}_activateFilter(e){const{kind:t,kindLifetime:s}=e,o=t();0!==o&&this._equalityFilterRuntimes[o].activateFilter(s,e)}_normalizeEqualityFilterValue(e,t){return this._equalityFilterRuntimes[e].normalizeFilterValue(t)}_getFilterUpdatingApi(){return this._filterUpdatingModulePromise||(this._filterUpdatingModulePromise=d.Promises.cancelOnDispose(this._parent,MsPortalFx.require("MsPortalImpl/UI/UI.DashboardFiltersManager.Updating").then((e=>(this._parent.widget&&this._parent.widget.element.attr("data-filterupdatingloaded",!0),new e.DashboardFiltersUpdatingImpl(this._diContainer,this._parent,{appliedFilters:this._appliedFilters,getDashboardLifetime:()=>this._filtersLifetime,activateFilter:e=>this._activateFilter(e),createDashboardFilterViewModel:e=>this._createDashboardFilterViewModel(e),ensureTimeRangeFilter:e=>this._ensureTimeRangeFilter(e),normalizeEqualityFilterValue:(e,t)=>this._normalizeEqualityFilterValue(e,t),subscriptions:this._subscriptions})))))),this._filterUpdatingModulePromise}_isFilterUpdatingModuleLoadingOrLoaded(){return!!this._filterUpdatingModulePromise}_getPartStaticFilters(e){return d.Promises.cancelOnDispose(this._filtersLifetime,e.getDashboardFiltering()).then((e=>e.staticFilters.map(x)))}};class b{activateFilter(e,t){}getFilterWarning(e){return Promise.resolve("")}}t.EqualityFilterRuntimeBase=b;class y extends b{normalizeFilterValue(e){return e}}t.EqualityFilterRuntime=y;class v extends b{constructor(e){super(),this._subscriptions=e}activateFilter(e,t){ko.reactor(e,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(()=>this.getFilterWarning(t.model()).then((e=>{t.warningMessage(e)}))))}normalizeFilterValue(e){return e.toLowerCase()}getFilterWarning(e){return 0!==e.selectAllState||(0,a.isSubstringFilterModel)(e)?Promise.resolve(""):this._subscriptions.getSelectedSubscriptions().then((t=>!e.values.some((e=>!t.some((t=>t.subscriptionId.toLowerCase()===e.toLowerCase()))))?"":n.Filtering.Subscription.subscriptionFilterUsingExcludedSubscriptions))}}t.SubscriptionFilterRuntime=v;class M extends b{constructor(){super()}normalizeFilterValue(e){return e}}t.LocationFilterRuntime=M;class C extends b{constructor(e){super(),this._subscriptions=e}activateFilter(e,t){ko.reactor(e,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(()=>{this.getFilterWarning(t.model()).then((e=>{t.warningMessage(e)}))}))}getFilterWarning(e){return 0!==e.selectAllState||(0,a.isSubstringFilterModel)(e)?Promise.resolve(""):this._subscriptions.getSelectedSubscriptions().then((t=>!e.values.some((e=>{const s=I(e),{subscription:o}=s;return!t.some((e=>e.subscriptionId.toLowerCase()===o.toLowerCase()))}))?"":n.Filtering.ResourceGroup.resourceGroupFilterUsingExcludedSubscriptions))}normalizeFilterValue(e,t){return w(e,t)||e}}t.ResourceGroupFilterRuntime=C;class P extends b{constructor(){super()}normalizeFilterValue(e){const{resourceType:t,resourceKind:s}=e,o={resourceType:t.toLowerCase()};return s&&(o.resourceKind=s.toLowerCase()),o}}function w(e,t){const s=I(e,t);return s&&o.ArmId.stringify(s,4)}function I(t,s,i){const n=o.ArmId.parse(t,!0);if(4===n.kind)return n;if(!i){const o=new Error(`Invalid resource group id '${JSON.stringify(t)}'`);s?(0,l.logToExtension)(e,s.widget.element,2,o):m.error(o)}}t.ResourceTypeFilterRuntime=P,t.normalizeResourceGroupId=w,t.parseResourceGroupId=I})),
define("MsPortalImpl/Weave/LazyControls",["require","exports","MsPortalImpl/Weave/Util"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LazyNotice=t.LazyInfoBox=t.LazyCustomHtml=t.LazyPillCollection=t.LazyCheckBox=t.LazyTextBox=t.LazySection=void 0,t.LazySection=(0,s.createControlLazyComponentForKO)((()=>MsPortalFx.require("MsPortalImpl.Controls/Fields/Section"))),t.LazyTextBox=(0,s.createControlLazyComponent)((()=>MsPortalFx.require("MsPortalImpl.Controls/Fields/TextField"))),t.LazyCheckBox=(0,s.createControlLazyComponent)((()=>MsPortalFx.require("MsPortalImpl.Controls/Fields/CheckBoxField"))),t.LazyPillCollection=(0,s.createControlLazyComponent)((()=>MsPortalFx.require("MsPortalImpl/Controls/Controls.PillCollection"))),t.LazyCustomHtml=(0,s.createControlLazyComponentForKO)((()=>MsPortalFx.require("MsPortalImpl.Controls/Fields/CustomHtmlField"))),t.LazyInfoBox=(0,s.createControlLazyComponentForKO)((()=>MsPortalFx.require("MsPortalImpl/Controls/Controls.InfoBox"))),t.LazyNotice=(0,s.createControlLazyComponentForKO)((()=>MsPortalFx.require("MsPortalImpl/Controls/Controls.Notice")))})),
define("_generated/MsPortalImpl/Svg/Library/Copy.svg",["require","exports"],(function(e,t){"use strict";return{type:338,data:"<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14 6.3V16H4v-3H0V0h6.7l3 3h1zM4 3h4.3l-2-2H1v11h3zm9 4h-3V4H5v11h8zm-2-1h1.3L11 4.7z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/CaretDown.svg",["require","exports"],(function(e,t){"use strict";return{type:286,data:"<svg viewBox='0 0 14.7 8.1' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m.7 0 6.7 6.6L14 0l.7.7-7.3 7.4L0 .7.7 0z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Share.svg",["require","exports"],(function(e,t){"use strict";return{type:324,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m14.9 10.4.4.4.4.5a1.4 1.4 0 0 1 .2.6 1.3 1.3 0 0 1 .1.6 3.6 3.6 0 0 1-.2 1 3.5 3.5 0 0 1-.5.8l-.8.5-1 .2a2 2 0 0 1-1.3-.4 5.4 5.4 0 0 1-2 1A5.4 5.4 0 0 1 8 16a5.7 5.7 0 0 1-2.2-.4 5.4 5.4 0 0 1-2-1 2 2 0 0 1-1.3.4l-1-.2-.8-.5a3.5 3.5 0 0 1-.5-.8 3.6 3.6 0 0 1-.2-1 1.3 1.3 0 0 1 .1-.6 1.4 1.4 0 0 1 .2-.6l.4-.5c.1-.2.3-.3.4-.4a1.7 1.7 0 0 0-.1-.7V9a7.6 7.6 0 0 1 .3-2.1A6.6 6.6 0 0 1 2.2 5l1.5-1.5a5.2 5.2 0 0 1 1.8-1 3 3 0 0 1 .2-1 2.2 2.2 0 0 1 .5-.8L7 .2 8 0l1 .2.8.5a2.2 2.2 0 0 1 .5.8 3 3 0 0 1 .2 1 5.2 5.2 0 0 1 1.8 1L13.8 5a6.6 6.6 0 0 1 .9 1.9A7.6 7.6 0 0 1 15 9v.7a1.7 1.7 0 0 0-.1.7zM1 12.5a1.3 1.3 0 0 0 .1.6l.3.5.5.3h1.2l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3H1.9l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6zM8 15a5.7 5.7 0 0 0 1.8-.3 4.8 4.8 0 0 0 1.6-.8l-.3-.7a1.5 1.5 0 0 1-.1-.7 3.6 3.6 0 0 1 .2-1 3.5 3.5 0 0 1 .5-.8l.8-.5 1-.2h.4a3.4 3.4 0 0 0 .1-1 5.7 5.7 0 0 0-.3-1.8 4.1 4.1 0 0 0-.7-1.5 4.9 4.9 0 0 0-1.2-1.3 3.8 3.8 0 0 0-1.5-.9l-.4.6c-.1.2-.3.3-.5.5l-.7.3H7.3l-.7-.3-.5-.5-.4-.6a3.8 3.8 0 0 0-1.5.9A4.9 4.9 0 0 0 3 5.7a5.1 5.1 0 0 0-.7 1.5A5.7 5.7 0 0 0 2 9a3.4 3.4 0 0 0 .1 1h1.1l.9.5a2.7 2.7 0 0 1 .7.8 4.3 4.3 0 0 1 .2 1.2 1.5 1.5 0 0 1-.1.7l-.3.7a4.8 4.8 0 0 0 1.6.8A5.7 5.7 0 0 0 8 15zM8 1h-.6l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6 1.3 1.3 0 0 0 .1.6l.3.5.5.3h1.2l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3zm5.5 13h.6l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3h-1.2l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6 1.3 1.3 0 0 0 .1.6l.3.5.5.3z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.StartBoard.Component",["require","exports","Weave/DirectMode","Weave","WeaveDOM/DirectRender/DataAttribute","Fx/Composition/Selectable","FxInternal/Weave","FxInternal/Weave/Components/Button","FxInternal/AsyncLoader","FxInternal/Weave/Util","_generated/MsPortalImpl/Svg/Startup/CaretDown.svg","_generated/MsPortalImpl/Svg/Library/Copy.svg","_generated/MsPortalImpl/Svg/Startup/Share.svg","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Weave/LazyControls","MsPortalImpl/Widgets/Widgets.DropMenu.Component","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.Portal"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StartBoardInner=void 0;var C=MsPortalFx.Base.Images,P=MsPortalFx.Base.Diagnostics.Telemetry;async function w(e,t,i,n){const[r,a]=await Promise.all([MsPortalFx.require("MsPortalImpl/UI/Dashboard/UI.DashboardCommands"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.CommandBar")]);return s(o.GetContext,{fn:l=>s(o.LifetimeManagerScoped,{fn:o=>{const c=l.diContainer,d=a.CommandBar;if(i){const i=r.initializeFullScreenCommandBar(o,c,e,t);return s(d,{className:["fxs-startboard-commandBar-fullScreen az-noprint",{"az-display-none":e.headerMode.compose((e=>2===e))}],vm:i})}if(n){const t=r.initializeOrganizeModeCommandBar(o,e);return s(d,{className:"fxs-startboard-commandBar-organize az-noprint",vm:t})}const p=r.initializeCommandBar(o,c,e,t);return s(d,{className:["fxs-startboard-commandBar az-noprint",{"az-display-none":e.headerMode.compose((e=>2===e))}],vm:p})}})})}async function I(e,t){const i=await MsPortalFx.require("MsPortalImpl/UI/Dashboard/UI.DashboardCommands");return s(o.GetContext,{fn:o=>{const n=o.diContainer.get(i.OpenBrowseDashboardsPane);return s("li",{className:["fxs-startboard-dropdown-item","fxs-startboard-dropdown-browseall","fxs-portal-hover"],role:"menuitem"},s("div",{className:"fxs-startboard-dropdown-subscriptions"},e.subscriptionsInfo),s("a",{tabindex:"-1",href:"#",className:"fxs-startboard-button-browse fxs-portal-text-primary",afterMount:e=>{t(n,e)},onClick:({event:e})=>{e.preventDefault(),n.execute(!1)}},g.Dashboard.browseAll))}})}function S(e,t){P.trace({source:"StartBoard",action:e,data:t})}t.StartBoardInner=function(e){const{vm:t,commandContextBinder:P}=e,_=(0,r.toComputation)(ko.observable(MsPortalFx.isFeatureEnabled("transformdashboard"))),F=t.headerMode.compose((e=>{const t=["fxs-startboard-header"];return 1===e?t.push("fxs-startboard-header-normal"):2===e&&t.push("fxs-startboard-header-migration"),t.join(" ")}));let T;return{focusOnDropMenu:()=>{T&&T.setFocus()},tsxNode:s(o.GetContext,{fn:e=>{const k=e.diContainer,D=k.get(M.ViewModel),E=D.displayMode.compose((e=>"Dashboard"===e)),B=t.title,A=t.isShared,N=`${g.Dashboard.sharedDashboard} | ${g.Dashboard.readOnlydDashboard}`,R=(0,o.composeComputation)([A,t.userPermissions],((e,{canModify:t})=>e?t?g.Dashboard.sharedDashboard:N:g.Dashboard.privateDashboard)),L=k.get(h.FullScreenMode),O=k.get(f.DesktopManagerMode).value,z=(0,r.toComputation)(O).compose((e=>1===e));return s(o.Fragment,null,s(o.Once,{"data-odebug":"17",condition:E,trueFn:()=>{return s(o.Fragment,null,s("div",{className:"fxs-startboard-loadanimation"},s("div",{className:"fxs-splashscreen-loader-container fxs-loading5dots-container"},s("div",null),s("div",null),s("div",null),s("div",null),s("div",null))),s("div",{className:F},s("div",{className:"fxs-startboard-title-next"},s("div",{className:"fxs-startboard-title-content"},s(o.If,{condition:A,concealmentBehavior:"remove",trueFn:()=>s("div",{className:"fxs-startboard-button-icon az-noprint",image:u})}),s("div",{className:"fxs-startboard-title",title:B},B)),s("div",{className:["fxs-startboard-subtitle",{"fxs-startboard-subtitle-shared":A}]},R)),s("div",{className:"fxs-startboard-header-item fxs-startboard-dropdown",afterMount:(e,s)=>{T=new v.Widget($(e),t.dashboardDropMenuViewModel,!0,!0),s.registerForDispose((()=>{T.dispose(),T=null}))}},s(y.DropMenuInner,{button:s("div",{className:"fxs-startboard-dropdown-button fxs-portal-hover"},s("div",{className:"fxs-startboard-title-container"},s(o.If,{condition:A,concealmentBehavior:"remove",trueFn:()=>s("div",{className:"fxs-startboard-button-icon az-noprint",image:u})}),s("div",{className:"fxs-startboard-title",title:B},B),s("div",{className:"fxs-startboard-button-icon az-noprint",image:C.CustomImageWithOptions(d,{palette:99})})),s("div",{className:["fxs-startboard-subtitle",{"fxs-startboard-subtitle-shared":A}]},R)),content:s("div",{className:"fx-dropmenu-dropdown"},s("ul",{className:"fxs-dropmenu-list-system",role:"menu","aria-label":g.Dashboard.recentMenuLabel},s(o.If,{condition:t.dashboardList,concealmentBehavior:"remove",trueFn:()=>s(o.Fragment,null,s(o.If,{condition:t.dashboardList.compose(c.isEmptyArray),concealmentBehavior:"remove",trueFn:()=>s("li",{className:"fxs-startboard-dropdown-item",role:"menuitem",tabindex:"-1"},s("div",{className:"fxs-dropmenu-list-content"},g.Dashboard.emptynext))}),s(o.ForEach,{collection:t.dashboardList,fn:({item:t})=>{const o=-1===t.id.indexOf("private");return s("li",{className:["fxs-startboard-dropdown-item","fxs-startboard-dropdown-dashboard","fxs-portal-hover","msportalfx-tooltip-overflow"],role:"menuitem",tabindex:"-1","aria-label":t.title+(o?" "+g.Dashboard.sharedStatusLabel:""),data:t,onClick:e,onKeyDown:e},s("div",{className:"fxs-dropmenu-list-content fxs-startboard-item-container"},s("div",{className:"fxs-startboard-item-icon fxs-portal-svg",image:o?u:null}),s("div",{className:"fxs-startboard-item-title"},t.title)))}})),falseFn:()=>s("li",{className:"fxs-startboard-dropdown-item",role:"menuitem",tabindex:"-1"},s("div",{className:"fxs-tile-progress-transparent fxs-loading5dots-container"},s("div",null),s("div",null),s("div",null),s("div",null),s("div",null)))}),s(o.PromiseFragment,{"data-odebug":"p12",promise:I(t,P)}))),vm:t.dashboardDropMenuViewModel})),s("input",{type:"text",className:"fxs-startboard-header-item fxs-startboard-title-edit fxs-hide-in-normal",maxlength:200,value:B,"aria-label":g.Dashboard.titleLabel,onValueChange:({value:e})=>t.title(e),onBlur:({event:e})=>{$(e.target).trigger("fxstartboardtitlechanged")}}),s(o.Once,{"data-odebug":"18",condition:(0,r.toComputation)(L.isActive),trueFn:()=>s(o.PromiseFragment,{"data-odebug":"p13",promise:w(t,P,!0)})}),s("div",{className:"fxs-startboard-header-item fxs-startboard-migration",role:"menubar"},s("button",{type:"button",role:"menuitem",className:"fxs-startboard-button fxs-startboard-button-migrate fxs-portal-hover",title:g.Dashboard.migrate,tabindex:"0",onClick:({event:e})=>{$(e.currentTarget).trigger("fxmigratestartboard")}},s("div",{className:"fxs-startboard-button-icon","aria-hidden":"true",image:C.CustomImageWithOptions(p,{palette:99})}),s("div",{className:"fxs-startboard-button-text"},g.Dashboard.migrate))),s(o.Once,{"data-odebug":"19",condition:D.topBar.newDashboardSaveEnabled,trueFn:()=>function(e,t){const i=g.Dashboard.Actions,n=(0,o.composeComputation)([t,e.dashboardChanged],((e,t)=>e||t)),r=(0,o.composeComputation)([t,e.userPermissions,e.dashboardChanged],((e,{canModify:t},s)=>s||e&&!t)),l=(0,o.composeComputation)([t,e.dashboardChanged],((e,t)=>e&&t)),c=e.userPermissions.compose((({canModify:e})=>e?i.save:i.saveCopy));return s("div",{className:"fxs-startboard-actions"},s(a.Button,{className:"fxs-startboard-actions-save",text:c,style:0,visible:r,loading:e.dashboardSaveInProgress,onClick:()=>{const t=e.userPermissions.value.canModify,s=t?1:2;S(t?"DashboardPublish":"DashboardSaveACopy"),e.finishDashboardEdit(s,"StartBoard")}}),s(a.Button,{className:"fxs-startboard-actions-preview",text:i.preview,style:1,visible:l,onClick:()=>{S("CustomizeModeExited",{dashboardChanged:!!e.dashboardChanged.value}),e.exitOrganizeMode()}}),s(a.Button,{className:"fxs-startboard-actions-cancel",text:i.cancel,style:1,visible:n,onClick:()=>{S("DashboardDiscard"),e.finishDashboardEdit(3)}}))}(t,z)})),s(o.PromiseFragment,{"data-odebug":"p14",promise:w(t,P)}),s("div",{className:"fxs-startboard-filter",afterMount:(e,s)=>{if(t.filtersWidgetViewModel){const o=s.createChildLifetime();t.filtersWidgetViewModel.showDashboardFilteringUi.subscribeAndRun(o,(i=>{i&&(o.dispose(),l.get("MsPortalImpl/Widgets/Widgets.DashboardFilters","Widget").then((o=>{s.registerForDispose(new o($(e.parentElement),t.filtersWidgetViewModel,k))})))}))}}}),s("div",{className:"fxs-startboard-customize-header fxs-hide-in-normal"},s(o.If,{condition:z,trueFn:()=>s(o.PromiseFragment,{"data-odebug":"p15",promise:w(t,P,!1,!0)})}),s("div",{className:"fxs-startboard-customize-description"},g.Dashboard.editDescription)),s(o.If,{condition:(0,o.composeComputation)([t.userPermissions,z],(({canModify:e},t)=>t&&!e)),trueFn:()=>s(o.LifetimeManagerScoped,{fn:e=>s(b.LazyInfoBox,{className:"fxs-startboard-warning",vm:t=>t.createVm(e,{style:4,text:g.Dashboard.readOnlyWarningMsg,ariaLabel:g.Dashboard.readOnlyWarningMsg})})})}),s(o.If,{condition:t.dashboardErrorMessage.compose(c.isNonEmptyString),trueFn:()=>s(o.LifetimeManagerScoped,{fn:e=>s(b.LazyInfoBox,{className:"fxs-startboard-error",vm:s=>s.createVm(e,{style:5,text:(0,r.toObservable)(e,t.dashboardErrorMessage),ariaLabel:(0,r.toObservable)(e,t.dashboardErrorMessage)})})})}),s(o.If,{condition:_,concealmentBehavior:"remove",trueFn:()=>{const e=()=>{MsPortalFx.require("MsPortalImpl/UI/UI.BladeOpenerImpl").then((e=>{const s=e.BladeOpener;return t.diContainer.get(x.GetCurrentDashboardPropertiesPortalFunc).invoke(null,"ShellCommands").then((e=>{const o=new n.PdlBladeReference("Dashboards.ReactView","Microsoft_Azure_PortalDashboard",{parameters:{id:e.originalId||e.id,isV1:!0}});return t.diContainer.get(s).openBlade(o,{flags:8,telemetryName:"UI.DashboardCommands:TransformDashboard"})}))}))};return s(o.LifetimeManagerScoped,{fn:t=>s(b.LazyInfoBox,{className:"fxs-startboard-info",vm:s=>s.createVm(t,{style:1,canClose:!0,text:{htmlTemplate:"<span data-bind='text: message'></span> <a data-bind='text: tryText, fxclick: onClick'></a>",viewModel:{message:g.Dashboard.transformDashboard,tryText:g.Dashboard.tryV2,onClick:e}},ariaLabel:g.Dashboard.transformDashboard})})})}}));function e(e){const s=e.event;if("keydown"===s.type&&(13!==s.keyCode&&32!==s.keyCode||0!==(0,m.getModifierKeys)(s)))return;const o=(0,i.getElementData)(s.currentTarget);s.preventDefault(),s.stopPropagation(),t.switchDashboard&&t.switchDashboard(o).then((()=>{if(T){const e=T.element,t=Math.min(Math.max(e.outerWidth()+50,400),560);e.find(".fxs-dropmenu-content").css({minWidth:t})}})),t.dashboardDropMenuViewModel.close()}}}),s("div",{className:"fxs-startboard-layout fxs-flowlayout"},s(o.Once,{"data-odebug":"20",condition:(0,r.toComputation)(D.inOrganizeMode),trueFn:()=>{const e=t.flowLayoutOptions.resolutionGuidesOffset,i=e.y+"px",n=e.x+"px";return s(o.Fragment,null,[{x:3840,y:2160},{x:1920,y:1080},{x:1440,y:900},{x:1366,y:768},{x:1024,y:768}].map((e=>s("div",{className:`fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-${e.x}x${e.y} fxs-hide-in-normal`,style:{top:i,left:n}}))))}}),s("div",{className:"fxs-flowlayout-childcontainer",style:{height:t.flowLayoutOptions.childContainerHeight,width:t.flowLayoutOptions.childContainerWidth}})),s("div",{className:"fxs-startboard-message-container"},s("div",{className:"fxs-startboard-message-title"},g.Dashboard.NotFound.title),s("div",{className:"fxs-startboard-message-body"},t.notFoundMessage)))}})}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/UI.DashboardFiltersManager","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Parts/Parts","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.StartBoard.Component"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M,C,P,w,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvePartReference=t.getPinPartOptions=t.Instance=t.isStartboardPartKey=t.fxstartboardsettingchanged=void 0;var S=MsPortalFx.Base.Diagnostics,_=S.Telemetry,F=p.ReferenceScope,T=MsPortalFx.Parts,k=T.PartSize;const D=S.createLog(e);t.fxstartboardsettingchanged="fxstartboardsettingchanged",t.isStartboardPartKey=function(e){return e!==i.desktopSettingsKey&&e!==i.startBoardSettingsKey&&!MsPortalFx.startsWith(e,d.partIdentityStatePrefix)};const E=i.startBoardSettingsKey;class B extends a.Instance{constructor(e){super(E,e,null,[],null,E),this._diContainer=e,this._partAwaiter=new l.CompositionAwaiter(!0),this._containerAwaiter=new l.CompositionAwaiter,this.masterContainer=null,this.notFound=ko.observable(!1),this.containerType=0,this.eligibleForBinding=!1,this._browser=e.get(M.Browser),this._store=4,this.registerForDispose(this.dashboardFiltersManager=new m.DashboardFiltersManager(e,this))}static create(e){return new B(e)}getCompositionType(){return r.CompositionType.Startboard}setGetDashboard(e){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=e}removeGetDashboard(){this._getDashboard=null}getDashboard(){const e=this._getDashboard;return e?e():null}onDetailContainersChanged(){}getDeepLink(){return Promise.resolve("")}toJSON(){const e=super.toJSON(),t=this._getDashboard?this._getDashboard():null;if(t){e.dashboardId=t.id,e.dashboardTitle=t.title;const s=t.model;e.dashboardModel=s?{model:ko.toJS(s.model),metadata:MsPortalFx.clone(s.metadata,!0)}:void 0}return delete e.children,e}getInputPropertyBindings(){throw new Error("Unreachable code")}getViewModel(e){let t;if(8===(e=MsPortalFx.isNullOrUndefined(e)?8:e)){const e=this._getDashboard&&this._getDashboard().model;if(!e)throw new Error("There is no current Dashboard.");t=e.model}return t||{}}getViewModelAsync(e){return Promise.resolve(this.getViewModel(e))}getCompatibleSourceReferences(e){const t=this._getDashboard&&this._getDashboard().model,s=t&&t.metadata;if(s){const t=e.type;if(t){return Object.keys(s).filter((e=>s[e]===t)).map((e=>({property:e,modelType:8,scope:F.CurrentContainer,cardinality:p.ReferenceCardinality.OneToOne})))}}return null}getFilters(){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFilters()}updateFilters(e,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.updateFilters(e,t)||Promise.resolve()}getDashboardFiltersForPart(e,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getDashboardFiltersForPart(e,t)||Promise.resolve({})}getFilterIdsForPart(e){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFiltersSupportedByPart(e)}setFilters(e){return this.dashboardFiltersManager&&this.dashboardFiltersManager.setFilters(e)}getPartInstance(e){return MsPortalFx.find(this.children,(t=>t.id===e))}_compose(e,s){const i=this.diContainer,n=this.createChildLifetime(),a=e.options,l=a.getStartBoardArea(),c=new x.ViewModel(this.id,this.widgetState(),this.dashboardFiltersManager&&this.dashboardFiltersManager.filtersWidgetViewModel,function(e,t){const s=[],i=new g.EnterOrganizeMode(e,t,!0);return i.text(o.Dashboard.edit),s.push(new g.ResetStartBoardCommand(e,t),i,new g.ExitOrganizeMode(e,t)),s}(n,i),a.startboardLoading,a.startboardNotFound,this.diContainer),d=this._getDashboard?this._getDashboard().title:null;d&&c.title(d);const{focusOnDropMenu:p,tsxNode:u}=(0,I.StartBoardInner)({vm:c,commandContextBinder:(e,t)=>{e.bind(new h.CompositionInstanceCommandContext(t,null,this))}});(0,w.applyToElement)({element:l[0],ltm:this,weaveNode:u,weaveContext:{diContainer:i},opName:"Startboard"}),this.widget=new x.Widget(l,c,p),l.data(r.CompositionInstanceDataName,this),this.widget.ltm.registerForDispose([n,l.setEvents([b.Widget.viewSettingsChanged,(e,s)=>{e.stopPropagation(),this.widgetState(s),l.trigger(t.fxstartboardsettingchanged)}],["fxunpin",(e,t)=>{const s=MsPortalFx.find(this.children,(0,r.getIdMatchFunc)(t.tileId));if(s){const e=this.widget;D.warning("Part '{0}' is about to be removed due to user unpin operation.".format(s)),this.removeTile(s),setTimeout((()=>{const t=this.diContainer.get(f.ViewModel),s=t.topBar.newDashboardSaveEnabled.value?e.element.find(".fxs-startboard-actions-save .fxs-button"):t.topBar.getWidget().element.find(".fxs-topbar-dashboard-save .fxs-button");s?s.focus():e.setFocus()}),50)}}])]),s.resolve()}removeTile(e,t){if(e){let s;const i=this._diContainer.get(y.JourneyManager),r=i.activeJourney();r&&r.originTile===e&&(s=r.id);const a=e.editScopeId()&&this._diContainer.get(n.EditScopeManager).getStateObservable(e.editScopeId()),l=!a||0===a()||2===a(),c=!s||i.canDiscardJourney(s),d=t&&t.force||l&&c;(d||this._browser.confirm(o.Desktop.confirmEditScopeDiscard))&&(s&&i.forceDiscardJourney(s),e.clearIdentitySettings(),this.removeChild(e,!1,t&&t.skipSave),d||D.warning("Part '{0}' is removed from the start board.".format(e)))}}resetLayout(e){return this.diContainer.get(v.ResetDashboardPortalFunc).invoke({duringPortalStartup:!1,force:e},"Dashboard")}clearStartboard(e){this.dashboardFiltersManager&&this.dashboardFiltersManager.resetFilters(),this.children.slice().forEach((e=>this.removeTile(e,{force:!0,skipSave:!0}))),!e&&this.save()}dispose(){super.dispose(!0)}get journeyPath(){return[]}getComposedParts(){return this._partAwaiter.resolvedCompositions}awaitComposedPart(e,t){return this._partAwaiter.await(e,t)}notifyPartComposed(e){this._partAwaiter.resolve(e)}awaitContainer(e,t){return this._containerAwaiter.await(e,t)}notifyContainer(e){this._containerAwaiter.resolve(e)}onInvocationStarted(){}getDiagnosticsData(){const e=this.diContainer.get(c.Finder).findBlades(this);return $.extend(super.getDiagnosticsData(),{detailBlades:e.map((e=>e+""))})}createStartBoardPart(e,t,o){if(!e)return void D.error("options should be specified for adding a part to the startboard.");if(!e.locator)return void D.error("options.originPartLocator should be specified for adding a part to the startboard.");let i={locator:e.locator,newBindings:void 0};e.ignoreRedirects||(i=L(this._diContainer.get(s.DefinitionFinder),e.locator,e.telemetryAction));const n=e.model,r=u.create(this._diContainer,i.locator,n,{modelContainsSensitiveData:e.modelContainsSensitiveData,filters:e.filters,pinnedBladeDeeplink:e.deepLink,duringPortalStartup:t});i.newBindings&&(r.getInstanceBindings=()=>i.newBindings);const a=e.defaultMenuItemId;return a&&(r.defaultMenuItemId=a),T.PartSize[e.initialSize]&&(r.initialSize=e.initialSize,e.initialSize===T.PartSize.Custom&&(r.initialHeight=e.initialHeight,r.initialWidth=e.initialWidth)),r}pinPartReferences(e,t){const o=e.map((e=>N(this._diContainer.get(s.DefinitionFinder),e,t,"PinPartReferences").then((e=>this.createStartBoardPart(e)))));return Promise.allSettled(o).then((e=>e.map((e=>"fulfilled"===e.status?e.value:void 0))))}pinBladeToStartboard(e){const t=e.locator.getExtensionLocator(),o=this.diContainer.get(s.DefinitionFinder);return A(e,o,t.name).then((t=>{const{locator:s,newBindings:i}=L(o,t.locator,t.telemetryAction);return o.locateAsync(s).then((()=>{const o=u.create(this._diContainer,s,t.model,{filters:t.filters,pinnedBladeDeeplink:e.deepLink});i&&(o.getInstanceBindings=()=>i);const{initialSize:n,initialHeight:r,initialWidth:a}=t;return T.PartSize[n]&&(o.initialSize=n,n===k.Custom&&(o.initialHeight=r,o.initialWidth=a)),o.defaultMenuItemId=t.defaultMenuItemId,o}))}))}clonePartToStartboard(e){return e.cloneAs(((t,s)=>u.create(this.diContainer,e.locator,t,{overridesModel:s,filters:e.filters})),!0).then((t=>{const o=R(this.diContainer.get(s.DefinitionFinder),e.locator,e.partDefinition);if(P.isVariableSize(t.initialSize)&&o&&o.length>0){const e=MsPortalFx.find(o,(function(e){return P.isFixedSize(e)}));if(!(null!==e&&e>=0))throw FxImpl.createError("Requested tile size for pinning not supported");t.initialSize=e,t.widgetState().NormalState.size=e}return t})).catch((t=>{const s=FxImpl.createError("Pin Part to Startboard Failed: The target part could not pinned. Part: {0}".format(e.toString()),{innerErrors:t});throw D.error(s),s}))}}function A(e,t,o){let i;if(e.onPin)i=e.onPin().then((e=>N(t,e,o,"Blade.onPin")));else{const n=e.locator;i=t.locateAsync(n).then((t=>{const i=t.pinnedPartExtension||o;return{locator:s.Locator.forExtension(i).withPartType(t.pinnedPart),model:(t.inputs||[]).concat(t.optionalInputs||[]).reduce(((t,s)=>(t[s]=p.getModelValue(e.model,s).value,t)),{}),telemetryAction:"PinPdlBlade"}}))}return i}function N(e,t,o,i){const{partName:n,parameters:r}=t,a=t.options,{extensionName:l,filters:c}=a;let{initialSize:d,initialHeight:p,initialWidth:u}=a;const m=l||o;let h,g=s.Locator.forExtension(m).withPartType(n);"UnboundPart"===n?h=Promise.resolve():(g=L(e,g,i).locator,h=e.locateAsync(g).then((t=>{if(T.PartSize[d]){const s=T.PartSize[t.initialSize]?t.initialSize:k.Normal,i=R(e,g,t)||[];s===d||i.includes(d)||(D.error("Extension {0} attempted to pin using an unsupported size of part with locator '{1}'. Requested size was '{2}'. Pinned with size '{3}'.".format(o,g.toString(),T.PartSize[d],T.PartSize[s])),d=s,d===k.Custom?(p=p||t.initialHeight,u=u||t.initialWidth):p=u=void 0)}})));const f=n&&n.endsWith(".ReactTile")?{parameters:r}:r;return h.then((()=>({model:f,locator:g,initialSize:d,initialHeight:p,initialWidth:u,filters:c,ignoreRedirects:!0,telemetryAction:i,deepLink:a.deepLink})))}function R(e,t,s){if("number"==typeof s.partKind){return C.getPartFactory(e,t,s).supportedSizes}}function L(e,t,o){let i;if(6===t.type){const n=t.getExtensionLocator(),r=s.Locator.forPartTypeRedirect(n.name,t.name),a={};if(e.tryLocate(r,a)){const e=t,r=a.value;t=(r.toExtension?s.Locator.forExtension(r.toExtension):n).withPartType(r.toPart),i=r.bindings,_.trace({source:"StartBoard",action:"Redirect",name:e.toFriendlyString(),data:{reason:o,to:t.toFriendlyString()}})}}return{locator:t,newBindings:i}}t.Instance=B,t.getPinPartOptions=A,t.resolvePartReference=N})),
define("MsPortalImpl/UI/UI.StartboardManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/UI/Compositions/UI.Composition.Part","FxInternal/AsyncLoader","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StartboardManager=void 0;var f=MsPortalFx.Base,x=MsPortalFx.Hubs.Notifications.NotificationStatus;const b=f.Diagnostics.createLog(e),y=n.CompositionBinder.createObservableModel,v=o.Dashboard.Notification,M=o.Dashboard.NotFound;let C=class{constructor(e,t,s){this._diContainer=e,this._view=t,this._lifetime=new FxImpl.TriggerableLifetimeManager,this._portal=(0,g.getPortalViewModel)(e),this._lifetime.registerForDispose(this.startboard=d.Instance.create(this._diContainer)),s.setStartBoard(this.startboard),MsPortalFx.tryImmediateResolve(this._portal.onWidgetCreate(),(()=>{this._view.composeStartBoard(this.startboard)}))}dispose(){this._lifetime&&this._lifetime.dispose()}setWidgetLoading(e){this.startboard.widget.options.loading(e)}collectDashboardSettings(e){const t={},s=e.toJSON(),o=e.children.filter((e=>!e.isDisposed())),i=e.widget.getDomOrderedChildren();o.length!==i.length&&b.error(`There should be the same number of composed parts to save (${o.length}) as the number of positioned elements in the layout (${i.length}). The settings will be incorrect.`);const n=[];return i.forEach((e=>{const t=MsPortalFx.remove(o,(t=>t.id===e));1===t.length?n.push(this.getPartSettings(t[0])):b.error(`There should be a composed part with ID '${e}' yet none was found. The saved content will be incorrect. The settings will be incorrect.`)})),o.length>0&&o.forEach((e=>{b.error(`Part '${e.id}' should have a position defined in the layout, yet none was found. The settings will be incorrect.`),n.push(this.getPartSettings(e))})),Promise.allSettled(n).then((o=>(o.forEach((e=>{$.extend(t,"fulfilled"===e.status?e.value:void 0)})),e.dashboardFiltersManager&&e.dashboardFiltersManager.toJSON().catch((e=>(b.error("Failed to get part filters information."),s.dashboardModel.model)))))).then((e=>(e&&(s.dashboardModel.model.filterLocale=e.filterLocale,s.dashboardModel.model.filters=e.filters),t[c.startBoardSettingsKey]=s,JSON.parse(JSON.stringify(t)))))}getPartSettings(e,t){return(t||void 0===t?e.await(7):Promise.resolve()).catch(MsPortalFx.noop).then((()=>{if(e.isDisposed())return{};const t={},{partJson:s,containerModel:o}=this.partCompositionToJSON(e);return t[s.id]=s,this.getPartIdentitySettings(e,o).then((e=>$.extend(t,e)))})).catch((t=>(b.error(t,8,`part: '${e.id}'.`),{})))}getPartIdentitySettings(e,t){const s=e.partDefinition;if(!s||!s.partState)return Promise.resolve({});const o=(0,a.buildIdentitySettingKey)(e.locator,t);return e.getPartSettingsManager().getStartboardPartIdentitySettings().then((e=>{if(!e)return{};const t={};return t[o]=e,t})).catch((t=>(b.error(t,9,`Failed to get part '${e.id}' identify settings for key '${o}'.`),{})))}enterOrganizeMode(e){this.startboard.widget.element.trigger("fxenterorganizemode",{openTileGallery:e})}pinMultipleParts(e,t,s,i){if(e.length<1)return Promise.resolve(void 0);let n;return n=i&&this.startboard.notFound()?Promise.reject("Can pin on not found dashboard"):this.startboard.pinPartReferences(e,t).then((e=>{if(void 0===s||s){const e=o.Shell.pinnedToStartBoard;this.popNotification(e,e,x.Information)}return e})),n.catch((t=>{throw b.debug("Pin multiple parts failed: The parts could not be pinned. Part references: {0}".format(e.toString())),this.popNotification(v.errorTitle,M.failToPinPart,x.Error),t}))}pinBladeToStartboard(e,t,s){let i;return i=s&&this.startboard.notFound()?Promise.reject("Can pin on not found dashboard"):this.startboard.pinBladeToStartboard(e).then((s=>{if(!t){const t=e.bladeTitle,s=t?o.Shell.pinnedToStartBoardWithTitle.format(t):o.Shell.pinnedToStartBoard;this.popNotification(s,s,x.Information)}return s})),i.catch((e=>{throw this.popNotification(v.errorTitle,M.failToPinBlade,x.Error),e}))}pinPartToStartboard(e){let t;return t=this.startboard.notFound()?Promise.reject("Can pin on not found dashboard"):this.startboard.clonePartToStartboard(e).then((t=>(this.popNotification(e.getTitle(),o.Shell.pinnedToStartBoard,x.Information),t))),t.catch((t=>{throw b.error("Pin Part to Startboard Failed: The target part could not pinned. Part: {0}".format(e.toString())),this.popNotification(v.errorTitle,M.failToPinPart,x.Error),t}))}popNotification(e,t,s,o){this._diContainer.getAsync(h.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((i=>i.addClientNotification({title:e,description:t,status:s,timestamp:new Date,uri:o||"#dashboard"})))}updateUriAndPageTitle(e,t=!1){e&&e.id&&(0,p.updateDashboardUri)(this._diContainer,e.id,t),this.startboard.widget.options.title(e.title)}partCompositionToJSON(e){const t=e.toJSON();let s=e.containerModel;if(!s||!s[i.PartContainerModelIdProperty]){const e=ko.toJS((0,l.createContainerModel)(t.containerModel))||{};e[i.PartContainerModelIdProperty]=MsPortalFx.getUniqueId(),s=y(e),t.containerModel=(0,m.getSerializableContainerModel)(s,!1)}return{partJson:t,containerModel:s}}};t.StartboardManager=C,t.StartboardManager=C=__decorate([__metadata("fx:diagnostics",[e,"StartboardManager"]),s.Class(),__metadata("design:paramtypes",[s.Container,u.DesktopManagerView,r.CompositionGraph])],C)})),
define("MsPortalImpl/UI/UI.DesktopManagerImpl",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Base/Base.DeepLink","FxHubs/RpcEndPoints","Fx/Composition/DashboardFilters","FxInternal/Composition/DashboardFilters","MsPortalImpl/Services/Services.Settings.Schema","FxInternal/AsyncLoader","MsPortalImpl/UI/UI.StartboardManager"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilterWarningHandler=t.getFilterValueDisplayTextHandler=t.getFilterValuesHandler=t.getDashboardFiltersHandler=t.getDashboardDeepLinkHandler=t.DesktopManagerImpl=void 0;const f=MsPortalFx.require;function x(){return f("MsPortalImpl/UI/UI.Desktop.Actions")}let b=class{constructor(e){this._diContainer=e,this._lifetime=new FxImpl.TriggerableLifetimeManager,this._manifestCache=e.get(i.ManifestCache),this._mode=e.get(a.DesktopManagerMode).value,this._settingsManager=e.get(r.SettingsManager),this._journeyManager=this._diContainer.get(l.JourneyManager),this.startBoard=e.get(g.StartboardManager).startboard,this._setupOrganizeModeComponents()}initialize(){return this._journeyManager.configure(this.startBoard),this._diContainer.get(n.AssetManager).onAssetDeleted(((e,t,s,o)=>{x().then((i=>i.handleAssetDeleted(this,this._journeyManager,e,t,s,o)))})),this.getSettingCollections().forEach((e=>{this._diContainer.get(r.SettingsManager).setSettings(e)})),Promise.resolve()}_getExtensionEmailAddress(e){const t=this._manifestCache.getManifest(e,"assetTypes");return t&&t.feedbackEmail}getCurrentBladeInfo(){const e=this._getBreadCrumb(),t=this._getExtensionEmailAddress("HubsExtension"),s=e[e.length-1],o=s&&s.extensionName||"";return{extensionName:o,feedbackTo:o&&this._getExtensionEmailAddress(o)||t,feedbackCC:t,breadcrumb:e.map((e=>e.title)).join(" > "),bladeLocators:e.map((e=>e.name)),bladeName:s&&s.name||""}}_getBreadCrumb(){const e=this._journeyManager.activeJourney();if(!e)return[];const t=e.children;return t&&t.length?t.map((e=>({title:e.isDefaultTitle()?e.id:e.title(),extensionName:e.locator.getExtensionName(),name:e.locator.toFriendlyString()}))):[]}getSettingCollections(){const e={},t=[];return e[m.desktopSettingsKey]=JSON.parse(JSON.stringify(this)),t.push({store:4,settings:e}),t}dispose(){this._lifetime.dispose()}toJSON(){return{startBoardId:this.startBoard?this.startBoard.id:null}}getDiagnosticsData(){const e=this.startBoard;return{startboard:e&&e.getDiagnosticsData()}}getAssetDiagnosticsData(){const e=this._journeyManager.activeJourney();return e?x().then((t=>t.dumpCompositionAssets(e))):Promise.resolve("No journey")}_setupOrganizeModeComponents(){const e=this._lifetime.createChildLifetime();this._mode.subscribe(e,(t=>{1===t&&(e.dispose(),o.get("MsPortalImpl/UI/UI.DragDropCompositionManager","create").then((e=>e(this._diContainer))))}))}};t.DesktopManagerImpl=b,t.DesktopManagerImpl=b=__decorate([__metadata("fx:diagnostics",[e,"DesktopManagerImpl"]),s.Class(),__metadata("design:paramtypes",[s.Container])],b),t.getDashboardDeepLinkHandler=(0,h.defineHandler)(d.DashboardEndpoints.getDashboardDeepLink,(e=>(0,c.rpcGetDashboardDeepLink)(e.diContainer,e.messageArg))),t.getDashboardFiltersHandler=(0,h.defineHandler)(d.PartFilterEndpoints.getFilters,(e=>{const t=e.diContainer.get(b),s=e.messageArg,o=t.startBoard,i=o.dashboardFiltersManager,n=o.getFilterIdsForPart(s).then((e=>{const t=[];return e.forEach((e=>{t.push(o.dashboardFiltersManager.getFilterIdTextAndOperators(s,e).then((t=>({id:e,displayString:t.displayString,operators:t.operators}))))})),Promise.all(t)})),r=o.getDashboardFiltersForPart(s,!0);return Promise.all([n,r]).then((e=>{const t={},n=e[1],r=[];Object.keys(n).forEach((o=>{const a=i.fromExtensionModel((0,u.getFilterKindFromId)(o),n[o]);if(o!==p.TimeRangeFilter.filterId){const l=i.getFilterValueDisplayText(o,n[o],s).then((e=>({displayString:e,value:a.values})));r.push(l.then((s=>{const i=MsPortalFx.find(e[0],(e=>e.id===o)).displayString;t[o]={filterIdDisplayText:i,operator:a.operator,valueString:s.displayString,values:s.value,substring:a.substring}})))}}));const a=MsPortalFx.forEachKey(MsPortalFx.clone(o.getPartInstance(s).filters,!0)||{},((e,t,o)=>{const n=i.getFilterValueDisplayText(e,t,s).then((s=>{o[e]=MsPortalFx.extend(i.fromExtensionModel((0,u.getFilterKindFromId)(e),t),{valueString:s})}));r.push(n)}),{});return Promise.all(r).then((()=>({dashboardFilterDisplays:t,dashboardTimeRangeFilter:n[p.TimeRangeFilter.filterId],partFilters:a||{},allPossibleFilters:e[0]})))}))})),t.getFilterValuesHandler=(0,h.defineHandler)(d.PartFilterEndpoints.getFilterValues,(e=>{const t=e.diContainer.get(b),s=e.messageArg;return t.startBoard.dashboardFiltersManager.getFilterValues(s.filterId,s.filterText,s.partId)})),t.getFilterValueDisplayTextHandler=(0,h.defineHandler)(d.PartFilterEndpoints.getFilterValueDisplayText,(e=>{const t=e.diContainer.get(b),s=e.messageArg,o=t.startBoard.dashboardFiltersManager.toExtensionModel((0,u.getFilterKindFromId)(s.filterId),s);return t.startBoard.dashboardFiltersManager.getFilterValueDisplayText(s.filterId,o,s.partId)})),t.getFilterWarningHandler=(0,h.defineHandler)(d.PartFilterEndpoints.getFilterWarning,(e=>{const t=e.diContainer.get(b),s=e.messageArg;return t.startBoard.dashboardFiltersManager.getFilterWarning(s.filterId,MsPortalFx.extend2(s.filterModel,{selectAllState:void 0}))}))})),
define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.FlowLayout"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowLayoutDragDrop=void 0;const a=window,l=$(a.document.body),c=n.Widget.getWidget,d="ui-draggable",p="draggable",u=d+" fxs-drag-disableTouchAction",m=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",h=".fxs-flowlayout",g={dismissFn:P,logName:"flowlayoutdragdrop"};let f,x,b,y,v;const M={left:0,top:0};function C(e){if(!f)return;l.off(h);const t=f.elementObject,s="true"===t.attr("dragdrop.revert"),i={left:e.pageX,top:e.pageY};o.unregister(g),s&&t.attr("dragdrop.revert","false"),w(),s&&x&&(w(),x.refreshLayout()),t.css("opacity",1),y=s?b:I(i),x.moveChild(f.elementObject,Math.max(y.col,0),Math.max(y.row,0),!0),S()}function P(){f.elementObject.attr("dragdrop.revert","true").trigger("mouseup")}function w(){v&&(clearTimeout(v),v=null)}function I(e){const t=x.element,s=t.offset(),o=e.left+M.left,n=e.top+M.top,r=o-s.left+t.scrollLeft(),a=n-s.top+t.scrollTop();return{col:Math.floor((r+.33*i.GridSpacingWidth)/i.GridSpacingWidth),row:Math.floor((a+.33*i.GridSpacingHeight)/i.GridSpacingHeight)}}function S(){x=null,b=null,y=null,f=null}function _(){const e=$.querySelectorAll(h),t=[];return e.each((function(e,s){const o=c($(s),r.Widget),i=o.options;i.allowReorder&&!i.locked()&&t.push(o.element.find(".fxs-flowlayout-childcontainer"))})),t}function F(e){P(),C(e)}class T{constructor(){if(T._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");T._singleton=this}dispose(){this.disableDragDropTargets(),S(),T._singleton=null}static get Instance(){return T._singleton||(T._singleton=new T),T._singleton}enableDragDropOnSingleTarget(e){if("true"===e.attr(p))return;e.attr(p,"true");e.filter(m).addClass(u).on("dragstart",(e=>{if(f&&F(e),s.isFullscreen()||e.target!==e.currentTarget)return void e.preventDefault();let t={left:e.pageX,top:e.pageY};l.on("dragover"+h,(e=>{e.preventDefault();const s={left:e.pageX,top:e.pageY};s.left===t.left&&s.top===t.top||function(e,t){if(x){const e=I(t);e.col===y.col&&e.row===y.row||(y=e)}w(),v=setTimeout((()=>{v=null,x&&x.moveChild(f.elementObject,Math.max(y.col,0),Math.max(y.row,0),!1)}),50)}(0,t=s)})),l.on("drop"+h,(e=>{e.preventDefault(),C(e)})),l.on("dragend"+h,(e=>{C(e)})),l.on("dragleave"+h,(e=>{0<e.clientX&&e.clientX<a.innerWidth&&0<e.clientY&&e.clientY<a.innerHeight||F(e)}));const i=e.originalEvent.dataTransfer;i.setData("text","fxs-draganddrop"),i.effectAllowed="move",function(e){const t=e.target,s=$(t);if(!f||f.htmlTarget===t){if(f={htmlTarget:t,elementObject:s,width:s.outerWidth(!1),height:s.outerHeight(!1)},M.top=-e.offsetY,M.left=-e.offsetX,x=c(s.closest(h),r.Widget),!x)return e.preventDefault(),void F(e);s.css("opacity",.75),b=y=I({left:e.pageX,top:e.pageY}),o.register(g)}}(e)}))}enableDragDropTargets(){_().forEach((e=>{e.on("mouseenter",m,(e=>{const t=$(e.currentTarget);"true"!==t.attr(p)&&this.enableDragDropOnSingleTarget(t)}))}))}disableDragDropTargets(){_().forEach((e=>e.off("mouseenter",m))),$.querySelectorAll(`.${d}`).removeClass(u).off("dragstart").removeAttr(p)}}t.FlowLayoutDragDrop=T})),
define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["module"],(function(e){"use strict";return{css:".fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;touch-action:none}.fxs-desktop-organize .fxs-tile:hover .fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-tile.fxs-tilesize-custom .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-sidebar{display:none!important}.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-filter,.fxs-desktop-organize .fxs-startboard-commandBar{display:none}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .msportalfx-clickable-in-customize,.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}.fxs-desktop-organize .fxs-startboard-customize-header .fxs-startboard-button{padding:15px 5px}.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay{display:none}.fxs-desktop-normal .fxs-hide-in-normal{display:none}@media(max-width:700px){.fxs-startboard-customize-header{min-height:initial}.fxs-startboard-customize-description{display:none}}",moduleId:e.id}})),
define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Resources/Resources.Images","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DesktopModeManagerImpl=t.createDesktopModeManager=void 0,(0,g.injectCss)(f,{moduleId:"flowlayoutGridShadowUri",css:`.fxs-desktop-organize .fxs-flowlayout-childcontainer {background: url(${m.getFlowLayout().gridShadow});}`});const x=p.Widget.widgetRemoveEvent,b=`.${u.overlayClassName}`,y=`.${u.widgetClassName}`,v=`.${u.actionBarContainerClassName}`;t.createDesktopModeManager=function(e,t,o){const i=e.get(l.DesktopManagerImpl),n=e.get(a.DesktopManagerMode).value,r=new M(t,e,o),c=e=>{const t=$(e.target).closest(y);return p.Widget.getWidget(t,u.Widget)},d=t.getStartBoardArea();return t.topBar.exitOrganizeMode=()=>{e.get(a.DesktopManagerMode).value(0);const t=i.startBoard.widget.element.find(".fxs-startboard-button-edit>.azc-toolbarButton-container");t.length&&t.focus()},d.on("fxenterorganizemode",((e,t)=>{e.stopPropagation();const s=c(e);t=$.extend({},t),MsPortalFx.isNullOrUndefined(t.trigger)&&(t.trigger=s?0:1),s&&(s.options.selected(!0),r.updateTileSelection(s)),r.startPartManagement(t).then((()=>{s&&s.showTileManagementContextMenu()}))})),d.on("fxopentilegallery",(e=>{1===n()&&(e.stopPropagation(),r.startPartManagement({openTileGallery:!0}))})),d.on("click",b,(e=>{const t=c(e),s=t&&t.options;s&&!s.locked()&&(s.selected(!s.selected()),r.updateTileSelection(t))})),d.on("click",v,(e=>{if(1!==n())return;const t=c(e),s=t&&t.options;!s||s.locked()||s.selected()||(s.selected(!0),r.updateTileSelection(t))})),d.on("dragstart",".ui-draggable",(e=>{if(s.isFullscreen())return void e.preventDefault();1!==n()&&n(1);const t=c(e),o=t&&t.options;o&&!o.selected()&&(o.selected(!0),r.updateTileSelection(t))})),d.on("fxpartcreated",((e,t)=>{e.stopPropagation();const s=t.widget;s.options.selected(!0),r.updateTileSelection(s)})),r};class M{constructor(e,t,s){this._diContainer=t,this._dismissHandle={dismissFn:()=>{this._mode(0)},logName:"desktopmodemanager"},this._mode=t.get(a.DesktopManagerMode).value,this._portal=e,this._lifetime=s,this._userSettingsManager=t.get(n.SettingsManager),this._contextPane=t.get(r.RightContextPane),this._partMgmtStarted=!1,this._selectedTile=null,this._handleModeChange(s)}get selectedTile(){return this._selectedTile}updateTileSelection(e){this._deselectCurrentTile(),e.options.selected()&&(this._selectedTile=e),this._selectedTile&&this._selectedTile.element.on(x,this._tileRemoveHandler=e=>{e.target===this._selectedTile.element[0]&&this._deselectCurrentTile()})}startPartManagement(e){if(this._partMgmtStarted)return Promise.resolve();if(this._mode(1),e.openTileGallery){const e=this._contextPane;return this._partMgmtStarted=!0,e.tryOpen(this).then((()=>{const e=this._partGalleryVm;return MsPortalFx.require("MsPortalImpl/UI/UI.PartGalleryManager").then((t=>{this._partGalleryManager||(this._partGalleryManager=t.create(this._lifetime.createChildLifetime(),this._diContainer,e))}))}))}return Promise.resolve()}onAddingContent(e){return MsPortalFx.require("MsPortalImpl/Widgets/Widgets.PartGallery").then((t=>{this._partGalleryVm||(this._partGalleryVm=new t.ViewModel(this._lifetime,this._diContainer));const s=this._partGalleryVm;if(!this._partGalleryWidget){const o=$(FxImpl.createElement("div",{class:"fxs-partgallery-container"}));return e.getWidget().getBladeHost(o,{title:h.PartGallery.title,bladeWidth:0}).then((i=>{e.getWidget().addChild(i);(this._partGalleryWidget=t.create(o,s)).ltm.registerForDispose(i)}))}}))}onRemovingContent(e){this._partMgmtStarted=!1,this._partGalleryWidget.dispose(),this._partGalleryWidget=null,e.getWidget().clear()}_enterOrganizeMode(){return this._portal.inOrganizeMode(!0),o.register(this._dismissHandle),i.FlowLayoutDragDrop.Instance.enableDragDropTargets(),this._partMgmtStarted?Promise.resolve():this.startPartManagement({})}_exitOrganizeMode(){const e=this._portal;i.FlowLayoutDragDrop.Instance.disableDragDropTargets(),e.inOrganizeMode(!1);this._contextPane.close(!0),this._deselectCurrentTile(),this._userSettingsManager.flushSettings(),o.unregister(this._dismissHandle)}_handleModeChange(e){this._mode.subscribe(e,(e=>{switch(e){case 1:{this._diContainer.getAsync(d.DialogManager).then((e=>{e.dismissOpenDialog()}));const e=this._diContainer.get(c.JourneyManager),t=e.activeJourney();t&&e.forceDiscardJourney(t.id),this._enterOrganizeMode(),s.isFullscreen()&&s.exitFullscreen();break}default:this._exitOrganizeMode()}}))}_deselectCurrentTile(){this._selectedTile&&(this._selectedTile.element.off(x,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)}}t.DesktopModeManagerImpl=M})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.Router","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.DesktopModeManager","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Portal"],(function(e,t,s,o,i,n,r,a,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.FeedbackPaneInfo=t.WhatsNewModal=t.ContactabilityModal=void 0;const u=MsPortalFx.require;class m{constructor(e){this.callBack=e}static create(e,t){return new m((s=>{u("MsPortalImpl/Widgets/Dialogs/Widgets.UpdateContact").then((o=>{new o.Widget($(FxImpl.createElement("div")),new o.ViewModel,s,t.getRootElement(),e)}))}))}}t.ContactabilityModal=m,__decorate([__metadata("fx:diagnostics",[e,"ContactabilityModal"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container,p.ViewModel]),__metadata("design:returntype",m)],m,"create",null);class h{constructor(e){this.callBack=e}static create(e,t){return new h((s=>{MsPortalFx.isFeatureEnabled("whatsnew")&&e.whatsNewEnabledKey()&&u("MsPortalImpl/Widgets/Widgets.WhatsNew").then((e=>{const o=s.items.map((e=>{const t=e.published?new Date(e.published).toLocaleString():"";return e.description+="\r\n"+t,e}));new e.Widget($(FxImpl.createElement("div")),new d.ViewModel,o,t.getRootElement())}))}))}}t.WhatsNewModal=h,__decorate([__metadata("fx:diagnostics",[e,"WhatsNewModal"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.GeneralSettings,p.ViewModel]),__metadata("design:returntype",h)],h,"create",null);class g{static create(e,t,s){return MsPortalFx.require("MsPortalImpl/Widgets/Widgets.FeedbackPane").then((o=>({amdModule:o,widget:new o.FeedbackPane(e,t,(()=>s.getCurrentBladeInfo()))})))}}t.FeedbackPaneInfo=g,__decorate([__metadata("fx:diagnostics",[e,"FeedbackPaneInfo"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container,r.DockedContextPane,a.DesktopManagerImpl]),__metadata("design:returntype",void 0)],g,"create",null),t.initialize=function(e,t,s){return t.get(n.PortalCommandManager),t.get(o.Router),(0,c.createNotificationManager)(t),MsPortalFx.tryImmediateResolve(s.onWidgetCreate(),(()=>{l.createDesktopModeManager(t,s,e)})),t}})),
define("MsPortalImpl/UI/Hubs/UI.NotificationsPane",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewModel=void 0;t.ViewModel=class{constructor(e){this.diContainer=e,this.lastPaneOpenedTime=ko.observable(Date.now()),this.isPaneOpen=ko.observable(!1)}}})),
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",["require","exports","MsPortalImpl/Extension/ViewModelManager"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerViewModels=void 0;t.registerViewModels=function(e){(0,s.registerWithDi)("BrowseAllBlade$ServicesListPartViewModel","ServicesListPartViewModel","MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseAll.Part")}})),
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports","MsPortalImpl/Extension/ViewModelManager","FxInternal/Composition/Part"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerViewModels=void 0;t.registerViewModels=function(e){const t=s.registerWithState,i="./MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.DiagnosticsPart";t("HelpAndSupportBlade$DiagnosticsPartViewModel",i,(t=>(0,o.composePartViewModel)((s=>new t.DiagnosticsPartViewModel(s,e)),{logArea:i})))}})),
define("MsPortalImpl/UI/UI.AdvisorNotificationHelper",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Base/Languages","MsPortalImpl/Resources/PortalNotificationsTelemetry"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.showAdvisorNotification=t.shouldShowAdvisorNotification=t.percentageOfUsersShownAdvisorNotification=void 0;var r=n.Source,a=n.Action,l=n.ActionModifier;const c=window,d=s.AdvisorNotification,p=24*(parseInt(MsPortalFx.getFeatureValue("advisornotificationdays"))||30)*3600*1e3;t.percentageOfUsersShownAdvisorNotification=parseFloat(MsPortalFx.getFeatureValue("advisornotificationpercent"))/100;let u=(0,o.hideSmallModals)(),m=MsPortalFx.isFeatureEnabled("hideadvisormodals"),h=MsPortalFx.isFeatureEnabled("ci"),g=FxImpl.features.isNativePerf,f=MsPortalFx.isFeatureEnabled("testadvisor");function x(){return f||!u&&!m&&t.percentageOfUsersShownAdvisorNotification>0&&!h&&!g}t.shouldShowAdvisorNotification=x,t.showAdvisorNotification=function(e){if(!x())return Promise.resolve(!1);const o=Date.now()-p,n=MsPortalFx.Base.Resources.getVersionlessContentUri("Content/static/MsPortalImpl/AdvisorNotifications/AdvisorDashboard_"+i.getCultureSpecificLanguage().split("-").join("")+".svg");return e.querySetting(13,"AdvisorNotification").then((i=>{if(f||(i||0)<o&&Math.random()<t.percentageOfUsersShownAdvisorNotification){FxImpl.Hubs.Notifications.InternalClientNotification.internalPublish({notificationId:"AdvisorModal",timestamp:new Date,modalNotificationData:{image:{imageUrl:MsPortalFx.encodeAttribute(n)}},title:d.title,description:`<h1>${MsPortalFx.encodeHtml(d.description)}&nbsp;<a aria-label='${s.AdvisorNotification.helpTextAriaLabel}' class='msportalfx-ext-link' href='${MsPortalFx.encodeAttribute(c.fx.environment.links.learnAdvisor)}' target="_blank">${MsPortalFx.encodeHtml(s.AdvisorNotification.helpText)}</a></h1>`,status:MsPortalFx.Hubs.Notifications.NotificationStatus.Information,descriptionAsHtml:!0,toastDuration:4,inlineForm:{buttons:[{label:d.buttonText,id:"LaunchAdvisorBladeButton",deepLink:{uri:"#blade/Microsoft_Azure_Expert/AdvisorMenuBlade"}}]}});const u=Date.now();return e.setSetting(13,"AdvisorNotification",u),MsPortalFx.Base.Diagnostics.Telemetry.trace({source:r.ToastTray,action:a.AdvisorNotificationShown,actionModifier:l.NotificationShown,data:{advisorNotificationOccurence:p,percentageOfUsersShownAdvisorNotification:t.percentageOfUsersShownAdvisorNotification,testAdvisorFlag:f,timeElapsedInMs:o,advisorLastShown:i,advisorShownTime:u}}),!0}return!1}))}})),
define("MsPortalImpl/UI/UI.CopilotToastHelper",["require","exports","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Services/Services.AssetTypes","FxInternal/Experimentation"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showCopilotToast=t.shouldShowCopilotToast=void 0;var n=MsPortalFx.Base.Diagnostics.Telemetry.trace;const r=s.Source,a=s.Action;async function l(e){const t=e.get(o.AssetTypeService);let s;try{await(t?.assetTypesComplete),s=!!t.getAssetType("Microsoft_Azure_Copilot","CopilotSettingsAsset")}catch(e){s=!1}return s}t.shouldShowCopilotToast=async function(e,t,s){const[o,c,d]=await Promise.all([e.get(i.ExperimentationManager).shellAssignments.whenAvailable(),t.querySetting(7,"CopilotToastReceived"),l(e)]),p=o.getBooleanValue("copilotmanageabilityuinotification"),u=o.getBooleanValue("disablecopilotdirectline"),m=o.getBooleanValue("copilotmanageability"),h=s&&!c&&p&&!u&&d&&!m;return h||n({source:r.ToastTray,action:a.CopilotToastNotLaunched,data:{copilotNotificationExp:p,disableCopilotDirectlineExp:u,copilotEnabledExp:m,hasReceivedToast:c,isTenantAdmin:s,assetTypeExists:d}}),h},t.showCopilotToast=async function(e,t,s){n({source:r.ToastTray,action:a.CopilotToastLaunched}),await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.CopilotToast").then((o=>{n({source:r.ToastTray,action:a.CopilotToastLoaded}),o.showToast(e,t,s)}))}})),
define("MsPortalImpl/UI/UI.DirectoryHelper",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/UI/UI.AuthStateManager"],(function(e,t,s,o,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SaveDirectorySettingsHandler=void 0;var a=MsPortalFx.Hubs.Notifications;let l=class{constructor(e,t){this._diContainer=e,this._authStateManager=t}async saveDirectorySettings(){const e=await this._diContainer.getAsync(i.UserDirectorySettings),t=e.userDefaultDirectory,s=t()||{},r=(("string"==typeof s?s:s.id)||"").toLowerCase();let l="";const[c,d]=await Promise.all([this._authStateManager.getUserInfo(),this._diContainer.get(n.TenantsService).getHomeTenants()]);l=(c.directoryId||"").toLowerCase();const p=MsPortalFx.find(d,(e=>e.id.toLowerCase()===r)),u=e.signInToLastVisitedDirectory;let m;!1===u()?p||(l&&a.ClientNotification.publish({title:o.defaultDirectoryNotFoundTitle,description:o.defaultDirectoryNotFoundDescription.format(c.domainName),status:a.NotificationStatus.Warning,uri:"#menu/directory"}),u(!0)):u(!0),m=u()?{id:c.directoryId,displayName:c.directoryName,domainName:c.domainName}:{id:p.id,displayName:p.displayName,domainName:p.domainName};const h=MsPortalImpl.sessionStorage.getItem("usedTenantHint");if(h&&(MsPortalImpl.sessionStorage.removeItem("usedTenantHint"),MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"UI.DirectoryHelper",action:"TenantHintUsage",actionModifier:"complete",data:{tenantHint:h,loggedInTenantId:c.directoryId,loggedInTenant:c.domainName}})),m.id){t(m),MsPortalImpl.localStorage.setItem("SavedDefaultDirectory",m.id);const e=!this._authStateManager.bootstrapState.user.isOrgId;MsPortalFx.isFeatureEnabled("usetenanthint")&&e?MsPortalImpl.localStorage.setItem("tenantHint",m.domainName):MsPortalImpl.localStorage.removeItem("tenantHint")}}};t.SaveDirectorySettingsHandler=l,t.SaveDirectorySettingsHandler=l=__decorate([__metadata("fx:diagnostics",[e,"SaveDirectorySettingsHandler"]),s.Class(),__metadata("design:paramtypes",[s.Container,r.AuthStateManager])],l)})),
define("MsPortalImpl/Services/Services.FeedbackPolicies",["require","exports","MsPortalImpl/Resources/FeedbackControlPolicyClientStrings","FxInternal/AsyncLoader","Fx/Ajax","FxInternal/RpcEndPoints"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetState=t.fetchFeedbackPolicySettingsHandler=t.fetchFeedbackPolicySettings=t.fetchFeedbackPolicies=void 0;var r=MsPortalFx.Base.Diagnostics.Telemetry;const a=FxImpl.internalEnv,l=a.ocpsEndpoint?.length>1?MsPortalFx.ensureSuffix(a.ocpsEndpoint,"/")+"user/v1.0/web/policies":"",c=MsPortalFx.getLogFriendlyMessage,d={resourceName:"office"},p={connectedExperiences:s.connectedExperiences,policyAllowContact:s.policyAllowContact,policyAllowContent:s.policyAllowContent,policyAllowFeedback:s.policyAllowFeedback,policyAllowScreenshot:s.policyAllowScreenshot,policyAllowSurvey:s.policyAllowSurvey,policyContentSamplesDefault:s.policyContentSamplesDefault,policyEmailCollectionDefault:s.policyEmailCollectionDefault,policyScreenshotDefault:s.policyScreenshotDefault},u={connectedExperiences:s.connectedExperiencesTooltip,policyAllowContact:s.policyAllowContactTooltip,policyAllowContent:s.policyAllowContentTooltip,policyAllowFeedback:s.policyAllowFeedbackTooltip,policyAllowScreenshot:s.policyAllowScreenshotTooltip,policyAllowSurvey:s.policyAllowSurveyTooltip,policyContentSamplesDefault:s.policyContentSamplesDefaultTooltip,policyEmailCollectionDefault:s.policyEmailCollectionDefaultTooltip,policyScreenshotDefault:s.policyScreenshotDefaultTooltip},m={connectedExperiences:"L_ConnectedOfficeExperiences",policyAllowContact:"L_EmailCollection",policyAllowContent:"L_LogCollection",policyAllowFeedback:"L_SendFeedback",policyAllowScreenshot:"L_Screenshot",policyAllowSurvey:"L_SendSurvey",policyContentSamplesDefault:"L_FeedbackOptionsDefaults",policyEmailCollectionDefault:"L_FeedbackOptionsDefaults",policyScreenshotDefault:"L_FeedbackOptionsDefaults"},h={0:"Disabled",1:"Enabled",2:"Not Configured"},g={0:s.disabled,1:s.enabled,2:s.notConfigured},f={connectedExperiences:"disconnectedstate",policyAllowContact:"includeemail",policyAllowContent:"feedbackincludelog",policyAllowFeedback:"enabled",policyAllowScreenshot:"includescreenshot",policyAllowSurvey:"surveyenabled",policyContentSamplesDefault:"contentsamplesdefault",policyEmailCollectionDefault:"emaildefault",policyScreenshotDefault:"screenshotdefault"},x=["connectedExperiences","policyAllowContact","policyAllowContent","policyAllowFeedback","policyAllowScreenshot","policyAllowSurvey","policyContentSamplesDefault","policyEmailCollectionDefault","policyScreenshotDefault"];let b,y;async function v(){return y?{...y}:(await M(),y)}async function M(){const e=r.startTrace({source:"FeedbackPolicies",action:"FetchAdminFeedbackControls"});let t=!0,o=null;l&&(o=await i.ajaxExtended({setTelemetryHeader:"FetchAdminFeedbackControls",type:"GET",uri:l,setAuthorizationHeader:d}).then((e=>e?.content),(s=>(t=!1,r.endTrace(e,"ErrorFetchingPolicies",c(JSON.stringify(s,null,4))),Promise.reject(c(JSON.stringify(s,null,4)))))).catch((s=>(t&&r.endTrace(e,"ErrorFetchingPolicies",c(JSON.stringify(s,null,4))),Promise.reject(c(JSON.stringify(s,null,4)))))));const n=[];if(o?.value?.length&&o.value[0]?.policiesPayload?.length){const e=o.value[0]?.policiesPayload;x.forEach((t=>{n.push(function(e,t){const o=m[e],i=f[e],n=t.find((e=>e?.settingId?.includes(o)&&e.valueName===i&&h[e.value]));if(n)return{description:u[e],displayValue:g[n.value],label:p[e],policy:e,value:h[n.value]};return{description:u[e],displayValue:s.notConfigured,label:p[e],policy:e,value:"Not Configured"}}(t,e))}))}else x.forEach((e=>{n.push({description:u[e],displayValue:s.notConfigured,label:p[e],policy:e,value:"Not Configured"})}));const a={},v={};n.forEach((e=>{a[e.policy]=e,v[e.policy]="Disabled"!==e.value}));const M={};n.forEach((e=>{M[e.policy]=e.value})),r.endTrace(e,"FetchingPoliciesSucceeded",M),b=a,y=v}t.fetchFeedbackPolicies=async function(){return b?{...b}:(await M(),b)},t.fetchFeedbackPolicySettings=v,t.fetchFeedbackPolicySettingsHandler=(0,o.defineHandler)(n.fetchFeedbackPolicySettingsEndpoint,(()=>v()))})),
define("MsPortalImpl/UI/UI.NpsHelper",["require","exports","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Services/Services.FeedbackPolicies","FxInternal/Experimentation"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTestValues=t.shouldShowPortalNps=t.showPortalNps=t.showNps=t.npsShownInSession=void 0;var n=MsPortalFx.Base.Diagnostics.Telemetry.trace,r=s.Source,a=s.Action,l=s.ActionModifier;const c=window,d=c?.fx?.environment?.surveys?.nps??Object.create(null);let p=MsPortalFx.isFeatureEnabled("testnps"),u=MsPortalFx.isFeatureEnabled("nps");const m=MsPortalFx.isFeatureEnabled("ci");let h=(parseFloat(MsPortalFx.getFeatureValue("npspercent"))||1)/100;const g=24*(parseInt(MsPortalFx.getFeatureValue("npsintervaldays"))||90)*3600*1e3;let f=!1;function x(e,t,s){return e?s:t}function b(e){return f=e,f}async function y(e,s,c,d,h,g,f,b){const y=await(b?.get(i.ExperimentationManager)?.shellAssignments?.whenAvailable());if(p||!m&&u&&!t.npsShownInSession){let i=!0,p=!1;try{let e;y?.getBooleanValue("enableadmincontrolpolicies")&&(e=await(0,o.fetchFeedbackPolicySettings)()),!e||e.policyAllowSurvey&&e.policyAllowContact||n({source:r.ToastTray,action:a.NPSAdminPolicies,actionModifier:l.PoliciesFetched,data:MsPortalFx.extend({policyAllowSurvey:e.policyAllowSurvey,policyAllowContact:e.policyAllowContact},g)}),e&&y?.getBooleanValue("enableocpstoaffectsurveys")&&(i=e.policyAllowSurvey,p=!e.policyAllowContact)}catch(e){n({source:r.ToastTray,action:a.NPSAdminPolicies,actionModifier:l.PoliciesFetchFailed,data:MsPortalFx.extend({error:MsPortalFx.getLogFriendlyMessage(e)},g)})}const u=y?.getNumberValue("newnpsexp")??0;i?await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.Nps").then((o=>{n({source:r.ToastTray,action:x(u,a.NPSShown,a.FrameworkSurveys_SATLoaded),actionModifier:l.NotificationShown,data:MsPortalFx.extend({productId:h,shouldHideContact:p},g)}),o.showSurvey(e,s,c,d,h,f,b,p,u<0||u>1?0:u),t.npsShownInSession=!0})):n({source:r.ToastTray,action:a.NPSAdminPolicies,actionModifier:x(u,l.NPSNotShown,l.FrameworkSurveys_SATNotLoaded),data:MsPortalFx.extend({data:MsPortalFx.extend({productId:h,shouldHideContact:p},g)},g)})}}t.npsShownInSession=!1,t.showNps=y,t.showPortalNps=async function(e,t,s,o,i){if(f)return f=!1,y(e,t,s,d?.productFamilyName??null,null,{surveyLastCompleted:o()},(()=>{o(Date.now())}),i)},t.shouldShowPortalNps=function(e){return b(!!p||!(!u||m)&&(e()<Date.now()-g&&Math.random()<h))}})),
define("MsPortalImpl/UI/UI.SessionHandlerDeferred",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateSessionLifetime=void 0;var s=MsPortalFx.Base,o=s.Diagnostics.Telemetry;const i=window,n=i.document,r=FxImpl.trustedParentOrigin.toLowerCase();let a=0,l=!0;t.validateSessionLifetime=function(e,t,c,d){if(!l)return Promise.resolve(!1);const p=Date.now();if(p-a<3e5)return Promise.resolve(!0);a=p;const u=o.startTrace({source:"Shell",action:d});let m=FxImpl.createElement("iframe");m.classList.add("fxs-extension-frame"),m.setAttribute("tab-index","-1"),m.setAttribute("aria-hidden","true"),m.src=s.Resources.getAppRelativeUri(`/signin/validateSession/@${t}/?sid=${e.aadSessionId||""}`);const h=n.body;h.appendChild(m);const g=Q.defer();let f=e=>{if(e.origin.toLowerCase()===r){const t=e.data||{};"ValidateSession"===t.signature&&(l=!1!==t.valid,x(l,l?"SessionValid":"SessionExpired"),l||c.onStatus({code:7},"fx"))}};const x=(e,t)=>{g.promise.isPending()&&(g.resolve(e),o.endTrace(u,t)),m&&(h.removeChild(m),m=null),f&&(i.removeEventListener("message",f,!1),f=null)};return MsPortalFx.delay(3e5).then((()=>{x(!0,"ErrorValidatingSession")})),i.addEventListener("message",f,!1),g.promise}})),
define("MsPortalImpl/UI/UI.SessionHandler",["require","exports","MsPortalImpl/UI/UI.SessionHandlerDeferred","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Resources/SessionHandlerResources","Fx"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTestValues=t.initialize=void 0;const r="SessionHandlerTimedSignout",a=window,l=MsPortalFx.Base.Diagnostics.createLog(e),c=parseInt((0,n.getFeatureValue)("sessionpollinterval"))||36e5;let d;const p=(0,n.memoizePromise)((()=>{if(MsPortalFx.isFeatureEnabled("disableaadgraphendpoint"))return Promise.resolve(!0);const e=a.fx.environment.links.graphPoliciesEndpoint;return e?MsPortalFx.Base.Net2.ajax({uri:e,setAuthorizationHeader:{resourceName:"graph"}}).then((e=>(e.value||[]).some((e=>"tokenlifetimepolicy"===(e.type||"").toLowerCase()&&(e.definition||[]).some((e=>(e||"").toLowerCase().includes("maxagesession"))))))).catch((e=>{const t=(e.jqXHR||{}).status;return 401===t||403===t||(0===t?(p.clear(),!1):(p.clear(),l.verbose("Error calling graph for policy details",0,e),!0))})):Promise.resolve(!0)}));function u(e,t,s,a,l){let c,d=!1;return a.addCallbacks({onBusy:()=>{c=void 0},onIdle:p=>{const u=ko.unwrap(s),m=t&&u?Math.min(t,u):Math.max(t,u);m&&p>=m?(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:r,action:"TimedSignout",data:{signedOutTime:Date.now(),idleTime:p,userSetting:u,tokenTimeout:t}}),c&&MsPortalFx.Base.Diagnostics.Telemetry.endTrace(c,"InactiveUserSignout",{signedOutTime:Date.now(),idleTime:p,userSetting:u,tokenTimeout:t}),l()):(0,n.isFeatureEnabled)("logouttimerpopup")&&m&&p+1===m&&!d&&e.getAsync(o.DialogManager).then((e=>{c=MsPortalFx.Base.Diagnostics.Telemetry.startTrace({source:r,action:"SessionInactivtyTimeoutPrompt",data:{idleTime:p,userSetting:u,tokenTimeout:t}}),d=!0;const{DialogResult:s}=MsPortalFx.ViewModels.Dialogs;e.showModalDialog({description:i.TimeoutDialog.description,title:i.TimeoutDialog.title,buttons:2,cancelButtonText:i.TimeoutDialog.cancelButton,defaultButtonText:i.TimeoutDialog.acceptButton}).then((e=>{switch(d=!1,e){case 1:MsPortalFx.Base.Diagnostics.Telemetry.cancelTrace(c,{signedOutTime:Date.now(),idleTime:p,userSetting:u,tokenTimeout:t}),l();break;case 4:MsPortalFx.Base.Diagnostics.Telemetry.completeTrace(c,{idleTime:p,userSetting:u,tokenTimeout:t}),a.signalBusy()}}))}))}})}t.initialize=function(e,t,o,i,r,a,l,m){const h=o.bootstrapState.idleTimeoutSeconds/60;if(h?d=u(e,h,i,r,a):i.subscribeAndRun(t,(t=>{t&&!d?d=u(e,0,i,r,a):t||h||!d||(r.removeCallbacks(d),d=null)})),(0,n.isFeatureEnabled)("sessionvalidity")){const e=()=>(0,n.delay)(c).then((()=>{p().then((t=>{t&&s.validateSessionLifetime(o.bootstrapState,l,m,"SessionValidityPoll").then((t=>{t&&e()}))}))}));e()}}})),
define("_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css",["module"],(function(e){"use strict";return{css:".fxt-copy{display:flex;margin-top:5px}.fxt-copy-control{padding-left:10px}",moduleId:e.id}})),
define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/Services.SecurityTokens","Fx/Composition","FxInternal/Css","_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css","Fx"],(function(e,t,s,o,i,n,r,a,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatusHandler=t.errorUri=void 0,(0,c.injectCss)(d);var u=MsPortalFx.Base,m=u.Constants,h=u.Diagnostics,g=h.Telemetry,f=MsPortalFx.Hubs.Notifications,x=f.NotificationStatus;const b=window,y=b.document,v=h.createLog(e),M=m.Shell,C=o.Shell,P=C.Notifications,w=C.Dialogs,I=P.SessionEnding,S=P.TokenFailure,_=P.VersionChanged,F={sessionId:MsPortalFx.sessionId};t.errorUri=b.fx.internalEnv.portalApplicationUri+"/Error";const T=[12e5,6e5],k=b.fx.environment.links.aadErrorCodes;function D(e,t,s,o,i){g.trace({source:"Shell",action:"StatusHandlerShowNotification",name:M,data:{title:e,description:t,correlationId:s}}),f.ClientNotification.publish({title:e,description:t,status:o||x.Information,descriptionAsHtml:i,correlationIds:[s]})}let E=class{constructor(e,t,s,o,i){this._diContainer=e,this._dialogManager=t,this._rootElements=s,this._windowManager=o,this.isShellInitialized=Q.defer(),this._pageBlockingPrompt=!1,this._isDialogVisible=!1,this.isOfflineDialogVisible=!1,this._unknownNetworkErrorCount=0,this._unknownNetworkErrorCanceled=!1,i.sessionEndedHandler=(e,t)=>this.onLastTokenRefresh(e,t),i.tokenFailedHandler=(e,t,s)=>{this.onStatus({code:2,message:s,data:{resourceName:t}},e)},i.tokenMfaErrorHandler=(e,t,s)=>{this.onStatus({code:8,message:s,data:{resourceName:t}},e)},i.tokenClaimsErrorHandler=(e,t,s,o)=>{const i=Object.create(null);k&&(i.learnMoreText=w.learnMore,i.onClickLearnMore=new l.ClickableLink(k,"_blank",null,MsPortalFx.noop,"AadErrorCodes")),this.onStatus({code:9,data:{missingClaims:s,resourceName:t},message:o},e,i)},i.unauthorizedTokenHandler=e=>{console.warn("ServerErrorCode:SessionEnded"),this.onStatus({code:7},e)},window.onoffline=e=>{this.onOfflineEvent(e)},window.ononline=e=>{this.onOnlineEvent(e)}}onOfflineEvent(e){this._isDialogVisible||this.isOfflineDialogVisible||(this._showDialog({extensionName:M,telemetryAction:"OfflineEvent",messageTitle:w.connectionErrorMessageTitle,messageDescription:w.offlineEventMessageDescription,defaultButtonText:w.newVersionDefaultButtonText,cancelButtonText:w.connectionErrorCancelButtonText,delayMilliSeconds:0,buttons:2,actions:0,additionalDetails:{type:e.type}}),this.isOfflineDialogVisible=!0)}onOnlineEvent(e){this.isOfflineDialogVisible&&(this._dismissDialog(),this.isOfflineDialogVisible=!1,g.trace({source:"Shell",action:"OnlineEvent",name:M}))}onLastTokenRefresh(e,t){const s=Date.now();g.trace({source:"Shell",action:"OnLastTokenRefresh",name:M,data:{tokenExpiresAt:t}}),t<=s&&this.onStatus({code:2},e),g.trace({source:"Shell",action:"SessionEndWarning",name:M,data:{tokenExpiresAt:t}}),T.forEach((e=>{setTimeout((()=>{const t=Math.floor(e/6e4),s=t>10?I.messageFmt.format(t):I.message;D(I.title,s,"lastTokenRefresh")}),t-e-s)}))}async onStatus(e,s,o){if(!e||this._pageBlockingPrompt)return;const i=s===M||"HubsExtension"===s,n=e.data??{},r=n.uri??"",a=e.message??"";switch(e.code){case 0:return;case 1:return i?void await this._showDialog({extensionName:s,telemetryAction:"ShellVersionChanged",messageTitle:w.newVersionMessageTitle,messageDescription:w.newVersionMessageDescription,defaultButtonText:w.newVersionDefaultButtonText,delayMilliSeconds:3e4,buttons:2,actions:5,additionalDetails:n}):(g.trace({source:"Shell",action:"ExtensionVersionChanged",data:s}),v.warning(`Extension reporting incompatible server version. ${s}:${n.version}`),void D(_.title,_.messageFmt.format(s),`VersionChanged-${s}`));case 2:{const e=n.resourceName;if(e){let t=S.description.format(s);e&&(t+="\n"+S.resourceName.format(e)),a&&(t+="\n"+S.errorDetails.format(a)),D(S.title,t,`AuthTokenError-${s}`,x.Information)}else this._windowManager.redirect({uri:t.errorUri+"/UE_SessionExpired"+window.location.hash,redirectAction:3,reason:`authorizationExpired_Arm_${s}`});return}case 7:return void await this._showDialog({extensionName:M,telemetryAction:"SessionExpired",messageTitle:w.sessionExpired,messageDescription:w.sessionExpiredMessage,defaultButtonText:w.refresh,buttons:1,actions:2,additionalDetails:n});case 4:{if(v.verbose(`Received a status code zero from extension ${s} for URL '${r}'.`),!i)return;if(this._unknownNetworkErrorCount>3||this._isDialogVisible||this._unknownNetworkErrorCanceled)return;this._unknownNetworkErrorCount++;const e=await this._showDialog({extensionName:M,telemetryAction:"UnknownNetworkError",messageTitle:w.connectionErrorMessageTitle,messageDescription:w.connectionErrorMessageDescription,defaultButtonText:w.newVersionDefaultButtonText,cancelButtonText:w.connectionErrorCancelButtonText,buttons:2,actions:0,additionalDetails:n});return void(this._unknownNetworkErrorCanceled=1===e)}case 6:{let e=w.tooManyRequestsDescription;const t=n.retryAfter;return t&&(e=`${e} ${w.tooManyRequestsRetry.format(t)}`),void D(w.tooManyRequestsTitle,e,`TooManyRequests-${s}`,x.Warning,!0)}case 8:return void await this._showDialog({extensionName:s,telemetryAction:"MfaError",messageTitle:w.mfaError,messageDescription:e.message,defaultButtonText:w.signOutText,buttons:2,actions:2,additionalDetails:n});case 9:{const t=(n.missingClaims||"").toLowerCase().includes("capolids"),i=t?w.claimsErrorTitle:w.claimsErrorGenericTitle,r=(t?w.claimsErrorDescription:w.claimsErrorGenericDescription).format(`${s},${n.resourceName||"default"}`,k?'<a class="msportalfx-ext-link" href="" data-bind="text: learnMoreText, fxclick: onClickLearnMore"></a>':"");return void await this._showDialog({extensionName:s,telemetryAction:t?"ClaimsErrorCA":"ClaimsErrorGeneric",messageTitle:i,messageDescription:r,defaultButtonText:w.claimsErrorButtonText,cancelButtonText:w.connectionErrorCancelButtonText,buttons:2,actions:0,missingClaims:n.missingClaims,additionalDetails:MsPortalFx.extend2(n,{errorMessage:e.message}),templateViewModel:o})}default:{const t=`Received unknown extension event '${e.code}' for extension '${s}'.`;return v.error(t),Promise.reject(t)}}}async _showDialog(t){if(p.isFeatureEnabled("nostatusmodal"))return 2;let s;const o=r.hasFlag(t.actions,2);let i;this._pageBlockingPrompt=r.hasFlag(t.actions,1),t.telemetryAction&&g.trace({source:"Shell",action:t.telemetryAction,name:t.extensionName,data:t.additionalDetails}),o&&(i=3);const n=(e,s)=>{this._windowManager.redirect({skipFlushBuffers:o,delayPromise:e&&t.delayMilliSeconds?p.delay(t.delayMilliSeconds):null,redirectAction:i,reason:s})};if(r.hasFlag(t.actions,4)&&this.isShellInitialized.promise.isPending())return s=Promise.withResolvers().promise,n(!1,"shouldSkipPrompt"),s;const a=Promise.withResolvers();this._isDialogVisible=!0;const l=await this._dialogManager.showModalDialog({title:t.messageTitle,description:t.messageDescription+'<div class="fxt-copy"><a href="#" data-bind="text: copyText, click: copyClick"></a></div>',templateViewModel:MsPortalFx.extend2(t.templateViewModel,{copyText:w.copyText,copyClick:()=>{const e=JSON.stringify(MsPortalFx.extend2(F,t.additionalDetails),null,2),s=FxImpl.createElement("pre");s.textContent=e,y.body.appendChild(s);const o=b.getSelection();o.removeAllRanges();const i=y.createRange();i.selectNodeContents(s),o.addRange(i),b.document.execCommand("copy"),s.remove()}}),defaultButtonText:t.defaultButtonText,cancelButtonText:t.cancelButtonText,buttons:t.buttons,uiShield:{hidePromise:a.promise}});if(!t.missingClaims||4!==l)return this._pageBlockingPrompt?(this._rootElements.showSplash(!0),a.resolve(),n(!0,"isPageBlockingPrompt")):4===l?n(!1,"isNotPageBlockingPrompt_Ok"):a.resolve(),this._isDialogVisible=!1,s;{const s=await MsPortalFx.require(e.normalize("./UI.NavigationManager.ForceSignIn"));try{await s.forceSignIn(this._diContainer,{bladeDeepLink:window.location.hash,signInParameters:JSON.parse(t.missingClaims),reason:"MissingClaims"},M)}catch(e){g.trace({source:"UIStatusHandler",action:"ErrorForcingMfaSignIn",data:{error:MsPortalFx.sanitizeMessage(JSON.stringify(e))}})}}}_dismissDialog(){this._dialogManager.hasOpenDialog&&this._dialogManager.dismissOpenDialog(0),this._isDialogVisible=!1}};t.StatusHandler=E,t.StatusHandler=E=__decorate([__metadata("fx:diagnostics",[e,"StatusHandler"]),s.Class(),__metadata("design:paramtypes",[s.Container,i.DialogManager,n.RootElements,n.WindowManager,a.SecurityTokensManager])],E)})),
define("MsPortalImpl/Widgets/PersonalizedSurvey.Data",["require","exports","MsPortalImpl/Resources/ImplScriptResources","Fx/Ajax","Fx","MsPortalImpl/UI/UI.AuthStateManager"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkPersonalizedSurveyEligibility=t.deleteSurvey=t.submitSurvey=t.fetchSurvey=t.surveyApis=t.tourSteps=t.getUserIntents=void 0;var r=MsPortalFx.Base.Diagnostics.Telemetry;const a=FxImpl.internalEnv,l=s.PersonalizedSurvey,c=l.Option,d=l.StartTour;t.getUserIntents=function(){return i.isDevelopmentMode?p:p.sort(((e,t)=>"Other"===e.id?1:"Other"===t.id?-1:Math.random()-.5))};const p=[{id:"ManageIdentityAndAccess",title:c.manageIdentityTitle,description:c.manageIdentityDescription},{id:"CloudNativeApplication",title:c.nativeApplicationTitle,description:c.nativeApplicationDescription},{id:"PlatformServices",title:c.platformServiceTitle,description:c.platformServiceDescription},{id:"InfrastructureManagement",title:c.createInfraTitle,description:c.createInfraDescription},{id:"LinuxSolutions",title:c.linuxTitle,description:c.linuxDescription},{id:"Migration",title:c.migrateTitle,description:c.migrateDescription},{id:"HybridCloud",title:c.hybridEnvTitle,description:c.hybridEnvDescription},{id:"Security",title:c.securityTitle,description:c.securityDescription},{id:"AIML",title:c.aimlTitle,description:c.aimlDescription},{id:"IoT",title:c.iotTitle,description:c.iotDescription},{id:"CloudSkills",title:c.cloudSkillTitle,description:c.cloudSkillDescription},{id:"GovernResources",title:c.governResourcesTitle,description:c.governResourcesDescription},{id:"Other",title:c.other}];t.tourSteps=[d.createAResource,d.dashboard,d.accountInfo,d.directoryAndSubscription,d.searchResource],t.surveyApis={get:a.fxPersonalizedSurveyEndpoint+"api/Survey_Get",post:a.fxPersonalizedSurveyEndpoint+"api/Survey_Post",delete:a.fxPersonalizedSurveyEndpoint+"api/Survey_Delete"},t.fetchSurvey=async function(){const e=r.start({source:"PersonalizedSurvey.Data",action:"fetchSurvey"});try{const s=await o.ajax({uri:t.surveyApis.get,type:"GET",setAuthorizationHeader:{resourceName:"survey"}});return r.completeTrace(e),s?.Questions||[]}catch(t){return r.cancelTrace(e,{error:t}),[]}},t.submitSurvey=async function(e){const s={Questions:e},i={surveyEntries:e},n=r.start({source:"PersonalizedSurvey.Data",action:"submitSurvey"});try{await o.ajax({uri:t.surveyApis.post,type:"POST",setAuthorizationHeader:{resourceName:"survey"},data:JSON.stringify(s)}),r.completeTrace(n,{...i})}catch(e){r.cancelTrace(n,{...i,error:e})}},t.deleteSurvey=async function(){const e=r.start({source:"PersonalizedSurvey.Data",action:"deleteSurvey"});try{await o.ajax({uri:t.surveyApis.delete,type:"DELETE",setAuthorizationHeader:{resourceName:"survey"}}),r.completeTrace(e)}catch(t){r.cancelTrace(e,{error:t})}},t.checkPersonalizedSurveyEligibility=function(e){const t=MsPortalFx.isFeatureEnabled("personalizedsurvey"),s=e.get(n.AuthStateManager).getCurrentUser(),o=!s.objectId,i=s.tenantId!==FxImpl.internalEnv.fxAadInfrastructureTenantId,a=t&&!o&&i;return r.trace({source:"PersonalizedSurvey.Data",action:"checkPersonalizedSurveyEligibility",data:{featureFlagEnabled:t,isPassthroughUser:o,notInfrastructureTenant:i,isEligible:a}}),a}})),
define("MsPortalImpl/UI/UI.Initialize",["require","exports","MsPortalImpl/Widgets/Widgets.Common","Fx","Fx/Diagnostics","Fx/DependencyInjection","Fx/Feedback","Fx/Telemetry","Fx/UriBuilder","MsPortalImpl/Services/Services.BrowserTelemetry","Fx/Composition/Selectable","FxInternal/Experimentation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.DialogManager","FxInternal/AsyncLoader","MsPortalImpl/RpcEndPoints","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/ClaimsIdentity","MsPortalImpl/Base/Languages","MsPortalImpl/Base/Themes","MsPortalImpl/Controls/ControlBindings.Async","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.PrintHandler","MsPortalImpl/Services/Services.AssetTypes.Rpc","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Clarity","MsPortalImpl/Services/Services.HatsSettings","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.FileUploadEndpointRegistration","MsPortalImpl/Services/Services.FileUploadInitialization","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Services/Services.MfaSettings","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Services/Services.PortalPollingManager","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.SessionManager","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Recents","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.ShellProvisioner","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.TelemetrySharing","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/Services/Services.Util","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Widgets/Widgets.ToastViewModel","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/UI/UI.DirectoryHelper","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/UI/Hubs/UI.NotificationHelper","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Notifications/NotificationsArea","MsPortalImpl/UI/Hubs/UI.NotificationsPane","MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration","MsPortalImpl/UI/UI.AdvisorNotificationHelper","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.CopilotToastHelper","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.NpsHelper","MsPortalImpl/UI/UI.SessionHandler","MsPortalImpl/UI/UI.StatusHandler","MsPortalImpl/Services/Services.ProjectedDirectories","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Notifications/PortalNotifications","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/UI/UI.PassthroughUser","MsPortalImpl/Services/Services.GitHub","FxInternal/Notifications","Fx/Experimentation","MsPortalImpl/Widgets/PersonalizedSurvey.Data","MsPortalImpl/Utilities/UrlUtilities","FxInternal/Events","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.FxClick","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Services/Services.SharedSettings","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h,g,f,x,b,y,v,M,C,P,w,I,S,_,F,T,k,D,E,B,A,N,R,L,O,z,H,U,W,V,j,q,G,K,J,Q,X,Z,Y,ee,te,se,oe,ie,ne,re,ae,le,ce,de,pe,ue,me,he,ge,fe,xe,be,ye,ve,Me,Ce,Pe,we,Ie,Se,_e,Fe,Te){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.Portal=t.registerAsyncHandlers=t.subscribeNotifications=t.routeIfHash=void 0;var ke=FxImpl.Extension,De=FxImpl.TriggerableLifetimeManager,Ee=MsPortalFx.Base,Be=Ee.Constants.Shell,Ae=Ee.Diagnostics,Ne=Ae.Telemetry,Re=FxImpl.NetDiagnostics,Le=Ee.Resources,Oe=FxImpl.Rpc,ze=MsPortalFx.Hubs.Notifications.NotificationStatus,He=FxImpl.Hubs.Notifications,Ue=Ee.Net2,We=FxImpl.Base.Diagnostics.Metric;const Ve=window,je=Ve.performance,qe=Ve.fx,$e=qe.getTimestamp;let Ge=Ne.flush,Ke=We.flush;const Je=Oe.client,Qe="Shell",Xe=qe.environment,Ze=Xe.links,Ye=Xe?.customNotificationsProvider,et="TopBar",tt=MsPortalFx.ensureSuffix,st=MsPortalFx.getLogFriendlyMessage,ot=MsPortalFx.noop,it=tt(Le.getAppRelativeUri("/"),"/"),nt=Ve.location,rt=(0,i.createLog)(e),at=it+"SignOut",lt=e=>it+e.slice(1),ct="loadedPageVersion",dt=q.ComponentName.Telemetry,pt="FirstVisitedTimestamp",ut=Object.create(null),mt="portalInit_lastSessionId";let ht,gt,ft="";function xt(e,t,s){t&&t.startsWith("#")&&e.route(t,s)}function bt(e,t,s){a.trace({source:e,action:t,data:s})}function yt(e,t,s,o,i){bt(Qe,"PortalInitializeNpsModal"),ge.showPortalNps(e,t,s,o,i).catch((e=>{bt(Qe,"PortalInitializeNpsModalFailure",{error:st(e)})}))}function vt(e){e=e||{};const t=new l(at);t.query.setParameters(e);const s="feature.msaljs",o=new l(Ve.location.href).query.getParameter(s);return o&&t.query.setParameter(s,o),t.toString()}function Mt(e){const t=Pe.temporaryExtensionCount.getExtensionCountsAsList();e.addExtensionCounts(t),Pe.temporaryExtensionCount.flush()}Ue.setAjaxLogFunc((function(){rt.warning.apply(rt,arguments)})),t.routeIfHash=xt;let Ct=function(e,t,s,o){Date.now()>t&&wt(e,s,o)};const Pt="Redirect_BootParameters";let wt=function(e,t,s){clearInterval(s()),e.addCallbacks({onIdle:e=>{if(5<e){MsPortalImpl.sessionStorage.setItem("wasForceReloaded","true"),Ne.trace({source:Qe,action:"ForceRefresh",actionModifier:"Idle",data:{idleTimeInMins:e,reloadAfterMilliseconds:t}});const s=[Ge(),Ke()];Promise.all(s).then((()=>{nt.reload(!0)}))}}})};async function It(e,t){const s=t.userInfo.isTenantParityDependent??!1,i=t.portalNotifications.shouldShowContactability(),n=ge.shouldShowPortalNps(t.generalSettings.npsTimeMs),r=t.portalNotifications.shouldShowIrisAdvisor(),a=await ue.shouldShowCopilotToast(e,t.userSettingsManager,t.userInfo.isTenantAdmin),l=t.generalSettings.notificationToastEnabledKey();Pe.temporaryExtensionCount.addIntervalId(setInterval((()=>Mt(t.hatsSettings)),6e5));let c="";if(s?c="SkippedModalsWhenParityDependent":(0,o.isFeatureEnabled)("hidemodalswhendeeplinked")&&t.deeplinkLoadedPortal?c="SkippedModalsWhenDeeplinked":l||(c="SkippedModalsWhenUserDisabled"),c)return bt(Qe,c,{deeplink:t.deeplinkLoadedPortal,isTenantParityDependent:s,shouldShowWelcomeSequence:t.eligibleForWelcomeSequence,shouldShowContactability:i,shouldShowNps:n,shouldShowAdvisorNotification:de.shouldShowAdvisorNotification(),shouldShowIrisAdvisor:r,shouldShowCopilotToast:a,shouldShowModalsAndToasts:l}),n?yt(t.generalSettings,t.userSettingsManager,t.toastVM,t.generalSettings.npsTimeMs,e):void(a&&await ue.showCopilotToast(e,t.userSettingsManager,t.toastVM));if(t.eligibleForWelcomeSequence){const e=performance.now();await t.welcomeSequenceCallback();const s=performance.now();return void bt(Qe,"PortalInitializeWelcomeModal",{welcomeSequenceLoadDuration:s-e})}if(i)return bt(Qe,"PortalInitializeUpdateContactModal"),void await t.portalNotifications.showContactabilityModal(e);if(r)return bt(Qe,"PortalInitializeIrisAdvisor"),void await t.portalNotifications.showIrisAdvisor(e);if(!(0,o.isFeatureEnabled)("showirisadvisor")&&await de.showAdvisorNotification(t.userSettingsManager))bt(Qe,"PortalInitializeAdvisorModal");else{if(!n)return a&&await ue.showCopilotToast(e,t.userSettingsManager,t.toastVM),function(e,t){if((0,o.isFeatureEnabled)("canmodifyextensions")||(0,o.isFeatureEnabled)("testdevsat"))return(0,o.require)("MsPortalImpl/UI/UI.DevSATSurvey").then((s=>{s.showDevSAT(e,t)}))}(t.toastVM,t.generalSettings.devSatTimeMs);yt(t.generalSettings,t.userSettingsManager,t.toastVM,t.generalSettings.npsTimeMs,e)}}function St(e){return(0,o.isFeatureEnabled)("mspfilter")?e.getAsync(be.ServicesProjectedDirectories):Promise.resolve(void 0)}function _t(e,t,s,o,i){e.notifications.subscribeArrayChanges(t,(e=>{ie.showToastAndUpdateCount(s,e,s.get(FxImpl.Features).isEnabled("enablecustomnotificationsprovider")&&ut.customNotificationsProviderViewModel?.isPaneOpen?ut.customNotificationsProviderViewModel:o,i)}),(e=>{ie.updateNotificationCount(e,o)}))}t.subscribeNotifications=_t;const Ft={initializeCustomTopBarButtons:function(e,t){const s="fxs-topbar-active";e.topBar.customTopBarButtonClick=(o,i,n)=>{bt(et,"CustomTopBarButtonClicked",{bladeTarget:o,extensionName:i});const r=e.getWidget().element.find(`.${n}`),a=r.hasClass(s);if(r.toggleClass(s,!a),a)t.get(pe.RightContextPane).close();else{const r=new d.PdlBladeReference(o,i,{onClosed:()=>{bt(et,"CustomTopBarButtonClosed",{bladeTarget:o,extensionName:i});e.getWidget().element.find(`.${n}`).removeClass(s)}});t.get(ee.BladeOpener).openBlade(r,{flags:1,telemetryName:`CustomTopBarButtonOpened_${o}`}).then((()=>bt(et,"CustomTopBarButtonOpened",{bladeTarget:o,extensionName:i}))).catch((e=>{bt(et,"CustomTopBarButtonOpenFailed",{error:e,bladeTarget:o,extensionName:i})}))}}},initializeFeedbackPane:function(e,t){e.feedbackButtonClick=()=>{t.getAsync(te.FeedbackPaneInfo).then((e=>{const t=e.widget;bt(et,"FeedbackSmileyClicked",{isPaneOpen:t.isVisible()}),t.toggle()}))}},initializeNotificationsPane:function(e,t,s,i,n){const r=new ae.ViewModel(t),a=Ye?.blade,l=t.get(FxImpl.Features).isEnabled("enablecustomnotificationsprovider"),c=(0,o.memoizePromise)((()=>{if(!l||!a)return(0,o.require)("MsPortalImpl/Widgets/Widgets.NotificationsPane").then((e=>new e.Widget(n,r)))}));_t(i,n,t,r,s),e.topBar.notificationButtonClick=()=>{if(l&&a){const e=new d.PdlBladeReference(a,Ye?.extensionName);t.get(ee.BladeOpener).openBlade(e,{flags:1,telemetryName:`OpenCustomNotificationsPane_${a}`}).then((e=>{e&&(s.removeAllToasts(),ut.customNotificationsProviderViewModel?.isPaneOpen(!0))})).catch((e=>{bt(et,"OpenCustomNotificationsPaneFailed",{error:e})}))}else c().then((e=>{e.toggleNotificationsContextPane().then((e=>{e?(s.removeAllToasts(),ie.updateUnreadCountOnButton(0)):r.isPaneOpen(!1)}))}))};const p={events:"fxtoastclick",handler:(e,t)=>{i.handleNotificationClick(t.data.value,!0)}};s.eventHandlers.push(p)},initializeSearch:function(e,t,s){e.initOptions((()=>(0,o.require)("MsPortalImpl/Widgets/Widgets.SharedOptionsInit").then((o=>{o.initSearchWidgetOptions(s,e,t)}))))},initializeSettings:function(e,t,s){const o=e.topBar;let i=1;s.isEnabled("hidesettingsoverview")&&(i=s.isEnabled("hidedirectorypanebutton")?4:2),o.settingsButtonClick=()=>{const s=e.settingsFlyoutState.value;let o=!0;if(0===s&&(o=t.get(pe.RightContextPane).close()),o){bt(et,s?"SettingsFlyoutClose":"SettingsFlyoutOpen");const t=0!==s?0:i;e.settingsFlyoutState(t)}}},initializeTopBar:function(e,t,s,o,i){const n=t.get(Y.ViewModel),r=e.topBar;this.initializeSettings(e,t,i),this.initializeFeedbackPane(r,t),MsPortalFx.tryImmediateResolve(e.onWidgetCreate(),(()=>{!i.isEnabled("asyncSearch")&&this.initializeSearch(r.searchViewModel,t,s)})),this.initializeNotificationsPane(e,t,n,o,s),this.initializeCustomTopBarButtons(e,t)},markFromNavigation:function(e){je.mark(e);try{je.measure(e,"Navigation",e)}catch(t){const s=[t];try{s.push(...je.getEntriesByName("Navigation")||[]),s.push(...je.getEntriesByName(e)||[])}catch(e){s.push(e)}rt.error("Error calling Performance.measure",0,...s)}}};function Tt(e){return e.getAsync(U.SettingsManager).then((e=>U.queryStores(e,[4]))).then((e=>{const t=e?.get(4),s=t&&t[V.startBoardSettingsKey];return s&&s.dashboardId||""}))}function kt(e){e.get(U.PortalStartupMarkers).preloadDashboardStart=$e(),Ft.markFromNavigation("preloadDashboardBundle"),(0,o.require)("MsPortalImpl/UI/Dashboard/DashboardManager"),MsPortalFx.tryImmediateResolve(function(e){const t=(0,ve.getCurrentUri)().getHashParts();return"dashboard"===t.category.toLowerCase()&&t.rest?Promise.resolve(t.rest):Tt(e)}(e),(t=>{t=(t||"").toLowerCase();const s=e.get(U.PortalStartupMarkers);t?.startsWith("private")?(Ft.markFromNavigation("preloadDashboardPrivateRepoBundle"),(0,o.require)("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository"),s.preloadDashboardRepoStart=$e(),s.preloadDashboardRepoType="private"):t?.startsWith("arm")&&(Ft.markFromNavigation("preloadDashboardArmRepoBundle"),(0,o.require)("MsPortalImpl/UI/Dashboard/ArmDashboardRepository"),s.preloadDashboardRepoStart=$e(),s.preloadDashboardRepoType="arm")}))}function Dt(e,t,s){e.get(t).setRegistration(s)}function Et(e,t,s){Dt(e,t,((t,o)=>function(e){const t=e.get(U.PortalStartupMarkers);return t.hasOwnProperty("requireDashboardStart")||(t.requireDashboardStart=$e()),e.getAsync(g.get("MsPortalImpl/UI/Dashboard/DashboardManager","DashboardManagerImpl"))}(e).then((e=>s(e,t,o)))))}function Bt(e){Et(e,ye.StartNewDashboardPortalFunc,((e,t,s)=>e.startNewDashboard(s))),Et(e,ye.ExportDashboardPortalFunc,(e=>e.getArmDashboardJson())),Et(e,ye.ImportDashboardPortalFunc,((e,t)=>e.importDashboard(t.dashboard,t.title))),Et(e,ye.ReadDashboardPortalFunc,((e,t)=>e.readDashboardsForType(t.repositoryType,t.subscriptions,t.useArg,t.includeRecents))),Et(e,ye.SwitchDashboardPortalFunc,((e,t,s)=>e.switchDashboard(t,s))),Et(e,ye.ResetDashboardPortalFunc,((e,t)=>e.resetLayout(t.duringPortalStartup,t.force))),Et(e,ye.CloneDashboardPortalFunc,(e=>e.cloneCurrentDashboard())),Et(e,ye.UpdateDashboardPortalFunc,((e,t)=>e.updateDashboard(t.dashboard))),Et(e,ye.ClonePartPortalFunc,((e,t,s)=>e.clonePartToDashboardJson(t.partComposition,s,t.dashboard,t.isCopyExperience))),Et(e,ye.AssignTagsToDashboardPortalFunc,((e,t,s)=>e.assignTagsToDashboard(s))),Et(e,ye.ShareCurrentDashboardPortalFunc,((e,t)=>e.shareCurrentDashboard(t.title,t.armExtras))),Et(e,ye.ShareDashboardToSessionPortalFunc,((e,t)=>{e.shareCurrentDashboardToSession(t)})),Et(e,ye.UnshareDashboardToSessionPortalFunc,(e=>e.unshareCurrentDashboard())),Et(e,ye.GetUserPermissionsForDashboardPortalFunc,((e,t)=>e.getPermissions(t))),Et(e,ye.IsCurrentDashboarSharedPortalFunc,(e=>e.isCurrentDashboardShared())),Et(e,ye.GetCurrentDashboardPropertiesPortalFunc,(e=>e.getCurrentDashboardProperties())),Et(e,ye.PinTilesPortalFunc,((e,t,s)=>e.pinMultipleParts(t.partReferences,t.originExtension,t.notify,s,t.dashboard?t.dashboard:null,t.dashboardCreationOption?t.dashboardCreationOption:null))),Et(e,ye.PinTileWithOptionsPortalFunc,((e,t,s)=>e.addPartToStartBoard(t.options,t.duringPortalStartup,t.shouldSave,s))),Et(e,ye.PinBladePortalFunc,((e,t,s)=>e.pinBladeToDashboard(t,s))),Et(e,ye.PinTilePortalFunc,((e,t,s)=>e.pinPartToStartboard(t,s))),Et(e,ye.DeleteDashboardWithConfimationPortalFunc,((e,t)=>e.deleteDashboardWithConfirmation(t.currentContext,t.reasonDeleted))),Et(e,ye.RefreshDashboardPortalFunc,((e,t,s)=>e.refreshDashboard(s))),Dt(e,ye.RoutePortalFunc,(t=>e.getAsync(g.get("MsPortalImpl/Base/Base.Router","Router")).then((e=>e.route(t.uri,t.openedByContext))))),Dt(e,ye.ReplacePartPortalFunc,(t=>g.get("MsPortalImpl/UI/UI.ReplacePart","replacePart").then((s=>s(e,t.part,t.newLocator,t.options))))),Dt(e,ye.ReloadPartPortalFunc,(t=>g.get("MsPortalImpl/UI/UI.ReloadPart","reloadPart").then((s=>s(e,t))))),Dt(e,ye.CreateJourneyForBladeFunc,(t=>g.get("MsPortalImpl/UI/UI.CreateJourney","createJourney").then((s=>s(e,t,!1))))),Dt(e,ye.CreateJourneyForAssetFunc,(t=>g.get("MsPortalImpl/UI/UI.CreateJourney","createJourney").then((s=>s(e,t,!0))))),Dt(e,ye.ToggleCloudShell,(()=>e.getAsync(g.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole")).then((e=>{e.toggle()}))))}function At(e,t){const s=(t=t||{}).duration||$e(),o=t.data||{};return Ne.trace({timestamp:t.endTime,source:Qe,action:e,actionModifier:Ne.ActionModifier.Complete,duration:s,data:o}),We.record({name:e,value:s,dimensions:{actionModifier:Ne.ActionModifier.Complete}}),Ft.markFromNavigation(e),s}t.registerAsyncHandlers=Bt;let Nt=function(){nt.href=nt.origin};let Rt=class{constructor(e){this._diContainer=e,this._lifetime=new De}async initialize(t){const i=this._lifetime,n=this._diContainer,a=n.get(he.RootElements),d=n.get(FxImpl.Features),ee=n.get(q.StorageService),ae=new l(nt.href),de=$e();Ft.markFromNavigation("enterUIInitialize"),Ne.Internal.initialize({extensionName:Qe,userQuery:MsPortalEarly.userQuery}),We.Internal.initialize({extensionName:Qe,userQuery:MsPortalEarly.userQuery}),MsPortalEarly.initializedTelemetry(Ne.trace);const pe=setInterval((()=>{Ge(),Ke()}),14e3);C.initialize();const ue=n.get(p.ExperimentationManager),be=await ue.shellAssignments.whenAvailable();if(!(0,Te.isTestEnvironment)()){if(be.getBooleanValue("showUnsafeURLCustomizationWarning")){const e=10;await async function(e,t){if(e.size>0){ko.bindingHandlers.pcSimpleButton=s.getAsyncBindingHandler("MsPortalImpl.Controls/Controls/SimpleButton",null);const o=t.get(h.DialogManager),i=new h.MessageBox(u.Shell.Dialogs.unsafePortalTitle,null,4),n=Array.from(e,(([e,t])=>`${e}: ${t}`));i.description=`${u.Shell.Dialogs.unsafePortalDescription.format(["",...n].join("<br/>"))}`,i.defaultButtonText=u.Shell.Dialogs.unsafePortalReload,i.cancelButtonText=u.Shell.Dialogs.unsafePortalContinue,bt(Qe,"PortalUnsafeParamsDialogShown",{PotentiallyUnsafeURLParams:Array.from(e.keys())}),Ft.markFromNavigation("enterUnsafePortalDialog"),6===await o.showModalDialog(i)&&Nt(),Ft.markFromNavigation("exitUnsafePortalDialog")}}((0,Te.getUnsafeParams)(e),this._diContainer)}}t.resolve(!0),Bt(n),Ne.trace({source:Qe,action:"TrackPreviousSessionId",data:MsPortalImpl.sessionStorage.getItem(mt)}),MsPortalImpl.sessionStorage.setItem(mt,MsPortalFx.sessionId);const Pe=function(e){return e.getAsync(U.SettingsManager).then((t=>Promise.all([t.querySetting(12,pt),e.getAsync(N.GeneralSettings),e.get(FxImpl.Features)]).then((([t,s,o])=>{const i=!t;return o.isEnabled("landalltohome")&&i&&s.landingPage(1),(0,N.isLandingPageDashboard)(e)}))))}(n);!function(e,t){const s=(0,ve.getCurrentUri)().getHashParts().category.toLowerCase();switch(s){case"blade":case"create":case"asset":case"resource":["MsPortalImpl/UI/UI.CreateJourney","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener"].forEach((e=>{(0,o.require)(e),bt(Qe,"PortalInitializeDeeplinkPreload",{routeType:s,moduleId:e})})),ft=s;break;case"dashboard":kt(e);break;case"":(0,o.isFeatureEnabled)("azureHome")?t.then((t=>{t&&kt(e)})):kt(e)}}(n,Pe),await Promise.all([n.getAsync(m.AuthStateManager),n.getAsync(P.ExtensionManager),n.getAsync(z.SecurityTokensManager),n.getAsync(U.SettingsManager),n.getAsync(W.MruTokensSettingsManager),St(n)]).then((([t,s,l,p])=>{const C=Xe.pageVersion,W=function(e,t){const s=e.getValue(dt,ct,0);return t!==s&&e.setValue(dt,ct,t,0),s}(ee,C),ue=n.get(U.PortalStartupMarkers);ue.defaultRoute=!1,ue.splashScreen=MsPortalEarly.splashScreenLoadTime,ue.initializeStart=$e(),ue.enterUIInitialize=de,ue.loadedSameVersion=C===W,ue.previousVersion=W||"",ue.performanceTelemetry=FxImpl.NetDiagnostics.getPerformanceTelemetry(),ue.requireConfigPerf=MsPortalImpl.requireConfigPerf,Ft.markFromNavigation("initializeStart"),function(){const e=MsPortalImpl.sessionStorage.getItem("SavedLogs")||"{}";try{const t=JSON.parse(e);t?.length&&t.forEach((e=>Ne.trace({timestamp:e.timestamp,source:e.source,action:e.action,actionModifier:e.actionModifier,duration:e.duration,data:e.data})))}catch{}MsPortalImpl.sessionStorage.removeItem("SavedLogs")}();const he=t.bootstrapState,Te=he.loginReplyUrlPath,De=t.getCurrentUser();FxImpl.Base.Diagnostics.setObjectIdToScrub(De.objectId);const Ee=new URLSearchParams(window.location.search),Le=Ee.get("msaljslogin");if(!he)return bt(Qe,"SignInRedirect","AuthBootstrapState not found. Redirecting the user to sign-in."),void x.redirectWithCdn(n,{uri:lt(Te),parameters:Le&&m.getMsalJsLoginQueryParameters(Le),hash:nt.hash});d.isEnabled("enableanimations",!0)||$.enableAnimations(!1);const We="/auth/login/"===Te,qe=MsPortalFx.isFeatureEnabled("msaljslogin")&&be.getBooleanValue("msaljsloginexp");z.persistOrClearFeatureValueInLocalStorage(qe,"MsalJsLoginEnabled"),bt("UI.Initialize","msalJsLoginState",{currentPortalLoginWithMsalJs:We,nextPortalLoginWithMsalJs:qe});const tt=be.getBooleanValue("mfaloginexp");z.persistOrClearFeatureValueInLocalStorage(tt,"MfaLoginEnabled"),bt("UI.Initialize","mfaEnabledState",{mfaExpEnabled:tt,currentPortalLoginWithMsalJs:We,nextPortalLoginWithMsalJs:qe});bt("UI.Initialize","mfaLoginState",{currentPortalLoginWithMsalJs:We,isMfa:De.isMfa});const at=n.get(L.PortalIdleStateService);f.registerRpc(n);const mt=/^.*[/|.]entra\..*$/i.test(FxImpl.trustedParentOrigin??""),yt=new S.PortalReader(i,{idPrefix:"portal"});yt.read(mt?u.Shell.Reader.entraLoading:u.Shell.Reader.portalLoading);const vt=n.get(xe.StatusHandler);n.get(k.ClarityManager).initialize();const Mt=Promise.all([n.getAsync(N.GeneralSettings),n.getAsync(Me.PortalNotifications),n.getAsync(D.HatsSettings),n.getAsync(E.UserDirectorySettings),n.getAsync(oe.FavoritesManager),n.getAsync(M.ThemeManager),n.getAsync(P.ExtensionManagerOptions)]).then((([m,f,C,P])=>{ue.initializeGeneralSettings=$e(),Ft.markFromNavigation("initializeGeneralSettings");const S=v.initialize(i,n,d.shellFeatures.fromQuery.l,void 0!==ae.query.getParameter("l"));S.requireRedirect&&this._redirect({uri:null,skipFlushBuffers:!0,reason:"Locale",logData:S}),MsPortalFx.isObject(Xe)&&console.log("Version: "+Xe.version+"\nSession: "+MsPortalFx.sessionId),w.initialize(),i.registerForDispose((()=>{w.dispose()}));const k=(0,Ce.getPortalViewModel)(n);ue.portalWidgetStart=$e(),n.get(Z.Widget),ue.portalWidgetEnd=$e(),te.initialize(i,n,k),ue.uiCompositionInitEnd=$e();const D=n.get(G.SubscriptionsUserContext).getGlobalSelectedSubscriptions().then((e=>e())),E=D.then((e=>{St(e),bt(Qe,"getGlobalSelectedSubscriptions",{first100SubscriptionIds:e.slice(0,100).map((e=>e.subscriptionId)),globalSelectedSubscriptionCount:e.length})}));(0,o.require)("MsPortalImpl/Services/Services.Recents").then((e=>e.loadRecentsFromLazyData(n)));const B=n.get(ne.NotificationManager);d.isEnabled("enablecustomnotificationsprovider")&&Ye?.provider&&(0,o.require)("MsPortalImpl/UI/UI.CustomNotificationsHelper").then((e=>{e.activateCustomNotificationProvider(n,B,ie.updateUnreadCountOnButton,ut)})).catch((e=>{bt(Qe,"GetCustomNotificationsHelperFailed",{error:e})})),n.get(re.DataContext),s.lastExtensionError.subscribeAndRun(i,(e=>{e&&B.addClientNotification({title:u.Shell.extensionError,description:u.Shell.loadingError.format(e.name,`${fx.environment.trustedParentOrigin}/SelfHelp`),status:ze.Error,timestamp:new Date,descriptionAsHtml:!0})})),ke.extensionStatusEndPoint.register(Je,null,((e,t)=>{e&&wt(e,t.srcWindowId)}));const L=k.topBar;L.exitDevMode=()=>{a.showSplash(!0),MsPortalImpl.Extension.unregisterAll().then((()=>{this._redirect({uri:it})}))},Dt(n,ye.DownloadDiagnosticsJson,(()=>(0,o.require)("../Base/Base.ClientRawFileDownload",e).then((e=>{e.downloadFile({provideText:()=>W().then((e=>JSON.stringify(e,null,2)))},"PortalDiagnostics.json","charset=utf-8;application/json")}))));const z=(0,o.memoizePromise)((()=>(0,o.require)("../Base/Base.DebugInfo",e).then((e=>e.initialize(i,n)))));Dt(n,ye.ShowDebugTools,(e=>z().then((t=>t.toggleStickys(ht,e))))),(0,o.isFeatureEnabled)("telemetryinsights")&&Dt(n,ye.ShowTelemetryInsights,(async()=>{const{TelemetryInsights:t}=await(0,o.require)("../Services/Services.TelemetryInsights",e);n.get(t).toggleOverlay(i)})),n.get(I.KeyboardShortcutHandler),Dt(n,ye.ShowPersonalizedSurvey,(async()=>{const e=(await(0,o.require)("MsPortalImpl/Widgets/Widgets.PersonalizedSurvey")).Widget.create(n,k);return i.registerForDispose(e),e})),Dt(n,ye.ShowWelcomeSequence,(e=>g.get("MsPortalImpl/Widgets/Widgets.WelcomeSequence","Widget").then((t=>{const s=t.create(k,p,e,n);return i.registerForDispose(s),s}))));const U=()=>n.get(J.TenantsService).getTenants(),W=()=>Promise.all([(0,o.require)("MsPortalImpl/Base/Base.DiagnosticsPopup"),E,U()]).then((([e,t,s])=>e.getDiagnosticsData(n,ko.observableArray(s.tenants),l)));L.reportBug=()=>{(0,o.require)("./UI.Portal.Actions",e).then((e=>{e.reportBug(n,ae)}))},(0,o.isFeatureEnabled)("subscreditcheck")&&(0,o.isFeatureEnabled)("upgradefromtrialbutton")&&(0,o.require)("MsPortalImpl/Services/SubsCreditCheck").then((e=>{e.subscriptionsRequiringUpgrade.subscribeAndRun(i,(e=>{1===e.length?(Ne.trace({action:"FreeTrialUpgradeShown",source:"TopBar",data:{subscriptionId:e[0].subscriptionId,creditsRemaining:e[0].remaining}}),L.canUpgradeSubscription(!0),L.upgradeableSubscription({subscriptionId:e[0].subscriptionId,remaining:e[0].remaining})):L.canUpgradeSubscription(!1)}))}));const K=n.get(b.Router),oe=MsPortalFx.getIdGenerator("SideBarOpeningBlade");k.sideBar.launchBlade=(e,t)=>{const s=K.route(e,{openedBy:t?1:void 0}),o=k.getJourneyWidget();if(o){const e=oe();o.loadingHint(e,!0),s.finally((()=>{o.loadingHint(e,!1),o.trigger("fxbladerepos")}))}},T.initializeRpc(),Q.registerEndpoints(Oe.client,n),Ft.markFromNavigation("beforeInitDesktopMgr"),ue.beforeInitDesktopMgr=$e();const de=n.get(me.DesktopManagerImpl).initialize().then((()=>k.onWidgetCreate())).then((async()=>{Ft.markFromNavigation("desktopMgrInitialized"),ue.desktopMgrInitialized=$e();let e=await p.querySetting(12,pt);e||(e=Date.now(),p.setSetting(12,pt,e)),bt(Qe,"FirstVisited",{[pt]:e});const t=await p.querySetting(6,"gallery_createLauncher_lastUsed_subscriptionId");return bt(Qe,"LastUsedSubscriptions",t),Pe})).then((e=>{ue.defaultLandingView=e?"Dashboard":"Home",ue.defaultSideBarLayout=(0,N.isSideBarDocked)(n)?"Docked":"Flyout",ue.desktopAndExtensionManagerInitialize=$e(),Ft.markFromNavigation("desktopAndExtensionManagerInitialize");const t=d.isEnabled("nodirectory");return K.initialRoute((()=>(ue.defaultRoute=!0,K.goToLandingPage({interactionSource:"UIInitialize",replaceHistory:!0,skipFocus:t,invokedByInitRoute:!0}))),{skipFocus:t})})).then((()=>{Ft.markFromNavigation("setupInitialRoute"),ue.setupInitialRoute=$e(),L.getWidget().initReactiveLayout(be),a.showSplash(!1),ue.locationHash=ae.fragment.split("?")[0],ue.hiddenTime=MsPortalEarly.stopPageLoadTimeout(),ue.earlyLoad=MsPortalEarly.earlyLoadPerfData,ue.windowSize=window.innerWidth;const e=je.timing;if(e){const t=e.navigationStart;ue.fetchStart=e.fetchStart-t,ue.requestStart=e.requestStart-t,ue.responseStart=e.responseStart-t,ue.responseEnd=e.responseEnd-t,ue.domComplete=e.domComplete-t}const t={data:$.extend(ue,MsPortalFx.convertArrayToMap(["EntryPoint","SignInIndex"],(e=>`PageTelemetry_${e}`),((e,t,s)=>{const o=MsPortalImpl.sessionStorage.getItem(s);if(o)return MsPortalImpl.sessionStorage.removeItem(s),JSON.parse(o)})))};MsPortalEarly.blockedHosts.length>0&&rt.warning(`Fallbacks are being used for extension hosting service. The current blocked hosts are ${JSON.stringify(MsPortalEarly.blockedHosts)}`),clearInterval(pe),ht=At("TotalTimeToPortalReady",t),Ge(),Ke();const s=at.addCallbacks({onIdle:e=>{const t=Ve.navigator;t&&!1!==t.onLine&&e%15==0&&We(!0),at.removeCallbacks(s)}});!function(e){const t=Number((0,o.getFeatureValue)("reloadafterdays"));if(MsPortalImpl.sessionStorage.getItem("wasForceReloaded")&&(MsPortalImpl.sessionStorage.removeItem("wasForceReloaded"),(0,Se.publishNotification)({title:u.Shell.Dialogs.reloadPortalMessageTitle,description:u.Shell.Dialogs.reloadPortalMessageDescription.format(t),status:0,toastDuration:1})),t>0){const s=864e5*t,o=Date.now()+s,i=setInterval((()=>{Ct(e,o,s,(()=>i))}),36e5)}}(at),P.addRecentDirectory(De.tenantId)})).catch((e=>{gt=gt||"/LoadFailed?stack="+encodeURIComponent(e&&e.stack).slice(0,1e3)+"&message="+encodeURIComponent(e&&e.message).slice(0,1e3),this._redirect({uri:xe.errorUri+gt})}));n.get(se.SaveDirectorySettingsHandler).saveDirectorySettings(),de.then((()=>(0,we.checkPassthroughUserWithNoSubs)(n))).then((e=>{if(e)return(0,we.launchPassthroughModalDialog)(n,(()=>this._logoutHandler({securityTokensManager:l,telemetryEvent:{source:"UIInitialize",action:"PassthroughUserSignOut"},buildSignOutUriParams:{sid:he.aadSessionId,tid:De.tenantId}})))})).then((()=>{p.querySettings({store:7,keys:["WelcomeSequence"]}).then((e=>{if((0,R.handleMfaNotificationLogic)(De.isTenantAdmin,be,m),It(n,{deeplinkLoadedPortal:!ue.defaultRoute&&ft,welcomeSequenceCallback:()=>(0,Fe.checkPersonalizedSurveyEligibility)(n)?n.get(ye.ShowPersonalizedSurvey).invoke():n.get(ye.ShowWelcomeSequence).invoke({skipWelcomePrompt:!1,shouldDisplaySettingBubble:!1}),eligibleForWelcomeSequence:d.isEnabled("guidedtour")&&(!e||!e.WelcomeSequence)&&!d.isEnabled("ci"),portalNotifications:f,generalSettings:m,toastVM:Me,userSettingsManager:p,hatsSettings:C,userInfo:De}).catch((e=>{bt(Qe,"StartupModalsFailure",{error:st(e)})})),d.isEnabled("nodirectory")){n.get(b.Router).route("#settings/directory",{openedBy:7})}else;})).catch((e=>{bt(Qe,"QuerySettingsFailure",{error:st(e)})})),A.init(p);const e=u.Portal;if(d.isEnabled("internalonly")&&!d.isEnabled("canmodifyextensions")&&!t.isInternal){const t=FxImpl.trustedParentOrigin,s=t.replace(/^([^/]+\/\/).+\.([^.]+\.[^.]+\.[^.]+)$/,"$1$2");t!==s&&B.addClientNotification({status:ze.Information,title:e.preview,description:e.unsupportedEnvironment.format(t),uri:s,timestamp:new Date,uriAction:He.ClientNotificationUriAction.OpenInCurrentTab})}Promise&&Promise.prototype.finally&&Promise.allSettled&&Promise.any||n.getAsync(h.DialogManager).then((t=>t.showModalDialog({title:e.unsupportedBrowser,description:e.unsupportedBrowserDesc.format(Ze.unsupportedBrowser),buttons:1,showErrorIcon:!0})))})).then((async()=>{(await n.get(_e.Experimentation).shellAssignments.whenAvailable()).getBooleanValue("removebootparam")&&(await(0,o.delay)(1e3),sessionStorage.removeItem(Pt),localStorage.removeItem(Pt))})),F.setupAssetTypeServiceRpc(n),j.create(n),d.isEnabled("portalpolling")&&n.get(O.PollingManager).startPolling(),n.get(_e.Experimentation).shellAssignments.whenAvailable().then((e=>{e.getBooleanValue("sessionmanager")&&t.getUserInfo().then((e=>{n.get(H.SessionManager).initialize(e.directoryName)}))}));let fe=null;Ae.ErrorReporter.initialize((()=>{fe=fe||n.get(me.DesktopManagerImpl),rt.debug(fe.getDiagnosticsData())}),!1,(()=>(fe=fe||n.get(me.DesktopManagerImpl),fe.getCurrentBladeInfo())));const Me=n.get(Y.ViewModel);Ft.initializeTopBar(k,n,i,B,d);const Be=n.get(FxImpl.Rpc.Client);r.Internal.showNpsEndpoint.register(Be,null,((e,t)=>{ge.showNps(m,p,Me,e.productDisplayName,`${t.srcWindowId||""}_${e.productId}`)})),r.Internal.canShowNpsEndpoint.register(Be,null,(()=>!ge.npsShownInSession));const Re=L.avatarMenuVM;De.gitHubUserId&&(0,Ie.fetchGitHubAccountInfo)(De.gitHubUserId).then((e=>Re.gitHubUserInfo(e))),Re.userIdentity(De),Re.hideTenant(d.isEnabled("hideavatartenant"));const Ue=d.isEnabled("tenants2020");t.getUserInfo().then((e=>{let t;if(Re.userInfo(e),Ue&&(Re.tenantDisplayName(e.uniqueDirectoryName),Re.listOfTenants.setAll([{id:e.directoryId,domainName:e.domainName,displayName:e.directoryName,tenantCategory:""}])),d.isEnabled("saveDeploymentNotification")){try{t=JSON.parse(MsPortalImpl.sessionStorage.getItem("_msPortalFx-Session-Deployments-{0}".format((e.objectId||e.email)+e.directoryId)))||{}}catch{return}Object.keys(t).length&&(0,o.require)("MsPortalImpl/Services/Services.DeploymentSession").then((e=>{n.get(e.DeploymentSession).restoreDeployments(n)}))}})),Ue||U().then((e=>{const t=e.tenants;_t(t),Re.listOfTenants.setAll(t)})),Re.showDiagnostics=()=>n.get(ye.DownloadDiagnosticsJson).invoke(),Re.showDebugTools=()=>n.get(ye.ShowDebugTools).invoke(),Re.signedOut=()=>{this._logoutHandler({securityTokensManager:l,telemetryEvent:{source:et,action:"AvatarMenuSignOut"},redirectAction:15})},Re.openAccountPortal=()=>{const e=Ze.accountPortal;bt(et,"AvatarMenuOpenBilling"),xt(K,e.startsWith("#")?e:e+"subscriptions",{openedBy:7})},Re.switchDirectory=()=>{const e=n.get(b.Router);bt(et,"SettingsFlyoutOpen",{launchedBy:"AvatarMenu"}),e.route("#settings/directory",{openedBy:7})},Re.openGitHubProfile=De.gitHubUserId?()=>{bt(et,"AvatarMenuOpenGitHubProfile",{launchedBy:"AvatarMenu"}),(0,Ie.fetchGitHubAccountInfo)(De.gitHubUserId).then((e=>window.open(e.html_url,"_blank")))}:ot;const We=e=>{let t;t=De.gitHubUserId?Promise.resolve(`${"https://avatars.githubusercontent.com/u/{0}".format(De.gitHubUserId)}`):d.isEnabled("serveravatar")?p.queryStore(0).then((e=>(ee.clearAllComponentItems(q.ComponentName.Avatar,0),(e||{})[V.avatarKey]||De.defaultAvatarUri))):y.getAvatarImage(De.emailAddress,De.avatarUri,De.defaultAvatarUri,ee,e),t.then((e=>{Re.avatarImage(e)})).catch((e=>{bt(et,"AvatarImageFetchFailed",{error:st(e)})}))};We(),Re.submitAnIdea=()=>{bt(et,"AvatarMenuOpenFeedback"),Ve.open(Ze.submitAnIdea,"_blank")},Re.showSessionManager=()=>{bt(et,"AvatarMenuOpenSessionManager"),n.get(ye.CreateJourneyForBladeFunc).invoke({extension:"HubsExtension",detailBlade:"SessionManager.ReactView",detailBladeInputs:{resourceId:""},defaultMenuItemId:void 0})};const qe=()=>{const e=Ze.accessDetails;return!(!e||!e.startsWith("#"))&&(bt(et,"AvatarMenuOpenAccessDetails"),xt(K,e,{openedBy:7}),!0)};Re.showMyAccessBlade=()=>{(0,o.isFeatureEnabled)("vlcentralcustommecontrollinks")?qe():qe()||(bt(et,"AvatarMenuOpenAccessDetailsDefault"),n.get(ye.CreateJourneyForBladeFunc).invoke({extension:"HubsExtension",detailBlade:"MyAccess.ReactView",detailBladeInputs:{resourceId:""},defaultMenuItemId:void 0}))},D.then((e=>{const t=(Mt.selectedFormatCulture||"").toLowerCase().split("-").slice(-1)[0];Re.contactInfoEnabled(e.length&&d.isEnabled("contactinfo")&&!["at","ru","de","gr"].includes(t))})),Re.showContactInfoBlade=()=>{bt(et,"AvatarMenuOpenContactInfo"),k.settingsFlyoutState(6)},Re.switchAccount=e=>{let t=e?{loginHint:e}:{selectAccount:"true"};Le&&(t={...t,"feature.msaljslogin":"true",msaljsscript:"true"}),x.redirectWithCdn(n,{uri:lt(Te),parameters:t,hash:x.getHashQueryStringSegment(nt.href),redirectAction:2})},!d.isEnabled("ci")&&(o.isDevelopmentMode||MsPortalEarly.query.clientoptimizations&&"true"!==MsPortalEarly.query.clientoptimizations||d.isEnabled("canmodifyextensions"))&&z().then((e=>e.startErrorDetection(i)));const tt="data-click-telemetry";let ct;k.customEvents.addHandler(i,"mousedown",(e=>{ct=e.target})),k.customEvents.addHandler(i,"mouseup",(e=>{const t=ct;if(ct=null,e.target===t){const e=k.getRootElement()[0],s=$(t).closest(`[${tt}]`,e);if(s.length){const t=s.attr(tt)+"",o=s.closest(".fxs-tile",e).data(X.CompositionInstanceDataName),i=o?.locator,n=i?.toFriendlyString()||Qe;Ne.trace({source:n,action:"CustomClick",name:t})}}})),le.registerViewModels(n),ce.registerViewModels({diContainer:n,securityTokensManager:l,tenants:_t}),vt.isShellInitialized.resolve();n.get(_.PrintHandler).init(this._lifetime);const dt=n.get(M.ThemeManager),mt=dt.currentTheme().name,yt=dt.highContrastMode(),Mt=v.currentLocaleContext,Tt=Mt.selectedDisplayLanguage,kt=Mt.selectedFormatCulture||Tt,Et=c.getBrowserInfo(),Bt=k.sideBar.isCollapsed.value?"collapsed":"expanded",Nt=ee.clearValue(q.ComponentName.Redirect,"Referrers",1),Rt="1"===Ee.get("pwa");return Promise.all([n.get(J.TenantsService).getHomeTenantsCount(),n.get(G.SubscriptionsUserContext).getAllSubscriptionsCount(),n.get(G.SubscriptionsUserContext).getGlobalDisplayedSubscriptions()]).then((([e,t])=>{const s=(0,ve.getCurrentUri)().getHashParts().category,o="dashboard"===s?`${s}/${(0,ve.getDashboardTypeFromUri)()}`:s;Ne.trace({source:"UIInitialize",action:"PortalInitialized",data:{selectedDisplayLanguage:Tt,formatCulture:kt,sidebarState:Bt,defaultLandingView:ue.defaultLandingView,defaultSideBarLayout:ue.defaultSideBarLayout,currentTheme:mt,highContrastMode:yt,tenantsCount:e,subscriptionsCount:t.value,freeTrial:L.canUpgradeSubscription.value,deepLinkType:o,referrers:Nt,browserInfo:Et,userAgentData:Ve.navigator.userAgentData??{},isStandalonePwa:Rt,defaultMenuCollapseSetting:(0,N.stringifyDefaultMenuCollapseState)(m.defaultMenuCollapseState())}})})),de})),wt=(e,t)=>{vt.onStatus(e,t)},St=ko.observable(),_t=ko.observableArray();return Re.registerTelemetrySubmissionHandler(),FxImpl.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),Ue.status.subscribe(i,(e=>{wt(e,Be)})),n.getAsync(K.SharingTelemetryProcessor).then(Ne.addProcessor),function(e){if(!e||!je?.getEntriesByType||!je.timing)return;const t=$e(),s=function(e,t,s){At(e,{duration:t,endTime:Math.round(s+je.timing.navigationStart)})},o=je.getEntriesByType("resource").filter((e=>{const t=e.initiatorType;return"link"===t||"script"===t}));let i=o.reduce(((e,t)=>Math.min(t.startTime,e)),1/0),n=o.reduce(((e,t)=>Math.max(t.responseEnd,e)),0);const r=n-i,a=n;i=Math.max(i,e),n=Math.min(n,t);const l=n-i,c=t-l-e;s("TotalTimeToSplashScreen",e,e),s("TotalStartupResourceDownload",r,a),s("StartupResourceDownload",l,n),s("StartupScriptExecution",c,t)}(MsPortalEarly.splashScreenLoadTime),Mt.then((()=>{yt.read(mt?u.Shell.Reader.entraReady:u.Shell.Reader.portalReady),fe.initialize(n,this._lifetime,t,n.get(N.GeneralSettings).idleTimeoutMins,at,(()=>this._logoutHandler({securityTokensManager:l,telemetryEvent:{source:"UIInitialize",action:"IdleTimeoutSignOut"},buildSignOutUriParams:{sid:he.aadSessionId,tid:De.tenantId}})),De.tenantDomain,vt)})),B.registerFileUploadEndpoints(),A.uploadSettingsManager=p,Xe.oneDsInstrumentationKey&&d.getValue("enable1ds")&&setTimeout((async()=>{(await(0,o.require)("MsPortalImpl/Services/Services.1ds")).initialize()}),5e3),Mt}))}dispose(){Pe.temporaryExtensionCount.flushIntervalIds(),this._diContainer.isDisposed||Mt(this._diContainer.get(D.HatsSettings)),this._lifetime.dispose(),FxImpl.resetGlobalState()}_redirect(e){this._diContainer.get(he.WindowManager).redirect(e)}async _logoutHandler(e){const{securityTokensManager:t,telemetryEvent:s,redirectAction:o,buildSignOutUriParams:i}=e,n=await t.portalAuthHandlerPromise,r=!!n,a={...s.data};s.data={telemetryEventData:a,isPortalAuthHandlerInitialized:r},Ne.trace(s),r&&await n.localLogout(),this._redirect({uri:vt(i),redirectAction:o})}};t.Portal=Rt,t.Portal=Rt=__decorate([__metadata("fx:diagnostics",[e,"Portal"]),n.Class(),__metadata("design:paramtypes",[n.Container])],Rt)})),
define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["module"],(function(e){"use strict";return{css:".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14,.msportalfx-svg-c32{fill:#57a300}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.fxs-mode-light .msportalfx-svg-c22{fill:#a4262c}.msportalfx-svg-c23{fill:#cae3f3}.msportalfx-svg-c24{fill:#59aed3}.msportalfx-svg-c25{fill:#4c3b12}.msportalfx-svg-c26{fill:#be9555}.msportalfx-svg-c27{fill:#4f4d52}.msportalfx-svg-c28{fill:#ef6f59}.msportalfx-svg-c29{fill:#f7cb64}.msportalfx-svg-c30{fill:#fdd8db}.msportalfx-svg-c31{fill:#f6ffec}.msportalfx-svg-c33{fill:#8a2da5}.msportalfx-svg-c34{fill:#e00b1c}.msportalfx-svg-c35{fill:#015cda}.msportalfx-svg-c36{fill:#5db300}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.msportalfx-inverted-theme .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05{fill:#777}.msportalfx-inverted-theme .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white{fill:#fff}.msportalfx-svg-palette-blue{fill:#015cda}.msportalfx-svg-palette-black{fill:#1e1e1e}.msportalfx-svg-palette-green{fill:#57a300}.msportalfx-svg-palette-gray{fill:#a0a1a2}.msportalfx-svg-palette-inherit{fill:inherit}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:10px;min-width:10px}.fxc-menu-icon>.msportalfx-svg-badge{left:-2px;bottom:-2px;min-height:8px;min-width:8px}.msportalfx-svg-disabled{filter:grayscale(100%)}.msportalfx-svg-loading-square{animation:ProgressFlagAnimation 1.45s infinite ease-in-out;transform-origin:50%}.msportalfx-svg-loading-square:nth-child(1){animation-delay:0s}.msportalfx-svg-loading-square:nth-child(2){animation-delay:.2s}.msportalfx-svg-loading-square:nth-child(3){animation-delay:.4s}@keyframes ProgressFlagAnimation{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scaleX(-1)}.msportalfx-svg-fabric-rotate360{animation:ImageRotation 1.3s cubic-bezier(.53,.21,.29,.67) infinite}@keyframes ImageRotation{0%{transform:rotate(-45deg)}100%{transform:rotate(315deg)}}.fxs-svg-number .msportalfx-font-bold{font-size:10px;fill:#0065ad}.fxs-svg-number .fxs-svg-circle{stroke-width:0%;fill:#0078d4}.fxs-svg-number .fxs-svg-text{fill:#fff;font-size:10px}.fxs-svg-number.msportalfx-svg-disabled{filter:grayscale(0%)}.fxs-svg-number.msportalfx-svg-disabled .fxs-svg-circle{fill:#fff;stroke-width:1px;stroke:#949494}.fxs-svg-number.msportalfx-svg-disabled .fxs-svg-text{fill:#949494}.fxs-theme-dark .fxs-svg-number .fxs-svg-text{fill:#0f0f0f}.fxs-theme-dark .fxs-svg-number .fxs-svg-circle{stroke-width:0%;fill:#0078d4}.fxs-theme-dark .fxs-svg-number.msportalfx-svg-disabled .fxs-svg-circle{fill:#0f0f0f;stroke-width:1px;stroke:#949494}.fxs-theme-dark .fxs-svg-number.msportalfx-svg-disabled .fxs-svg-text{fill:#949494}",moduleId:e.id}})),
define("MsPortalImpl/Init",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/UI/UI.Initialize","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.HistoryManager","FxInternal/Environment","FxInternal/Css","_generated/Less/MsPortalImpl/Base/Base.Images.css","MsPortalImpl/InitShellWorker","FxInternal/Experimentation","Fx/Telemetry"],(function(e,t,s,o,i,n,r,a,l,c,d,p,u,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,d.injectCss)(p);var g=MsPortalFx.Base,f=g.Diagnostics,x=g.UriBuilder,b=r.ComponentName;const y=fx.environment,v=f.createLog(e),M=s.container.get(r.StorageService),C=new x(a.originalHref);C.query=new g.QueryStringBuilder(MsPortalEarly.userQuery),(0,l.replaceState)({data:{},url:C.toString()}),M.clearValue(b.Redirect,"IdpRedirectCount",1);let P=0;const w=M.getValue(b.Redirect,"Referrers",1)||"";setInterval((function(e){const t={fx:y.version};(e?Promise.resolve():Promise.all([s.container.getAsync(o.ExtensionManager),s.container.getAsync(i.ManifestCache)]).then((([e,s])=>{e.initializedExtensions.forEach((e=>{t[e.name]=s.getVersion(e.name)}))}))).then((()=>{v.custom("Session",1,++P,w,t)}))}),36e5);const I=Promise.withResolvers();s.container.set(c.Environment,{extensionName:y.extensionName,sdkEnv:{},shellTrustedLinkedDomains:FxImpl.internalEnv.shellTrustedLinkedDomains,trustedLinkedDomains:void 0,linkedDomainMap:FxImpl.internalEnv.linkedDomainMap}).set(m.ExperimentationManager,new m.ExperimentationManager({frameContext:1,shellVariants:MsPortalEarly.preload.then((e=>e?.variants?.hubsextension)),features:FxImpl.features,trace:h.trace})).get(n.Portal).initialize(I),I.promise.then((()=>{(0,u.init)(s.container)})),FxImpl.features.getValue("extensionsidebar")&&MsPortalFx.require("MsPortalImpl/UI/UI.BladeOpenerImpl")}));